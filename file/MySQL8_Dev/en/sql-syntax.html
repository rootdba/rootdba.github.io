<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Chapter 13 SQL Statement Syntax</title>
<link rel="stylesheet" href="mvl.css" type="text/css" />
<meta name="generator" content="DocBook XSL Stylesheets + chunker.py v1.9.2" />
<link rel="start" href="index.html" title="{book-title}" />
<link rel="up" href="" title="" />
<link rel="prev" href="functions.html" title="Chapter 12 Functions and Operators" />
<link rel="next" href="data-dictionary.html" title="Chapter 14 MySQL Data Dictionary" />
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<th colspan="3" align="center">Chapter 13 SQL Statement Syntax</th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href="functions.html">Prev</a> </td>
<th width="60%" align="center"></th>
<td width="20%" align="right"> <a accesskey="n" href="data-dictionary.html">Next</a></td>
</tr>
</table>
<hr>
</div>
<div class="chapter">
<div class="titlepage">
<div>
<div>
<h1 class="title"><a name="sql-syntax"></a>Chapter 13 SQL Statement Syntax</h1>

</div>

</div>

</div>
<div class="toc">
<p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="sql-syntax.html#sql-syntax-data-definition">13.1 Data Definition Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#atomic-ddl">13.1.1 Atomic Data Definition Statement Support</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-database">13.1.2 ALTER DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-event">13.1.3 ALTER EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-function">13.1.4 ALTER FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-instance">13.1.5 ALTER INSTANCE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-logfile-group">13.1.6 ALTER LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-procedure">13.1.7 ALTER PROCEDURE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-server">13.1.8 ALTER SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-table">13.1.9 ALTER TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-tablespace">13.1.10 ALTER TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-view">13.1.11 ALTER VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-database">13.1.12 CREATE DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-event">13.1.13 CREATE EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-function">13.1.14 CREATE FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-index">13.1.15 CREATE INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-logfile-group">13.1.16 CREATE LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-procedure">13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-server">13.1.18 CREATE SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-spatial-reference-system">13.1.19 CREATE SPATIAL REFERENCE SYSTEM Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table">13.1.20 CREATE TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-tablespace">13.1.21 CREATE TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-trigger">13.1.22 CREATE TRIGGER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-view">13.1.23 CREATE VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-database">13.1.24 DROP DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-event">13.1.25 DROP EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-function">13.1.26 DROP FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-index">13.1.27 DROP INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-logfile-group">13.1.28 DROP LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-procedure">13.1.29 DROP PROCEDURE and DROP FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-server">13.1.30 DROP SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-spatial-reference-system">13.1.31 DROP SPATIAL REFERENCE SYSTEM Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-table">13.1.32 DROP TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-tablespace">13.1.33 DROP TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-trigger">13.1.34 DROP TRIGGER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-view">13.1.35 DROP VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#rename-table">13.1.36 RENAME TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#truncate-table">13.1.37 TRUNCATE TABLE Syntax</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-data-manipulation">13.2 Data Manipulation Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#call">13.2.1 CALL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#delete">13.2.2 DELETE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#do">13.2.3 DO Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#handler">13.2.4 HANDLER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#import-table">13.2.5 IMPORT TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#insert">13.2.6 INSERT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#load-data">13.2.7 LOAD DATA Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#load-xml">13.2.8 LOAD XML Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#replace">13.2.9 REPLACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#select">13.2.10 SELECT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#subqueries">13.2.11 Subquery Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#update">13.2.12 UPDATE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#with">13.2.13 WITH Syntax (Common Table Expressions)</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-transactions">13.3 Transactional and Locking Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#commit">13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#cannot-roll-back">13.3.2 Statements That Cannot Be Rolled Back</a></span></dt><dt><span class="section"><a href="sql-syntax.html#implicit-commit">13.3.3 Statements That Cause an Implicit Commit</a></span></dt><dt><span class="section"><a href="sql-syntax.html#savepoint">13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#lock-instance-for-backup">13.3.5 LOCK INSTANCE FOR BACKUP and UNLOCK INSTANCE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#lock-tables">13.3.6 LOCK TABLES and UNLOCK TABLES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-transaction">13.3.7 SET TRANSACTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#xa">13.3.8 XA Transactions</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-replication">13.4 Replication Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#replication-master-sql">13.4.1 SQL Statements for Controlling Master Servers</a></span></dt><dt><span class="section"><a href="sql-syntax.html#replication-slave-sql">13.4.2 SQL Statements for Controlling Slave Servers</a></span></dt><dt><span class="section"><a href="sql-syntax.html#replication-group-sql">13.4.3 SQL Statements for Controlling Group Replication</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-prepared-statements">13.5 Prepared SQL Statement Syntax</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#prepare">13.5.1 PREPARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#execute">13.5.2 EXECUTE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#deallocate-prepare">13.5.3 DEALLOCATE PREPARE Syntax</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-compound-statements">13.6 Compound-Statement Syntax</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#begin-end">13.6.1 BEGIN ... END Compound-Statement Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#statement-labels">13.6.2 Statement Label Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#declare">13.6.3 DECLARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#stored-program-variables">13.6.4 Variables in Stored Programs</a></span></dt><dt><span class="section"><a href="sql-syntax.html#flow-control-statements">13.6.5 Flow Control Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#cursors">13.6.6 Cursors</a></span></dt><dt><span class="section"><a href="sql-syntax.html#condition-handling">13.6.7 Condition Handling</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-server-administration">13.7 Database Administration Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#account-management-sql">13.7.1 Account Management Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#resource-group-sql">13.7.2 Resource Group Management Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#table-maintenance-sql">13.7.3 Table Maintenance Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#component-sql">13.7.4 Component, Plugin, and User-Defined Function Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-statement">13.7.5 SET Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show">13.7.6 SHOW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#other-administrative-sql">13.7.7 Other Administrative Statements</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-utility">13.8 Utility Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#describe">13.8.1 DESCRIBE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#explain">13.8.2 EXPLAIN Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#help">13.8.3 HELP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#use">13.8.4 USE Syntax</a></span></dt></dl></dd></dl>
</div>
<p>
    This chapter describes the syntax for the
    <a class="link" href="glossary.html#glos_sql" title="SQL">SQL</a> statements supported by MySQL.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-data-definition"></a>13.1 Data Definition Statements</h2>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#atomic-ddl">13.1.1 Atomic Data Definition Statement Support</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-database">13.1.2 ALTER DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-event">13.1.3 ALTER EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-function">13.1.4 ALTER FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-instance">13.1.5 ALTER INSTANCE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-logfile-group">13.1.6 ALTER LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-procedure">13.1.7 ALTER PROCEDURE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-server">13.1.8 ALTER SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-table">13.1.9 ALTER TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-tablespace">13.1.10 ALTER TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-view">13.1.11 ALTER VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-database">13.1.12 CREATE DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-event">13.1.13 CREATE EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-function">13.1.14 CREATE FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-index">13.1.15 CREATE INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-logfile-group">13.1.16 CREATE LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-procedure">13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-server">13.1.18 CREATE SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-spatial-reference-system">13.1.19 CREATE SPATIAL REFERENCE SYSTEM Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table">13.1.20 CREATE TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-tablespace">13.1.21 CREATE TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-trigger">13.1.22 CREATE TRIGGER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-view">13.1.23 CREATE VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-database">13.1.24 DROP DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-event">13.1.25 DROP EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-function">13.1.26 DROP FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-index">13.1.27 DROP INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-logfile-group">13.1.28 DROP LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-procedure">13.1.29 DROP PROCEDURE and DROP FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-server">13.1.30 DROP SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-spatial-reference-system">13.1.31 DROP SPATIAL REFERENCE SYSTEM Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-table">13.1.32 DROP TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-tablespace">13.1.33 DROP TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-trigger">13.1.34 DROP TRIGGER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-view">13.1.35 DROP VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#rename-table">13.1.36 RENAME TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#truncate-table">13.1.37 TRUNCATE TABLE Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091673063776"></a>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="atomic-ddl"></a>13.1.1 Atomic Data Definition Statement Support</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091673061568"></a><a class="indexterm" name="idm140091673060560"></a><p>
      MySQL 8.0 supports atomic Data Definition Language
      (DDL) statements. This feature is referred to as <span class="emphasis"><em>atomic
      DDL</em></span>. An atomic DDL statement combines the data
      dictionary updates, storage engine operations, and binary log
      writes associated with a DDL operation into a single, atomic
      transaction. The transaction is either committed, with applicable
      changes persisted to the data dictionary, storage engine, and
      binary log, or is rolled back, even if the server halts during the
      operation.
    </p><p>
      Atomic DDL is made possible by the introduction of the MySQL data
      dictionary in MySQL 8.0. In earlier MySQL versions,
      metadata was stored in metadata files, nontransactional tables,
      and storage engine-specific dictionaries, which necessitated
      intermediate commits. Centralized, transactional metadata storage
      provided by the MySQL data dictionary removed this barrier, making
      it possible to restructure DDL statement operations into atomic
      transactions.
    </p><p>
      The atomic DDL feature is described under the following topics in
      this section:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#atomic-ddl-supported-statements" title="Supported DDL Statements">Supported DDL Statements</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#atomic-ddl-characteristics" title="Atomic DDL Characteristics">Atomic DDL Characteristics</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#atomic-ddl-statement-behavior" title="Changes in DDL Statement Behavior">Changes in DDL Statement Behavior</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#atomic-ddl-storage-engine-support" title="Storage Engine Support">Storage Engine Support</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#atomic-ddl-view-logs" title="Viewing DDL Logs">Viewing DDL Logs</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="atomic-ddl-supported-statements"></a>Supported DDL Statements</h4>

</div>

</div>

</div>
<p>
        The atomic DDL feature supports both table and non-table DDL
        statements. Table-related DDL operations require storage engine
        support, whereas non-table DDL operations do not. Currently,
        only the <code class="literal">InnoDB</code> storage engine supports
        atomic DDL.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Supported table DDL statements include
            <code class="literal">CREATE</code>, <code class="literal">ALTER</code>, and
            <code class="literal">DROP</code> statements for databases,
            tablespaces, tables, and indexes, and the
            <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> statement.
          </p></li><li class="listitem"><p>
            Supported non-table DDL statements include:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">CREATE</code> and <code class="literal">DROP</code>
                statements, and, if applicable, <code class="literal">ALTER</code>
                statements for stored programs, triggers, views, and
                user-defined functions (UDFs).
              </p></li><li class="listitem"><p>
                Account management statements:
                <code class="literal">CREATE</code>, <code class="literal">ALTER</code>,
                <code class="literal">DROP</code>, and, if applicable,
                <code class="literal">RENAME</code> statements for users and
                roles, as well as <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a>
                and <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> statements.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
        The following statements are not supported by the atomic DDL
        feature:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Table-related DDL statements that involve a storage engine
            other than <code class="literal">InnoDB</code>.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> and
            <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a>
            statements.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#install-component" title="13.7.4.3 INSTALL COMPONENT Syntax"><code class="literal">INSTALL COMPONENT</code></a> and
            <a class="link" href="sql-syntax.html#uninstall-component" title="13.7.4.5 UNINSTALL COMPONENT Syntax"><code class="literal">UNINSTALL COMPONENT</code></a>
            statements.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#create-server" title="13.1.18 CREATE SERVER Syntax"><code class="literal">CREATE SERVER</code></a>,
            <a class="link" href="sql-syntax.html#alter-server" title="13.1.8 ALTER SERVER Syntax"><code class="literal">ALTER SERVER</code></a>, and
            <a class="link" href="sql-syntax.html#drop-server" title="13.1.30 DROP SERVER Syntax"><code class="literal">DROP SERVER</code></a> statements.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="atomic-ddl-characteristics"></a>Atomic DDL Characteristics</h4>

</div>

</div>

</div>
<p>
        The characteristics of atomic DDL statements include the
        following:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Metadata updates, binary log writes, and storage engine
            operations, where applicable, are combined into a single
            transaction.
          </p></li><li class="listitem"><p>
            There are no intermediate commits at the SQL layer during
            the DDL operation.
          </p></li><li class="listitem"><p>
            Where applicable:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                The state of data dictionary, routine, event, and UDF
                caches is consistent with the status of the DDL
                operation, meaning that caches are updated to reflect
                whether or not the DDL operation was completed
                successfully or rolled back.
              </p></li><li class="listitem"><p>
                The storage engine methods involved in a DDL operation
                do not perform intermediate commits, and the storage
                engine registers itself as part of the DDL transaction.
              </p></li><li class="listitem"><p>
                The storage engine supports redo and rollback of DDL
                operations, which is performed in the
                <span class="emphasis"><em>Post-DDL</em></span> phase of the DDL
                operation.
</p></li></ul>
</div>
</li><li class="listitem"><p>
            The visible behaviour of DDL operations is atomic, which
            changes the behavior of some DDL statements. See
            <a class="xref" href="sql-syntax.html#atomic-ddl-statement-behavior" title="Changes in DDL Statement Behavior">Changes in DDL Statement Behavior</a>.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          DDL statements, atomic or otherwise, implicitly end any
          transaction that is active in the current session, as if you
          had done a <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a> before
          executing the statement. This means that DDL statements cannot
          be performed within another transaction, within transaction
          control statements such as
          <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START TRANSACTION ...
          COMMIT</code></a>, or combined with other statements within the
          same transaction.
</p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="atomic-ddl-statement-behavior"></a>Changes in DDL Statement Behavior</h4>

</div>

</div>

</div>
<p>
        This section describes changes in DDL statement behavior due to
        the introduction of atomic DDL support.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> operations are
            fully atomic if all named tables use an atomic DDL-supported
            storage engine. The statement either drops all tables
            successfully or is rolled back.
          </p><p>
            <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> fails with an
            error if a named table does not exist, and no changes are
            made, regardless of the storage engine. This change in
            behavior is demonstrated in the following example, where the
            <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement fails
            because a named table does not exist:
          </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT);</code></strong>
mysql&gt; <strong class="userinput"><code>DROP TABLE t1, t2;</code></strong>
ERROR 1051 (42S02): Unknown table 'test.t2'
mysql&gt; <strong class="userinput"><code>SHOW TABLES;</code></strong>
+----------------+
| Tables_in_test |
+----------------+
| t1             |
+----------------+
</pre><p>
            Prior to the introduction of atomic DDL,
            <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> reports an error
            for the named table that does not exist but succeeds for the
            named table that does exist:
          </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT);</code></strong>
mysql&gt; <strong class="userinput"><code>DROP TABLE t1, t2;</code></strong>
ERROR 1051 (42S02): Unknown table 'test.t2'
mysql&gt; <strong class="userinput"><code>SHOW TABLES;</code></strong>
Empty set (0.00 sec)
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Due to this change in behavior, a partially completed
              <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement on a
              MySQL 5.7 master fails when replicated on a MySQL 8.0
              slave. To avoid this failure scenario, use <code class="literal">IF
              EXISTS</code> syntax in <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP
              TABLE</code></a> statements to prevent errors from
              occurring for tables that do not exist.
</p>
</div>
</li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> is atomic if
            all tables use an atomic DDL-supported storage engine. The
            statement either drops all objects successfully or is rolled
            back. However, removal of the database directory from the
            file system occurs last and is not part of the atomic
            transaction. If removal of the database directory fails due
            to a file system error or server halt, the
            <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> transaction is
            not rolled back.
          </p></li><li class="listitem"><p>
            For tables that do not use an atomic DDL-supported storage
            engine, table deletion occurs outside of the atomic
            <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> or
            <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> transaction.
            Such table deletions are written to the binary log
            individually, which limits the discrepancy between the
            storage engine, data dictionary, and binary log to one table
            at most in the case of an interrupted
            <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> or
            <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> operation. For
            operations that drop multiple tables, the tables that do not
            use an atomic DDL-supported storage engine are dropped
            before tables that do.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>,
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>,
            <a class="link" href="sql-syntax.html#rename-table" title="13.1.36 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a>,
            <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>,
            <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.21 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a>, and
            <a class="link" href="sql-syntax.html#drop-tablespace" title="13.1.33 DROP TABLESPACE Syntax"><code class="literal">DROP TABLESPACE</code></a> operations
            for tables that use an atomic DDL-supported storage engine
            are either fully committed or rolled back if the server
            halts during their operation. In earlier MySQL releases,
            interruption of these operations could cause discrepancies
            between the storage engine, data dictionary, and binary log,
            or leave behind orphan files. <a class="link" href="sql-syntax.html#rename-table" title="13.1.36 RENAME TABLE Syntax"><code class="literal">RENAME
            TABLE</code></a> operations are only atomic if all named
            tables use an atomic DDL-supported storage engine.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a> fails if a named
            view does not exist, and no changes are made. The change in
            behavior is demonstrated in this example, where the
            <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a> statement fails
            because a named view does not exist:
          </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE VIEW test.viewA AS SELECT * FROM t;</code></strong>
mysql&gt; <strong class="userinput"><code>DROP VIEW test.viewA, test.viewB;</code></strong>
ERROR 1051 (42S02): Unknown table 'test.viewB'
mysql&gt; <strong class="userinput"><code>SHOW FULL TABLES IN test WHERE TABLE_TYPE LIKE 'VIEW';</code></strong>
+----------------+------------+
| Tables_in_test | Table_type |
+----------------+------------+
| viewA          | VIEW       |
+----------------+------------+
</pre><p>
            Prior to the introduction of atomic DDL,
            <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a> returns an error
            for the named view that does not exist but succeeds for the
            named view that does exist:
          </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE VIEW test.viewA AS SELECT * FROM t;</code></strong>
mysql&gt; <strong class="userinput"><code>DROP VIEW test.viewA, test.viewB;</code></strong>
ERROR 1051 (42S02): Unknown table 'test.viewB'
mysql&gt; <strong class="userinput"><code>SHOW FULL TABLES IN test WHERE TABLE_TYPE LIKE 'VIEW';</code></strong>
Empty set (0.00 sec)
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Due to this change in behavior, a partially completed
              <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a> operation on a
              MySQL 5.7 master fails when replicated on a MySQL 8.0
              slave. To avoid this failure scenario, use <code class="literal">IF
              EXISTS</code> syntax in <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP
              VIEW</code></a> statements to prevent an error from
              occurring for views that do not exist.
</p>
</div>
</li><li class="listitem"><p>
            Partial execution of account management statements is no
            longer permitted. Account management statements either
            succeed for all named users or roll back and have no effect
            if an error occurs. In earlier MySQL versions, account
            management statements that name multiple users could succeed
            for some users and fail for others.
          </p><p>
            The change in behavior is demonstrated in this example,
            where the second <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>
            statement returns an error but fails because it cannot
            succeed for all named users.
          </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE USER userA;</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE USER userA, userB;</code></strong>
ERROR 1396 (HY000): Operation CREATE USER failed for 'userA'@'%'
mysql&gt; <strong class="userinput"><code>SELECT User FROM mysql.user WHERE User LIKE 'user%';</code></strong>
+-------+
| User  |
+-------+
| userA |
+-------+
</pre><p>
            Prior to the introduction of atomic DDL, the second
            <code class="literal">CREATE USER</code> statement returns an error
            for the named user that does not exist but succeeds for the
            named user that does exist:
          </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE USER userA;</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE USER userA, userB;</code></strong>
ERROR 1396 (HY000): Operation CREATE USER failed for 'userA'@'%'
mysql&gt; <strong class="userinput"><code>SELECT User FROM mysql.user WHERE User LIKE 'user%';</code></strong>
+-------+
| User  |
+-------+
| userA |
| userB |
+-------+
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Due to this change in behavior, partially completed
              account management statements on a MySQL 5.7 master fail
              when replicated on a MySQL 8.0 slave. To avoid this
              failure scenario, use <code class="literal">IF EXISTS</code> or
              <code class="literal">IF NOT EXISTS</code> syntax, as appropriate,
              in account management statements to prevent errors related
              to named users.
</p>
</div>
</li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="atomic-ddl-storage-engine-support"></a>Storage Engine Support</h4>

</div>

</div>

</div>
<p>
        Currently, only the <code class="literal">InnoDB</code> storage engine
        supports atomic DDL. Storage engines that do not support atomic
        DDL are exempted from DDL atomicity. DDL operations involving
        exempted storage engines remain capable of introducing
        inconsistencies that can occur when operations are interrupted
        or only partially completed.
      </p><p>
        To support redo and rollback of DDL operations,
        <code class="literal">InnoDB</code> writes DDL logs to the
        <code class="literal">mysql.innodb_ddl_log</code> table, which is a hidden
        data dictionary table that resides in the
        <code class="filename">mysql.ibd</code> data dictionary tablespace.
      </p><p>
        To view DDL logs that are written to the
        <code class="literal">mysql.innodb_ddl_log</code> table during a DDL
        operation, enable the
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_print_ddl_logs"><code class="literal">innodb_print_ddl_logs</code></a>
        configuration option. For more information, see
        <a class="xref" href="sql-syntax.html#atomic-ddl-view-logs" title="Viewing DDL Logs">Viewing DDL Logs</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          The redo logs for changes to the
          <code class="literal">mysql.innodb_ddl_log</code> table are flushed to
          disk immediately regardless of the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_flush_log_at_trx_commit"><code class="literal">innodb_flush_log_at_trx_commit</code></a>
          setting. Flushing the redo logs immediately avoids situations
          where data files are modified by DDL operations but the redo
          logs for changes to the
          <code class="literal">mysql.innodb_ddl_log</code> table resulting from
          those operations are not persisted to disk. Such a situation
          could cause errors during rollback or recovery.
</p>
</div>
<p>
        The <code class="literal">InnoDB</code> storage engine executes DDL
        operations in phases. DDL operations such as
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> may perform the
        <span class="emphasis"><em>Prepare</em></span> and <span class="emphasis"><em>Perform</em></span>
        phases multiple times prior to the <span class="emphasis"><em>Commit</em></span>
        phase.
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            <span class="emphasis"><em>Prepare</em></span>: Create the required objects
            and write the DDL logs to the
            <code class="literal">mysql.innodb_ddl_log</code> table. The DDL logs
            define how to roll forward and roll back the DDL operation.
          </p></li><li class="listitem"><p>
            <span class="emphasis"><em>Perform</em></span>: Perform the DDL operation. For
            example, perform a create routine for a <code class="literal">CREATE
            TABLE</code> operation.
          </p></li><li class="listitem"><p>
            <span class="emphasis"><em>Commit</em></span>: Update the data dictionary and
            commit the data dictionary transaction.
          </p></li><li class="listitem"><p>
            <span class="emphasis"><em>Post-DDL</em></span>: Replay and remove DDL logs
            from the <code class="literal">mysql.innodb_ddl_log</code> table. To
            ensure that rollback can be performed safely without
            introducing inconsistencies, file operations such as
            renaming or removing data files are performed in this final
            phase. This phase also removes dynamic metadata from the
            <code class="literal">mysql.innodb_dynamic_metadata</code> data
            dictionary table for <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP
            TABLE</code></a>, <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
            TABLE</code></a>, and other DDL operations that rebuild the
            table.
</p></li></ol>
</div>
<p>
        DDL logs are replayed and removed from the
        <code class="literal">mysql.innodb_ddl_log</code> table during the
        <span class="emphasis"><em>Post-DDL</em></span> phase, regardless of whether the
        transaction is committed or rolled back. DDL logs should only
        remain in the <code class="literal">mysql.innodb_ddl_log</code> table if
        the server is halted during a DDL operation. In this case, the
        DDL logs are replayed and removed after recovery.
      </p><p>
        In a recovery situation, a DDL transaction may be committed or
        rolled back when the server is restarted. If the data dictionary
        transaction that was performed during the
        <span class="emphasis"><em>Commit</em></span> phase of a DDL operation is present
        in the redo log and binary log, the operation is considered
        successful and is rolled forward. Otherwise, the incomplete data
        dictionary transaction is rolled back when
        <code class="literal">InnoDB</code> replays data dictionary redo logs, and
        the DDL transaction is rolled back.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="atomic-ddl-view-logs"></a>Viewing DDL Logs</h4>

</div>

</div>

</div>
<p>
        To view DDL logs that are written to the
        <code class="literal">mysql.innodb_ddl_log</code> data dictionary table
        during atomic DDL operations that involve the
        <code class="literal">InnoDB</code> storage engine, enable
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_print_ddl_logs"><code class="literal">innodb_print_ddl_logs</code></a> to have
        MySQL write the DDL logs to <code class="literal">stderr</code>. Depending
        on the host operating system and MySQL configuration,
        <code class="literal">stderr</code> may be the error log, terminal, or
        console window. See
        <a class="xref" href="server-administration.html#error-log-destination-configuration" title="5.4.2.2 Default Error Log Destination Configuration">Section 5.4.2.2, “Default Error Log Destination Configuration”</a>.
      </p><p>
        <code class="literal">InnoDB</code> writes DDL logs to the
        <code class="literal">mysql.innodb_ddl_log</code> table to support redo
        and rollback of DDL operations. The
        <code class="literal">mysql.innodb_ddl_log</code> table is a hidden data
        dictionary table that resides in the
        <code class="filename">mysql.ibd</code> data dictionary tablespace. Like
        other hidden data dictionary tables, the
        <code class="literal">mysql.innodb_ddl_log</code> table cannot be accessed
        directly in non-debug versions of MySQL. (See
        <a class="xref" href="data-dictionary.html#data-dictionary-schema" title="14.1 Data Dictionary Schema">Section 14.1, “Data Dictionary Schema”</a>.) The structure of the
        <code class="literal">mysql.innodb_ddl_log</code> table corresponds to
        this definition:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE mysql.innodb_ddl_log (
  id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  thread_id BIGINT UNSIGNED NOT NULL,
  type INT UNSIGNED NOT NULL,
  space_id INT UNSIGNED,
  page_no INT UNSIGNED,
  index_id BIGINT UNSIGNED,
  table_id BIGINT UNSIGNED,
  old_file_path VARCHAR(512) COLLATE UTF8_BIN,
  new_file_path VARCHAR(512) COLLATE UTF8_BIN,
  KEY(thread_id)
);
</pre>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">id</code>: A unique identifier for a DDL log
            record.
          </p></li><li class="listitem"><p>
            <code class="literal">thread_id</code>: Each DDL log record is
            assigned a <code class="literal">thread_id</code>, which is used to
            replay and remove DDL logs that belong to a particular DDL
            transaction. DDL transactions that involve multiple data
            file operations generate multiple DDL log records.
          </p></li><li class="listitem"><p>
            <code class="literal">type</code>: The DDL operation type. Types
            include <code class="literal">FREE</code> (drop an index tree),
            <code class="literal">DELETE</code> (delete a file),
            <code class="literal">RENAME</code> (rename a file), or
            <code class="literal">DROP</code> (drop metadata from the
            <code class="literal">mysql.innodb_dynamic_metadata</code> data
            dictionary table).
          </p></li><li class="listitem"><p>
            <code class="literal">space_id</code>: The tablespace ID.
          </p></li><li class="listitem"><p>
            <code class="literal">page_no</code>: A page that contains allocation
            information; an index tree root page, for example.
          </p></li><li class="listitem"><p>
            <code class="literal">index_id</code>: The index ID.
          </p></li><li class="listitem"><p>
            <code class="literal">table_id</code>: The table ID.
          </p></li><li class="listitem"><p>
            <code class="literal">old_file_path</code>: The old tablespace file
            path. Used by DDL operations that create or drop tablespace
            files; also used by DDL operations that rename a tablespace.
          </p></li><li class="listitem"><p>
            <code class="literal">new_file_path</code>: The new tablespace file
            path. Used by DDL operations that rename tablespace files.
</p></li></ul>
</div>
<p>
        This example demonstrates enabling
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_print_ddl_logs"><code class="literal">innodb_print_ddl_logs</code></a> to view
        DDL logs written to <code class="literal">strderr</code> for a
        <code class="literal">CREATE TABLE</code> operation.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; SET GLOBAL innodb_print_ddl_logs=1;
mysql&gt; CREATE TABLE t1 (c1 INT) ENGINE = InnoDB;
</pre><pre data-lang="none" class="programlisting">
[Note] [000000] InnoDB: DDL log insert : [DDL record: DELETE SPACE, id=18, thread_id=7, 
space_id=5, old_file_path=./test/t1.ibd]
[Note] [000000] InnoDB: DDL log delete : by id 18
[Note] [000000] InnoDB: DDL log insert : [DDL record: REMOVE CACHE, id=19, thread_id=7, 
table_id=1058, new_file_path=test/t1]
[Note] [000000] InnoDB: DDL log delete : by id 19
[Note] [000000] InnoDB: DDL log insert : [DDL record: FREE, id=20, thread_id=7, 
space_id=5, index_id=132, page_no=4]
[Note] [000000] InnoDB: DDL log delete : by id 20
[Note] [000000] InnoDB: DDL log post ddl : begin for thread id : 7
[Note] [000000] InnoDB: DDL log post ddl : end for thread id : 7
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-database"></a>13.1.2 ALTER DATABASE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091672863152"></a><a class="indexterm" name="idm140091672862080"></a><a class="indexterm" name="idm140091672861008"></a><a class="indexterm" name="idm140091672859520"></a><a class="indexterm" name="idm140091672858032"></a><a class="indexterm" name="idm140091672856544"></a><pre data-lang="sql" class="programlisting">
ALTER {DATABASE | SCHEMA} [<em class="replaceable"><code>db_name</code></em>]
    <em class="replaceable"><code>alter_specification</code></em> ...

<em class="replaceable"><code>alter_specification</code></em>:
    [DEFAULT] CHARACTER SET [=] <em class="replaceable"><code>charset_name</code></em>
  | [DEFAULT] COLLATE [=] <em class="replaceable"><code>collation_name</code></em>
  | DEFAULT ENCRYPTION [=] {'Y' | 'N'}
</pre><p>
      <a class="link" href="sql-syntax.html#alter-database" title="13.1.2 ALTER DATABASE Syntax"><code class="literal">ALTER DATABASE</code></a> enables you to
      change the overall characteristics of a database. These
      characteristics are stored in the data dictionary. To use
      <a class="link" href="sql-syntax.html#alter-database" title="13.1.2 ALTER DATABASE Syntax"><code class="literal">ALTER DATABASE</code></a>, you need the
      <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a> privilege on the database.
      <a class="link" href="sql-syntax.html#alter-database" title="13.1.2 ALTER DATABASE Syntax"><code class="literal">ALTER
      SCHEMA</code></a> is a synonym for <a class="link" href="sql-syntax.html#alter-database" title="13.1.2 ALTER DATABASE Syntax"><code class="literal">ALTER
      DATABASE</code></a>.
    </p><p>
      The database name can be omitted from the first syntax, in which
      case the statement applies to the default database.
</p>
<h4><a name="idm140091672841184"></a>National Language Characteristics</h4>
<p>
      The <code class="literal">CHARACTER SET</code> clause changes the default
      database character set. The <code class="literal">COLLATE</code> clause
      changes the default database collation. <a class="xref" href="charset.html" title="Chapter 10 Character Sets, Collations, Unicode">Chapter 10, <i>Character Sets, Collations, Unicode</i></a>,
      discusses character set and collation names.
    </p><p>
      You can see what character sets and collations are available
      using, respectively, the <a class="link" href="sql-syntax.html#show-character-set" title="13.7.6.3 SHOW CHARACTER SET Syntax"><code class="literal">SHOW CHARACTER
      SET</code></a> and <a class="link" href="sql-syntax.html#show-collation" title="13.7.6.4 SHOW COLLATION Syntax"><code class="literal">SHOW COLLATION</code></a>
      statements. See <a class="xref" href="sql-syntax.html#show-character-set" title="13.7.6.3 SHOW CHARACTER SET Syntax">Section 13.7.6.3, “SHOW CHARACTER SET Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#show-collation" title="13.7.6.4 SHOW COLLATION Syntax">Section 13.7.6.4, “SHOW COLLATION Syntax”</a>, for more information.
    </p><p>
      If you change the default character set or collation for a
      database, stored routines that use the database defaults must be
      dropped and recreated so that they use the new defaults. (In a
      stored routine, variables with character data types use the
      database defaults if the character set or collation are not
      specified explicitly. See <a class="xref" href="sql-syntax.html#create-procedure" title="13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax">Section 13.1.17, “CREATE PROCEDURE and CREATE FUNCTION Syntax”</a>.)
</p>
<h4><a name="idm140091672832032"></a>Encryption</h4>
<p>
      The <code class="literal">DEFAULT ENCRYPTION</code> clause, introduced in
      MySQL 8.0.16, defines the default database encryption, which is
      inherited by tables created in the database. Changing the default
      encryption of the database does not alter the encryption of
      existing tables associated with the schema. Only newly-created
      tables inherit the default database encryption. An <code class="literal">ALTER
      DATABASE</code> statement executed without a <code class="literal">DEFAULT
      ENCRYPTION</code> clause retains the existing default database
      encryption. If the
      <a class="link" href="server-administration.html#sysvar_table_encryption_privilege_check"><code class="literal">table_encryption_privilege_check</code></a>
      variable is enabled, the
      <a class="link" href="security.html#priv_table-encryption-admin"><code class="literal">TABLE_ENCRYPTION_ADMIN</code></a> privilege is
      required to specify a default encryption setting that differs from
      the <a class="link" href="server-administration.html#sysvar_default_table_encryption"><code class="literal">default_table_encryption</code></a>
      setting. For more information, see
      <a class="xref" href="innodb-storage-engine.html#innodb-schema-tablespace-encryption-default" title="Defining an Encryption Default for Schemas and General Tablespaces">Defining an Encryption Default for Schemas and General Tablespaces</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-event"></a>13.1.3 ALTER EVENT Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091672821888"></a><a class="indexterm" name="idm140091672820400"></a><a class="indexterm" name="idm140091672818912"></a><pre data-lang="sql" class="programlisting">
ALTER
    [DEFINER = <em class="replaceable"><code>user</code></em>]
    EVENT <em class="replaceable"><code>event_name</code></em>
    [ON SCHEDULE <em class="replaceable"><code>schedule</code></em>]
    [ON COMPLETION [NOT] PRESERVE]
    [RENAME TO <em class="replaceable"><code>new_event_name</code></em>]
    [ENABLE | DISABLE | DISABLE ON SLAVE]
    [COMMENT '<em class="replaceable"><code>string</code></em>']
    [DO <em class="replaceable"><code>event_body</code></em>]
</pre><p>
      The <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement changes
      one or more of the characteristics of an existing event without
      the need to drop and recreate it. The syntax for each of the
      <code class="literal">DEFINER</code>, <code class="literal">ON SCHEDULE</code>,
      <code class="literal">ON COMPLETION</code>, <code class="literal">COMMENT</code>,
      <code class="literal">ENABLE</code> / <code class="literal">DISABLE</code>, and
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clauses is exactly the same as
      when used with <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a>. (See
      <a class="xref" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax">Section 13.1.13, “CREATE EVENT Syntax”</a>.)
    </p><p>
      Any user can alter an event defined on a database for which that
      user has the <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a> privilege. When
      a user executes a successful <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER
      EVENT</code></a> statement, that user becomes the definer for the
      affected event.
    </p><p>
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> works only with an
      existing event:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER EVENT no_such_event </code></strong>
     &gt;     <strong class="userinput"><code>ON SCHEDULE </code></strong>
     &gt;       <strong class="userinput"><code>EVERY '2:3' DAY_HOUR;</code></strong>
<span class="errortext">ERROR 1517 (HY000): Unknown event 'no_such_event'</span>
</pre><p>
      In each of the following examples, assume that the event named
      <code class="literal">myevent</code> is defined as shown here:
    </p><pre data-lang="sql" class="programlisting">
CREATE EVENT myevent
    ON SCHEDULE
      EVERY 6 HOUR
    COMMENT 'A sample comment.'
    DO
      UPDATE myschema.mytable SET mycol = mycol + 1;
</pre><p>
      The following statement changes the schedule for
      <code class="literal">myevent</code> from once every six hours starting
      immediately to once every twelve hours, starting four hours from
      the time the statement is run:
    </p><pre data-lang="sql" class="programlisting">
ALTER EVENT myevent
    ON SCHEDULE
      EVERY 12 HOUR
    STARTS CURRENT_TIMESTAMP + INTERVAL 4 HOUR;
</pre><p>
      It is possible to change multiple characteristics of an event in a
      single statement. This example changes the SQL statement executed
      by <code class="literal">myevent</code> to one that deletes all records from
      <code class="literal">mytable</code>; it also changes the schedule for the
      event such that it executes once, one day after this
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement is run.
    </p><pre data-lang="sql" class="programlisting">
ALTER EVENT myevent
    ON SCHEDULE
      AT CURRENT_TIMESTAMP + INTERVAL 1 DAY
    DO
      TRUNCATE TABLE myschema.mytable;
</pre><p>
      Specify the options in an <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER
      EVENT</code></a> statement only for those characteristics that you
      want to change; omitted options keep their existing values. This
      includes any default values for <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE
      EVENT</code></a> such as <code class="literal">ENABLE</code>.
    </p><p>
      To disable <code class="literal">myevent</code>, use this
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement:
    </p><pre data-lang="sql" class="programlisting">
ALTER EVENT myevent
    DISABLE;
</pre><p>
      The <code class="literal">ON SCHEDULE</code> clause may use expressions
      involving built-in MySQL functions and user variables to obtain
      any of the <em class="replaceable"><code>timestamp</code></em> or
      <em class="replaceable"><code>interval</code></em> values which it contains. You
      cannot use stored routines or user-defined functions in such
      expressions, and you cannot use any table references; however, you
      can use <code class="literal">SELECT FROM DUAL</code>. This is true for both
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> and
      <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> statements. References
      to stored routines, user-defined functions, and tables in such
      cases are specifically not permitted, and fail with an error (see
      Bug #22830).
    </p><p>
      Although an <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement
      that contains another <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a>
      statement in its <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause appears
      to succeed, when the server attempts to execute the resulting
      scheduled event, the execution fails with an error.
    </p><p>
      To rename an event, use the <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER
      EVENT</code></a> statement's <code class="literal">RENAME TO</code> clause.
      This statement renames the event <code class="literal">myevent</code> to
      <code class="literal">yourevent</code>:
    </p><pre data-lang="sql" class="programlisting">
ALTER EVENT myevent
    RENAME TO yourevent;
</pre><p>
      You can also move an event to a different database using
      <code class="literal">ALTER EVENT ... RENAME TO ...</code> and
      <code class="literal"><em class="replaceable"><code>db_name.event_name</code></em></code>
      notation, as shown here:
    </p><pre data-lang="sql" class="programlisting">
ALTER EVENT olddb.myevent
    RENAME TO newdb.myevent;
</pre><p>
      To execute the previous statement, the user executing it must have
      the <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a> privilege on both the
      <code class="literal">olddb</code> and <code class="literal">newdb</code> databases.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        There is no <code class="literal">RENAME EVENT</code> statement.
</p>
</div>
<p>
      The value <code class="literal">DISABLE ON SLAVE</code> is used on a
      replication slave instead of <code class="literal">ENABLE</code> or
      <code class="literal">DISABLE</code> to indicate an event that was created
      on the master and replicated to the slave, but that is not
      executed on the slave. Normally, <code class="literal">DISABLE ON
      SLAVE</code> is set automatically as required; however, there
      are some circumstances under which you may want or need to change
      it manually. See <a class="xref" href="replication.html#replication-features-invoked" title="17.4.1.16 Replication of Invoked Features">Section 17.4.1.16, “Replication of Invoked Features”</a>,
      for more information.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-function"></a>13.1.4 ALTER FUNCTION Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091672749424"></a><pre data-lang="sql" class="programlisting">
ALTER FUNCTION <em class="replaceable"><code>func_name</code></em> [<em class="replaceable"><code>characteristic</code></em> ...]

<em class="replaceable"><code>characteristic</code></em>:
    COMMENT '<em class="replaceable"><code>string</code></em>'
  | LANGUAGE SQL
  | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  | SQL SECURITY { DEFINER | INVOKER }
</pre><p>
      This statement can be used to change the characteristics of a
      stored function. More than one change may be specified in an
      <a class="link" href="sql-syntax.html#alter-function" title="13.1.4 ALTER FUNCTION Syntax"><code class="literal">ALTER FUNCTION</code></a> statement. However,
      you cannot change the parameters or body of a stored function
      using this statement; to make such changes, you must drop and
      re-create the function using <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP
      FUNCTION</code></a> and <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE
      FUNCTION</code></a>.
    </p><p>
      You must have the <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a>
      privilege for the function. (That privilege is granted
      automatically to the function creator.) If binary logging is
      enabled, the <a class="link" href="sql-syntax.html#alter-function" title="13.1.4 ALTER FUNCTION Syntax"><code class="literal">ALTER FUNCTION</code></a>
      statement might also require the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, as described in
      <a class="xref" href="stored-objects.html#stored-programs-logging" title="24.7 Stored Program Binary Logging">Section 24.7, “Stored Program Binary Logging”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-instance"></a>13.1.5 ALTER INSTANCE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091672730160"></a><pre data-lang="sql" class="programlisting">
ALTER INSTANCE <em class="replaceable"><code>instance_action</code></em>

<em class="replaceable"><code>instance_action</code></em>: {
    ROTATE INNODB MASTER KEY
  | ROTATE BINLOG MASTER KEY
  | RELOAD TLS [NO ROLLBACK ON ERROR]
}
</pre><p>
      <code class="literal">ALTER INSTANCE</code> defines actions applicable to a
      MySQL server instance. The statement supports these actions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="alter-instance-rotate-innodb-master-key"></a>
          <code class="literal">ALTER INSTANCE ROTATE INNODB MASTER KEY</code>
        </p><p>
          This action rotates the master encryption key used for
          <code class="literal">InnoDB</code> tablespace encryption. Key rotation
          requires the
          <a class="link" href="security.html#priv_encryption-key-admin"><code class="literal">ENCRYPTION_KEY_ADMIN</code></a> or
          <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege. To perform
          this action, a keyring plugin must be installed and
          configured. For instructions, see <a class="xref" href="security.html#keyring" title="6.4.4 The MySQL Keyring">Section 6.4.4, “The MySQL Keyring”</a>.
        </p><p>
          <code class="literal">ALTER INSTANCE ROTATE INNODB MASTER KEY</code>
          supports concurrent DML. However, it cannot be run
          concurrently with
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
          ENCRYPTION</code></a> or
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          ENCRYPTION</code></a> operations, and locks are taken to
          prevent conflicts that could arise from concurrent execution
          of these statements. If one of the conflicting statements is
          running, it must complete before another can proceed.
        </p><p>
          <code class="literal">ALTER INSTANCE ROTATE INNODB MASTER KEY</code>
          statements are written to the binary log so that they can be
          executed on replicated servers.
        </p><p>
          For additional <code class="literal">ALTER INSTANCE ROTATE INNODB MASTER
          KEY</code> usage information, see
          <a class="xref" href="innodb-storage-engine.html#innodb-tablespace-encryption" title="15.6.3.9 InnoDB Data-at-Rest Encryption">Section 15.6.3.9, “InnoDB Data-at-Rest Encryption”</a>.
        </p></li><li class="listitem"><p><a name="alter-instance-rotate-binlog-master-key"></a>
          <code class="literal">ALTER INSTANCE ROTATE BINLOG MASTER KEY</code>
        </p><p>
          This action rotates the binary log master key used for binary
          log encryption. Key rotation for the binary log master key
          requires the
          <a class="link" href="security.html#priv_binlog-encryption-admin"><code class="literal">BINLOG_ENCRYPTION_ADMIN</code></a> or
          <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege. The statement
          cannot be used if the
          <a class="link" href="replication.html#sysvar_binlog_encryption"><code class="literal">binlog_encryption</code></a> system
          variable is set to <code class="literal">OFF</code>. To perform this
          action, a keyring plugin must be installed and configured. For
          instructions, see <a class="xref" href="security.html#keyring" title="6.4.4 The MySQL Keyring">Section 6.4.4, “The MySQL Keyring”</a>.
        </p><p>
          <code class="literal">ALTER INSTANCE ROTATE BINLOG MASTER KEY</code>
          actions are not written to the binary log and are not executed
          on replication slaves. Binary log master key rotation can
          therefore be carried out in replication environments including
          a mix of MySQL versions. To schedule regular rotation of the
          binary log master key on all applicable master and slave
          servers, you can enable the MySQL Event Scheduler on each
          server and issue the <code class="literal">ALTER INSTANCE ROTATE BINLOG
          MASTER KEY</code> statement using a
          <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> statement. If you
          rotate the binary log master key because you suspect that the
          current or any of the previous binary log master keys might
          have been compromised, issue the statement on every applicable
          master and slave server, which enables you to verify immediate
          compliance.
        </p><p>
          For additional <code class="literal">ALTER INSTANCE ROTATE BINLOG MASTER
          KEY</code> usage information, including what to do if the
          process does not complete correctly or is interrupted by an
          unexpected server halt, see
          <a class="xref" href="replication.html#replication-binlog-encryption" title="17.3.10 Encrypting Binary Log Files and Relay Log Files">Section 17.3.10, “Encrypting Binary Log Files and Relay Log Files”</a>.
        </p></li><li class="listitem"><p><a name="alter-instance-reload-tls"></a>
          <code class="literal">ALTER INSTANCE RELOAD TLS</code>
        </p><p>
          This action reconfigures the SSL context from the current
          values of the system variables that define the context. It
          also updates the status variables that reflect the active
          context values. This action requires the
          <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> privilege.
        </p><p>
          By default, the <code class="literal">RELOAD TLS</code> action rolls
          back with an error and has no effect if the configuration
          values do not permit creation of a new SSL context. The
          previous context values continue to be used for new
          connections.
        </p><p>
          If the optional <code class="literal">NO ROLLBACK ON ERROR</code> clause
          is given and a new context cannot be created, rollback does
          not occur. Instead, a warning is generated and SSL is disabled
          for new connections.
        </p><p>
          <code class="literal">ALTER INSTANCE RELOAD TLS</code> statements are
          not written to the binary log (and thus are not replicated).
          SSL configuration is local and depends on local files not
          necessarily present on all servers involved.
        </p><p>
          For additional information about reconfiguring the SSL
          context, including which system and status variables are
          context-related, see
          <a class="xref" href="security.html#using-encrypted-connections-server-side-runtime-configuration" title="Server-Side Runtime Configuration for Encrypted Connections">Server-Side Runtime Configuration for Encrypted Connections</a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-logfile-group"></a>13.1.6 ALTER LOGFILE GROUP Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091672684656"></a><pre data-lang="sql" class="programlisting">
ALTER LOGFILE GROUP <em class="replaceable"><code>logfile_group</code></em>
    ADD UNDOFILE '<em class="replaceable"><code>file_name</code></em>'
    [INITIAL_SIZE [=] <em class="replaceable"><code>size</code></em>]
    [WAIT]
    ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
</pre><p>
      This statement adds an <code class="literal">UNDO</code> file named
      '<em class="replaceable"><code>file_name</code></em>' to an existing log file
      group <em class="replaceable"><code>logfile_group</code></em>. An
      <a class="link" href="sql-syntax.html#alter-logfile-group" title="13.1.6 ALTER LOGFILE GROUP Syntax"><code class="literal">ALTER LOGFILE GROUP</code></a> statement has
      one and only one <code class="literal">ADD UNDOFILE</code> clause. No
      <code class="literal">DROP UNDOFILE</code> clause is currently supported.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        All NDB Cluster Disk Data objects share the same namespace. This
        means that <span class="emphasis"><em>each Disk Data object</em></span> must be
        uniquely named (and not merely each Disk Data object of a given
        type). For example, you cannot have a tablespace and an undo log
        file with the same name, or an undo log file and a data file
        with the same name.
</p>
</div>
<p>
      The optional <code class="literal">INITIAL_SIZE</code> parameter sets the
      <code class="literal">UNDO</code> file's initial size in bytes; if not
      specified, the initial size defaults to 134217728 (128 MB). You
      may optionally follow <em class="replaceable"><code>size</code></em> with a
      one-letter abbreviation for an order of magnitude, similar to
      those used in <code class="filename">my.cnf</code>. Generally, this is one
      of the letters <code class="literal">M</code> (megabytes) or
      <code class="literal">G</code> (gigabytes). (Bug #13116514, Bug #16104705,
      Bug #62858)
    </p><p>
      On 32-bit systems, the maximum supported value for
      <code class="literal">INITIAL_SIZE</code> is 4294967296 (4 GB). (Bug #29186)
    </p><p>
      The minimum allowed value for <code class="literal">INITIAL_SIZE</code> is
      1048576 (1 MB). (Bug #29574)
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        <code class="literal">WAIT</code> is parsed but otherwise ignored. This
        keyword currently has no effect, and is intended for future
        expansion.
</p>
</div>
<p>
      The <code class="literal">ENGINE</code> parameter (required) determines the
      storage engine which is used by this log file group, with
      <em class="replaceable"><code>engine_name</code></em> being the name of the
      storage engine. Currently, the only accepted values for
      <em class="replaceable"><code>engine_name</code></em> are
      <span class="quote">“<span class="quote"><a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDBCLUSTER</code></a></span>”</span> and
      <span class="quote">“<span class="quote"><a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a></span>”</span>. The two values
      are equivalent.
    </p><p>
      Here is an example, which assumes that the log file group
      <code class="literal">lg_3</code> has already been created using
      <a class="link" href="sql-syntax.html#create-logfile-group" title="13.1.16 CREATE LOGFILE GROUP Syntax"><code class="literal">CREATE LOGFILE GROUP</code></a> (see
      <a class="xref" href="sql-syntax.html#create-logfile-group" title="13.1.16 CREATE LOGFILE GROUP Syntax">Section 13.1.16, “CREATE LOGFILE GROUP Syntax”</a>):
    </p><pre data-lang="sql" class="programlisting">
ALTER LOGFILE GROUP lg_3
    ADD UNDOFILE 'undo_10.dat'
    INITIAL_SIZE=32M
    ENGINE=NDBCLUSTER;
</pre><p>
      When <a class="link" href="sql-syntax.html#alter-logfile-group" title="13.1.6 ALTER LOGFILE GROUP Syntax"><code class="literal">ALTER LOGFILE GROUP</code></a> is used
      with <code class="literal">ENGINE = NDBCLUSTER</code> (alternatively,
      <code class="literal">ENGINE = NDB</code>), an <code class="literal">UNDO</code> log
      file is created on each NDB Cluster data node. You can verify that
      the <code class="literal">UNDO</code> files were created and obtain
      information about them by querying the
      <a class="link" href="information-schema.html#files-table" title="25.11 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> table. For
      example:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT FILE_NAME, LOGFILE_GROUP_NUMBER, EXTRA</code></strong>
    -&gt; <strong class="userinput"><code>FROM INFORMATION_SCHEMA.FILES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE LOGFILE_GROUP_NAME = 'lg_3';</code></strong>
+-------------+----------------------+----------------+
| FILE_NAME   | LOGFILE_GROUP_NUMBER | EXTRA          |
+-------------+----------------------+----------------+
| newdata.dat |                    0 | CLUSTER_NODE=3 |
| newdata.dat |                    0 | CLUSTER_NODE=4 |
| undo_10.dat |                   11 | CLUSTER_NODE=3 |
| undo_10.dat |                   11 | CLUSTER_NODE=4 |
+-------------+----------------------+----------------+
4 rows in set (0.01 sec)
</pre><p>
      (See <a class="xref" href="information-schema.html#files-table" title="25.11 The INFORMATION_SCHEMA FILES Table">Section 25.11, “The INFORMATION_SCHEMA FILES Table”</a>.)
    </p><p>
      Memory used for <code class="literal">UNDO_BUFFER_SIZE</code> comes from the
      global pool whose size is determined by the value of the
      <a class="link" href="mysql-cluster.html#ndbparam-ndbd-sharedglobalmemory"><code class="literal">SharedGlobalMemory</code></a> data
      node configuration parameter. This includes any default value
      implied for this option by the setting of the
      <a class="link" href="mysql-cluster.html#ndbparam-ndbd-initiallogfilegroup"><code class="literal">InitialLogFileGroup</code></a> data
      node configuration parameter.
    </p><p>
      <a class="link" href="sql-syntax.html#alter-logfile-group" title="13.1.6 ALTER LOGFILE GROUP Syntax"><code class="literal">ALTER LOGFILE GROUP</code></a> is useful only
      with Disk Data storage for NDB Cluster. For more information, see
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="22.5.13 NDB Cluster Disk Data Tables">Section 22.5.13, “NDB Cluster Disk Data Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-procedure"></a>13.1.7 ALTER PROCEDURE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091672634704"></a><pre data-lang="sql" class="programlisting">
ALTER PROCEDURE <em class="replaceable"><code>proc_name</code></em> [<em class="replaceable"><code>characteristic</code></em> ...]

<em class="replaceable"><code>characteristic</code></em>:
    COMMENT '<em class="replaceable"><code>string</code></em>'
  | LANGUAGE SQL
  | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  | SQL SECURITY { DEFINER | INVOKER }
</pre><p>
      This statement can be used to change the characteristics of a
      stored procedure. More than one change may be specified in an
      <a class="link" href="sql-syntax.html#alter-procedure" title="13.1.7 ALTER PROCEDURE Syntax"><code class="literal">ALTER PROCEDURE</code></a> statement. However,
      you cannot change the parameters or body of a stored procedure
      using this statement; to make such changes, you must drop and
      re-create the procedure using <a class="link" href="sql-syntax.html#drop-procedure" title="13.1.29 DROP PROCEDURE and DROP FUNCTION Syntax"><code class="literal">DROP
      PROCEDURE</code></a> and <a class="link" href="sql-syntax.html#create-procedure" title="13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax"><code class="literal">CREATE
      PROCEDURE</code></a>.
    </p><p>
      You must have the <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a>
      privilege for the procedure. By default, that privilege is granted
      automatically to the procedure creator. This behavior can be
      changed by disabling the
      <a class="link" href="server-administration.html#sysvar_automatic_sp_privileges"><code class="literal">automatic_sp_privileges</code></a> system
      variable. See <a class="xref" href="stored-objects.html#stored-routines-privileges" title="24.2.2 Stored Routines and MySQL Privileges">Section 24.2.2, “Stored Routines and MySQL Privileges”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-server"></a>13.1.8 ALTER SERVER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091672617376"></a><pre data-lang="sql" class="programlisting">
ALTER SERVER  <em class="replaceable"><code>server_name</code></em>
    OPTIONS (<em class="replaceable"><code>option</code></em> [, <em class="replaceable"><code>option</code></em>] ...)
</pre><p>
      Alters the server information for
      <code class="literal"><em class="replaceable"><code>server_name</code></em></code>,
      adjusting any of the options permitted in the
      <a class="link" href="sql-syntax.html#create-server" title="13.1.18 CREATE SERVER Syntax"><code class="literal">CREATE SERVER</code></a> statement. The
      corresponding fields in the <code class="literal">mysql.servers</code> table
      are updated accordingly. This statement requires the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
    </p><p>
      For example, to update the <code class="literal">USER</code> option:
    </p><pre data-lang="sql" class="programlisting">ALTER SERVER s OPTIONS (USER 'sally');</pre><p>
      <code class="literal">ALTER SERVER</code> causes an implicit commit. See
      <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
    </p><p>
      <code class="literal">ALTER SERVER</code> is not written to the binary log,
      regardless of the logging format that is in use.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-table"></a>13.1.9 ALTER TABLE Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#alter-table-partition-operations">13.1.9.1 ALTER TABLE Partition Operations</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-table-generated-columns">13.1.9.2 ALTER TABLE and Generated Columns</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-table-examples">13.1.9.3 ALTER TABLE Examples</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091672598768"></a><a class="indexterm" name="idm140091672597696"></a><a class="indexterm" name="idm140091672596208"></a><pre data-lang="sql" class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em>
    [<em class="replaceable"><code>alter_specification</code></em> [, <em class="replaceable"><code>alter_specification</code></em>] ...]
    [<em class="replaceable"><code>partition_options</code></em>]

<em class="replaceable"><code>alter_specification</code></em>:
    <em class="replaceable"><code>table_options</code></em>
  | ADD [COLUMN] <em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definition</code></em>
        [FIRST | AFTER <em class="replaceable"><code>col_name</code></em>]
  | ADD [COLUMN] (<em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definition</code></em>,...)
  | ADD {INDEX|KEY} [<em class="replaceable"><code>index_name</code></em>]
        [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>key_part</code></em>,...) [<em class="replaceable"><code>index_option</code></em>] ...
  | ADD {FULLTEXT|SPATIAL} [INDEX|KEY] [<em class="replaceable"><code>index_name</code></em>]
        (<em class="replaceable"><code>key_part</code></em>,...) [<em class="replaceable"><code>index_option</code></em>] ...
  | ADD [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] PRIMARY KEY
        [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>key_part</code></em>,...)
        [<em class="replaceable"><code>index_option</code></em>] ...
  | ADD [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] UNIQUE [INDEX|KEY]
        [<em class="replaceable"><code>index_name</code></em>] [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>key_part</code></em>,...)
        [<em class="replaceable"><code>index_option</code></em>] ...
  | ADD [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] FOREIGN KEY
        [<em class="replaceable"><code>index_name</code></em>] (<em class="replaceable"><code>col_name</code></em>,...)
        <em class="replaceable"><code>reference_definition</code></em>
  | ADD <em class="replaceable"><code>check_constraint_definition</code></em>
  | DROP CHECK <em class="replaceable"><code>symbol</code></em>
  | ALTER CHECK <em class="replaceable"><code>symbol</code></em> [NOT] ENFORCED
  | ALGORITHM [=] {DEFAULT|INSTANT|INPLACE|COPY}
  | ALTER [COLUMN] <em class="replaceable"><code>col_name</code></em> {SET DEFAULT <em class="replaceable"><code>literal</code></em> | DROP DEFAULT}
  | ALTER INDEX <em class="replaceable"><code>index_name</code></em> {VISIBLE | INVISIBLE}
  | CHANGE [COLUMN] <em class="replaceable"><code>old_col_name</code></em> <em class="replaceable"><code>new_col_name</code></em> <em class="replaceable"><code>column_definition</code></em>
        [FIRST|AFTER <em class="replaceable"><code>col_name</code></em>]
  | [DEFAULT] CHARACTER SET [=] <em class="replaceable"><code>charset_name</code></em> [COLLATE [=] <em class="replaceable"><code>collation_name</code></em>]
  | CONVERT TO CHARACTER SET <em class="replaceable"><code>charset_name</code></em> [COLLATE <em class="replaceable"><code>collation_name</code></em>]
  | {DISABLE|ENABLE} KEYS
  | {DISCARD|IMPORT} TABLESPACE
  | DROP [COLUMN] <em class="replaceable"><code>col_name</code></em>
  | DROP {INDEX|KEY} <em class="replaceable"><code>index_name</code></em>
  | DROP PRIMARY KEY
  | DROP FOREIGN KEY <em class="replaceable"><code>fk_symbol</code></em>
  | FORCE
  | LOCK [=] {DEFAULT|NONE|SHARED|EXCLUSIVE}
  | MODIFY [COLUMN] <em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definition</code></em>
        [FIRST | AFTER <em class="replaceable"><code>col_name</code></em>]
  | ORDER BY <em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...
  | RENAME COLUMN <em class="replaceable"><code>old_col_name</code></em> TO <em class="replaceable"><code>new_col_name</code></em>
  | RENAME {INDEX|KEY} <em class="replaceable"><code>old_index_name</code></em> TO <em class="replaceable"><code>new_index_name</code></em>
  | RENAME [TO|AS] <em class="replaceable"><code>new_tbl_name</code></em>
  | {WITHOUT|WITH} VALIDATION
  | ADD PARTITION (<em class="replaceable"><code>partition_definition</code></em>)
  | DROP PARTITION <em class="replaceable"><code>partition_names</code></em>
  | DISCARD PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL} TABLESPACE
  | IMPORT PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL} TABLESPACE
  | TRUNCATE PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | COALESCE PARTITION <em class="replaceable"><code>number</code></em>
  | REORGANIZE PARTITION <em class="replaceable"><code>partition_names</code></em> INTO (<em class="replaceable"><code>partition_definitions</code></em>)
  | EXCHANGE PARTITION <em class="replaceable"><code>partition_name</code></em> WITH TABLE <em class="replaceable"><code>tbl_name</code></em> [{WITH|WITHOUT} VALIDATION]
  | ANALYZE PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | CHECK PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | OPTIMIZE PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | REBUILD PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | REPAIR PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | REMOVE PARTITIONING

<em class="replaceable"><code>key_part</code></em>: {<em class="replaceable"><code>col_name</code></em> [(<em class="replaceable"><code>length</code></em>)] | (<em class="replaceable"><code>expr</code></em>)} [ASC | DESC]

<em class="replaceable"><code>index_type</code></em>:
    USING {BTREE | HASH}

<em class="replaceable"><code>index_option</code></em>:
    KEY_BLOCK_SIZE [=] <em class="replaceable"><code>value</code></em>
  | <em class="replaceable"><code>index_type</code></em>
  | WITH PARSER <em class="replaceable"><code>parser_name</code></em>
  | COMMENT '<em class="replaceable"><code>string</code></em>'
  | {VISIBLE | INVISIBLE}

<em class="replaceable"><code>check_constraint_definition</code></em>:
    [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] CHECK (<em class="replaceable"><code>expr</code></em>) [[NOT] ENFORCED]

<em class="replaceable"><code>table_options</code></em>:
    <em class="replaceable"><code>table_option</code></em> [[,] <em class="replaceable"><code>table_option</code></em>] ...

<em class="replaceable"><code>table_option</code></em>:
    AUTO_INCREMENT [=] <em class="replaceable"><code>value</code></em>
  | AVG_ROW_LENGTH [=] <em class="replaceable"><code>value</code></em>
  | [DEFAULT] CHARACTER SET [=] <em class="replaceable"><code>charset_name</code></em>
  | CHECKSUM [=] {0 | 1}
  | [DEFAULT] COLLATE [=] <em class="replaceable"><code>collation_name</code></em>
  | COMMENT [=] '<em class="replaceable"><code>string</code></em>'
  | COMPRESSION [=] {'ZLIB'|'LZ4'|'NONE'}
  | CONNECTION [=] '<em class="replaceable"><code>connect_string</code></em>'
  | {DATA|INDEX} DIRECTORY [=] '<em class="replaceable"><code>absolute path to directory</code></em>'
  | DELAY_KEY_WRITE [=] {0 | 1}
  | ENCRYPTION [=] {'Y' | 'N'}
  | ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
  | INSERT_METHOD [=] { NO | FIRST | LAST }
  | KEY_BLOCK_SIZE [=] <em class="replaceable"><code>value</code></em>
  | MAX_ROWS [=] <em class="replaceable"><code>value</code></em>
  | MIN_ROWS [=] <em class="replaceable"><code>value</code></em>
  | PACK_KEYS [=] {0 | 1 | DEFAULT}
  | PASSWORD [=] '<em class="replaceable"><code>string</code></em>'
  | ROW_FORMAT [=] {DEFAULT|DYNAMIC|FIXED|COMPRESSED|REDUNDANT|COMPACT}
  | STATS_AUTO_RECALC [=] {DEFAULT|0|1}
  | STATS_PERSISTENT [=] {DEFAULT|0|1}
  | STATS_SAMPLE_PAGES [=] <em class="replaceable"><code>value</code></em>
  | TABLESPACE <em class="replaceable"><code>tablespace_name</code></em> [STORAGE {DISK|MEMORY}]
  | UNION [=] (<em class="replaceable"><code>tbl_name</code></em>[,<em class="replaceable"><code>tbl_name</code></em>]...)

<em class="replaceable"><code>partition_options</code></em>:
    (see <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> options)
</pre><p>
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> changes the structure
      of a table. For example, you can add or delete columns, create or
      destroy indexes, change the type of existing columns, or rename
      columns or the table itself. You can also change characteristics
      such as the storage engine used for the table or the table
      comment.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          To use <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>, you need
          <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a>,
          <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a>, and
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges for the
          table. Renaming a table requires
          <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a> and
          <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> on the old table,
          <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a>,
          <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a>, and
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> on the new table.
        </p></li><li class="listitem"><p>
          Following the table name, specify the alterations to be made.
          If none are given, <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
          does nothing.
        </p></li><li class="listitem"><p>
          The syntax for many of the permissible alterations is similar
          to clauses of the <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
          statement. <em class="replaceable"><code>column_definition</code></em>
          clauses use the same syntax for <code class="literal">ADD</code> and
          <code class="literal">CHANGE</code> as for <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
          TABLE</code></a>. For more information, see
          <a class="xref" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax">Section 13.1.20, “CREATE TABLE Syntax”</a>.
        </p></li><li class="listitem"><p>
          The word <code class="literal">COLUMN</code> is optional and can be
          omitted, except for <code class="literal">RENAME COLUMN</code> (to
          distinguish a column-renaming operation from the
          <code class="literal">RENAME</code> table-renaming operation).
        </p></li><li class="listitem"><p>
          Multiple <code class="literal">ADD</code>, <code class="literal">ALTER</code>,
          <code class="literal">DROP</code>, and <code class="literal">CHANGE</code> clauses
          are permitted in a single <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
          TABLE</code></a> statement, separated by commas. This is a
          MySQL extension to standard SQL, which permits only one of
          each clause per <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
          statement. For example, to drop multiple columns in a single
          statement, do this:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t2 DROP COLUMN c, DROP COLUMN d;
</pre></li><li class="listitem"><p>
          If a storage engine does not support an attempted
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operation, a
          warning may result. Such warnings can be displayed with
          <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a>. See
          <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax">Section 13.7.6.40, “SHOW WARNINGS Syntax”</a>. For information on
          troubleshooting <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>,
          see <a class="xref" href="error-handling.html#alter-table-problems" title="B.4.6.1 Problems with ALTER TABLE">Section B.4.6.1, “Problems with ALTER TABLE”</a>.
        </p></li><li class="listitem"><p>
          For information about generated columns, see
          <a class="xref" href="sql-syntax.html#alter-table-generated-columns" title="13.1.9.2 ALTER TABLE and Generated Columns">Section 13.1.9.2, “ALTER TABLE and Generated Columns”</a>.
        </p></li><li class="listitem"><p>
          For usage examples, see
          <a class="xref" href="sql-syntax.html#alter-table-examples" title="13.1.9.3 ALTER TABLE Examples">Section 13.1.9.3, “ALTER TABLE Examples”</a>.
        </p></li><li class="listitem"><p>
          With the <a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info()"><code class="literal">mysql_info()</code></a> C API
          function, you can find out how many rows were copied by
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>. See
          <a class="xref" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info()">Section 28.7.7.36, “mysql_info()”</a>.
</p><a class="indexterm" name="idm140091672494368"></a></li></ul>
</div>
<p>
      There are several additional aspects to the <code class="literal">ALTER
      TABLE</code> statement, described under the following topics in
      this section:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-options" title="Table Options">Table Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-performance" title="Performance and Space Requirements">Performance and Space Requirements</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-concurrency" title="Concurrency Control">Concurrency Control</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-add-drop-column" title="Adding and Dropping Columns">Adding and Dropping Columns</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-redefine-column" title="Renaming, Redefining, and Reordering Columns">Renaming, Redefining, and Reordering Columns</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-index" title="Primary Keys and Indexes">Primary Keys and Indexes</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-foreign-key" title="Foreign Keys and Other Constraints">Foreign Keys and Other Constraints</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-character-set" title="Changing the Character Set">Changing the Character Set</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-discard-import" title="Discarding and Importing InnoDB Tablespaces">Discarding and Importing InnoDB Tablespaces</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-row-order" title="Row Order for MyISAM Tables">Row Order for MyISAM Tables</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-table-partition-options" title="Partitioning Options">Partitioning Options</a></p></li></ul>
</div>
<h4><a name="alter-table-options"></a>Table Options</h4>
<p>
      <em class="replaceable"><code>table_options</code></em> signifies table options
      of the kind that can be used in the <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
      TABLE</code></a> statement, such as <code class="literal">ENGINE</code>,
      <code class="literal">AUTO_INCREMENT</code>,
      <code class="literal">AVG_ROW_LENGTH</code>, <code class="literal">MAX_ROWS</code>,
      <code class="literal">ROW_FORMAT</code>, or <code class="literal">TABLESPACE</code>.
    </p><p>
      For descriptions of all table options, see
      <a class="xref" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax">Section 13.1.20, “CREATE TABLE Syntax”</a>. However,
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> ignores <code class="literal">DATA
      DIRECTORY</code> and <code class="literal">INDEX DIRECTORY</code> when
      given as table options. <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
      permits them only as partitioning options, and requires that you
      have the <code class="literal">FILE</code> privilege.
    </p><p>
      Use of table options with <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a> provides a convenient way of altering single table
      characteristics. For example:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If <code class="literal">t1</code> is currently not an
          <code class="literal">InnoDB</code> table, this statement changes its
          storage engine to <code class="literal">InnoDB</code>:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 ENGINE = InnoDB;
</pre>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              See <a class="xref" href="innodb-storage-engine.html#converting-tables-to-innodb" title="15.6.1.3 Converting Tables from MyISAM to InnoDB">Section 15.6.1.3, “Converting Tables from MyISAM to InnoDB”</a> for
              considerations when switching tables to the
              <code class="literal">InnoDB</code> storage engine.
            </p></li><li class="listitem"><p>
              When you specify an <code class="literal">ENGINE</code> clause,
              <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> rebuilds the
              table. This is true even if the table already has the
              specified storage engine.
            </p></li><li class="listitem"><p>
              Running <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
              TABLE <em class="replaceable"><code>tbl_name</code></em>
              ENGINE=INNODB</code></a> on an existing
              <code class="literal">InnoDB</code> table performs a
              <span class="quote">“<span class="quote">null</span>”</span> <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
              TABLE</code></a> operation, which can be used to defragment
              an <code class="literal">InnoDB</code> table, as described in
              <a class="xref" href="innodb-storage-engine.html#innodb-file-defragmenting" title="15.11.4 Defragmenting a Table">Section 15.11.4, “Defragmenting a Table”</a>. Running
              <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
              <em class="replaceable"><code>tbl_name</code></em> FORCE</code></a> on an
              <code class="literal">InnoDB</code> table performs the same
              function.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
              <em class="replaceable"><code>tbl_name</code></em>
              ENGINE=INNODB</code></a> and
              <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
              <em class="replaceable"><code>tbl_name</code></em> FORCE</code></a> use
              <a class="link" href="innodb-storage-engine.html#innodb-online-ddl" title="15.12 InnoDB and Online DDL">online DDL</a>. For
              more information, see <a class="xref" href="innodb-storage-engine.html#innodb-online-ddl" title="15.12 InnoDB and Online DDL">Section 15.12, “InnoDB and Online DDL”</a>.
            </p></li><li class="listitem"><p>
              The outcome of attempting to change the storage engine of
              a table is affected by whether the desired storage engine
              is available and the setting of the
              <a class="link" href="server-administration.html#sqlmode_no_engine_substitution"><code class="literal">NO_ENGINE_SUBSTITUTION</code></a>
              SQL mode, as described in <a class="xref" href="server-administration.html#sql-mode" title="5.1.11 Server SQL Modes">Section 5.1.11, “Server SQL Modes”</a>.
            </p></li><li class="listitem"><p>
              To prevent inadvertent loss of data,
              <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> cannot be used
              to change the storage engine of a table to
              <code class="literal">MERGE</code> or <code class="literal">BLACKHOLE</code>.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          To change the <code class="literal">InnoDB</code> table to use
          compressed row-storage format:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 ROW_FORMAT = COMPRESSED;
</pre></li><li class="listitem"><p>
          The <code class="literal">ENCRYPTION</code> clause enables or disables
          page-level data encryption for an <code class="literal">InnoDB</code>
          table. A keyring plugin must be installed and configured to
          enable encryption.
        </p><p>
          If the
          <a class="link" href="server-administration.html#sysvar_table_encryption_privilege_check"><code class="literal">table_encryption_privilege_check</code></a>
          variable is enabled, the
          <a class="link" href="security.html#priv_table-encryption-admin"><code class="literal">TABLE_ENCRYPTION_ADMIN</code></a>
          privilege is required to use an <code class="literal">ENCRYPTION</code>
          clause with a setting that differs from the default schema
          encryption setting.
        </p><p>
          Prior to MySQL 8.0.16, the <code class="literal">ENCRYPTION</code>
          clause was only supported when altering tables residing in
          file-per-table tablespaces. As of MySQL 8.0.16, the
          <code class="literal">ENCRYPTION</code> clause is also supported for
          tables residing in general tablespaces.
        </p><p>
          For tables that reside in general tablespaces, table and
          tablespace encryption must match.
        </p><p>
          Altering table encryption by moving a table to a different
          tablespace or changing the storage engine is not permitted
          without explicitly specifying an <code class="literal">ENCRYPTION</code>
          clause.
        </p><p>
          As of MySQL 8.0.16, specifying an
          <code class="literal">ENCRYPTION</code> clause with a value other than
          <code class="literal">'N'</code> or <code class="literal">''</code> is not
          permitted if the table uses storage engine that does not
          support encryption. Previously, the clause was accepted.
          Attempting to create a table without an
          <code class="literal">ENCRYPTION</code> clause in an encryption-enabled
          schema using a storage engine that does not support encryption
          is also not permitted.
        </p><p>
          For more information, see
          <a class="xref" href="innodb-storage-engine.html#innodb-tablespace-encryption" title="15.6.3.9 InnoDB Data-at-Rest Encryption">Section 15.6.3.9, “InnoDB Data-at-Rest Encryption”</a>.
        </p></li><li class="listitem"><p>
          To reset the current auto-increment value:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 AUTO_INCREMENT = 13;
</pre><p>
          You cannot reset the counter to a value less than or equal to
          the value that is currently in use. For both
          <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code>, if
          the value is less than or equal to the maximum value currently
          in the <code class="literal">AUTO_INCREMENT</code> column, the value is
          reset to the current maximum <code class="literal">AUTO_INCREMENT</code>
          column value plus one.
        </p></li><li class="listitem"><p>
          To change the default table character set:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 CHARACTER SET = utf8;
</pre><p>
          See also <a class="xref" href="sql-syntax.html#alter-table-character-set" title="Changing the Character Set">Changing the Character Set</a>.
        </p></li><li class="listitem"><p>
          To add (or change) a table comment:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 COMMENT = 'New table comment';
</pre></li><li class="listitem"><p>
          Use <code class="literal">ALTER TABLE</code> with the
          <code class="literal">TABLESPACE</code> option to move
          <code class="literal">InnoDB</code> tables between existing
          <a class="link" href="glossary.html#glos_general_tablespace" title="general tablespace">general
          tablespaces</a>,
          <a class="link" href="glossary.html#glos_file_per_table" title="file-per-table">file-per-table</a>
          tablespaces, and the
          <a class="link" href="glossary.html#glos_system_tablespace" title="system tablespace">system
          tablespace</a>. See
          <a class="xref" href="innodb-storage-engine.html#general-tablespaces-moving-non-partitioned-tables" title="Moving Tables Between Tablespaces Using ALTER TABLE">Moving Tables Between Tablespaces Using ALTER TABLE</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">ALTER TABLE ... TABLESPACE</code> operations
              always cause a full table rebuild, even if the
              <code class="literal">TABLESPACE</code> attribute has not changed
              from its previous value.
            </p></li><li class="listitem"><p>
              <code class="literal">ALTER TABLE ... TABLESPACE</code> syntax does
              not support moving a table from a temporary tablespace to
              a persistent tablespace.
            </p></li><li class="listitem"><p>
              The <code class="literal">DATA DIRECTORY</code> clause, which is
              supported with
              <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE
              ... TABLESPACE</code></a>, is not supported with
              <code class="literal">ALTER TABLE ... TABLESPACE</code>, and is
              ignored if specified.
            </p></li><li class="listitem"><p>
              For more information about the capabilities and
              limitations of the <code class="literal">TABLESPACE</code> option,
              see <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          MySQL NDB Cluster 8.0 supports setting
          <code class="literal">NDB_TABLE</code> options for controlling a
          table's partition balance (fragment count type),
          read-from-any-replica capability, full replication, or any
          combination of these, as part of the table comment for an
          <code class="literal">ALTER TABLE</code> statement in the same manner as
          for <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>, as shown in
          this example:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 COMMENT = "NDB_TABLE=READ_BACKUP=0,PARTITION_BALANCE=FOR_RA_BY_NODE";
</pre><p>
          Bear in mind that <code class="literal">ALTER TABLE ... COMMENT
          ...</code> discards any existing comment for the table. See
          <a class="xref" href="sql-syntax.html#create-table-comment-ndb-table-options" title="Setting NDB_TABLE options">Setting NDB_TABLE options</a>, for
          additional information and examples.
</p></li></ul>
</div>
<p>
      To verify that the table options were changed as intended, use
      <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>, or query the
      <a class="link" href="information-schema.html#tables-table" title="25.30 The INFORMATION_SCHEMA TABLES Table"><code class="literal">INFORMATION_SCHEMA.TABLES</code></a> table.
</p>
<h4><a name="alter-table-performance"></a>Performance and Space Requirements</h4>
<p>
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operations are
      processed using one of the following algorithms:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">COPY</code>: Operations are performed on a copy of
          the original table, and table data is copied from the original
          table to the new table row by row. Concurrent DML is not
          permitted.
        </p></li><li class="listitem"><p>
          <code class="literal">INPLACE</code>: Operations avoid copying table
          data but may rebuild the table in place. An exclusive metadata
          lock on the table may be taken briefly during preparation and
          execution phases of the operation. Typically, concurrent DML
          is supported.
        </p></li><li class="listitem"><p>
          <code class="literal">INSTANT</code>: Operations only modify metadata in
          the data dictionary. No exclusive metadata locks are taken on
          the table during preparation and execution, and table data is
          unaffected, making operations instantaneous. Concurrent DML is
          permitted. (Introduced in MySQL 8.0.12)
</p></li></ul>
</div>
<p>
      The <code class="literal">ALGORITHM</code> clause is optional. If the
      <code class="literal">ALGORITHM</code> clause is omitted, MySQL uses
      <code class="literal">ALGORITHM=INSTANT</code> for storage engines and
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> clauses that support
      it. Otherwise, <code class="literal">ALGORITHM=INPLACE</code> is used. If
      <code class="literal">ALGORITHM=INPLACE</code> is not supported,
      <code class="literal">ALGORITHM=COPY</code> is used.
    </p><p>
      Specifying an <code class="literal">ALGORITHM</code> clause requires the
      operation to use the specified algorithm for clauses and storage
      engines that support it, or fail with an error otherwise.
      Specifying <code class="literal">ALGORITHM=DEFAULT</code> is the same as
      omitting the <code class="literal">ALGORITHM</code> clause.
    </p><p>
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operations that use the
      <code class="literal">COPY</code> algorithm wait for other operations that
      are modifying the table to complete. After alterations are applied
      to the table copy, data is copied over, the original table is
      deleted, and the table copy is renamed to the name of the original
      table. While the <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
      operation executes, the original table is readable by other
      sessions (with the exception noted shortly). Updates and writes to
      the table started after the <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a> operation begins are stalled until the new table
      is ready, then are automatically redirected to the new table. The
      temporary copy of the table is created in the database directory
      of the original table unless it is a <code class="literal">RENAME TO</code>
      operation that moves the table to a database that resides in a
      different directory.
    </p><p>
      The exception referred to earlier is that
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> blocks reads (not just
      writes) at the point where it is ready to clear outdated table
      structures from the table and table definition caches. At this
      point, it must acquire an exclusive lock. To do so, it waits for
      current readers to finish, and blocks new reads and writes.
    </p><p>
      An <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operation that uses
      the <code class="literal">COPY</code> algorithm prevents concurrent DML
      operations. Concurrent queries are still allowed. That is, a
      table-copying operation always includes at least the concurrency
      restrictions of <code class="literal">LOCK=SHARED</code> (allow queries but
      not DML). You can further restrict concurrency for operations that
      support the <code class="literal">LOCK</code> clause by specifying
      <code class="literal">LOCK=EXCLUSIVE</code>, which prevents DML and queries.
      For more information, see
      <a class="xref" href="sql-syntax.html#alter-table-concurrency" title="Concurrency Control">Concurrency Control</a>.
    </p><p>
      To force use of the <code class="literal">COPY</code> algorithm for an
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operation that would
      otherwise not use it, specify <code class="literal">ALGORITHM=COPY</code> or
      enable the <a class="link" href="server-administration.html#sysvar_old_alter_table"><code class="literal">old_alter_table</code></a> system
      variable. If there is a conflict between the
      <code class="literal">old_alter_table</code> setting and an
      <code class="literal">ALGORITHM</code> clause with a value other than
      <code class="literal">DEFAULT</code>, the <code class="literal">ALGORITHM</code>
      clause takes precedence.
    </p><p>
      For <code class="literal">InnoDB</code> tables, an
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operation that uses the
      <code class="literal">COPY</code> algorithm on a table that resides in a
      <a class="link" href="glossary.html#glos_shared_tablespace" title="shared tablespace">shared tablespace</a>
      can increase the amount of space used by the tablespace. Such
      operations require as much additional space as the data in the
      table plus indexes. For a table residing in a shared tablespace,
      the additional space used during the operation is not released
      back to the operating system as it is for a table that resides in
      a <a class="link" href="glossary.html#glos_file_per_table" title="file-per-table">file-per-table</a>
      tablespace.
    </p><p>
      For information about space requirements for online DDL
      operations, see
      <a class="xref" href="innodb-storage-engine.html#innodb-online-ddl-space-requirements" title="15.12.3 Online DDL Space Requirements">Section 15.12.3, “Online DDL Space Requirements”</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operations that support
      the <code class="literal">INPLACE</code> algorithm include:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">ALTER TABLE</code> operations supported by the
          <code class="literal">InnoDB</code>
          <a class="link" href="glossary.html#glos_online_ddl" title="online DDL">online DDL</a> feature. See
          <a class="xref" href="innodb-storage-engine.html#innodb-online-ddl-operations" title="15.12.1 Online DDL Operations">Section 15.12.1, “Online DDL Operations”</a>.
        </p></li><li class="listitem"><p>
          Renaming a table. MySQL renames files that correspond to the
          table <em class="replaceable"><code>tbl_name</code></em> without making a
          copy. (You can also use the <a class="link" href="sql-syntax.html#rename-table" title="13.1.36 RENAME TABLE Syntax"><code class="literal">RENAME
          TABLE</code></a> statement to rename tables. See
          <a class="xref" href="sql-syntax.html#rename-table" title="13.1.36 RENAME TABLE Syntax">Section 13.1.36, “RENAME TABLE Syntax”</a>.) Privileges granted
          specifically for the renamed table are not migrated to the new
          name. They must be changed manually.
        </p></li><li class="listitem"><p>
          Operations that only modify table metadata. These operations
          are immediate because the server does not touch table
          contents. Metadata-only operations include:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Renaming a column.
            </p></li><li class="listitem"><p>
              Changing the default value of a column (except for
              <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables).
            </p></li><li class="listitem"><p>
              Modifying the definition of an
              <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> or
              <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> column by adding new
              enumeration or set members to the <span class="emphasis"><em>end</em></span>
              of the list of valid member values, as long as the storage
              size of the data type does not change. For example, adding
              a member to a <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> column
              that has 8 members changes the required storage per value
              from 1 byte to 2 bytes; this requires a table copy. Adding
              members in the middle of the list causes renumbering of
              existing members, which requires a table copy.
            </p></li><li class="listitem"><p>
              Changing the definition of a spatial column to remove the
              <code class="literal">SRID</code> attribute. (Adding or changing an
              <code class="literal">SRID</code> attribute does require a rebuild
              and cannot be done in place because the server must verify
              that all values have the specified SRID value.)
            </p></li><li class="listitem"><p>
              As of MySQL 8.0.14, changing a column character set, when
              these conditions apply:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  The column data type is
                  <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
                  <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, a
                  <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> type, or
                  <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a>.
                </p></li><li class="listitem"><p>
                  The character set change is from
                  <code class="literal">utf8mb3</code> to
                  <code class="literal">utf8mb4</code>, or any character set to
                  <code class="literal">binary</code>.
                </p></li><li class="listitem"><p>
                  There is no index on the column.
</p></li></ul>
</div>
</li><li class="listitem"><p>
              As of MySQL 8.0.14, changing a generated column, when
              these conditions apply:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  For <code class="literal">InnoDB</code> tables, statements that
                  modify generated stored columns but do not change
                  their type, expression, or nullability.
                </p></li><li class="listitem"><p>
                  For non-<code class="literal">InnoDB</code> tables, statements
                  that modify generated stored or virtual columns but do
                  not change their type, expression, or nullability.
</p></li></ul>
</div>
<p>
              An example of such a change is a change to the column
              comment.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          Renaming an index.
        </p></li><li class="listitem"><p>
          Adding or dropping a secondary index, for
          <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
          <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables. See
          <a class="xref" href="innodb-storage-engine.html#innodb-online-ddl-operations" title="15.12.1 Online DDL Operations">Section 15.12.1, “Online DDL Operations”</a>.
        </p></li><li class="listitem"><p>
          For <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables, operations that
          add and drop indexes on variable-width columns. These
          operations occur online, without table copying and without
          blocking concurrent DML actions for most of their duration.
          See <a class="xref" href="mysql-cluster.html#mysql-cluster-online-operations" title="22.5.14 Online Operations with ALTER TABLE in NDB Cluster">Section 22.5.14, “Online Operations with ALTER TABLE in NDB Cluster”</a>.
        </p></li><li class="listitem"><p>
          Modifying index visibility with an <code class="literal">ALTER
          INDEX</code> operation.
        </p></li><li class="listitem"><p>
          Column modifications of tables containing generated columns
          that depend on columns with a <code class="literal">DEFAULT</code> value
          if the modified columns are not involved in the generated
          column expressions. For example, changing the
          <code class="literal">NULL</code> property of a separate column can be
          done in place without a table rebuild.
</p></li></ul>
</div>
<p>
      <code class="literal">ALTER TABLE</code> operations that support the
      <code class="literal">INSTANT</code> algorithm include:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Adding a column. This feature is referred to as <span class="quote">“<span class="quote">Instant
          <code class="literal">ADD COLUMN</code></span>”</span>. Limitations apply. See
          <a class="xref" href="innodb-storage-engine.html#innodb-online-ddl-operations" title="15.12.1 Online DDL Operations">Section 15.12.1, “Online DDL Operations”</a>.
        </p></li><li class="listitem"><p>
          Adding or dropping a virtual column.
        </p></li><li class="listitem"><p>
          Adding or dropping a column default value.
        </p></li><li class="listitem"><p>
          Modifying the definition of an
          <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> or
          <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> column. The same
          restrictions apply as described above for
          <code class="literal">ALGORITHM=INSTANT</code>.
        </p></li><li class="listitem"><p>
          Changing the index type.
        </p></li><li class="listitem"><p>
          Renaming a table. The same restrictions apply as described
          above for <code class="literal">ALGORITHM=INSTANT</code>.
</p></li></ul>
</div>
<p>
      For more information about operations that support
      <code class="literal">ALGORITHM=INSTANT</code>, see
      <a class="xref" href="innodb-storage-engine.html#innodb-online-ddl-operations" title="15.12.1 Online DDL Operations">Section 15.12.1, “Online DDL Operations”</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> upgrades MySQL 5.5
      temporal columns to 5.6 format for <code class="literal">ADD COLUMN</code>,
      <code class="literal">CHANGE COLUMN</code>, <code class="literal">MODIFY
      COLUMN</code>, <code class="literal">ADD INDEX</code>, and
      <code class="literal">FORCE</code> operations. This conversion cannot be
      done using the <code class="literal">INPLACE</code> algorithm because the
      table must be rebuilt, so specifying
      <code class="literal">ALGORITHM=INPLACE</code> in these cases results in an
      error. Specify <code class="literal">ALGORITHM=COPY</code> if necessary.
    </p><p>
      If an <code class="literal">ALTER TABLE</code> operation on a multicolumn
      index used to partition a table by <code class="literal">KEY</code> changes
      the order of the columns, it can only be performed using
      <code class="literal">ALGORITHM=COPY</code>.
    </p><p>
      The <code class="literal">WITHOUT VALIDATION</code> and <code class="literal">WITH
      VALIDATION</code> clauses affect whether
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> performs an in-place
      operation for
      <a class="link" href="glossary.html#glos_virtual_generated_column" title="virtual generated column">virtual generated
      column</a> modifications. See
      <a class="xref" href="sql-syntax.html#alter-table-generated-columns" title="13.1.9.2 ALTER TABLE and Generated Columns">Section 13.1.9.2, “ALTER TABLE and Generated Columns”</a>.
    </p><p>
      NDB Cluster 8.0 supports online operations using the same
      <code class="literal">ALGORITHM=INPLACE</code> syntax used with the standard
      MySQL Server. See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-online-operations" title="22.5.14 Online Operations with ALTER TABLE in NDB Cluster">Section 22.5.14, “Online Operations with ALTER TABLE in NDB Cluster”</a>, for more
      information.
    </p><p>
      <code class="literal">ALTER TABLE</code> with <code class="literal">DISCARD ... PARTITION
      ... TABLESPACE</code> or <code class="literal">IMPORT ... PARTITION ...
      TABLESPACE</code> does not create any temporary tables or
      temporary partition files.
    </p><p>
      <code class="literal">ALTER TABLE</code> with <code class="literal">ADD
      PARTITION</code>, <code class="literal">DROP PARTITION</code>,
      <code class="literal">COALESCE PARTITION</code>, <code class="literal">REBUILD
      PARTITION</code>, or <code class="literal">REORGANIZE PARTITION</code>
      does not create temporary tables (except when used with
      <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables); however, these
      operations can and do create temporary partition files.
    </p><p>
      <code class="literal">ADD</code> or <code class="literal">DROP</code> operations for
      <code class="literal">RANGE</code> or <code class="literal">LIST</code> partitions are
      immediate operations or nearly so. <code class="literal">ADD</code> or
      <code class="literal">COALESCE</code> operations for <code class="literal">HASH</code>
      or <code class="literal">KEY</code> partitions copy data between all
      partitions, unless <code class="literal">LINEAR HASH</code> or
      <code class="literal">LINEAR KEY</code> was used; this is effectively the
      same as creating a new table, although the <code class="literal">ADD</code>
      or <code class="literal">COALESCE</code> operation is performed partition by
      partition. <code class="literal">REORGANIZE</code> operations copy only
      changed partitions and do not touch unchanged ones.
    </p><p>
      For <code class="literal">MyISAM</code> tables, you can speed up index
      re-creation (the slowest part of the alteration process) by
      setting the
      <a class="link" href="server-administration.html#sysvar_myisam_sort_buffer_size"><code class="literal">myisam_sort_buffer_size</code></a> system
      variable to a high value.
</p>
<h4><a name="alter-table-concurrency"></a>Concurrency Control</h4>
<p>
      For <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operations that
      support it, you can use the <code class="literal">LOCK</code> clause to
      control the level of concurrent reads and writes on a table while
      it is being altered. Specifying a non-default value for this
      clause enables you to require a certain amount of concurrent
      access or exclusivity during the alter operation, and halts the
      operation if the requested degree of locking is not available.
    </p><p>
      Only <code class="literal">LOCK = DEFAULT</code> is permitted for operations
      that use <code class="literal">ALGORITHM=INSTANT</code>. The other
      <code class="literal">LOCK</code> clause parameters are not applicable.
    </p><p>
      The parameters for the <code class="literal">LOCK</code> clause are:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
</p><pre data-lang="sql" class="programlisting">
LOCK = DEFAULT
</pre><p>

          Maximum level of concurrency for the given
          <code class="literal">ALGORITHM</code> clause (if any) and
          <code class="literal">ALTER TABLE</code> operation: Permit concurrent
          reads and writes if supported. If not, permit concurrent reads
          if supported. If not, enforce exclusive access.
        </p></li><li class="listitem"><p>
</p><pre data-lang="sql" class="programlisting">
LOCK = NONE
</pre><p>

          If supported, permit concurrent reads and writes. Otherwise,
          an error occurs.
        </p></li><li class="listitem"><p>
</p><pre data-lang="sql" class="programlisting">
LOCK = SHARED
</pre><p>

          If supported, permit concurrent reads but block writes. Writes
          are blocked even if concurrent writes are supported by the
          storage engine for the given <code class="literal">ALGORITHM</code>
          clause (if any) and <code class="literal">ALTER TABLE</code> operation.
          If concurrent reads are not supported, an error occurs.
        </p></li><li class="listitem"><p>
</p><pre data-lang="sql" class="programlisting">
LOCK = EXCLUSIVE
</pre><p>

          Enforce exclusive access. This is done even if concurrent
          reads/writes are supported by the storage engine for the given
          <code class="literal">ALGORITHM</code> clause (if any) and
          <code class="literal">ALTER TABLE</code> operation.
</p></li></ul>
</div>
<h4><a name="alter-table-add-drop-column"></a>Adding and Dropping Columns</h4>
<p>
      Use <code class="literal">ADD</code> to add new columns to a table, and
      <code class="literal">DROP</code> to remove existing columns. <code class="literal">DROP
      <em class="replaceable"><code>col_name</code></em></code> is a MySQL extension
      to standard SQL.
    </p><p>
      To add a column at a specific position within a table row, use
      <code class="literal">FIRST</code> or <code class="literal">AFTER
      <em class="replaceable"><code>col_name</code></em></code>. The default is to
      add the column last.
    </p><p>
      If a table contains only one column, the column cannot be dropped.
      If what you intend is to remove the table, use the
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement instead.
    </p><p>
      If columns are dropped from a table, the columns are also removed
      from any index of which they are a part. If all columns that make
      up an index are dropped, the index is dropped as well. If you use
      <code class="literal">CHANGE</code> or <code class="literal">MODIFY</code> to shorten
      a column for which an index exists on the column, and the
      resulting column length is less than the index length, MySQL
      shortens the index automatically.
    </p><p>
      For <code class="literal">ALTER TABLE ... ADD</code>, if the column has an
      expression default value that uses a nondeterministic function,
      the statement may produce a warning or error. For details, see
      <a class="xref" href="replication.html#replication-gtids-restrictions" title="17.1.3.6 Restrictions on Replication with GTIDs">Section 17.1.3.6, “Restrictions on Replication with GTIDs”</a>.
</p>
<h4><a name="alter-table-redefine-column"></a>Renaming, Redefining, and Reordering Columns</h4>
<a class="indexterm" name="idm140091672195360"></a><a class="indexterm" name="idm140091672193872"></a><a class="indexterm" name="idm140091672192384"></a><a class="indexterm" name="idm140091672190896"></a><p>
      The <code class="literal">CHANGE</code>, <code class="literal">MODIFY</code>,
      <code class="literal">RENAME COLUMN</code>, and <code class="literal">ALTER</code>
      clauses enable the names and definitions of existing columns to be
      altered. They have these comparative characteristics:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">CHANGE</code>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Can rename a column and change its definition, or both.
            </p></li><li class="listitem"><p>
              Has more capability than <code class="literal">MODIFY</code> or
              <code class="literal">RENAME COLUMN</code>, but at the expense of
              convenience for some operations. <code class="literal">CHANGE</code>
              requires naming the column twice if not renaming it, and
              requires respecifying the column definition if only
              renaming it.
            </p></li><li class="listitem"><p>
              With <code class="literal">FIRST</code> or <code class="literal">AFTER</code>,
              can reorder columns.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal">MODIFY</code>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Can change a column definition but not its name.
            </p></li><li class="listitem"><p>
              More convenient than <code class="literal">CHANGE</code> to change a
              column definition without renaming it.
            </p></li><li class="listitem"><p>
              With <code class="literal">FIRST</code> or <code class="literal">AFTER</code>,
              can reorder columns.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal">RENAME COLUMN</code>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Can change a column name but not its definition.
            </p></li><li class="listitem"><p>
              More convenient than <code class="literal">CHANGE</code> to rename a
              column without changing its definition.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal">ALTER</code>: Used only to change a column default
          value.
</p></li></ul>
</div>
<a class="indexterm" name="idm140091672164992"></a><a class="indexterm" name="idm140091672163920"></a><p>
      <code class="literal">CHANGE</code> is a MySQL extension to standard SQL.
      <code class="literal">MODIFY</code> and <code class="literal">RENAME COLUMN</code> are
      MySQL extensions for Oracle compatibility.
    </p><p>
      To alter a column to change both its name and definition, use
      <code class="literal">CHANGE</code>, specifying the old and new names and
      the new definition. For example, to rename an <code class="literal">INT NOT
      NULL</code> column from <code class="literal">a</code> to
      <code class="literal">b</code> and change its definition to use the
      <code class="literal">BIGINT</code> data type while retaining the
      <code class="literal">NOT NULL</code> attribute, do this:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 CHANGE a b BIGINT NOT NULL;
</pre><p>
      To change a column definition but not its name, use
      <code class="literal">CHANGE</code> or <code class="literal">MODIFY</code>. With
      <code class="literal">CHANGE</code>, the syntax requires two column names,
      so you must specify the same name twice to leave the name
      unchanged. For example, to change the definition of column
      <code class="literal">b</code>, do this:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 CHANGE b b INT NOT NULL;
</pre><p>
      <code class="literal">MODIFY</code> is more convenient to change the
      definition without changing the name because it requires the
      column name only once:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 MODIFY b INT NOT NULL;
</pre><p>
      To change a column name but not its definition, use
      <code class="literal">CHANGE</code> or <code class="literal">RENAME COLUMN</code>.
      With <code class="literal">CHANGE</code>, the syntax requires a column
      definition, so to leave the definition unchanged, you must
      respecify the definition the column currently has. For example, to
      rename an <code class="literal">INT NOT NULL</code> column from
      <code class="literal">b</code> to <code class="literal">a</code>, do this:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 CHANGE b a INT NOT NULL;
</pre><p>
      <code class="literal">RENAME COLUMN</code> is more convenient to change the
      name without changing the definition because it requires only the
      old and new names:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 RENAME COLUMN b TO a;
</pre><p>
      In general, you cannot rename a column to a name that already
      exists in the table. However, this is sometimes not the case, such
      as when you swap names or move them through a cycle. If a table
      has columns named <code class="literal">a</code>, <code class="literal">b</code>, and
      <code class="literal">c</code>, these are valid operations:
    </p><pre data-lang="sql" class="programlisting">
-- swap a and b
ALTER TABLE t1 RENAME COLUMN a TO b,
               RENAME COLUMN b TO a;
-- "rotate" a, b, c through a cycle
ALTER TABLE t1 RENAME COLUMN a TO b,
               RENAME COLUMN b TO c,
               RENAME COLUMN c TO a;
</pre><p>
      For column definition changes using <code class="literal">CHANGE</code> or
      <code class="literal">MODIFY</code>, the definition must include the data
      type and all attributes that should apply to the new column, other
      than index attributes such as <code class="literal">PRIMARY KEY</code> or
      <code class="literal">UNIQUE</code>. Attributes present in the original
      definition but not specified for the new definition are not
      carried forward. Suppose that a column <code class="literal">col1</code> is
      defined as <code class="literal">INT UNSIGNED DEFAULT 1 COMMENT 'my
      column'</code> and you modify the column as follows, intending
      to change only <code class="literal">INT</code> to
      <code class="literal">BIGINT</code>:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 MODIFY col1 BIGINT;
</pre><p>
      That statement changes the data type from <code class="literal">INT</code>
      to <code class="literal">BIGINT</code>, but it also drops the
      <code class="literal">UNSIGNED</code>, <code class="literal">DEFAULT</code>, and
      <code class="literal">COMMENT</code> attributes. To retain them, the
      statement must include them explicitly:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 MODIFY col1 BIGINT UNSIGNED DEFAULT 1 COMMENT 'my column';
</pre><p>
      For data type changes using <code class="literal">CHANGE</code> or
      <code class="literal">MODIFY</code>, MySQL tries to convert existing column
      values to the new type as well as possible.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
        This conversion may result in alteration of data. For example,
        if you shorten a string column, values may be truncated. To
        prevent the operation from succeeding if conversions to the new
        data type would result in loss of data, enable strict SQL mode
        before using <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> (see
        <a class="xref" href="server-administration.html#sql-mode" title="5.1.11 Server SQL Modes">Section 5.1.11, “Server SQL Modes”</a>).
</p>
</div>
<p>
      If you use <code class="literal">CHANGE</code> or <code class="literal">MODIFY</code>
      to shorten a column for which an index exists on the column, and
      the resulting column length is less than the index length, MySQL
      shortens the index automatically.
    </p><p>
      For columns renamed by <code class="literal">CHANGE</code> or
      <code class="literal">RENAME COLUMN</code>, MySQL automatically renames
      these references to the renamed column:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Indexes that refer to the old column, including invisible
          indexes and disabled <code class="literal">MyISAM</code> indexes.
        </p></li><li class="listitem"><p>
          Foreign keys that refer to the old column.
</p></li></ul>
</div>
<p>
      For columns renamed by <code class="literal">CHANGE</code> or
      <code class="literal">RENAME COLUMN</code>, MySQL does not automatically
      rename these references to the renamed column:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Generated column and partition expressions that refer to the
          renamed column. You must use <code class="literal">CHANGE</code> to
          redefine such expressions in the same
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement as the
          one that renames the column.
        </p></li><li class="listitem"><p>
          Views and stored programs that refer to the renamed column.
          You must manually alter the definition of these objects to
          refer to the new column name.
</p></li></ul>
</div>
<p>
      To reorder columns within a table, use <code class="literal">FIRST</code>
      and <code class="literal">AFTER</code> in <code class="literal">CHANGE</code> or
      <code class="literal">MODIFY</code> operations.
    </p><a class="indexterm" name="idm140091672101680"></a><p>
      <code class="literal">ALTER ... SET DEFAULT</code> or <code class="literal">ALTER ...
      DROP DEFAULT</code> specify a new default value for a column or
      remove the old default value, respectively. If the old default is
      removed and the column can be <code class="literal">NULL</code>, the new
      default is <code class="literal">NULL</code>. If the column cannot be
      <code class="literal">NULL</code>, MySQL assigns a default value as
      described in <a class="xref" href="data-types.html#data-type-defaults" title="11.7 Data Type Default Values">Section 11.7, “Data Type Default Values”</a>.
</p>
<h4><a name="alter-table-index"></a>Primary Keys and Indexes</h4>
<a class="indexterm" name="idm140091672094608"></a><a class="indexterm" name="idm140091672093568"></a><a class="indexterm" name="idm140091672092080"></a><p>
      <code class="literal">DROP PRIMARY KEY</code> drops the
      <a class="link" href="glossary.html#glos_primary_key" title="primary key">primary key</a>. If there is
      no primary key, an error occurs. For information about the
      performance characteristics of primary keys, especially for
      <code class="literal">InnoDB</code> tables, see
      <a class="xref" href="optimization.html#primary-key-optimization" title="8.3.2 Primary Key Optimization">Section 8.3.2, “Primary Key Optimization”</a>.
    </p><a class="indexterm" name="idm140091672086928"></a><a class="indexterm" name="idm140091672085856"></a><p>
      If you add a <code class="literal">UNIQUE INDEX</code> or <code class="literal">PRIMARY
      KEY</code> to a table, MySQL stores it before any nonunique
      index to permit detection of duplicate keys as early as possible.
    </p><a class="indexterm" name="idm140091672082816"></a><a class="indexterm" name="idm140091672081744"></a><a class="indexterm" name="idm140091672080256"></a><p>
      <a class="link" href="sql-syntax.html#drop-index" title="13.1.27 DROP INDEX Syntax"><code class="literal">DROP INDEX</code></a> removes an index. This
      is a MySQL extension to standard SQL. See
      <a class="xref" href="sql-syntax.html#drop-index" title="13.1.27 DROP INDEX Syntax">Section 13.1.27, “DROP INDEX Syntax”</a>. To determine index names, use
      <code class="literal">SHOW INDEX FROM
      <em class="replaceable"><code>tbl_name</code></em></code>.
    </p><p>
      Some storage engines permit you to specify an index type when
      creating an index. The syntax for the
      <em class="replaceable"><code>index_type</code></em> specifier is <code class="literal">USING
      <em class="replaceable"><code>type_name</code></em></code>. For details about
      <code class="literal">USING</code>, see <a class="xref" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax">Section 13.1.15, “CREATE INDEX Syntax”</a>. The
      preferred position is after the column list. Support for use of
      the option before the column list will be removed in a future
      MySQL release.
    </p><p>
      <em class="replaceable"><code>index_option</code></em> values specify additional
      options for an index. <code class="literal">USING</code> is one such option.
      For details about permissible
      <em class="replaceable"><code>index_option</code></em> values, see
      <a class="xref" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax">Section 13.1.15, “CREATE INDEX Syntax”</a>.
    </p><p>
      <code class="literal">RENAME INDEX <em class="replaceable"><code>old_index_name</code></em> TO
      <em class="replaceable"><code>new_index_name</code></em></code> renames an
      index. This is a MySQL extension to standard SQL. The content of
      the table remains unchanged.
      <em class="replaceable"><code>old_index_name</code></em> must be the name of an
      existing index in the table that is not dropped by the same
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement.
      <em class="replaceable"><code>new_index_name</code></em> is the new index name,
      which cannot duplicate the name of an index in the resulting table
      after changes have been applied. Neither index name can be
      <code class="literal">PRIMARY</code>.
    </p><a class="indexterm" name="idm140091672064112"></a><a class="indexterm" name="idm140091672063040"></a><a class="indexterm" name="idm140091672061552"></a><p>
      If you use <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> on a
      <code class="literal">MyISAM</code> table, all nonunique indexes are created
      in a separate batch (as for <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
      TABLE</code></a>). This should make <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a> much faster when you have many indexes.
    </p><p>
      For <code class="literal">MyISAM</code> tables, key updating can be
      controlled explicitly. Use <code class="literal">ALTER TABLE ... DISABLE
      KEYS</code> to tell MySQL to stop updating nonunique indexes.
      Then use <code class="literal">ALTER TABLE ... ENABLE KEYS</code> to
      re-create missing indexes. <code class="literal">MyISAM</code> does this
      with a special algorithm that is much faster than inserting keys
      one by one, so disabling keys before performing bulk insert
      operations should give a considerable speedup. Using
      <code class="literal">ALTER TABLE ... DISABLE KEYS</code> requires the
      <a class="link" href="security.html#priv_index"><code class="literal">INDEX</code></a> privilege in addition to the
      privileges mentioned earlier.
    </p><p>
      While the nonunique indexes are disabled, they are ignored for
      statements such as <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> and
      <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> that otherwise would use
      them.
    </p><p>
      After an <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement, it
      may be necessary to run <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
      TABLE</code></a> to update index cardinality information. See
      <a class="xref" href="sql-syntax.html#show-index" title="13.7.6.22 SHOW INDEX Syntax">Section 13.7.6.22, “SHOW INDEX Syntax”</a>.
    </p><a class="indexterm" name="idm140091672042880"></a><p>
      The <code class="literal">ALTER INDEX</code> operation permits an index to
      be made visible or invisible. An invisible index is not used by
      the optimizer. Modification of index visibility applies to indexes
      other than primary keys (either explicit or implicit). This
      feature is storage engine neutral (supported for any engine). For
      more information, see <a class="xref" href="optimization.html#invisible-indexes" title="8.3.12 Invisible Indexes">Section 8.3.12, “Invisible Indexes”</a>.
</p>
<h4><a name="alter-table-foreign-key"></a>Foreign Keys and Other Constraints</h4>
<a class="indexterm" name="idm140091672038496"></a><a class="indexterm" name="idm140091672037456"></a><p>
      The <code class="literal">FOREIGN KEY</code> and
      <code class="literal">REFERENCES</code> clauses are supported by the
      <code class="literal">InnoDB</code> and <code class="literal">NDB</code> storage
      engines, which implement <code class="literal">ADD [CONSTRAINT
      [<em class="replaceable"><code>symbol</code></em>]] FOREIGN KEY
      [<em class="replaceable"><code>index_name</code></em>] (...) REFERENCES ...
      (...)</code>. See
      <a class="xref" href="innodb-storage-engine.html#innodb-foreign-key-constraints" title="15.6.1.5 InnoDB and FOREIGN KEY Constraints">Section 15.6.1.5, “InnoDB and FOREIGN KEY Constraints”</a>. For other
      storage engines, the clauses are parsed but ignored.
    </p><p>
      For <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>, unlike
      <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>, <code class="literal">ADD FOREIGN
      KEY</code> ignores <em class="replaceable"><code>index_name</code></em> if
      given and uses an automatically generated foreign key name. As a
      workaround, include the <code class="literal">CONSTRAINT</code> clause to
      specify the foreign key name:
    </p><pre data-lang="sql" class="programlisting">
ADD CONSTRAINT <em class="replaceable"><code>name</code></em> FOREIGN KEY (....) ...
</pre>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        MySQL silently ignores inline <code class="literal">REFERENCES</code>
        specifications, where the references are defined as part of the
        column specification. MySQL accepts only
        <code class="literal">REFERENCES</code> clauses defined as part of a
        separate <code class="literal">FOREIGN KEY</code> specification.
</p>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
        Partitioned <code class="literal">InnoDB</code> tables do not support
        foreign keys. This restriction does not apply to
        <code class="literal">NDB</code> tables, including those explicitly
        partitioned by <code class="literal">[LINEAR] KEY</code>. For more
        information, see
        <a class="xref" href="partitioning.html#partitioning-limitations-storage-engines" title="23.6.2 Partitioning Limitations Relating to Storage Engines">Section 23.6.2, “Partitioning Limitations Relating to Storage Engines”</a>.
</p>
</div>
<a class="indexterm" name="idm140091672017408"></a><a class="indexterm" name="idm140091672016336"></a><a class="indexterm" name="idm140091672014848"></a><p>
      MySQL Server and NDB Cluster both support the use of
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> to drop foreign keys:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DROP FOREIGN KEY <em class="replaceable"><code>fk_symbol</code></em>;
</pre><p>
      Adding and dropping a foreign key in the same
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement is supported
      for <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
      ALGORITHM=INPLACE</code></a> but not for
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
      ALGORITHM=COPY</code></a>.
    </p><p>
      The server prohibits changes to foreign key columns that have the
      potential to cause loss of referential integrity. A workaround is
      to use <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
      ... DROP FOREIGN KEY</code></a> before changing the column
      definition and <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE ... ADD FOREIGN KEY</code></a> afterward. Examples of
      prohibited changes include:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Changes to the data type of foreign key columns that may be
          unsafe. For example, changing
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR(20)</code></a> to
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR(30)</code></a> is permitted, but
          changing it to <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR(1024)</code></a> is
          not because that alters the number of length bytes required to
          store individual values.
        </p></li><li class="listitem"><p>
          Changing a <code class="literal">NULL</code> column to <code class="literal">NOT
          NULL</code> in non-strict mode is prohibited to prevent
          converting <code class="literal">NULL</code> values to default
          non-<code class="literal">NULL</code> values, for which there are no
          corresponding values in the referenced table. The operation is
          permitted in strict mode, but an error is returned if any such
          conversion is required.
</p></li></ul>
</div>
<p>
      <code class="literal">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> RENAME
      <em class="replaceable"><code>new_tbl_name</code></em></code> changes
      internally generated foreign key constraint names and user-defined
      foreign key constraint names that begin with the string
      <span class="quote">“<span class="quote"><em class="replaceable"><code>tbl_name</code></em>_ibfk_</span>”</span> to
      reflect the new table name. <code class="literal">InnoDB</code> interprets
      foreign key constraint names that begin with the string
      <span class="quote">“<span class="quote"><em class="replaceable"><code>tbl_name</code></em>_ibfk_</span>”</span> as
      internally generated names.
    </p><a class="indexterm" name="idm140091671989216"></a><p>
      Prior to MySQL 8.0.16, <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
      permits only the following limited version of
      <code class="literal">CHECK</code> constraint-adding syntax, which is parsed
      and ignored:
    </p><pre data-lang="sql" class="programlisting">
ADD CHECK (<em class="replaceable"><code>expr</code></em>)
</pre><p>
      As of MySQL 8.0.16, <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
      permits <code class="literal">CHECK</code> constraints for existing tables
      to be added, dropped, or altered:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Add a new constraint:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em>
    ADD CONSTRAINT [<em class="replaceable"><code>symbol</code></em>] CHECK (<em class="replaceable"><code>expr</code></em>) [[NOT] ENFORCED];
</pre><p>
          The meaning of constraint syntax elements is the same as for
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>. See
          <a class="xref" href="sql-syntax.html#create-table-check-constraints" title="13.1.20.7 CHECK Constraints">Section 13.1.20.7, “CHECK Constraints”</a>.
        </p></li><li class="listitem"><p>
          Drop an existing constraint named
          <em class="replaceable"><code>symbol</code></em>:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em>
    DROP CHECK <em class="replaceable"><code>symbol</code></em>;
</pre></li><li class="listitem"><p>
          Alter whether an existing constraint named
          <em class="replaceable"><code>symbol</code></em> is enforced:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em>
    ALTER CHECK <em class="replaceable"><code>symbol</code></em> [NOT] ENFORCED;
</pre></li></ul>
</div>
<p>
      The <code class="literal">DROP CHECK</code> and <code class="literal">ALTER
      CHECK</code> clauses are MySQL extensions to standard SQL.
    </p><p>
      If a table alteration causes a violation of an enforced
      <code class="literal">CHECK</code> constraint, an error occurs and the table
      is not modified. Examples of operations for which an error occurs:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Attempts to add the <code class="literal">AUTO_INCREMENT</code>
          attribute to a column that is used in a
          <code class="literal">CHECK</code> constraint.
        </p></li><li class="listitem"><p>
          Attempts to add an enforced <code class="literal">CHECK</code>
          constraint or enforce a nonenforced <code class="literal">CHECK</code>
          constraint for which existing rows violate the constraint
          condition.
        </p></li><li class="listitem"><p>
          Attempts to modify, rename, or drop a column that is used in a
          <code class="literal">CHECK</code> constraint, unless that constraint is
          also dropped in the same statement. Exception: If a
          <code class="literal">CHECK</code> constraint refers only to a single
          column, dropping the column automatically drops the
          constraint.
</p></li></ul>
</div>
<p>
      <code class="literal">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> RENAME
      <em class="replaceable"><code>new_tbl_name</code></em></code> changes
      internally generated and user-defined <code class="literal">CHECK</code>
      constraint names that begin with the string
      <span class="quote">“<span class="quote"><em class="replaceable"><code>tbl_name</code></em>_chk_</span>”</span> to reflect
      the new table name. MySQL interprets <code class="literal">CHECK</code>
      constraint names that begin with the string
      <span class="quote">“<span class="quote"><em class="replaceable"><code>tbl_name</code></em>_chk_</span>”</span> as
      internally generated names.
</p>
<h4><a name="alter-table-character-set"></a>Changing the Character Set</h4>
<p>
      <a class="indexterm" name="idm140091671952224"></a>

      To change the table default character set and all character
      columns (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
      <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>) to a new character set, use a
      statement like this:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> CONVERT TO CHARACTER SET <em class="replaceable"><code>charset_name</code></em>;
</pre><p>
      The statement also changes the collation of all character columns.
      If you specify no <code class="literal">COLLATE</code> clause to indicate
      which collation to use, the statement uses default collation for
      the character set. If this collation is inappropriate for the
      intended table use (for example, if it would change from a
      case-sensitive collation to a case-insensitive collation), specify
      a collation explicitly.
    </p><p>
      For a column that has a data type of
      <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> or one of the
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> types, <code class="literal">CONVERT TO
      CHARACTER SET</code> changes the data type as necessary to
      ensure that the new column is long enough to store as many
      characters as the original column. For example, a
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> column has two length bytes,
      which store the byte-length of values in the column, up to a
      maximum of 65,535. For a <code class="literal">latin1</code>
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> column, each character
      requires a single byte, so the column can store up to 65,535
      characters. If the column is converted to <code class="literal">utf8</code>,
      each character might require up to three bytes, for a maximum
      possible length of 3 × 65,535 = 196,605 bytes. That length
      does not fit in a <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> column's
      length bytes, so MySQL converts the data type to
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">MEDIUMTEXT</code></a>, which is the smallest
      string type for which the length bytes can record a value of
      196,605. Similarly, a <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>
      column might be converted to
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">MEDIUMTEXT</code></a>.
    </p><p>
      To avoid data type changes of the type just described, do not use
      <code class="literal">CONVERT TO CHARACTER SET</code>. Instead, use
      <code class="literal">MODIFY</code> to change individual columns. For
      example:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t MODIFY latin1_text_col TEXT CHARACTER SET utf8;
ALTER TABLE t MODIFY latin1_varchar_col VARCHAR(<em class="replaceable"><code>M</code></em>) CHARACTER SET utf8;
</pre><p>
      If you specify <code class="literal">CONVERT TO CHARACTER SET binary</code>,
      the <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
      <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, and
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns are converted to their
      corresponding binary string types
      (<a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
      <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>,
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>). This means that the columns
      no longer will have a character set and a subsequent
      <code class="literal">CONVERT TO</code> operation will not apply to them.
    </p><p>
      If <em class="replaceable"><code>charset_name</code></em> is
      <code class="literal">DEFAULT</code> in a <code class="literal">CONVERT TO CHARACTER
      SET</code> operation, the character set named by the
      <a class="link" href="server-administration.html#sysvar_character_set_database"><code class="literal">character_set_database</code></a> system
      variable is used.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
        The <code class="literal">CONVERT TO</code> operation converts column
        values between the original and named character sets. This is
        <span class="emphasis"><em>not</em></span> what you want if you have a column in
        one character set (like <code class="literal">latin1</code>) but the
        stored values actually use some other, incompatible character
        set (like <code class="literal">utf8</code>). In this case, you have to do
        the following for each such column:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 CHANGE c1 c1 BLOB;
ALTER TABLE t1 CHANGE c1 c1 TEXT CHARACTER SET utf8;
</pre><p>
        The reason this works is that there is no conversion when you
        convert to or from <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> columns.
</p>
</div>
<p>
      To change only the <span class="emphasis"><em>default</em></span> character set for
      a table, use this statement:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DEFAULT CHARACTER SET <em class="replaceable"><code>charset_name</code></em>;
</pre><p>
      The word <code class="literal">DEFAULT</code> is optional. The default
      character set is the character set that is used if you do not
      specify the character set for columns that you add to a table
      later (for example, with <code class="literal">ALTER TABLE ... ADD
      column</code>).
    </p><p>
      When the <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a>
      system variable is enabled, which is the default setting,
      character set conversion is not permitted on tables that include a
      character string column used in a foreign key constraint. The
      workaround is to disable
      <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a> before
      performing the character set conversion. You must perform the
      conversion on both tables involved in the foreign key constraint
      before re-enabling
      <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a>. If you
      re-enable <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a>
      after converting only one of the tables, an <code class="literal">ON DELETE
      CASCADE</code> or <code class="literal">ON UPDATE CASCADE</code>
      operation could corrupt data in the referencing table due to
      implicit conversion that occurs during these operations (Bug
      #45290, Bug #74816).
</p>
<h4><a name="alter-table-discard-import"></a>Discarding and Importing InnoDB Tablespaces</h4>
<a class="indexterm" name="idm140091671894144"></a><a class="indexterm" name="idm140091671893072"></a><p>
      An <code class="literal">InnoDB</code> table created in its own
      <a class="link" href="glossary.html#glos_file_per_table" title="file-per-table">file-per-table</a>
      tablespace can be discarded and imported using the
      <code class="literal">DISCARD TABLESPACE</code> and <code class="literal">IMPORT
      TABLESPACE</code> options. These options can be used to import
      a file-per-table tablespace from a backup or to copy a
      file-per-table tablespace from one database server to another. See
      <a class="xref" href="innodb-storage-engine.html#tablespace-copying" title="15.6.3.7 Copying Tablespaces to Another Instance">Section 15.6.3.7, “Copying Tablespaces to Another Instance”</a>.
</p>
<h4><a name="alter-table-row-order"></a>Row Order for MyISAM Tables</h4>
<a class="indexterm" name="idm140091671886432"></a><p>
      <code class="literal">ORDER BY</code> enables you to create the new table
      with the rows in a specific order. This option is useful primarily
      when you know that you query the rows in a certain order most of
      the time. By using this option after major changes to the table,
      you might be able to get higher performance. In some cases, it
      might make sorting easier for MySQL if the table is in order by
      the column that you want to order it by later.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        The table does not remain in the specified order after inserts
        and deletes.
</p>
</div>
<p>
      <code class="literal">ORDER BY</code> syntax permits one or more column
      names to be specified for sorting, each of which optionally can be
      followed by <code class="literal">ASC</code> or <code class="literal">DESC</code> to
      indicate ascending or descending sort order, respectively. The
      default is ascending order. Only column names are permitted as
      sort criteria; arbitrary expressions are not permitted. This
      clause should be given last after any other clauses.
    </p><p>
      <code class="literal">ORDER BY</code> does not make sense for
      <code class="literal">InnoDB</code> tables because <code class="literal">InnoDB</code>
      always orders table rows according to the
      <a class="link" href="glossary.html#glos_clustered_index" title="clustered index">clustered index</a>.
    </p><p>
      When used on a partitioned table, <code class="literal">ALTER TABLE ... ORDER
      BY</code> orders rows within each partition only.
</p>
<h4><a name="alter-table-partition-options"></a>Partitioning Options</h4>
<p>
      <em class="replaceable"><code>partition_options</code></em> signifies options
      that can be used with partitioned tables for repartitioning, to
      add, drop, discard, import, merge, and split partitions, and to
      perform partitioning maintenance.
    </p><p>
      It is possible for an <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
      statement to contain a <code class="literal">PARTITION BY</code> or
      <code class="literal">REMOVE PARTITIONING</code> clause in an addition to
      other alter specifications, but the <code class="literal">PARTITION
      BY</code> or <code class="literal">REMOVE PARTITIONING</code> clause must
      be specified last after any other specifications. The <code class="literal">ADD
      PARTITION</code>, <code class="literal">DROP PARTITION</code>,
      <code class="literal">DISCARD PARTITION</code>, <code class="literal">IMPORT
      PARTITION</code>, <code class="literal">COALESCE PARTITION</code>,
      <code class="literal">REORGANIZE PARTITION</code>, <code class="literal">EXCHANGE
      PARTITION</code>, <code class="literal">ANALYZE PARTITION</code>,
      <code class="literal">CHECK PARTITION</code>, and <code class="literal">REPAIR
      PARTITION</code> options cannot be combined with other alter
      specifications in a single <code class="literal">ALTER TABLE</code>, since
      the options just listed act on individual partitions.
    </p><p>
      For more information about partition options, see
      <a class="xref" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax">Section 13.1.20, “CREATE TABLE Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#alter-table-partition-operations" title="13.1.9.1 ALTER TABLE Partition Operations">Section 13.1.9.1, “ALTER TABLE Partition Operations”</a>. For
      information about and examples of <code class="literal">ALTER TABLE ...
      EXCHANGE PARTITION</code> statements, see
      <a class="xref" href="partitioning.html#partitioning-management-exchange" title="23.3.3 Exchanging Partitions and Subpartitions with Tables">Section 23.3.3, “Exchanging Partitions and Subpartitions with Tables”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="alter-table-partition-operations"></a>13.1.9.1 ALTER TABLE Partition Operations</h4>
</div>
</div>
</div>
<p>
        Partitioning-related clauses for <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a> can be used with partitioned tables for
        repartitioning, to add, drop, discard, import, merge, and split
        partitions, and to perform partitioning maintenance.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Simply using a <em class="replaceable"><code>partition_options</code></em>
            clause with <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> on a
            partitioned table repartitions the table according to the
            partitioning scheme defined by the
            <em class="replaceable"><code>partition_options</code></em>. This clause
            always begins with <code class="literal">PARTITION BY</code>, and
            follows the same syntax and other rules as apply to the
            <em class="replaceable"><code>partition_options</code></em> clause for
            <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> (for more
            detailed information, see <a class="xref" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax">Section 13.1.20, “CREATE TABLE Syntax”</a>),
            and can also be used to partition an existing table that is
            not already partitioned. For example, consider a
            (nonpartitioned) table defined as shown here:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (
    id INT,
    year_col INT
);
</pre><p>
            This table can be partitioned by <code class="literal">HASH</code>,
            using the <code class="literal">id</code> column as the partitioning
            key, into 8 partitions by means of this statement:
          </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1
    PARTITION BY HASH(id)
    PARTITIONS 8;
</pre><p>
            MySQL supports an <code class="literal">ALGORITHM</code> option with
            <code class="literal">[SUB]PARTITION BY [LINEAR] KEY</code>.
            <code class="literal">ALGORITHM=1</code> causes the server to use the
            same key-hashing functions as MySQL 5.1 when computing the
            placement of rows in partitions;
            <code class="literal">ALGORITHM=2</code> means that the server employs
            the key-hashing functions implemented and used by default
            for new <code class="literal">KEY</code> partitioned tables in MySQL
            5.5 and later. (Partitioned tables created with the
            key-hashing functions employed in MySQL 5.5 and later cannot
            be used by a MySQL 5.1 server.) Not specifying the option
            has the same effect as using <code class="literal">ALGORITHM=2</code>.
            This option is intended for use chiefly when upgrading or
            downgrading <code class="literal">[LINEAR] KEY</code> partitioned
            tables between MySQL 5.1 and later MySQL versions, or for
            creating tables partitioned by <code class="literal">KEY</code> or
            <code class="literal">LINEAR KEY</code> on a MySQL 5.5 or later server
            which can be used on a MySQL 5.1 server.
          </p><p>
            The table that results from using an <code class="literal">ALTER TABLE
            ... PARTITION BY</code> statement must follow the same
            rules as one created using <code class="literal">CREATE TABLE ...
            PARTITION BY</code>. This includes the rules governing
            the relationship between any unique keys (including any
            primary key) that the table might have, and the column or
            columns used in the partitioning expression, as discussed in
            <a class="xref" href="partitioning.html#partitioning-limitations-partitioning-keys-unique-keys" title="23.6.1 Partitioning Keys, Primary Keys, and Unique Keys">Section 23.6.1, “Partitioning Keys, Primary Keys, and Unique Keys”</a>.
            The <code class="literal">CREATE TABLE ... PARTITION BY</code> rules
            for specifying the number of partitions also apply to
            <code class="literal">ALTER TABLE ... PARTITION BY</code>.
          </p><p>
            The <em class="replaceable"><code>partition_definition</code></em> clause
            for <code class="literal">ALTER TABLE ADD PARTITION</code> supports
            the same options as the clause of the same name for the
            <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement. (See
            <a class="xref" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax">Section 13.1.20, “CREATE TABLE Syntax”</a>, for the syntax and
            description.) Suppose that you have the partitioned table
            created as shown here:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (
    id INT,
    year_col INT
)
PARTITION BY RANGE (year_col) (
    PARTITION p0 VALUES LESS THAN (1991),
    PARTITION p1 VALUES LESS THAN (1995),
    PARTITION p2 VALUES LESS THAN (1999)
);
</pre><p>
            You can add a new partition <code class="literal">p3</code> to this
            table for storing values less than <code class="literal">2002</code>
            as follows:
          </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 ADD PARTITION (PARTITION p3 VALUES LESS THAN (2002));
</pre><p>
            <code class="literal">DROP PARTITION</code> can be used to drop one or
            more <code class="literal">RANGE</code> or <code class="literal">LIST</code>
            partitions. This statement cannot be used with
            <code class="literal">HASH</code> or <code class="literal">KEY</code>
            partitions; instead, use <code class="literal">COALESCE
            PARTITION</code> (see later in this section). Any data
            that was stored in the dropped partitions named in the
            <em class="replaceable"><code>partition_names</code></em> list is
            discarded. For example, given the table
            <code class="literal">t1</code> defined previously, you can drop the
            partitions named <code class="literal">p0</code> and
            <code class="literal">p1</code> as shown here:
          </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 DROP PARTITION p0, p1;
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              <code class="literal">DROP PARTITION</code> does not work with
              tables that use the <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a>
              storage engine. See
              <a class="xref" href="partitioning.html#partitioning-management-range-list" title="23.3.1 Management of RANGE and LIST Partitions">Section 23.3.1, “Management of RANGE and LIST Partitions”</a>, and
              <a class="xref" href="mysql-cluster.html#mysql-cluster-limitations" title="22.1.7 Known Limitations of NDB Cluster">Section 22.1.7, “Known Limitations of NDB Cluster”</a>.
</p>
</div>
<p>
            <code class="literal">ADD PARTITION</code> and <code class="literal">DROP
            PARTITION</code> do not currently support <code class="literal">IF
            [NOT] EXISTS</code>.
          </p><p>
            The <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">DISCARD
            PARTITION ... TABLESPACE</code></a> and
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">IMPORT
            PARTITION ... TABLESPACE</code></a> options extend the
            <a class="link" href="glossary.html#glos_transportable_tablespace" title="transportable tablespace">Transportable
            Tablespace</a> feature to individual
            <code class="literal">InnoDB</code> table partitions. Each
            <code class="literal">InnoDB</code> table partition has its own
            tablespace file (<code class="filename">.ibd</code> file). The
            <a class="link" href="glossary.html#glos_transportable_tablespace" title="transportable tablespace">Transportable
            Tablespace</a> feature makes it easy to copy the
            tablespaces from a running MySQL server instance to another
            running instance, or to perform a restore on the same
            instance. Both options take a comma-separated list of one or
            more partition names. For example:
          </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 DISCARD PARTITION p2, p3 TABLESPACE;
</pre><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 IMPORT PARTITION p2, p3 TABLESPACE;
</pre><p>
            When running
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">DISCARD
            PARTITION ... TABLESPACE</code></a> and
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">IMPORT
            PARTITION ... TABLESPACE</code></a> on subpartitioned tables,
            both partition and subpartition names are allowed. When a
            partition name is specified, subpartitions of that partition
            are included.
          </p><p>
            The
            <a class="link" href="glossary.html#glos_transportable_tablespace" title="transportable tablespace">Transportable
            Tablespace</a> feature also supports copying or restoring
            partitioned <code class="literal">InnoDB</code> tables (all partitions
            at once). For additional information, see
            <a class="xref" href="innodb-storage-engine.html#tablespace-copying" title="15.6.3.7 Copying Tablespaces to Another Instance">Section 15.6.3.7, “Copying Tablespaces to Another Instance”</a>, as well as,
            <a class="xref" href="innodb-storage-engine.html#innodb-transportable-tablespace-examples" title="15.6.3.7.1 Transportable Tablespace Examples">Section 15.6.3.7.1, “Transportable Tablespace Examples”</a>.
          </p><p>
            Renames of partitioned tables are supported. You can rename
            individual partitions indirectly using <code class="literal">ALTER TABLE
            ... REORGANIZE PARTITION</code>; however, this operation
            copies the partition's data.
          </p><p>
            To delete rows from selected partitions, use the
            <code class="literal">TRUNCATE PARTITION</code> option. This option
            takes a list of one or more comma-separated partition names.
            Consider the table <code class="literal">t1</code> created by this
            statement:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (
    id INT,
    year_col INT
)
PARTITION BY RANGE (year_col) (
    PARTITION p0 VALUES LESS THAN (1991),
    PARTITION p1 VALUES LESS THAN (1995),
    PARTITION p2 VALUES LESS THAN (1999),
    PARTITION p3 VALUES LESS THAN (2003),
    PARTITION p4 VALUES LESS THAN (2007)
);
</pre><p>
            To delete all rows from partition <code class="literal">p0</code>, use
            the following statement:
          </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 TRUNCATE PARTITION p0;
</pre><p>
            The statement just shown has the same effect as the
            following <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement:
          </p><pre data-lang="sql" class="programlisting">
DELETE FROM t1 WHERE year_col &lt; 1991;
</pre><p>
            When truncating multiple partitions, the partitions do not
            have to be contiguous: This can greatly simplify delete
            operations on partitioned tables that would otherwise
            require very complex <code class="literal">WHERE</code> conditions if
            done with <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements.
            For example, this statement deletes all rows from partitions
            <code class="literal">p1</code> and <code class="literal">p3</code>:
          </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 TRUNCATE PARTITION p1, p3;
</pre><p>
            An equivalent <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>
            statement is shown here:
          </p><pre data-lang="sql" class="programlisting">
DELETE FROM t1 WHERE
    (year_col &gt;= 1991 AND year_col &lt; 1995)
    OR
    (year_col &gt;= 2003 AND year_col &lt; 2007);
</pre><p>
            If you use the <code class="literal">ALL</code> keyword in place of
            the list of partition names, the statement acts on all table
            partitions.
          </p><p>
            <code class="literal">TRUNCATE PARTITION</code> merely deletes rows;
            it does not alter the definition of the table itself, or of
            any of its partitions.
          </p><p>
            To verify that the rows were dropped, check the
            <code class="literal">INFORMATION_SCHEMA.PARTITIONS</code> table,
            using a query such as this one:
          </p><pre data-lang="sql" class="programlisting">
SELECT PARTITION_NAME, TABLE_ROWS
    FROM INFORMATION_SCHEMA.PARTITIONS
    WHERE TABLE_NAME = 't1';
</pre><p>
            <code class="literal">COALESCE PARTITION</code> can be used with a
            table that is partitioned by <code class="literal">HASH</code> or
            <code class="literal">KEY</code> to reduce the number of partitions by
            <em class="replaceable"><code>number</code></em>. Suppose that you have
            created table <code class="literal">t2</code> as follows:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t2 (
    name VARCHAR (30),
    started DATE
)
PARTITION BY HASH( YEAR(started) )
PARTITIONS 6;
</pre><p>
            To reduce the number of partitions used by
            <code class="literal">t2</code> from 6 to 4, use the following
            statement:
          </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t2 COALESCE PARTITION 2;
</pre><p>
            The data contained in the last
            <em class="replaceable"><code>number</code></em> partitions will be merged
            into the remaining partitions. In this case, partitions 4
            and 5 will be merged into the first 4 partitions (the
            partitions numbered 0, 1, 2, and 3).
          </p><p>
            To change some but not all the partitions used by a
            partitioned table, you can use <code class="literal">REORGANIZE
            PARTITION</code>. This statement can be used in several
            ways:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                To merge a set of partitions into a single partition.
                This is done by naming several partitions in the
                <em class="replaceable"><code>partition_names</code></em> list and
                supplying a single definition for
                <em class="replaceable"><code>partition_definition</code></em>.
              </p></li><li class="listitem"><p>
                To split an existing partition into several partitions.
                Accomplish this by naming a single partition for
                <em class="replaceable"><code>partition_names</code></em> and providing
                multiple
                <em class="replaceable"><code>partition_definitions</code></em>.
              </p></li><li class="listitem"><p>
                To change the ranges for a subset of partitions defined
                using <code class="literal">VALUES LESS THAN</code> or the value
                lists for a subset of partitions defined using
                <code class="literal">VALUES IN</code>.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
              For partitions that have not been explicitly named, MySQL
              automatically provides the default names
              <code class="literal">p0</code>, <code class="literal">p1</code>,
              <code class="literal">p2</code>, and so on. The same is true with
              regard to subpartitions.
</p>
</div>
<p>
            For more detailed information about and examples of
            <code class="literal">ALTER TABLE ... REORGANIZE PARTITION</code>
            statements, see
            <a class="xref" href="partitioning.html#partitioning-management-range-list" title="23.3.1 Management of RANGE and LIST Partitions">Section 23.3.1, “Management of RANGE and LIST Partitions”</a>.
          </p></li><li class="listitem"><p>
            To exchange a table partition or subpartition with a table,
            use the <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
            TABLE ... EXCHANGE PARTITION</code></a> statement—that
            is, to move any existing rows in the partition or
            subpartition to the nonpartitioned table, and any existing
            rows in the nonpartitioned table to the table partition or
            subpartition.
          </p><p>
            For usage information and examples, see
            <a class="xref" href="partitioning.html#partitioning-management-exchange" title="23.3.3 Exchanging Partitions and Subpartitions with Tables">Section 23.3.3, “Exchanging Partitions and Subpartitions with Tables”</a>.
          </p></li><li class="listitem"><p>
            Several options provide partition maintenance and repair
            functionality analogous to that implemented for
            nonpartitioned tables by statements such as
            <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> and
            <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> (which are also
            supported for partitioned tables; for more information, see
            <a class="xref" href="sql-syntax.html#table-maintenance-sql" title="13.7.3 Table Maintenance Statements">Section 13.7.3, “Table Maintenance Statements”</a>). These include
            <code class="literal">ANALYZE PARTITION</code>, <code class="literal">CHECK
            PARTITION</code>, <code class="literal">OPTIMIZE PARTITION</code>,
            <code class="literal">REBUILD PARTITION</code>, and <code class="literal">REPAIR
            PARTITION</code>. Each of these options takes a
            <em class="replaceable"><code>partition_names</code></em> clause consisting
            of one or more names of partitions, separated by commas. The
            partitions must already exist in the target table. You can
            also use the <code class="literal">ALL</code> keyword in place of
            <em class="replaceable"><code>partition_names</code></em>, in which case
            the statement acts on all table partitions. For more
            information and examples, see
            <a class="xref" href="partitioning.html#partitioning-maintenance" title="23.3.4 Maintenance of Partitions">Section 23.3.4, “Maintenance of Partitions”</a>.
          </p><p>
            <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> does not currently
            support per-partition optimization; <code class="literal">ALTER TABLE ...
            OPTIMIZE PARTITION</code> causes the entire table to
            rebuilt and analyzed, and an appropriate warning to be
            issued. (Bug #11751825, Bug #42822) To work around this
            problem, use <code class="literal">ALTER TABLE ... REBUILD
            PARTITION</code> and <code class="literal">ALTER TABLE ... ANALYZE
            PARTITION</code> instead.
          </p><p>
            The <code class="literal">ANALYZE PARTITION</code>, <code class="literal">CHECK
            PARTITION</code>, <code class="literal">OPTIMIZE PARTITION</code>,
            and <code class="literal">REPAIR PARTITION</code> options are not
            supported for tables which are not partitioned.
          </p></li><li class="listitem"><p>
            <code class="literal">REMOVE PARTITIONING</code> enables you to remove
            a table's partitioning without otherwise affecting the
            table or its data. This option can be combined with other
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> options such as
            those used to add, drop, or rename columns or indexes.
          </p></li><li class="listitem"><p>
            Using the <code class="literal">ENGINE</code> option with
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> changes the
            storage engine used by the table without affecting the
            partitioning. The target storage engine must provide its own
            partitioning handler. Only the <code class="literal">InnoDB</code> and
            <code class="literal">NDB</code> storage engines have native
            partitioning handlers; <code class="literal">NDB</code> is not
            currently supported in MySQL 8.0.
</p></li></ul>
</div>
<p>
        It is possible for an <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
        statement to contain a <code class="literal">PARTITION BY</code> or
        <code class="literal">REMOVE PARTITIONING</code> clause in an addition to
        other alter specifications, but the <code class="literal">PARTITION
        BY</code> or <code class="literal">REMOVE PARTITIONING</code> clause
        must be specified last after any other specifications.
      </p><p>
        The <code class="literal">ADD PARTITION</code>, <code class="literal">DROP
        PARTITION</code>, <code class="literal">COALESCE PARTITION</code>,
        <code class="literal">REORGANIZE PARTITION</code>, <code class="literal">ANALYZE
        PARTITION</code>, <code class="literal">CHECK PARTITION</code>, and
        <code class="literal">REPAIR PARTITION</code> options cannot be combined
        with other alter specifications in a single <code class="literal">ALTER
        TABLE</code>, since the options just listed act on individual
        partitions. For more information, see
        <a class="xref" href="sql-syntax.html#alter-table-partition-operations" title="13.1.9.1 ALTER TABLE Partition Operations">Section 13.1.9.1, “ALTER TABLE Partition Operations”</a>.
      </p><p>
        Only a single instance of any one of the following options can
        be used in a given <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
        statement: <code class="literal">PARTITION BY</code>, <code class="literal">ADD
        PARTITION</code>, <code class="literal">DROP PARTITION</code>,
        <code class="literal">TRUNCATE PARTITION</code>, <code class="literal">EXCHANGE
        PARTITION</code>, <code class="literal">REORGANIZE PARTITION</code>, or
        <code class="literal">COALESCE PARTITION</code>, <code class="literal">ANALYZE
        PARTITION</code>, <code class="literal">CHECK PARTITION</code>,
        <code class="literal">OPTIMIZE PARTITION</code>, <code class="literal">REBUILD
        PARTITION</code>, <code class="literal">REMOVE PARTITIONING</code>.
      </p><p>
        For example, the following two statements are invalid:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 ANALYZE PARTITION p1, ANALYZE PARTITION p2;

ALTER TABLE t1 ANALYZE PARTITION p1, CHECK PARTITION p2;
</pre><p>
        In the first case, you can analyze partitions
        <code class="literal">p1</code> and <code class="literal">p2</code> of table
        <code class="literal">t1</code> concurrently using a single statement with
        a single <code class="literal">ANALYZE PARTITION</code> option that lists
        both of the partitions to be analyzed, like this:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 ANALYZE PARTITION p1, p2;
</pre><p>
        In the second case, it is not possible to perform
        <code class="literal">ANALYZE</code> and <code class="literal">CHECK</code>
        operations on different partitions of the same table
        concurrently. Instead, you must issue two separate statements,
        like this:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 ANALYZE PARTITION p1;
ALTER TABLE t1 CHECK PARTITION p2;
</pre><p>
        <code class="literal">REBUILD</code> operations are currently unsupported
        for subpartitions. The <code class="literal">REBUILD</code> keyword is
        expressly disallowed with subpartitions, and causes
        <code class="literal">ALTER TABLE</code> to fail with an error if so used.
      </p><p>
        <code class="literal">CHECK PARTITION </code>and<code class="literal"> REPAIR
        PARTITION</code> operations fail when the partition to be
        checked or repaired contains any duplicate key errors.
      </p><p>
        For more information about these statements, see
        <a class="xref" href="partitioning.html#partitioning-maintenance" title="23.3.4 Maintenance of Partitions">Section 23.3.4, “Maintenance of Partitions”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="alter-table-generated-columns"></a>13.1.9.2 ALTER TABLE and Generated Columns</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091671680304"></a><p>
        <code class="literal">ALTER TABLE</code> operations permitted for
        generated columns are <code class="literal">ADD</code>,
        <code class="literal">MODIFY</code>, and <code class="literal">CHANGE</code>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Generated columns can be added.
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (c1 INT);
ALTER TABLE t1 ADD COLUMN c2 INT GENERATED ALWAYS AS (c1 + 1) STORED;            
</pre></li><li class="listitem"><p>
            The data type and expression of generated columns can be
            modified.
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (c1 INT, c2 INT GENERATED ALWAYS AS (c1 + 1) STORED);
ALTER TABLE t1 MODIFY COLUMN c2 TINYINT GENERATED ALWAYS AS (c1 + 5) STORED;
</pre></li><li class="listitem"><p>
            Generated columns can be renamed or dropped, if no other
            column refers to them.
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (c1 INT, c2 INT GENERATED ALWAYS AS (c1 + 1) STORED);
ALTER TABLE t1 CHANGE c2 c3 INT GENERATED ALWAYS AS (c1 + 1) STORED;
ALTER TABLE t1 DROP COLUMN c3;            
</pre></li><li class="listitem"><p>
            Virtual generated columns cannot be altered to stored
            generated columns, or vice versa. To work around this, drop
            the column, then add it with the new definition.
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (c1 INT, c2 INT GENERATED ALWAYS AS (c1 + 1) VIRTUAL);
ALTER TABLE t1 DROP COLUMN c2;
ALTER TABLE t1 ADD COLUMN c2 INT GENERATED ALWAYS AS (c1 + 1) STORED;           
</pre></li><li class="listitem"><p>
            Nongenerated columns can be altered to stored but not
            virtual generated columns.
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (c1 INT, c2 INT);
ALTER TABLE t1 MODIFY COLUMN c2 INT GENERATED ALWAYS AS (c1 + 1) STORED;            
</pre></li><li class="listitem"><p>
            Stored but not virtual generated columns can be altered to
            nongenerated columns. The stored generated values become the
            values of the nongenerated column.
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (c1 INT, c2 INT GENERATED ALWAYS AS (c1 + 1) STORED);
ALTER TABLE t1 MODIFY COLUMN c2 INT;            
</pre></li><li class="listitem"><p>
            <code class="literal">ADD COLUMN</code> is not an in-place operation
            for stored columns (done without using a temporary table)
            because the expression must be evaluated by the server. For
            stored columns, indexing changes are done in place, and
            expression changes are not done in place. Changes to column
            comments are done in place.
          </p></li><li class="listitem"><p>
            For non-partitioned tables, <code class="literal">ADD COLUMN</code>
            and <code class="literal">DROP COLUMN</code> are in-place operations
            for virtual columns. However, adding or dropping a virtual
            column cannot be performed in place in combination with
            other <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operations.
          </p><p>
            For partitioned tables, <code class="literal">ADD COLUMN</code> and
            <code class="literal">DROP COLUMN</code> are not in-place operations
            for virtual columns.
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> supports secondary indexes on
            virtual generated columns. Adding or dropping a secondary
            index on a virtual generated column is an in-place
            operation. For more information, see
            <a class="xref" href="sql-syntax.html#create-table-secondary-indexes" title="13.1.20.10 Secondary Indexes and Generated Columns">Section 13.1.20.10, “Secondary Indexes and Generated Columns”</a>.
          </p></li><li class="listitem"><p>
            When a <code class="literal">VIRTUAL</code> generated column is added
            to a table or modified, it is not ensured that data being
            calculated by the generated column expression will not be
            out of range for the column. This can lead to inconsistent
            data being returned and unexpectedly failed statements. To
            permit control over whether validation occurs for such
            columns, <code class="literal">ALTER TABLE</code> supports
            <code class="literal">WITHOUT VALIDATION</code> and <code class="literal">WITH
            VALIDATION</code> clauses:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                With <code class="literal">WITHOUT VALIDATION</code> (the default
                if neither clause is specified), an in-place operation
                is performed (if possible), data integrity is not
                checked, and the statement finishes more quickly.
                However, later reads from the table might report
                warnings or errors for the column if values are out of
                range.
              </p></li><li class="listitem"><p>
                With <code class="literal">WITH VALIDATION</code>, <code class="literal">ALTER
                TABLE</code> copies the table. If an out-of-range or
                any other error occurs, the statement fails. Because a
                table copy is performed, the statement takes longer.
</p></li></ul>
</div>
<p>
            <code class="literal">WITHOUT VALIDATION</code> and <code class="literal">WITH
            VALIDATION</code> are permitted only with <code class="literal">ADD
            COLUMN</code>, <code class="literal">CHANGE COLUMN</code>, and
            <code class="literal">MODIFY COLUMN</code> operations. Otherwise, an
            <a class="link" href="error-handling.html#error_er_wrong_usage"><code class="literal">ER_WRONG_USAGE</code></a> error occurs.
          </p></li><li class="listitem"><p>
            If expression evaluation causes truncation or provides
            incorrect input to a function, the
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement
            terminates with an error and the DDL operation is rejected.
          </p></li><li class="listitem"><p>
            An <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement that
            changes the default value of a column
            <em class="replaceable"><code>col_name</code></em> may also change the
            value of a generated column expression that refers to the
            column using <em class="replaceable"><code>col_name</code></em>, which may
            change the value of a generated column expression that
            refers to the column using
            <a class="link" href="functions.html#function_default"><code class="literal">DEFAULT(<em class="replaceable"><code>col_name</code></em>)</code></a>.
            For this reason, <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
            operations that change the definition of a column cause a
            table rebuild if any generated column expression uses
            <a class="link" href="functions.html#function_default"><code class="literal">DEFAULT()</code></a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="alter-table-examples"></a>13.1.9.3 ALTER TABLE Examples</h4>

</div>

</div>

</div>
<p>
        Begin with a table <code class="literal">t1</code> created as shown here:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (a INTEGER, b CHAR(10));
</pre><p>
        To rename the table from <code class="literal">t1</code> to
        <code class="literal">t2</code>:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t1 RENAME t2;
</pre><p>
        To change column <code class="literal">a</code> from
        <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INTEGER</code></a> to <code class="literal">TINYINT NOT
        NULL</code> (leaving the name the same), and to change column
        <code class="literal">b</code> from <code class="literal">CHAR(10)</code> to
        <code class="literal">CHAR(20)</code> as well as renaming it from
        <code class="literal">b</code> to <code class="literal">c</code>:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t2 MODIFY a TINYINT NOT NULL, CHANGE b c CHAR(20);
</pre><p>
        To add a new <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> column
        named <code class="literal">d</code>:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t2 ADD d TIMESTAMP;
</pre><p>
        To add an index on column <code class="literal">d</code> and a
        <code class="literal">UNIQUE</code> index on column <code class="literal">a</code>:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t2 ADD INDEX (d), ADD UNIQUE (a);
</pre><p>
        To remove column <code class="literal">c</code>:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t2 DROP COLUMN c;
</pre><p>
        To add a new <code class="literal">AUTO_INCREMENT</code> integer column
        named <code class="literal">c</code>:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE t2 ADD c INT UNSIGNED NOT NULL AUTO_INCREMENT,
  ADD PRIMARY KEY (c);
</pre><p>
        We indexed <code class="literal">c</code> (as a <code class="literal">PRIMARY
        KEY</code>) because <code class="literal">AUTO_INCREMENT</code> columns
        must be indexed, and we declare <code class="literal">c</code> as
        <code class="literal">NOT NULL</code> because primary key columns cannot
        be <code class="literal">NULL</code>.
      </p><p>
        For <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables, it is also possible
        to change the storage type used for a table or column. For
        example, consider an <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> table
        created as shown here:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT) TABLESPACE ts_1 ENGINE NDB;</code></strong>
Query OK, 0 rows affected (1.27 sec)
</pre><p>
        To convert this table to disk-based storage, you can use the
        following <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER TABLE t1 TABLESPACE ts_1 STORAGE DISK;</code></strong>
Query OK, 0 rows affected (2.99 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t1\G</code></strong>
*************************** 1. row ***************************
       Table: t1
Create Table: CREATE TABLE `t1` (
  `c1` int(11) DEFAULT NULL
) /*!50100 TABLESPACE ts_1 STORAGE DISK */
ENGINE=ndbcluster DEFAULT CHARSET=latin1
1 row in set (0.01 sec)
</pre><p>
        It is not necessary that the tablespace was referenced when the
        table was originally created; however, the tablespace must be
        referenced by the <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t2 (c1 INT) ts_1 ENGINE NDB;</code></strong>
Query OK, 0 rows affected (1.00 sec)

mysql&gt; <strong class="userinput"><code>ALTER TABLE t2 STORAGE DISK;</code></strong>
<span class="errortext">ERROR 1005 (HY000): Can't create table 'c.#sql-1750_3' (errno: 140)</span>
mysql&gt; <strong class="userinput"><code>ALTER TABLE t2 TABLESPACE ts_1 STORAGE DISK;</code></strong>
Query OK, 0 rows affected (3.42 sec)
Records: 0  Duplicates: 0  Warnings: 0
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t2\G</code></strong>
*************************** 1. row ***************************
       Table: t1
Create Table: CREATE TABLE `t2` (
  `c1` int(11) DEFAULT NULL
) /*!50100 TABLESPACE ts_1 STORAGE DISK */
ENGINE=ndbcluster DEFAULT CHARSET=latin1
1 row in set (0.01 sec)
</pre><p>
        To change the storage type of an individual column, you can use
        <code class="literal">ALTER TABLE ... MODIFY [COLUMN]</code>. For example,
        suppose you create an NDB Cluster Disk Data table with two
        columns, using this <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
        statement:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t3 (c1 INT, c2 INT)</code></strong>
    -&gt;     <strong class="userinput"><code>TABLESPACE ts_1 STORAGE DISK ENGINE NDB;</code></strong>
Query OK, 0 rows affected (1.34 sec)
</pre><p>
        To change column <code class="literal">c2</code> from disk-based to
        in-memory storage, include a STORAGE MEMORY clause in the column
        definition used by the ALTER TABLE statement, as shown here:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER TABLE t3 MODIFY c2 INT STORAGE MEMORY;</code></strong>
Query OK, 0 rows affected (3.14 sec)
Records: 0  Duplicates: 0  Warnings: 0
</pre><p>
        You can make an in-memory column into a disk-based column by
        using <code class="literal">STORAGE DISK</code> in a similar fashion.
      </p><p>
        Column <code class="literal">c1</code> uses disk-based storage, since this
        is the default for the table (determined by the table-level
        <code class="literal">STORAGE DISK</code> clause in the
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement). However,
        column <code class="literal">c2</code> uses in-memory storage, as can be
        seen here in the output of SHOW <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
        TABLE</code></a>:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t3\G</code></strong>
*************************** 1. row ***************************
       Table: t3
Create Table: CREATE TABLE `t3` (
  `c1` int(11) DEFAULT NULL,
  `c2` int(11) /*!50120 STORAGE MEMORY */ DEFAULT NULL
) /*!50100 TABLESPACE ts_1 STORAGE DISK */ ENGINE=ndbcluster DEFAULT CHARSET=latin1
1 row in set (0.02 sec)
</pre><p>
        When you add an <code class="literal">AUTO_INCREMENT</code> column, column
        values are filled in with sequence numbers automatically. For
        <code class="literal">MyISAM</code> tables, you can set the first sequence
        number by executing <code class="literal">SET
        INSERT_ID=<em class="replaceable"><code>value</code></em></code> before
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> or by using the
        <code class="literal">AUTO_INCREMENT=<em class="replaceable"><code>value</code></em></code>
        table option.
      </p><p>
        With <code class="literal">MyISAM</code> tables, if you do not change the
        <code class="literal">AUTO_INCREMENT</code> column, the sequence number is
        not affected. If you drop an <code class="literal">AUTO_INCREMENT</code>
        column and then add another <code class="literal">AUTO_INCREMENT</code>
        column, the numbers are resequenced beginning with 1.
      </p><p>
        When replication is used, adding an
        <code class="literal">AUTO_INCREMENT</code> column to a table might not
        produce the same ordering of the rows on the slave and the
        master. This occurs because the order in which the rows are
        numbered depends on the specific storage engine used for the
        table and the order in which the rows were inserted. If it is
        important to have the same order on the master and slave, the
        rows must be ordered before assigning an
        <code class="literal">AUTO_INCREMENT</code> number. Assuming that you want
        to add an <code class="literal">AUTO_INCREMENT</code> column to the table
        <code class="literal">t1</code>, the following statements produce a new
        table <code class="literal">t2</code> identical to <code class="literal">t1</code>
        but with an <code class="literal">AUTO_INCREMENT</code> column:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t2 (id INT AUTO_INCREMENT PRIMARY KEY)
SELECT * FROM t1 ORDER BY col1, col2;
</pre><p>
        This assumes that the table <code class="literal">t1</code> has columns
        <code class="literal">col1</code> and <code class="literal">col2</code>.
      </p><p>
        This set of statements will also produce a new table
        <code class="literal">t2</code> identical to <code class="literal">t1</code>, with
        the addition of an <code class="literal">AUTO_INCREMENT</code> column:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t2 LIKE t1;
ALTER TABLE t2 ADD id INT AUTO_INCREMENT PRIMARY KEY;
INSERT INTO t2 SELECT * FROM t1 ORDER BY col1, col2;
</pre>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          To guarantee the same ordering on both master and slave,
          <span class="emphasis"><em>all</em></span> columns of <code class="literal">t1</code> must
          be referenced in the <code class="literal">ORDER BY</code> clause.
</p>
</div>
<p>
        Regardless of the method used to create and populate the copy
        having the <code class="literal">AUTO_INCREMENT</code> column, the final
        step is to drop the original table and then rename the copy:
      </p><pre data-lang="sql" class="programlisting">
DROP TABLE t1;
ALTER TABLE t2 RENAME t1;
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-tablespace"></a>13.1.10 ALTER TABLESPACE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091671539088"></a><a class="indexterm" name="idm140091671537600"></a><a class="indexterm" name="idm140091671536112"></a><pre data-lang="sql" class="programlisting">
ALTER [UNDO] TABLESPACE <em class="replaceable"><code>tablespace_name</code></em>
  <span class="emphasis"><em>NDB only:</em></span>  
    {ADD|DROP} DATAFILE '<em class="replaceable"><code>file_name</code></em>'
    [INITIAL_SIZE [=] size]
    [WAIT]
  <span class="emphasis"><em>InnoDB and NDB:</em></span>
    [RENAME TO <em class="replaceable"><code>tablespace_name</code></em>] 
  <span class="emphasis"><em>InnoDB only:</em></span>
    [SET {ACTIVE|INACTIVE}]
    [ENCRYPTION [=] {'Y' | 'N'}]
  <span class="emphasis"><em>InnoDB and NDB:</em></span>
    [ENGINE [=] <em class="replaceable"><code>engine_name</code></em>]
</pre><p>
      This statement is used with <code class="literal">NDB</code> and
      <code class="literal">InnoDB</code> tablespaces. It can be used to add a new
      data file to, or to drop a data file from an
      <code class="literal">NDB</code> tablespace. It can also be used to rename
      an NDB Cluster Disk Data tablespace, rename an
      <code class="literal">InnoDB</code> general tablespace, encrypt an
      <code class="literal">InnoDB</code> general tablespace, or mark an
      <code class="literal">InnoDB</code> undo tablespace as active or inactive.
    </p><p>
      The <code class="literal">UNDO</code> keyword, introduced in MySQL 8.0.14,
      is used with the <code class="literal">SET {ACTIVE|INACTIVE}</code> clause
      to mark an <code class="literal">InnoDB</code> undo tablespace as active or
      inactive. For more information, see
      <a class="xref" href="innodb-storage-engine.html#innodb-undo-tablespaces" title="15.6.3.4 Undo Tablespaces">Section 15.6.3.4, “Undo Tablespaces”</a>.
    </p><p>
      The <code class="literal">ADD DATAFILE</code> variant enables you to specify
      an initial size for an <code class="literal">NDB</code> Disk Data tablespace
      using an <code class="literal">INITIAL_SIZE</code> clause, where
      <em class="replaceable"><code>size</code></em> is measured in bytes; the default
      value is 134217728 (128 MB). You may optionally follow
      <em class="replaceable"><code>size</code></em> with a one-letter abbreviation for
      an order of magnitude, similar to those used in
      <code class="filename">my.cnf</code>. Generally, this is one of the letters
      <code class="literal">M</code> (megabytes) or <code class="literal">G</code>
      (gigabytes).
    </p><p>
      On 32-bit systems, the maximum supported value for
      <code class="literal">INITIAL_SIZE</code> is 4294967296 (4 GB). (Bug #29186)
    </p><p>
      <code class="literal">INITIAL_SIZE</code> is rounded, explicitly, as for
      <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.21 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a>.
    </p><p>
      Once a data file has been created, its size cannot be changed;
      however, you can add more data files to an NDB tablespace using
      additional <code class="literal">ALTER TABLESPACE ... ADD DATAFILE</code>
      statements.
    </p><p>
      When <code class="literal">ALTER TABLESPACE ... ADD DATAFILE</code> is used
      with <code class="literal">ENGINE = NDB</code>, a data file is created on
      each Cluster data node, but only one row is generated in the
      <a class="link" href="information-schema.html#files-table" title="25.11 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> table. See
      the description of this table, as well as
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data-objects" title="22.5.13.1 NDB Cluster Disk Data Objects">Section 22.5.13.1, “NDB Cluster Disk Data Objects”</a>, for more
      information. <code class="literal">ADD DATAFILE</code> is not supported with
      <code class="literal">InnoDB</code> tablespaces.
    </p><p>
      Using <code class="literal">DROP DATAFILE</code> with
      <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.10 ALTER TABLESPACE Syntax"><code class="literal">ALTER TABLESPACE</code></a> drops the data
      file '<em class="replaceable"><code>file_name</code></em>' from an NDB
      tablespace. You cannot drop a data file from a tablespace which is
      in use by any table; in other words, the data file must be empty
      (no extents used). See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data-objects" title="22.5.13.1 NDB Cluster Disk Data Objects">Section 22.5.13.1, “NDB Cluster Disk Data Objects”</a>. In addition,
      any data file to be dropped must previously have been added to the
      tablespace with <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.21 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a>
      or <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.10 ALTER TABLESPACE Syntax"><code class="literal">ALTER TABLESPACE</code></a>. <code class="literal">DROP
      DATAFILE</code> is not supported with <code class="literal">InnoDB</code>
      tablespaces.
    </p><p>
      <code class="literal">WAIT</code> is parsed but otherwise ignored. It is
      intended for future expansion.
    </p><p>
      The <code class="literal">ENGINE</code> clause, which specifies the storage
      engine used by the tablespace, is deprecated and will be removed
      in a future release. The tablespace storage engine is known by the
      data dictionary, making the <code class="literal">ENGINE</code> clause
      obsolete. If the storage engine is specified, it must match the
      tablespace storage engine defined in the data dictionary. The only
      values for <em class="replaceable"><code>engine_name</code></em> compatible with
      <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tablespaces are
      <code class="literal">NDB</code> and <code class="literal">NDBCLUSTER</code>.
    </p><p>
      <code class="literal">RENAME TO</code> operations are implicitly performed
      in <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> mode, regardless of
      the <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> setting.
    </p><p>
      A <code class="literal">RENAME TO</code> operation cannot be performed while
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> or
      <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH TABLES WITH READ
      LOCK</code></a> is in effect for tables that reside in the
      tablespace.
    </p><p>
      Exclusive <a class="link" href="glossary.html#glos_metadata_lock" title="metadata lock">metadata locks</a>
      are taken on tables that reside in a general tablespace while the
      tablespace is renamed, which prevents concurrent DDL. Concurrent
      DML is supported.
    </p><p>
      The <a class="link" href="security.html#priv_create-tablespace"><code class="literal">CREATE TABLESPACE</code></a> privilege is
      required to rename an <code class="literal">InnoDB</code> general
      tablespace.
    </p><p>
      The <code class="literal">ENCRYPTION</code> clause enables or disables
      page-level data encryption for an <code class="literal">InnoDB</code>
      general tablespace or the <code class="literal">mysql</code> system
      tablespace. Encryption support for general tablespaces was
      introduced in MySQL 8.0.13. Encryption support for the
      <code class="literal">mysql</code> system tablespace was introduced in MySQL
      8.0.16.
    </p><p>
      A keyring plugin must be installed and configured before
      encryption can be enabled.
    </p><p>
      As of MySQL 8.0.16, if the
      <a class="link" href="server-administration.html#sysvar_table_encryption_privilege_check"><code class="literal">table_encryption_privilege_check</code></a>
      variable is enabled, the
      <a class="link" href="security.html#priv_table-encryption-admin"><code class="literal">TABLE_ENCRYPTION_ADMIN</code></a> privilege is
      required to alter a general tablespace with an
      <code class="literal">ENCRYPTION</code> clause setting that differs from the
      <a class="link" href="server-administration.html#sysvar_default_table_encryption"><code class="literal">default_table_encryption</code></a> setting.
    </p><p>
      Enabling encryption for a general tablespace fails if any table in
      the tablespace belongs to a schema defined with
      <a class="link" href="sql-syntax.html#create-database" title="13.1.12 CREATE DATABASE Syntax"><code class="literal">DEFAULT
      ENCRYPTION='N'</code></a>. Similarly, disabling encryption fails if
      any table in the general tablespace belongs to a schema defined
      with <a class="link" href="sql-syntax.html#create-database" title="13.1.12 CREATE DATABASE Syntax"><code class="literal">DEFAULT
      ENCRYPTION='Y'</code></a>. The
      <a class="link" href="sql-syntax.html#create-database" title="13.1.12 CREATE DATABASE Syntax"><code class="literal">DEFAULT
      ENCRYPTION</code></a> schema option was introduced in MySQL 8.0.16.
    </p><p>
      If an <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.10 ALTER TABLESPACE Syntax"><code class="literal">ALTER TABLESPACE</code></a> statement
      executed on a general tablespace does not include an
      <code class="literal">ENCRYPTION</code> clause, the tablespace retains its
      current encryption status, regardless of the
      <a class="link" href="server-administration.html#sysvar_default_table_encryption"><code class="literal">default_table_encryption</code></a> setting.
    </p><p>
      When a general tablespace or the <code class="literal">mysql</code> system
      tablespace is encrypted, all tables residing in the tablespace are
      encrypted. Likewise, a table created in an encrypted tablespace is
      encrypted.
    </p><p>
      The <code class="literal">INPLACE</code> algorithm is used when altering the
      <code class="literal">ENCRYPTION</code> attribute of a general tablespace or
      the <code class="literal">mysql</code> system tablespace. The
      <code class="literal">INPLACE</code> algorithm permits concurrent DML on
      tables that reside in the tablespace. Concurrent DDL is blocked.
    </p><p>
      For more information, see
      <a class="xref" href="innodb-storage-engine.html#innodb-tablespace-encryption" title="15.6.3.9 InnoDB Data-at-Rest Encryption">Section 15.6.3.9, “InnoDB Data-at-Rest Encryption”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-view"></a>13.1.11 ALTER VIEW Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091671452352"></a><pre data-lang="sql" class="programlisting">
ALTER
    [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}]
    [DEFINER = <em class="replaceable"><code>user</code></em>]
    [SQL SECURITY { DEFINER | INVOKER }]
    VIEW <em class="replaceable"><code>view_name</code></em> [(<em class="replaceable"><code>column_list</code></em>)]
    AS <em class="replaceable"><code>select_statement</code></em>
    [WITH [CASCADED | LOCAL] CHECK OPTION]
</pre><p>
      This statement changes the definition of a view, which must exist.
      The syntax is similar to that for <a class="link" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax"><code class="literal">CREATE
      VIEW</code></a> see <a class="xref" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax">Section 13.1.23, “CREATE VIEW Syntax”</a>). This statement
      requires the <a class="link" href="security.html#priv_create-view"><code class="literal">CREATE VIEW</code></a> and
      <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> privileges for the view, and
      some privilege for each column referred to in the
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
      <a class="link" href="sql-syntax.html#alter-view" title="13.1.11 ALTER VIEW Syntax"><code class="literal">ALTER VIEW</code></a> is permitted only to the
      definer or users with the
      <a class="link" href="security.html#priv_set-user-id"><code class="literal">SET_USER_ID</code></a> or
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-database"></a>13.1.12 CREATE DATABASE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091671434256"></a><a class="indexterm" name="idm140091671432768"></a><a class="indexterm" name="idm140091671431696"></a><a class="indexterm" name="idm140091671430624"></a><a class="indexterm" name="idm140091671429136"></a><a class="indexterm" name="idm140091671427648"></a><a class="indexterm" name="idm140091671426160"></a><pre data-lang="sql" class="programlisting">
CREATE {DATABASE | SCHEMA} [IF NOT EXISTS] <em class="replaceable"><code>db_name</code></em>
    [<em class="replaceable"><code>create_specification</code></em>] ...

<em class="replaceable"><code>create_specification</code></em>:
    [DEFAULT] CHARACTER SET [=] <em class="replaceable"><code>charset_name</code></em>
  | [DEFAULT] COLLATE [=] <em class="replaceable"><code>collation_name</code></em>
  | DEFAULT ENCRYPTION [=] {'Y' | 'N'}
</pre><p>
      <a class="link" href="sql-syntax.html#create-database" title="13.1.12 CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a> creates a database
      with the given name. To use this statement, you need the
      <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a> privilege for the database.
      <a class="link" href="sql-syntax.html#create-database" title="13.1.12 CREATE DATABASE Syntax"><code class="literal">CREATE
      SCHEMA</code></a> is a synonym for <a class="link" href="sql-syntax.html#create-database" title="13.1.12 CREATE DATABASE Syntax"><code class="literal">CREATE
      DATABASE</code></a>.
    </p><p>
      An error occurs if the database exists and you did not specify
      <code class="literal">IF NOT EXISTS</code>.
    </p><p>
      <a class="link" href="sql-syntax.html#create-database" title="13.1.12 CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a> is not permitted
      within a session that has an active <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
      TABLES</code></a> statement.
    </p><p>
      <em class="replaceable"><code>create_specification</code></em> options specify
      database characteristics. Database characteristics are stored in
      the data dictionary.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The <code class="literal">CHARACTER SET</code> clause specifies the
          default database character set. The <code class="literal">COLLATE</code>
          clause specifies the default database collation.
          <a class="xref" href="charset.html" title="Chapter 10 Character Sets, Collations, Unicode">Chapter 10, <i>Character Sets, Collations, Unicode</i></a>, discusses character set and
          collation names.
        </p></li><li class="listitem"><p>
          The <code class="literal">DEFAULT ENCRYPTION</code> clause, introduced
          in MySQL 8.0.16, defines the default database encryption,
          which is inherited by tables created in the database. If the
          <code class="literal">DEFAULT ENCRYPTION</code> clause is not specified,
          the <a class="link" href="server-administration.html#sysvar_default_table_encryption"><code class="literal">default_table_encryption</code></a>
          setting defines the default database encryption. If the
          <a class="link" href="server-administration.html#sysvar_table_encryption_privilege_check"><code class="literal">table_encryption_privilege_check</code></a>
          variable is enabled, the
          <a class="link" href="security.html#priv_table-encryption-admin"><code class="literal">TABLE_ENCRYPTION_ADMIN</code></a>
          privilege is required to specify a default encryption setting
          that differs from the
          <a class="link" href="server-administration.html#sysvar_default_table_encryption"><code class="literal">default_table_encryption</code></a>
          setting. For more information, see
          <a class="xref" href="innodb-storage-engine.html#innodb-schema-tablespace-encryption-default" title="Defining an Encryption Default for Schemas and General Tablespaces">Defining an Encryption Default for Schemas and General Tablespaces</a>.
</p></li></ul>
</div>
<p>
      A database in MySQL is implemented as a directory containing files
      that correspond to tables in the database. Because there are no
      tables in a database when it is initially created, the
      <a class="link" href="sql-syntax.html#create-database" title="13.1.12 CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a> statement creates
      only a directory under the MySQL data directory. Rules for
      permissible database names are given in
      <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>. If a database name contains special
      characters, the name for the database directory contains encoded
      versions of those characters as described in
      <a class="xref" href="language-structure.html#identifier-mapping" title="9.2.3 Mapping of Identifiers to File Names">Section 9.2.3, “Mapping of Identifiers to File Names”</a>.
    </p><p>
      Creating a database directory by manually creating a directory
      under the data directory (for example, with
      <span class="command"><strong>mkdir</strong></span>) is unsupported in MySQL 8.0.
    </p><a class="indexterm" name="idm140091671389456"></a><p>
      You can also use the <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin</strong></span></a> program to
      create databases. See <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-event"></a>13.1.13 CREATE EVENT Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091671384848"></a><a class="indexterm" name="idm140091671383360"></a><a class="indexterm" name="idm140091671381872"></a><pre data-lang="sql" class="programlisting">
CREATE
    [DEFINER = <em class="replaceable"><code>user</code></em>]
    EVENT
    [IF NOT EXISTS]
    <em class="replaceable"><code>event_name</code></em>
    ON SCHEDULE <em class="replaceable"><code>schedule</code></em>
    [ON COMPLETION [NOT] PRESERVE]
    [ENABLE | DISABLE | DISABLE ON SLAVE]
    [COMMENT '<em class="replaceable"><code>string</code></em>']
    DO <em class="replaceable"><code>event_body</code></em>;

<em class="replaceable"><code>schedule</code></em>:
    AT <em class="replaceable"><code>timestamp</code></em> [+ INTERVAL <em class="replaceable"><code>interval</code></em>] ...
  | EVERY <em class="replaceable"><code>interval</code></em>
    [STARTS <em class="replaceable"><code>timestamp</code></em> [+ INTERVAL <em class="replaceable"><code>interval</code></em>] ...]
    [ENDS <em class="replaceable"><code>timestamp</code></em> [+ INTERVAL <em class="replaceable"><code>interval</code></em>] ...]

<em class="replaceable"><code>interval</code></em>:
    <em class="replaceable"><code>quantity</code></em> {YEAR | QUARTER | MONTH | DAY | HOUR | MINUTE |
              WEEK | SECOND | YEAR_MONTH | DAY_HOUR | DAY_MINUTE |
              DAY_SECOND | HOUR_MINUTE | HOUR_SECOND | MINUTE_SECOND}
</pre><p>
      This statement creates and schedules a new event. The event will
      not run unless the Event Scheduler is enabled. For information
      about checking Event Scheduler status and enabling it if
      necessary, see <a class="xref" href="stored-objects.html#events-configuration" title="24.4.2 Event Scheduler Configuration">Section 24.4.2, “Event Scheduler Configuration”</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> requires the
      <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a> privilege for the schema in
      which the event is to be created. If the
      <code class="literal">DEFINER</code> clause is present, the privileges
      required depend on the <em class="replaceable"><code>user</code></em> value, as
      discussed in <a class="xref" href="stored-objects.html#stored-objects-security" title="24.6 Stored Object Access Control">Section 24.6, “Stored Object Access Control”</a>.
    </p><p>
      The minimum requirements for a valid <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE
      EVENT</code></a> statement are as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The keywords <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> plus
          an event name, which uniquely identifies the event in a
          database schema.
        </p></li><li class="listitem"><p>
          An <code class="literal">ON SCHEDULE</code> clause, which determines
          when and how often the event executes.
        </p></li><li class="listitem"><p>
          A <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause, which contains the
          SQL statement to be executed by an event.
</p></li></ul>
</div>
<p>
      This is an example of a minimal <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE
      EVENT</code></a> statement:
    </p><pre data-lang="sql" class="programlisting">
CREATE EVENT myevent
    ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 1 HOUR
    DO
      UPDATE myschema.mytable SET mycol = mycol + 1;
</pre><p>
      The previous statement creates an event named
      <code class="literal">myevent</code>. This event executes once—one
      hour following its creation—by running an SQL statement that
      increments the value of the <code class="literal">myschema.mytable</code>
      table's <code class="literal">mycol</code> column by 1.
    </p><p>
      The <em class="replaceable"><code>event_name</code></em> must be a valid MySQL
      identifier with a maximum length of 64 characters. Event names are
      not case-sensitive, so you cannot have two events named
      <code class="literal">myevent</code> and <code class="literal">MyEvent</code> in the
      same schema. In general, the rules governing event names are the
      same as those for names of stored routines. See
      <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>.
    </p><p>
      An event is associated with a schema. If no schema is indicated as
      part of <em class="replaceable"><code>event_name</code></em>, the default
      (current) schema is assumed. To create an event in a specific
      schema, qualify the event name with a schema using
      <code class="literal"><em class="replaceable"><code>schema_name</code></em>.<em class="replaceable"><code>event_name</code></em></code>
      syntax.
    </p><p>
      The <code class="literal">DEFINER</code> clause specifies the MySQL account
      to be used when checking access privileges at event execution
      time. If the <code class="literal">DEFINER</code> clause is present, the
      <em class="replaceable"><code>user</code></em> value should be a MySQL account
      specified as
      <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>,
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>, or
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>. The permitted
      <em class="replaceable"><code>user</code></em> values depend on the privileges
      you hold, as discussed in
      <a class="xref" href="stored-objects.html#stored-objects-security" title="24.6 Stored Object Access Control">Section 24.6, “Stored Object Access Control”</a>. Also see that section
      for additional information about event security.
    </p><p>
      If the <code class="literal">DEFINER</code> clause is omitted, the default
      definer is the user who executes the <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE
      EVENT</code></a> statement. This is the same as specifying
      <code class="literal">DEFINER = CURRENT_USER</code> explicitly.
    </p><p>
      Within an event body, the
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> function returns the
      account used to check privileges at event execution time, which is
      the <code class="literal">DEFINER</code> user. For information about user
      auditing within events, see
      <a class="xref" href="security.html#account-activity-auditing" title="6.2.22 SQL-Based Account Activity Auditing">Section 6.2.22, “SQL-Based Account Activity Auditing”</a>.
    </p><p>
      <code class="literal">IF NOT EXISTS</code> has the same meaning for
      <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> as for
      <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>: If an event named
      <em class="replaceable"><code>event_name</code></em> already exists in the same
      schema, no action is taken, and no error results. (However, a
      warning is generated in such cases.)
    </p><p>
      The <code class="literal">ON SCHEDULE</code> clause determines when, how
      often, and for how long the <em class="replaceable"><code>event_body</code></em>
      defined for the event repeats. This clause takes one of two forms:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">AT <em class="replaceable"><code>timestamp</code></em></code> is
          used for a one-time event. It specifies that the event
          executes one time only at the date and time given by
          <em class="replaceable"><code>timestamp</code></em>, which must include both
          the date and time, or must be an expression that resolves to a
          datetime value. You may use a value of either the
          <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> or
          <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> type for this
          purpose. If the date is in the past, a warning occurs, as
          shown here:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT NOW();</code></strong>
+---------------------+
| NOW()               |
+---------------------+
| 2006-02-10 23:59:01 |
+---------------------+
1 row in set (0.04 sec)

mysql&gt; <strong class="userinput"><code>CREATE EVENT e_totals</code></strong>
    -&gt;     <strong class="userinput"><code>ON SCHEDULE AT '2006-02-10 23:59:00'</code></strong>
    -&gt;     <strong class="userinput"><code>DO INSERT INTO test.totals VALUES (NOW());</code></strong>
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Note
   Code: 1588
Message: Event execution time is in the past and ON COMPLETION NOT
         PRESERVE is set. The event was dropped immediately after
         creation.
</pre><p>
          <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> statements which
          are themselves invalid—for whatever reason—fail
          with an error.
        </p><p>
          You may use <a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP</code></a>
          to specify the current date and time. In such a case, the
          event acts as soon as it is created.
        </p><p>
          To create an event which occurs at some point in the future
          relative to the current date and time—such as that
          expressed by the phrase <span class="quote">“<span class="quote">three weeks from
          now</span>”</span>—you can use the optional clause <code class="literal">+
          INTERVAL <em class="replaceable"><code>interval</code></em></code>. The
          <em class="replaceable"><code>interval</code></em> portion consists of two
          parts, a quantity and a unit of time, and follows the syntax
          rules described in <a class="xref" href="language-structure.html#temporal-intervals" title="Temporal Intervals">Temporal Intervals</a>,
          except that you cannot use any units keywords that involving
          microseconds when defining an event. With some interval types,
          complex time units may be used. For example, <span class="quote">“<span class="quote">two
          minutes and ten seconds</span>”</span> can be expressed as <code class="literal">+
          INTERVAL '2:10' MINUTE_SECOND</code>.
        </p><p>
          You can also combine intervals. For example, <code class="literal">AT
          CURRENT_TIMESTAMP + INTERVAL 3 WEEK + INTERVAL 2 DAY</code>
          is equivalent to <span class="quote">“<span class="quote">three weeks and two days from
          now</span>”</span>. Each portion of such a clause must begin with
          <code class="literal">+ INTERVAL</code>.
        </p></li><li class="listitem"><p>
          To repeat actions at a regular interval, use an
          <code class="literal">EVERY</code> clause. The <code class="literal">EVERY</code>
          keyword is followed by an <em class="replaceable"><code>interval</code></em>
          as described in the previous discussion of the
          <code class="literal">AT</code> keyword. (<code class="literal">+ INTERVAL</code>
          is <span class="emphasis"><em>not</em></span> used with
          <code class="literal">EVERY</code>.) For example, <code class="literal">EVERY 6
          WEEK</code> means <span class="quote">“<span class="quote">every six weeks</span>”</span>.
        </p><p>
          Although <code class="literal">+ INTERVAL</code> clauses are not
          permitted in an <code class="literal">EVERY</code> clause, you can use
          the same complex time units permitted in a <code class="literal">+
          INTERVAL</code>.
        </p><p>
          An <code class="literal">EVERY</code> clause may contain an optional
          <code class="literal">STARTS</code> clause. <code class="literal">STARTS</code> is
          followed by a <em class="replaceable"><code>timestamp</code></em> value that
          indicates when the action should begin repeating, and may also
          use <code class="literal">+ INTERVAL
          <em class="replaceable"><code>interval</code></em></code> to specify an
          amount of time <span class="quote">“<span class="quote">from now</span>”</span>. For example,
          <code class="literal">EVERY 3 MONTH STARTS CURRENT_TIMESTAMP + INTERVAL 1
          WEEK</code> means <span class="quote">“<span class="quote">every three months, beginning one
          week from now</span>”</span>. Similarly, you can express <span class="quote">“<span class="quote">every
          two weeks, beginning six hours and fifteen minutes from
          now</span>”</span> as <code class="literal">EVERY 2 WEEK STARTS CURRENT_TIMESTAMP
          + INTERVAL '6:15' HOUR_MINUTE</code>. Not specifying
          <code class="literal">STARTS</code> is the same as using <code class="literal">STARTS
          CURRENT_TIMESTAMP</code>—that is, the action
          specified for the event begins repeating immediately upon
          creation of the event.
        </p><p>
          An <code class="literal">EVERY</code> clause may contain an optional
          <code class="literal">ENDS</code> clause. The <code class="literal">ENDS</code>
          keyword is followed by a <em class="replaceable"><code>timestamp</code></em>
          value that tells MySQL when the event should stop repeating.
          You may also use <code class="literal">+ INTERVAL
          <em class="replaceable"><code>interval</code></em></code> with
          <code class="literal">ENDS</code>; for instance, <code class="literal">EVERY 12 HOUR
          STARTS CURRENT_TIMESTAMP + INTERVAL 30 MINUTE ENDS
          CURRENT_TIMESTAMP + INTERVAL 4 WEEK</code> is equivalent to
          <span class="quote">“<span class="quote">every twelve hours, beginning thirty minutes from now,
          and ending four weeks from now</span>”</span>. Not using
          <code class="literal">ENDS</code> means that the event continues
          executing indefinitely.
        </p><p>
          <code class="literal">ENDS</code> supports the same syntax for complex
          time units as <code class="literal">STARTS</code> does.
        </p><p>
          You may use <code class="literal">STARTS</code>,
          <code class="literal">ENDS</code>, both, or neither in an
          <code class="literal">EVERY</code> clause.
        </p><p>
          If a repeating event does not terminate within its scheduling
          interval, the result may be multiple instances of the event
          executing simultaneously. If this is undesirable, you should
          institute a mechanism to prevent simultaneous instances. For
          example, you could use the
          <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a> function, or row or
          table locking.
</p></li></ul>
</div>
<p>
      The <code class="literal">ON SCHEDULE</code> clause may use expressions
      involving built-in MySQL functions and user variables to obtain
      any of the <em class="replaceable"><code>timestamp</code></em> or
      <em class="replaceable"><code>interval</code></em> values which it contains. You
      may not use stored functions or user-defined functions in such
      expressions, nor may you use any table references; however, you
      may use <code class="literal">SELECT FROM DUAL</code>. This is true for both
      <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> and
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statements. References
      to stored functions, user-defined functions, and tables in such
      cases are specifically not permitted, and fail with an error (see
      Bug #22830).
    </p><p>
      Times in the <code class="literal">ON SCHEDULE</code> clause are interpreted
      using the current session
      <a class="link" href="server-administration.html#sysvar_time_zone"><code class="literal">time_zone</code></a> value. This becomes the
      event time zone; that is, the time zone that is used for event
      scheduling and is in effect within the event as it executes. These
      times are converted to UTC and stored along with the event time
      zone in the <code class="literal">mysql.event</code> table. This enables
      event execution to proceed as defined regardless of any subsequent
      changes to the server time zone or daylight saving time effects.
      For additional information about representation of event times,
      see <a class="xref" href="stored-objects.html#events-metadata" title="24.4.4 Event Metadata">Section 24.4.4, “Event Metadata”</a>. See also
      <a class="xref" href="sql-syntax.html#show-events" title="13.7.6.18 SHOW EVENTS Syntax">Section 13.7.6.18, “SHOW EVENTS Syntax”</a>, and <a class="xref" href="information-schema.html#events-table" title="25.10 The INFORMATION_SCHEMA EVENTS Table">Section 25.10, “The INFORMATION_SCHEMA EVENTS Table”</a>.
    </p><p>
      Normally, once an event has expired, it is immediately dropped.
      You can override this behavior by specifying <code class="literal">ON
      COMPLETION PRESERVE</code>. Using <code class="literal">ON COMPLETION NOT
      PRESERVE</code> merely makes the default nonpersistent behavior
      explicit.
    </p><p>
      You can create an event but prevent it from being active using the
      <code class="literal">DISABLE</code> keyword. Alternatively, you can use
      <code class="literal">ENABLE</code> to make explicit the default status,
      which is active. This is most useful in conjunction with
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> (see
      <a class="xref" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax">Section 13.1.3, “ALTER EVENT Syntax”</a>).
    </p><p>
      A third value may also appear in place of
      <code class="literal">ENABLE</code> or <code class="literal">DISABLE</code>;
      <code class="literal">DISABLE ON SLAVE</code> is set for the status of an
      event on a replication slave to indicate that the event was
      created on the master and replicated to the slave, but is not
      executed on the slave. See
      <a class="xref" href="replication.html#replication-features-invoked" title="17.4.1.16 Replication of Invoked Features">Section 17.4.1.16, “Replication of Invoked Features”</a>.
    </p><p>
      You may supply a comment for an event using a
      <code class="literal">COMMENT</code> clause.
      <em class="replaceable"><code>comment</code></em> may be any string of up to 64
      characters that you wish to use for describing the event. The
      comment text, being a string literal, must be surrounded by
      quotation marks.
    </p><p>
      The <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause specifies an action
      carried by the event, and consists of an SQL statement. Nearly any
      valid MySQL statement that can be used in a stored routine can
      also be used as the action statement for a scheduled event. (See
      <a class="xref" href="restrictions.html#stored-program-restrictions" title="C.1 Restrictions on Stored Programs">Section C.1, “Restrictions on Stored Programs”</a>.) For example, the
      following event <code class="literal">e_hourly</code> deletes all rows from
      the <code class="literal">sessions</code> table once per hour, where this
      table is part of the <code class="literal">site_activity</code> schema:
    </p><pre data-lang="sql" class="programlisting">
CREATE EVENT e_hourly
    ON SCHEDULE
      EVERY 1 HOUR
    COMMENT 'Clears out sessions table each hour.'
    DO
      DELETE FROM site_activity.sessions;
</pre><p>
      MySQL stores the <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> system
      variable setting in effect when an event is created or altered,
      and always executes the event with this setting in force,
      <span class="emphasis"><em>regardless of the current server SQL mode when the event
      begins executing</em></span>.
    </p><p>
      A <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> statement that
      contains an <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement
      in its <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause appears to
      succeed; however, when the server attempts to execute the
      resulting scheduled event, the execution fails with an error.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Statements such as <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> or
        <a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax"><code class="literal">SHOW</code></a> that merely return a result
        set have no effect when used in an event; the output from these
        is not sent to the MySQL Monitor, nor is it stored anywhere.
        However, you can use statements such as
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT ...
        INTO</code></a> and
        <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT INTO ...
        SELECT</code></a> that store a result. (See the next example in
        this section for an instance of the latter.)
</p>
</div>
<p>
      The schema to which an event belongs is the default schema for
      table references in the <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause.
      Any references to tables in other schemas must be qualified with
      the proper schema name.
    </p><p>
      As with stored routines, you can use compound-statement syntax in
      the <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause by using the
      <code class="literal">BEGIN</code> and <code class="literal">END</code> keywords, as
      shown here:
    </p><pre data-lang="sql" class="programlisting">
delimiter |

CREATE EVENT e_daily
    ON SCHEDULE
      EVERY 1 DAY
    COMMENT 'Saves total number of sessions then clears the table each day'
    DO
      BEGIN
        INSERT INTO site_activity.totals (time, total)
          SELECT CURRENT_TIMESTAMP, COUNT(*)
            FROM site_activity.sessions;
        DELETE FROM site_activity.sessions;
      END |

delimiter ;
</pre><p>
      This example uses the <code class="literal">delimiter</code> command to
      change the statement delimiter. See
      <a class="xref" href="stored-objects.html#stored-programs-defining" title="24.1 Defining Stored Programs">Section 24.1, “Defining Stored Programs”</a>.
    </p><p>
      More complex compound statements, such as those used in stored
      routines, are possible in an event. This example uses local
      variables, an error handler, and a flow control construct:
    </p><pre data-lang="sql" class="programlisting">
delimiter |

CREATE EVENT e
    ON SCHEDULE
      EVERY 5 SECOND
    DO
      BEGIN
        DECLARE v INTEGER;
        DECLARE CONTINUE HANDLER FOR SQLEXCEPTION BEGIN END;

        SET v = 0;

        WHILE v &lt; 5 DO
          INSERT INTO t1 VALUES (0);
          UPDATE t2 SET s1 = s1 + 1;
          SET v = v + 1;
        END WHILE;
    END |

delimiter ;
</pre><p>
      There is no way to pass parameters directly to or from events;
      however, it is possible to invoke a stored routine with parameters
      within an event:
    </p><pre data-lang="sql" class="programlisting">
CREATE EVENT e_call_myproc
    ON SCHEDULE
      AT CURRENT_TIMESTAMP + INTERVAL 1 DAY
    DO CALL myproc(5, 27);
</pre><p>
      If an event's definer has privileges sufficient to set global
      system variables (see
      <a class="xref" href="server-administration.html#system-variable-privileges" title="5.1.9.1 System Variable Privileges">Section 5.1.9.1, “System Variable Privileges”</a>), the event can read
      and write global variables. As granting such privileges entails a
      potential for abuse, extreme care must be taken in doing so.
    </p><p>
      Generally, any statements that are valid in stored routines may be
      used for action statements executed by events. For more
      information about statements permissible within stored routines,
      see <a class="xref" href="stored-objects.html#stored-routines-syntax" title="24.2.1 Stored Routine Syntax">Section 24.2.1, “Stored Routine Syntax”</a>. You can create an
      event as part of a stored routine, but an event cannot be created
      by another event.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-function"></a>13.1.14 CREATE FUNCTION Syntax</h3>

</div>

</div>

</div>
<p>
      The <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> statement is
      used to create stored functions and user-defined functions (UDFs):
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          For information about creating stored functions, see
          <a class="xref" href="sql-syntax.html#create-procedure" title="13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax">Section 13.1.17, “CREATE PROCEDURE and CREATE FUNCTION Syntax”</a>.
        </p></li><li class="listitem"><p>
          For information about creating user-defined functions, see
          <a class="xref" href="sql-syntax.html#create-function-udf" title="13.7.4.1 CREATE FUNCTION Syntax for User-Defined Functions">Section 13.7.4.1, “CREATE FUNCTION Syntax for User-Defined Functions”</a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-index"></a>13.1.15 CREATE INDEX Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091671206448"></a><a class="indexterm" name="idm140091671205376"></a><a class="indexterm" name="idm140091671204304"></a><a class="indexterm" name="idm140091671202816"></a><pre data-lang="sql" class="programlisting">
CREATE [UNIQUE | FULLTEXT | SPATIAL] INDEX <em class="replaceable"><code>index_name</code></em>
    [<em class="replaceable"><code>index_type</code></em>]
    ON <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>key_part</code></em>,...)
    [<em class="replaceable"><code>index_option</code></em>]
    [<em class="replaceable"><code>algorithm_option</code></em> | <em class="replaceable"><code>lock_option</code></em>] ...

<em class="replaceable"><code>key_part</code></em>: {<em class="replaceable"><code>col_name</code></em> [(<em class="replaceable"><code>length</code></em>)] | (<em class="replaceable"><code>expr</code></em>)} [ASC | DESC]

<em class="replaceable"><code>index_option</code></em>:
    KEY_BLOCK_SIZE [=] <em class="replaceable"><code>value</code></em>
  | <em class="replaceable"><code>index_type</code></em>
  | WITH PARSER <em class="replaceable"><code>parser_name</code></em>
  | COMMENT '<em class="replaceable"><code>string</code></em>'
  | {VISIBLE | INVISIBLE}

<em class="replaceable"><code>index_type</code></em>:
    USING {BTREE | HASH}

<em class="replaceable"><code>algorithm_option</code></em>:
    ALGORITHM [=] {DEFAULT | INPLACE | COPY}

<em class="replaceable"><code>lock_option</code></em>:
    LOCK [=] {DEFAULT | NONE | SHARED | EXCLUSIVE}
</pre><p>
      Normally, you create all indexes on a table at the time the table
      itself is created with <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
      TABLE</code></a>. See <a class="xref" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax">Section 13.1.20, “CREATE TABLE Syntax”</a>. This
      guideline is especially important for
      <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables, where the primary key
      determines the physical layout of rows in the data file.
      <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> enables you to add
      indexes to existing tables.
    </p><p>
      <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> is mapped to an
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement to create
      indexes. See <a class="xref" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax">Section 13.1.9, “ALTER TABLE Syntax”</a>.
      <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> cannot be used to
      create a <code class="literal">PRIMARY KEY</code>; use
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> instead. For more
      information about indexes, see <a class="xref" href="optimization.html#mysql-indexes" title="8.3.1 How MySQL Uses Indexes">Section 8.3.1, “How MySQL Uses Indexes”</a>.
    </p><p>
      <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> supports secondary indexes on
      virtual columns. For more information, see
      <a class="xref" href="sql-syntax.html#create-table-secondary-indexes" title="13.1.20.10 Secondary Indexes and Generated Columns">Section 13.1.20.10, “Secondary Indexes and Generated Columns”</a>.
    </p><p>
      When the <a class="link" href="innodb-storage-engine.html#sysvar_innodb_stats_persistent"><code class="literal">innodb_stats_persistent</code></a>
      setting is enabled, run the <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
      TABLE</code></a> statement for an
      <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> table after creating an index
      on that table.
    </p><p>
      An index specification of the form
      <code class="literal">(<em class="replaceable"><code>key_part1</code></em>,
      <em class="replaceable"><code>key_part2</code></em>, ...)</code> creates an
      index with multiple key parts. Index key values are formed by
      concatenating the values of the given key parts. For example
      <code class="literal">(col1, col2, col3)</code> specifies a multiple-column
      index with index keys consisting of values from
      <code class="literal">col1</code>, <code class="literal">col2</code>, and
      <code class="literal">col3</code>.
    </p><p>
      A <em class="replaceable"><code>key_part</code></em> specification can end with
      <code class="literal">ASC</code> or <code class="literal">DESC</code> to specify
      whether index values are stored in ascending or descending order.
      The default is ascending if no order specifier is given.
      <code class="literal">ASC</code> and <code class="literal">DESC</code> are not
      permitted for <code class="literal">HASH</code> indexes. As of MySQL 8.0.12,
      <code class="literal">ASC</code> and <code class="literal">DESC</code> are not
      permitted for <code class="literal">SPATIAL</code> indexes.
    </p><p>
      The following sections describe different aspects of the
      <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-index-column-prefixes" title="Column Prefix Key Parts">Column Prefix Key Parts</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-index-functional-key-parts" title="Functional Key Parts">Functional Key Parts</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-index-unique" title="Unique Indexes">Unique Indexes</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-index-fulltext" title="Full-Text Indexes">Full-Text Indexes</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-index-spatial" title="Spatial Indexes">Spatial Indexes</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-index-options" title="Index Options">Index Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-index-copying" title="Table Copying and Locking Options">Table Copying and Locking Options</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="create-index-column-prefixes"></a>Column Prefix Key Parts</h4>

</div>

</div>

</div>
<p>
        For string columns, indexes can be created that use only the
        leading part of column values, using
        <code class="literal"><em class="replaceable"><code>col_name</code></em>(<em class="replaceable"><code>length</code></em>)</code>
        syntax to specify an index prefix length:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Prefixes can be specified for
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>, and
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> key parts.
          </p></li><li class="listitem"><p>
            Prefixes <span class="emphasis"><em>must</em></span> be specified for
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> and
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> key parts. Additionally,
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> and
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns can be indexed
            only for <code class="literal">InnoDB</code>,
            <code class="literal">MyISAM</code>, and <code class="literal">BLACKHOLE</code>
            tables.
          </p><a class="indexterm" name="idm140091671131296"></a><a class="indexterm" name="idm140091671129808"></a><a class="indexterm" name="idm140091671128320"></a><a class="indexterm" name="idm140091671126832"></a></li><li class="listitem"><p>
            Prefix <span class="emphasis"><em>limits</em></span> are measured in bytes.
            However, prefix <span class="emphasis"><em>lengths</em></span> for index
            specifications in <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
            TABLE</code></a>, <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>,
            and <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> statements
            are interpreted as number of characters for nonbinary string
            types (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>) and number of bytes for
            binary string types (<a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>,
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>). Take this into account
            when specifying a prefix length for a nonbinary string
            column that uses a multibyte character set.
          </p><p>
            Prefix support and lengths of prefixes (where supported) are
            storage engine dependent. For example, a prefix can be up to
            767 bytes long for <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>
            tables that use the
            <code class="literal"><a class="link" href="glossary.html#glos_redundant_row_format" title="redundant row format">REDUNDANT</a></code>
            or
            <code class="literal"><a class="link" href="glossary.html#glos_compact_row_format" title="compact row format">COMPACT</a></code>
            row format. The prefix length limit is 3072 bytes for
            <code class="literal">InnoDB</code> tables that use the
            <code class="literal"><a class="link" href="glossary.html#glos_dynamic_row_format" title="dynamic row format">DYNAMIC</a></code>
            or
            <code class="literal"><a class="link" href="glossary.html#glos_compressed_row_format" title="compressed row format">COMPRESSED</a></code>
            row format. For <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> tables,
            the prefix length limit is 1000 bytes. The
            <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> storage engine does not
            support prefixes (see
            <a class="xref" href="mysql-cluster.html#mysql-cluster-limitations-unsupported" title="22.1.7.6 Unsupported or Missing Features in NDB Cluster">Section 22.1.7.6, “Unsupported or Missing Features in NDB Cluster”</a>).
</p></li></ul>
</div>
<p>
        If a specified index prefix exceeds the maximum column data type
        size, <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> handles the
        index as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For a nonunique index, either an error occurs (if strict SQL
            mode is enabled), or the index length is reduced to lie
            within the maximum column data type size and a warning is
            produced (if strict SQL mode is not enabled).
          </p></li><li class="listitem"><p>
            For a unique index, an error occurs regardless of SQL mode
            because reducing the index length might enable insertion of
            nonunique entries that do not meet the specified uniqueness
            requirement.
</p></li></ul>
</div>
<p>
        The statement shown here creates an index using the first 10
        characters of the <code class="literal">name</code> column (assuming that
        <code class="literal">name</code> has a nonbinary string type):
      </p><pre data-lang="sql" class="programlisting">
CREATE INDEX part_of_name ON customer (name(10));
</pre><p>
        If names in the column usually differ in the first 10
        characters, lookups performed using this index should not be
        much slower than using an index created from the entire
        <code class="literal">name</code> column. Also, using column prefixes for
        indexes can make the index file much smaller, which could save a
        lot of disk space and might also speed up
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> operations.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="create-index-functional-key-parts"></a>Functional Key Parts</h4>

</div>

</div>

</div>
<p>
        A <span class="quote">“<span class="quote">normal</span>”</span> index indexes column values or prefixes
        of column values. For example, in the following table, the index
        entry for a given <code class="literal">t1</code> row includes the full
        <code class="literal">col1</code> value and a prefix of the
        <code class="literal">col2</code> value consisting of its first 10
        characters:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (
  col1 VARCHAR(10),
  col2 VARCHAR(20),
  INDEX (col1, col2(10))
);
</pre><p>
        MySQL 8.0.13 and higher supports functional key parts that index
        expression values rather than column or column prefix values.
        Use of functional key parts enables indexing of values not
        stored directly in the table. Examples:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (col1 INT, col2 INT, INDEX func_index ((ABS(col1))));
CREATE INDEX idx1 ON t1 ((col1 + col2));
CREATE INDEX idx2 ON t1 ((col1 + col2), (col1 - col2), col1);
ALTER TABLE t1 ADD INDEX ((col1 * 40) DESC);
</pre><p>
        An index with multiple key parts can mix nonfunctional and
        functional key parts.
      </p><p>
        <code class="literal">ASC</code> and <code class="literal">DESC</code> are supported
        for functional key parts.
      </p><p>
        Functional key parts must adhere to the following rules. An
        error occurs if a key part definition contains disallowed
        constructs.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            In index definitions, enclose expressions within parentheses
            to distinguish them from columns or column prefixes. For
            example, this is permitted; the expressions are enclosed
            within parentheses:
          </p><pre data-lang="sql" class="programlisting">
INDEX ((col1 + col2), (col3 - col4))
</pre><p>
            This produces an error; the expressions are not enclosed
            within parentheses:
          </p><pre data-lang="sql" class="programlisting">
INDEX (col1 + col2, col3 - col4)
</pre></li><li class="listitem"><p>
            A functional key part cannot consist solely of a column
            name. For example, this is not permitted:
          </p><pre data-lang="simple" class="programlisting">
INDEX ((col1), (col2))
</pre><p>
            Instead, write the key parts as nonfunctional key parts,
            without parentheses:
          </p><pre data-lang="simple" class="programlisting">
INDEX (col1, col2)
</pre></li><li class="listitem"><p>
            A functional key part expression cannot refer to column
            prefixes. For a workaround, see the discussion of
            <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a> and
            <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> later in this section.
          </p></li><li class="listitem"><p>
            Functional key parts are not permitted in foreign key
            specifications.
</p></li></ul>
</div>
<p>
        For <a class="link" href="sql-syntax.html#create-table-like" title="13.1.20.4 CREATE TABLE ... LIKE Syntax"><code class="literal">CREATE
        TABLE ... LIKE</code></a>, the destination table preserves
        functional key parts from the original table.
      </p><p>
        Functional indexes are implemented as hidden virtual generated
        columns, which has these implications:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Each functional key part counts against the limit on total
            number of table columns; see
            <a class="xref" href="restrictions.html#column-count-limit" title="C.10.4 Limits on Table Column Count and Row Size">Section C.10.4, “Limits on Table Column Count and Row Size”</a>.
          </p></li><li class="listitem"><p>
            Functional key parts inherit all restrictions that apply to
            generated columns. Examples:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                Only functions permitted for generated columns are
                permitted for functional key parts.
              </p></li><li class="listitem"><p>
                Subqueries, parameters, variables, stored functions, and
                user-defined functions are not permitted.
</p></li></ul>
</div>
<p>
            For more information about applicable restrictions, see
            <a class="xref" href="sql-syntax.html#create-table-generated-columns" title="13.1.20.9 CREATE TABLE and Generated Columns">Section 13.1.20.9, “CREATE TABLE and Generated Columns”</a>, and
            <a class="xref" href="sql-syntax.html#alter-table-generated-columns" title="13.1.9.2 ALTER TABLE and Generated Columns">Section 13.1.9.2, “ALTER TABLE and Generated Columns”</a>.
          </p></li><li class="listitem"><p>
            The virtual generated column itself requires no storage. The
            index itself takes up storage space as any other index.
</p></li></ul>
</div>
<p>
        <code class="literal">UNIQUE</code> is supported for indexes that include
        functional key parts. However, primary keys cannot include
        functional key parts. A primary key requires the generated
        column to be stored, but functional key parts are implemented as
        virtual generated columns, not stored generated columns.
      </p><p>
        <code class="literal">SPATIAL</code> and <code class="literal">FULLTEXT</code>
        indexes cannot have functional key parts.
      </p><p>
        If a table contains no primary key, <code class="literal">InnoDB</code>
        automatically promotes the first <code class="literal">UNIQUE NOT
        NULL</code> index to the primary key. This is not supported
        for <code class="literal">UNIQUE NOT NULL</code> indexes that have
        functional key parts.
      </p><p>
        Nonfunctional indexes raise a warning if there are duplicate
        indexes. Indexes that contain functional key parts do not have
        this feature.
      </p><p>
        To remove a column that is referenced by a functional key part,
        the index must be removed first. Otherwise, an error occurs.
      </p><p>
        Although nonfunctional key parts support a prefix length
        specification, this is not possible for functional key parts.
        The solution is to use
        <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a> (or
        <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a>, as described later in
        this section). For a functional key part containing the
        <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a> function to be used
        in a query, the <code class="literal">WHERE</code> clause must contain
        <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a> with the same
        arguments. In the following example, only the second
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> is able to use the index
        because that is the only query in which the arguments to
        <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a> match the index
        specification:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE tbl (
  col1 LONGTEXT,
  INDEX idx1 ((SUBSTRING(col1, 1, 10)))
);
SELECT * FROM tbl WHERE SUBSTRING(col1, 1, 9) = '123456789';
SELECT * FROM tbl WHERE SUBSTRING(col1, 1, 10) = '1234567890';
</pre><p>
        Functional key parts enable indexing of values that cannot be
        indexed otherwise, such as <a class="link" href="data-types.html#json" title="11.6 The JSON Data Type"><code class="literal">JSON</code></a>
        values. However, this must be done correctly to achieve the
        desired effect. For example, this syntax does not work:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE employees (
  data JSON,
  INDEX ((data-&gt;&gt;'$.name'))
);
</pre><p>
        The syntax fails because:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The
            <a class="link" href="functions.html#operator_json-inline-path"><code class="literal">-&gt;&gt;</code></a>
            operator translates into
            <a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE(JSON_EXTRACT(...))</code></a>.
          </p></li><li class="listitem"><p>
            <a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE()</code></a> returns a
            value with a data type of
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">LONGTEXT</code></a>, and the hidden
            generated column thus is assigned the same data type.
          </p></li><li class="listitem"><p>
            MySQL cannot index <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">LONGTEXT</code></a>
            columns specified without a prefix length on the key part,
            and prefix lengths are not permitted in functional key
            parts.
</p></li></ul>
</div>
<p>
        To index the <code class="literal">JSON</code> column, you could try using
        the <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> function as follows:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE employees (
  data JSON,
  INDEX ((CAST(data-&gt;&gt;'$.name' AS CHAR(30))))
);
</pre><p>
        The hidden generated column is assigned the
        <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR(30)</code></a> data type, which can
        be indexed. But this approach produces a new issue when trying
        to use the index:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> returns a string with
            the collation <code class="literal">utf8mb4_0900_ai_ci</code> (the
            server default collation).
          </p></li><li class="listitem"><p>
            <a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE()</code></a> returns a
            string with the collation <code class="literal">utf8mb4_bin</code>
            (hard coded).
</p></li></ul>
</div>
<p>
        As a result, there is a collation mismatch between the indexed
        expression in the preceding table definition and the
        <code class="literal">WHERE</code> clause expression in the following
        query:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM employees WHERE data-&gt;&gt;'$.name' = 'James';
</pre><p>
        The index is not used because the expressions in the query and
        the index differ. To support this kind of scenario for
        functional key parts, the optimizer automatically strips
        <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> when looking for an index
        to use, but <span class="emphasis"><em>only</em></span> if the collation of the
        indexed expression matches that of the query expression. For an
        index with a functional key part to be used, either of the
        following two solutions work (although they differ somewhat in
        effect):
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Solution 1. Assign the indexed expression the same collation
            as <a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE()</code></a>:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE employees (
  data JSON,
  INDEX idx ((CAST(data-&gt;&gt;"$.name" AS CHAR(30)) COLLATE utf8mb4_bin))
);
INSERT INTO employees VALUES
  ('{ "name": "james", "salary": 9000 }'),
  ('{ "name": "James", "salary": 10000 }'),
  ('{ "name": "Mary", "salary": 12000 }'),
  ('{ "name": "Peter", "salary": 8000 }');
SELECT * FROM employees WHERE data-&gt;&gt;'$.name' = 'James';
</pre><p>
            The <code class="literal">-&gt;&gt;</code> operator is the same as
            <code class="literal">JSON_UNQUOTE(JSON_EXTRACT(...))</code>, and
            <code class="literal">JSON_UNQUOTE()</code> returns a string with
            collation <code class="literal">utf8mb4_bin</code>. The comparison is
            thus case sensitive, and only one row matches:
          </p><pre data-lang="sql" class="programlisting">
+------------------------------------+
| data                               |
+------------------------------------+
| {"name": "James", "salary": 10000} |
+------------------------------------+
</pre></li><li class="listitem"><p>
            Solution 2. Specify the full expression in the query:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE employees (
  data JSON,
  INDEX idx ((CAST(data-&gt;&gt;"$.name" AS CHAR(30))))
);
INSERT INTO employees VALUES
  ('{ "name": "james", "salary": 9000 }'),
  ('{ "name": "James", "salary": 10000 }'),
  ('{ "name": "Mary", "salary": 12000 }'),
  ('{ "name": "Peter", "salary": 8000 }');
SELECT * FROM employees WHERE CAST(data-&gt;&gt;'$.name' AS CHAR(30)) = 'James';
</pre><p>
            <code class="literal">CAST()</code> returns a string with collation
            <code class="literal">utf8mb4_0900_ai_ci</code>, so the comparison
            case insensitive and two rows match:
          </p><pre data-lang="sql" class="programlisting">
+------------------------------------+
| data                               |
+------------------------------------+
| {"name": "james", "salary": 9000}  |
| {"name": "James", "salary": 10000} |
+------------------------------------+
</pre></li></ul>
</div>
<p>
        Be aware that although the optimizer supports automatically
        stripping <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> with indexed
        generated columns, the following approach does not work because
        it produces a different result with and without an index
        (Bug#27337092):
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE employees (</code></strong>
         <strong class="userinput"><code>data JSON,</code></strong>
         <strong class="userinput"><code>generated_col VARCHAR(30) AS (CAST(data-&gt;&gt;'$.name' AS CHAR(30)))</code></strong>
       <strong class="userinput"><code>);</code></strong>
Query OK, 0 rows affected, 1 warning (0.03 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO employees (data)</code></strong>
       <strong class="userinput"><code>VALUES ('{"name": "james"}'), ('{"name": "James"}');</code></strong>
Query OK, 2 rows affected, 1 warning (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 1

mysql&gt; <strong class="userinput"><code>SELECT * FROM employees WHERE data-&gt;&gt;'$.name' = 'James';</code></strong>
+-------------------+---------------+
| data              | generated_col |
+-------------------+---------------+
| {"name": "James"} | James         |
+-------------------+---------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>ALTER TABLE employees ADD INDEX idx (generated_col);</code></strong>
Query OK, 0 rows affected, 1 warning (0.03 sec)
Records: 0  Duplicates: 0  Warnings: 1

mysql&gt; <strong class="userinput"><code>SELECT * FROM employees WHERE data-&gt;&gt;'$.name' = 'James';</code></strong>
+-------------------+---------------+
| data              | generated_col |
+-------------------+---------------+
| {"name": "james"} | james         |
| {"name": "James"} | James         |
+-------------------+---------------+
2 rows in set (0.01 sec)
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="create-index-unique"></a>Unique Indexes</h4>

</div>

</div>

</div>
<p>
        A <code class="literal">UNIQUE</code> index creates a constraint such that
        all values in the index must be distinct. An error occurs if you
        try to add a new row with a key value that matches an existing
        row. If you specify a prefix value for a column in a
        <code class="literal">UNIQUE</code> index, the column values must be
        unique within the prefix length. A <code class="literal">UNIQUE</code>
        index permits multiple <code class="literal">NULL</code> values for
        columns that can contain <code class="literal">NULL</code>.
      </p><a class="indexterm" name="idm140091670982416"></a><p>
        If a table has a <code class="literal">PRIMARY KEY</code> or
        <code class="literal">UNIQUE NOT NULL</code> index that consists of a
        single column that has an integer type, you can use
        <code class="literal">_rowid</code> to refer to the indexed column in
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements, as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">_rowid</code> refers to the <code class="literal">PRIMARY
            KEY</code> column if there is a <code class="literal">PRIMARY
            KEY</code> consisting of a single integer column. If
            there is a <code class="literal">PRIMARY KEY</code> but it does not
            consist of a single integer column,
            <code class="literal">_rowid</code> cannot be used.
          </p></li><li class="listitem"><p>
            Otherwise, <code class="literal">_rowid</code> refers to the column in
            the first <code class="literal">UNIQUE NOT NULL</code> index if that
            index consists of a single integer column. If the first
            <code class="literal">UNIQUE NOT NULL</code> index does not consist of
            a single integer column, <code class="literal">_rowid</code> cannot be
            used.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="create-index-fulltext"></a>Full-Text Indexes</h4>

</div>

</div>

</div>
<p>
        <code class="literal">FULLTEXT</code> indexes are supported only for
        <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
        <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> tables and can include only
        <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
        <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, and
        <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns. Indexing always
        happens over the entire column; column prefix indexing is not
        supported and any prefix length is ignored if specified. See
        <a class="xref" href="functions.html#fulltext-search" title="12.9 Full-Text Search Functions">Section 12.9, “Full-Text Search Functions”</a>, for details of operation.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="create-index-spatial"></a>Spatial Indexes</h4>

</div>

</div>

</div>
<p>
        The <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>,
        <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>,
        <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a>, and
        <a class="link" href="storage-engines.html#archive-storage-engine" title="16.5 The ARCHIVE Storage Engine"><code class="literal">ARCHIVE</code></a> storage engines support
        spatial columns such as <a class="link" href="data-types.html#spatial-type-overview" title="11.5.1 Spatial Data Types"><code class="literal">POINT</code></a> and
        <a class="link" href="data-types.html#spatial-type-overview" title="11.5.1 Spatial Data Types"><code class="literal">GEOMETRY</code></a>.
        (<a class="xref" href="data-types.html#spatial-types" title="11.5 Spatial Data Types">Section 11.5, “Spatial Data Types”</a>, describes the spatial data
        types.) However, support for spatial column indexing varies
        among engines. Spatial and nonspatial indexes on spatial columns
        are available according to the following rules.
      </p><p>
        Spatial indexes on spatial columns have these characteristics:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Available only for <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
            <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> tables. Specifying
            <code class="literal">SPATIAL INDEX</code> for other storage engines
            results in an error.
          </p></li><li class="listitem"><p>
            As of MySQL 8.0.12, an index on a spatial column
            <span class="emphasis"><em>must</em></span> be a <code class="literal">SPATIAL</code>
            index. The <code class="literal">SPATIAL</code> keyword is thus
            optional but implicit for creating an index on a spatial
            column.
          </p></li><li class="listitem"><p>
            Available for single spatial columns only. A spatial index
            cannot be created over multiple spatial columns.
          </p></li><li class="listitem"><p>
            Indexed columns must be <code class="literal">NOT NULL</code>.
          </p></li><li class="listitem"><p>
            Column prefix lengths are prohibited. The full width of each
            column is indexed.
          </p></li><li class="listitem"><p>
            Not permitted for a primary key or unique index.
</p></li></ul>
</div>
<p>
        Nonspatial indexes on spatial columns (created with
        <code class="literal">INDEX</code>, <code class="literal">UNIQUE</code>, or
        <code class="literal">PRIMARY KEY</code>) have these characteristics:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Permitted for any storage engine that supports spatial
            columns except <a class="link" href="storage-engines.html#archive-storage-engine" title="16.5 The ARCHIVE Storage Engine"><code class="literal">ARCHIVE</code></a>.
          </p></li><li class="listitem"><p>
            Columns can be <code class="literal">NULL</code> unless the index is a
            primary key.
          </p></li><li class="listitem"><p>
            The index type for a non-<code class="literal">SPATIAL</code> index
            depends on the storage engine. Currently, B-tree is used.
          </p></li><li class="listitem"><p>
            Permitted for a column that can have <code class="literal">NULL</code>
            values only for <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>,
            <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>, and
            <a class="link" href="storage-engines.html#memory-storage-engine" title="16.3 The MEMORY Storage Engine"><code class="literal">MEMORY</code></a> tables.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="create-index-options"></a>Index Options</h4>

</div>

</div>

</div>
<p>
        Following the key part list, index options can be given. An
        <em class="replaceable"><code>index_option</code></em> value can be any of the
        following:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">KEY_BLOCK_SIZE [=]
            <em class="replaceable"><code>value</code></em></code>
          </p><p>
            For <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> tables,
            <code class="literal">KEY_BLOCK_SIZE</code> optionally specifies the
            size in bytes to use for index key blocks. The value is
            treated as a hint; a different size could be used if
            necessary. A <code class="literal">KEY_BLOCK_SIZE</code> value
            specified for an individual index definition overrides a
            table-level <code class="literal">KEY_BLOCK_SIZE</code> value.
          </p><p>
            <code class="literal">KEY_BLOCK_SIZE</code> is not supported at the
            index level for <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables.
            See <a class="xref" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax">Section 13.1.20, “CREATE TABLE Syntax”</a>.
          </p></li><li class="listitem"><p>
            <em class="replaceable"><code>index_type</code></em>
          </p><p>
            Some storage engines permit you to specify an index type
            when creating an index. For example:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE lookup (id INT) ENGINE = MEMORY;
CREATE INDEX id_index ON lookup (id) USING BTREE;
</pre><p>
            <a class="xref" href="sql-syntax.html#create-index-storage-engine-index-types" title="Table 13.1 Index Types Per Storage Engine">Table 13.1, “Index Types Per Storage Engine”</a>
            shows the permissible index type values supported by
            different storage engines. Where multiple index types are
            listed, the first one is the default when no index type
            specifier is given. Storage engines not listed in the table
            do not support an <em class="replaceable"><code>index_type</code></em>
            clause in index definitions.
</p>
<div class="table">
<a name="create-index-storage-engine-index-types"></a><p class="title"><b>Table 13.1 Index Types Per Storage Engine</b></p>
<div class="table-contents">
<table summary="Permissible index types by storage engine."><col width="20%"><col width="50%"><thead><tr>
                <th scope="col">Storage Engine</th>
                <th scope="col">Permissible Index Types</th>
              </tr></thead><tbody><tr>
                <td scope="row"><a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a></td>
                <td><code class="literal">BTREE</code></td>
              </tr><tr>
                <td scope="row"><a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a></td>
                <td><code class="literal">BTREE</code></td>
              </tr><tr>
                <td scope="row"><a class="link" href="storage-engines.html#memory-storage-engine" title="16.3 The MEMORY Storage Engine"><code class="literal">MEMORY</code></a>/<code class="literal">HEAP</code></td>
                <td><code class="literal">HASH</code>, <code class="literal">BTREE</code></td>
              </tr><tr>
                <td scope="row"><a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a></td>
                <td><code class="literal">HASH</code>, <code class="literal">BTREE</code> (see note in text)</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
            The <em class="replaceable"><code>index_type</code></em> clause cannot be
            used for <code class="literal">FULLTEXT INDEX</code> or (prior to
            MySQL 8.0.12) <code class="literal">SPATIAL INDEX</code>
            specifications. Full-text index implementation is storage
            engine dependent. Spatial indexes are implemented as R-tree
            indexes.
          </p><p>
            If you specify an index type that is not valid for a given
            storage engine, but another index type is available that the
            engine can use without affecting query results, the engine
            uses the available type. The parser recognizes
            <code class="literal">RTREE</code> as a type name. As of MySQL 8.0.12,
            this is permitted only for <code class="literal">SPATIAL</code>
            indexes. Prior to 8.0.12, <code class="literal">RTREE</code> cannot be
            specified for any storage engine.
          </p><p>
            <code class="literal">BTREE</code> indexes are implemented by the
            <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> storage engine as T-tree
            indexes.
</p><a class="indexterm" name="idm140091670875968"></a><a class="indexterm" name="idm140091670874480"></a>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              For indexes on <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> table
              columns, the <code class="literal">USING</code> option can be
              specified only for a unique index or primary key.
              <code class="literal">USING HASH</code> prevents the creation of an
              ordered index; otherwise, creating a unique index or
              primary key on an <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> table
              automatically results in the creation of both an ordered
              index and a hash index, each of which indexes the same set
              of columns.
            </p><p>
              For unique indexes that include one or more
              <code class="literal">NULL</code> columns of an
              <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> table, the hash index can
              be used only to look up literal values, which means that
              <code class="literal">IS [NOT] NULL</code> conditions require a full
              scan of the table. One workaround is to make sure that a
              unique index using one or more <code class="literal">NULL</code>
              columns on such a table is always created in such a way
              that it includes the ordered index; that is, avoid
              employing <code class="literal">USING HASH</code> when creating the
              index.
</p>
</div>
<p>
            If you specify an index type that is not valid for a given
            storage engine, but another index type is available that the
            engine can use without affecting query results, the engine
            uses the available type. The parser recognizes
            <code class="literal">RTREE</code> as a type name, but currently this
            cannot be specified for any storage engine.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Use of the <em class="replaceable"><code>index_type</code></em> option
              before the <code class="literal">ON
              <em class="replaceable"><code>tbl_name</code></em></code> clause is
              deprecated; support for use of the option in this position
              will be removed in a future MySQL release. If an
              <em class="replaceable"><code>index_type</code></em> option is given in
              both the earlier and later positions, the final option
              applies.
</p>
</div>
<p>
            <code class="literal">TYPE <em class="replaceable"><code>type_name</code></em></code>
            is recognized as a synonym for <code class="literal">USING
            <em class="replaceable"><code>type_name</code></em></code>. However,
            <code class="literal">USING</code> is the preferred form.
          </p><p>
            The following tables show index characteristics for the
            storage engines that support the
            <em class="replaceable"><code>index_type</code></em> option.
</p>
<div class="table">
<a name="innodb-storage-engine-index-characteristics"></a><p class="title"><b>Table 13.2 InnoDB Storage Engine Index Characteristics</b></p>
<div class="table-contents">
<table summary="Index characteristics of the InnoDB storage engine."><col width="15%"><col width="10%"><col width="15%"><col width="20%"><col width="20%"><col width="20%"><thead><tr>
                <th scope="col">Index Class</th>
                <th scope="col">Index Type</th>
                <th scope="col">Stores NULL VALUES</th>
                <th scope="col">Permits Multiple NULL Values</th>
                <th scope="col">IS NULL Scan Type</th>
                <th scope="col">IS NOT NULL Scan Type</th>
              </tr></thead><tbody><tr>
                <td scope="row">Primary key</td>
                <td><code class="literal">BTREE</code></td>
                <td>No</td>
                <td>No</td>
                <td>N/A</td>
                <td>N/A</td>
              </tr><tr>
                <td scope="row">Unique</td>
                <td><code class="literal">BTREE</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Index</td>
                <td>Index</td>
              </tr><tr>
                <td scope="row">Key</td>
                <td><code class="literal">BTREE</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Index</td>
                <td>Index</td>
              </tr><tr>
                <td scope="row"><code class="literal">FULLTEXT</code></td>
                <td>N/A</td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Table</td>
                <td>Table</td>
              </tr><tr>
                <td scope="row"><code class="literal">SPATIAL</code></td>
                <td>N/A</td>
                <td>No</td>
                <td>No</td>
                <td>N/A</td>
                <td>N/A</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="table">
<a name="myisam-storage-engine-index-characteristics"></a><p class="title"><b>Table 13.3 MyISAM Storage Engine Index Characteristics</b></p>
<div class="table-contents">
<table summary="Index characteristics of the MyISAM storage engine."><col width="15%"><col width="10%"><col width="15%"><col width="20%"><col width="20%"><col width="20%"><thead><tr>
                <th scope="col">Index Class</th>
                <th scope="col">Index Type</th>
                <th scope="col">Stores NULL VALUES</th>
                <th scope="col">Permits Multiple NULL Values</th>
                <th scope="col">IS NULL Scan Type</th>
                <th scope="col">IS NOT NULL Scan Type</th>
              </tr></thead><tbody><tr>
                <td scope="row">Primary key</td>
                <td><code class="literal">BTREE</code></td>
                <td>No</td>
                <td>No</td>
                <td>N/A</td>
                <td>N/A</td>
              </tr><tr>
                <td scope="row">Unique</td>
                <td><code class="literal">BTREE</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Index</td>
                <td>Index</td>
              </tr><tr>
                <td scope="row">Key</td>
                <td><code class="literal">BTREE</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Index</td>
                <td>Index</td>
              </tr><tr>
                <td scope="row"><code class="literal">FULLTEXT</code></td>
                <td>N/A</td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Table</td>
                <td>Table</td>
              </tr><tr>
                <td scope="row"><code class="literal">SPATIAL</code></td>
                <td>N/A</td>
                <td>No</td>
                <td>No</td>
                <td>N/A</td>
                <td>N/A</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="table">
<a name="memory-storage-engine-index-characteristics"></a><p class="title"><b>Table 13.4 MEMORY Storage Engine Index Characteristics</b></p>
<div class="table-contents">
<table summary="Index characteristics of the Memory storage engine."><col width="15%"><col width="10%"><col width="15%"><col width="20%"><col width="20%"><col width="20%"><thead><tr>
                <th scope="col">Index Class</th>
                <th scope="col">Index Type</th>
                <th scope="col">Stores NULL VALUES</th>
                <th scope="col">Permits Multiple NULL Values</th>
                <th scope="col">IS NULL Scan Type</th>
                <th scope="col">IS NOT NULL Scan Type</th>
              </tr></thead><tbody><tr>
                <td scope="row">Primary key</td>
                <td><code class="literal">BTREE</code></td>
                <td>No</td>
                <td>No</td>
                <td>N/A</td>
                <td>N/A</td>
              </tr><tr>
                <td scope="row">Unique</td>
                <td><code class="literal">BTREE</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Index</td>
                <td>Index</td>
              </tr><tr>
                <td scope="row">Key</td>
                <td><code class="literal">BTREE</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Index</td>
                <td>Index</td>
              </tr><tr>
                <td scope="row">Primary key</td>
                <td><code class="literal">HASH</code></td>
                <td>No</td>
                <td>No</td>
                <td>N/A</td>
                <td>N/A</td>
              </tr><tr>
                <td scope="row">Unique</td>
                <td><code class="literal">HASH</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Index</td>
                <td>Index</td>
              </tr><tr>
                <td scope="row">Key</td>
                <td><code class="literal">HASH</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Index</td>
                <td>Index</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="table">
<a name="ndb-storage-engine-index-characteristics"></a><p class="title"><b>Table 13.5 NDB Storage Engine Index Characteristics</b></p>
<div class="table-contents">
<table summary="Index characteristics of the NDB storage engine."><col width="15%"><col width="10%"><col width="15%"><col width="20%"><col width="20%"><col width="20%"><thead><tr>
                <th scope="col">Index Class</th>
                <th scope="col">Index Type</th>
                <th scope="col">Stores NULL VALUES</th>
                <th scope="col">Permits Multiple NULL Values</th>
                <th scope="col">IS NULL Scan Type</th>
                <th scope="col">IS NOT NULL Scan Type</th>
              </tr></thead><tbody><tr>
                <td scope="row">Primary key</td>
                <td><code class="literal">BTREE</code></td>
                <td>No</td>
                <td>No</td>
                <td>Index</td>
                <td>Index</td>
              </tr><tr>
                <td scope="row">Unique</td>
                <td><code class="literal">BTREE</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Index</td>
                <td>Index</td>
              </tr><tr>
                <td scope="row">Key</td>
                <td><code class="literal">BTREE</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Index</td>
                <td>Index</td>
              </tr><tr>
                <td scope="row">Primary key</td>
                <td><code class="literal">HASH</code></td>
                <td>No</td>
                <td>No</td>
                <td>Table (see note 1)</td>
                <td>Table (see note 1)</td>
              </tr><tr>
                <td scope="row">Unique</td>
                <td><code class="literal">HASH</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Table (see note 1)</td>
                <td>Table (see note 1)</td>
              </tr><tr>
                <td scope="row">Key</td>
                <td><code class="literal">HASH</code></td>
                <td>Yes</td>
                <td>Yes</td>
                <td>Table (see note 1)</td>
                <td>Table (see note 1)</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
            Table note:
          </p><p>
            1. <code class="literal">USING HASH</code> prevents creation of an
            implicit ordered index.
          </p></li><li class="listitem"><p>
            <code class="literal">WITH PARSER
            <em class="replaceable"><code>parser_name</code></em></code>
          </p><p>
            This option can be used only with
            <code class="literal">FULLTEXT</code> indexes. It associates a parser
            plugin with the index if full-text indexing and searching
            operations need special handling.
            <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
            <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> support full-text parser
            plugins. See <a class="xref" href="extending-mysql.html#full-text-plugin-type" title="Full-Text Parser Plugins">Full-Text Parser Plugins</a> and
            <a class="xref" href="extending-mysql.html#writing-full-text-plugins" title="29.2.4.4 Writing Full-Text Parser Plugins">Section 29.2.4.4, “Writing Full-Text Parser Plugins”</a> for more
            information.
          </p></li><li class="listitem"><p>
            <code class="literal">COMMENT
            '<em class="replaceable"><code>string</code></em>'</code>
          </p><p>
            Index definitions can include an optional comment of up to
            1024 characters.
          </p><p>
            The
            <a class="link" href="innodb-storage-engine.html#index-page-merge-threshold" title="15.8.11 Configuring the Merge Threshold for Index Pages"><code class="literal">MERGE_THRESHOLD</code></a>
            for index pages can be configured for individual indexes
            using the <em class="replaceable"><code>index_option</code></em>
            <code class="literal">COMMENT</code> clause of the
            <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> statement. For
            example:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (id INT);
CREATE INDEX id_index ON t1 (id) COMMENT 'MERGE_THRESHOLD=40';
</pre><p>
            If the page-full percentage for an index page falls below
            the <code class="literal">MERGE_THRESHOLD</code> value when a row is
            deleted or when a row is shortened by an update operation,
            <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> attempts to merge the
            index page with a neighboring index page. The default
            <code class="literal">MERGE_THRESHOLD</code> value is 50, which is the
            previously hardcoded value.
          </p><p>
            <code class="literal">MERGE_THRESHOLD</code> can also be defined at
            the index level and table level using
            <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> and
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statements. For
            more information, see
            <a class="xref" href="innodb-storage-engine.html#index-page-merge-threshold" title="15.8.11 Configuring the Merge Threshold for Index Pages">Section 15.8.11, “Configuring the Merge Threshold for Index Pages”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">VISIBLE</code>, <code class="literal">INVISIBLE</code>
          </p><p>
            Specify index visibility. Indexes are visible by default. An
            invisible index is not used by the optimizer. Specification
            of index visibility applies to indexes other than primary
            keys (either explicit or implicit). For more information,
            see <a class="xref" href="optimization.html#invisible-indexes" title="8.3.12 Invisible Indexes">Section 8.3.12, “Invisible Indexes”</a>.
</p><a class="indexterm" name="idm140091670630512"></a></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="create-index-copying"></a>Table Copying and Locking Options</h4>

</div>

</div>

</div>
<p>
        <code class="literal">ALGORITHM</code> and <code class="literal">LOCK</code> clauses
        may be given to influence the table copying method and level of
        concurrency for reading and writing the table while its indexes
        are being modified. They have the same meaning as for the
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement. For more
        information, see <a class="xref" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax">Section 13.1.9, “ALTER TABLE Syntax”</a>
      </p><p>
        NDB Cluster supports online operations using the same
        <code class="literal">ALGORITHM=INPLACE</code> syntax used with the
        standard MySQL Server. See
        <a class="xref" href="mysql-cluster.html#mysql-cluster-online-operations" title="22.5.14 Online Operations with ALTER TABLE in NDB Cluster">Section 22.5.14, “Online Operations with ALTER TABLE in NDB Cluster”</a>, for more
        information.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-logfile-group"></a>13.1.16 CREATE LOGFILE GROUP Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091670620640"></a><pre data-lang="sql" class="programlisting">
CREATE LOGFILE GROUP <em class="replaceable"><code>logfile_group</code></em>
    ADD UNDOFILE '<em class="replaceable"><code>undo_file</code></em>'
    [INITIAL_SIZE [=] <em class="replaceable"><code>initial_size</code></em>]
    [UNDO_BUFFER_SIZE [=] <em class="replaceable"><code>undo_buffer_size</code></em>]
    [REDO_BUFFER_SIZE [=] <em class="replaceable"><code>redo_buffer_size</code></em>]
    [NODEGROUP [=] <em class="replaceable"><code>nodegroup_id</code></em>]
    [WAIT]
    [COMMENT [=] '<em class="replaceable"><code>string</code></em>']
    ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
</pre><p>
      This statement creates a new log file group named
      <em class="replaceable"><code>logfile_group</code></em> having a single
      <code class="literal">UNDO</code> file named
      '<em class="replaceable"><code>undo_file</code></em>'. A
      <a class="link" href="sql-syntax.html#create-logfile-group" title="13.1.16 CREATE LOGFILE GROUP Syntax"><code class="literal">CREATE LOGFILE GROUP</code></a> statement has
      one and only one <code class="literal">ADD UNDOFILE</code> clause. For rules
      covering the naming of log file groups, see
      <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        All NDB Cluster Disk Data objects share the same namespace. This
        means that <span class="emphasis"><em>each Disk Data object</em></span> must be
        uniquely named (and not merely each Disk Data object of a given
        type). For example, you cannot have a tablespace and a log file
        group with the same name, or a tablespace and a data file with
        the same name.
</p>
</div>
<p>
      There can be only one log file group per NDB Cluster instance at
      any given time.
    </p><p>
      The optional <code class="literal">INITIAL_SIZE</code> parameter sets the
      <code class="literal">UNDO</code> file's initial size; if not specified, it
      defaults to <code class="literal">128M</code> (128 megabytes). The optional
      <code class="literal">UNDO_BUFFER_SIZE</code> parameter sets the size used
      by the <code class="literal">UNDO</code> buffer for the log file group; The
      default value for <code class="literal">UNDO_BUFFER_SIZE</code> is
      <code class="literal">8M</code> (eight megabytes); this value cannot exceed
      the amount of system memory available. Both of these parameters
      are specified in bytes. You may optionally follow either or both
      of these with a one-letter abbreviation for an order of magnitude,
      similar to those used in <code class="filename">my.cnf</code>. Generally,
      this is one of the letters <code class="literal">M</code> (for megabytes)
      or <code class="literal">G</code> (for gigabytes).
    </p><p>
      Memory used for <code class="literal">UNDO_BUFFER_SIZE</code> comes from the
      global pool whose size is determined by the value of the
      <a class="link" href="mysql-cluster.html#ndbparam-ndbd-sharedglobalmemory"><code class="literal">SharedGlobalMemory</code></a> data
      node configuration parameter. This includes any default value
      implied for this option by the setting of the
      <a class="link" href="mysql-cluster.html#ndbparam-ndbd-initiallogfilegroup"><code class="literal">InitialLogFileGroup</code></a> data
      node configuration parameter.
    </p><p>
      The maximum permitted for <code class="literal">UNDO_BUFFER_SIZE</code> is
      629145600 (600 MB).
    </p><p>
      On 32-bit systems, the maximum supported value for
      <code class="literal">INITIAL_SIZE</code> is 4294967296 (4 GB). (Bug #29186)
    </p><p>
      The minimum allowed value for <code class="literal">INITIAL_SIZE</code> is
      1048576 (1 MB).
    </p><p>
      The <code class="literal">ENGINE</code> option determines the storage engine
      to be used by this log file group, with
      <em class="replaceable"><code>engine_name</code></em> being the name of the
      storage engine. In MySQL 8.0, this must be
      <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> (or
      <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDBCLUSTER</code></a>). If
      <code class="literal">ENGINE</code> is not set, MySQL tries to use the
      engine specified by the
      <a class="link" href="server-administration.html#sysvar_default_storage_engine"><code class="literal">default_storage_engine</code></a> server
      system variable (formerly
      <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_storage_engine" target="_top"><code class="literal">storage_engine</code></a>). In any case, if
      the engine is not specified as <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> or
      <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDBCLUSTER</code></a>, the <code class="literal">CREATE
      LOGFILE GROUP</code> statement appears to succeed but actually
      fails to create the log file group, as shown here:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE LOGFILE GROUP lg1</code></strong>
    -&gt;     <strong class="userinput"><code>ADD UNDOFILE 'undo.dat' INITIAL_SIZE = 10M;</code></strong>
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------------------------------------------------------------------------+
| Level | Code | Message                                                                                        |
+-------+------+------------------------------------------------------------------------------------------------+
| Error | 1478 | <span class="errortext">Table storage engine 'InnoDB' does not support the create option 'TABLESPACE or LOGFILE GROUP'</span> |
+-------+------+------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>DROP LOGFILE GROUP lg1 ENGINE = NDB;</code></strong>            
<span class="errortext">ERROR 1529 (HY000): Failed to drop LOGFILE GROUP</span>

mysql&gt; <strong class="userinput"><code>CREATE LOGFILE GROUP lg1</code></strong>
    -&gt;     <strong class="userinput"><code>ADD UNDOFILE 'undo.dat' INITIAL_SIZE = 10M</code></strong>
    -&gt;     <strong class="userinput"><code>ENGINE = NDB;</code></strong>
Query OK, 0 rows affected (2.97 sec)
</pre><p>
      The fact that the <code class="literal">CREATE LOGFILE GROUP</code>
      statement does not actually return an error when a
      non-<code class="literal">NDB</code> storage engine is named, but rather
      appears to succeed, is a known issue which we hope to address in a
      future release of NDB Cluster.
    </p><p>
      <em class="replaceable"><code>REDO_BUFFER_SIZE</code></em>,
      <code class="literal">NODEGROUP</code>, <code class="literal">WAIT</code>, and
      <code class="literal">COMMENT</code> are parsed but ignored, and so have no
      effect in MySQL 8.0. These options are intended for
      future expansion.
    </p><p>
      When used with <code class="literal">ENGINE [=] NDB</code>, a log file group
      and associated <code class="literal">UNDO</code> log file are created on
      each Cluster data node. You can verify that the
      <code class="literal">UNDO</code> files were created and obtain information
      about them by querying the
      <a class="link" href="information-schema.html#files-table" title="25.11 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> table. For
      example:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LOGFILE_GROUP_NAME, LOGFILE_GROUP_NUMBER, EXTRA</code></strong>
    -&gt; <strong class="userinput"><code>FROM INFORMATION_SCHEMA.FILES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE FILE_NAME = 'undo_10.dat';</code></strong>
+--------------------+----------------------+----------------+
| LOGFILE_GROUP_NAME | LOGFILE_GROUP_NUMBER | EXTRA          |
+--------------------+----------------------+----------------+
| lg_3               |                   11 | CLUSTER_NODE=3 |
| lg_3               |                   11 | CLUSTER_NODE=4 |
+--------------------+----------------------+----------------+
2 rows in set (0.06 sec)
</pre><p>
      <a class="link" href="sql-syntax.html#create-logfile-group" title="13.1.16 CREATE LOGFILE GROUP Syntax"><code class="literal">CREATE LOGFILE GROUP</code></a> is useful only
      with Disk Data storage for NDB Cluster. See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="22.5.13 NDB Cluster Disk Data Tables">Section 22.5.13, “NDB Cluster Disk Data Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-procedure"></a>13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091670554304"></a><a class="indexterm" name="idm140091670553264"></a><pre data-lang="sql" class="programlisting">
CREATE
    [DEFINER = <em class="replaceable"><code>user</code></em>]
    PROCEDURE <em class="replaceable"><code>sp_name</code></em> ([<em class="replaceable"><code>proc_parameter</code></em>[,...]])
    [<em class="replaceable"><code>characteristic</code></em> ...] <em class="replaceable"><code>routine_body</code></em>

CREATE
    [DEFINER = <em class="replaceable"><code>user</code></em>]
    FUNCTION <em class="replaceable"><code>sp_name</code></em> ([<em class="replaceable"><code>func_parameter</code></em>[,...]])
    RETURNS <em class="replaceable"><code>type</code></em>
    [<em class="replaceable"><code>characteristic</code></em> ...] <em class="replaceable"><code>routine_body</code></em>

<em class="replaceable"><code>proc_parameter</code></em>:
    [ IN | OUT | INOUT ] <em class="replaceable"><code>param_name</code></em> <em class="replaceable"><code>type</code></em>

<em class="replaceable"><code>func_parameter</code></em>:
    <em class="replaceable"><code>param_name</code></em> <em class="replaceable"><code>type</code></em>

<em class="replaceable"><code>type</code></em>:
    <em class="replaceable"><code>Any valid MySQL data type</code></em>

<em class="replaceable"><code>characteristic</code></em>:
    COMMENT '<em class="replaceable"><code>string</code></em>'
  | LANGUAGE SQL
  | [NOT] DETERMINISTIC
  | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  | SQL SECURITY { DEFINER | INVOKER }

<em class="replaceable"><code>routine_body</code></em>:
    <em class="replaceable"><code>Valid SQL routine statement</code></em>
</pre><p>
      These statements create stored routines. By default, a routine is
      associated with the default database. To associate the routine
      explicitly with a given database, specify the name as
      <em class="replaceable"><code>db_name.sp_name</code></em> when you create it.
    </p><p>
      The <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> statement is
      also used in MySQL to support UDFs (user-defined functions). See
      <a class="xref" href="extending-mysql.html#adding-functions" title="29.4 Adding New Functions to MySQL">Section 29.4, “Adding New Functions to MySQL”</a>. A UDF can be regarded as an
      external stored function. Stored functions share their namespace
      with UDFs. See <a class="xref" href="language-structure.html#function-resolution" title="9.2.4 Function Name Parsing and Resolution">Section 9.2.4, “Function Name Parsing and Resolution”</a>, for the
      rules describing how the server interprets references to different
      kinds of functions.
    </p><p>
      To invoke a stored procedure, use the
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statement (see
      <a class="xref" href="sql-syntax.html#call" title="13.2.1 CALL Syntax">Section 13.2.1, “CALL Syntax”</a>). To invoke a stored function, refer to it
      in an expression. The function returns a value during expression
      evaluation.
    </p><p>
      <a class="link" href="sql-syntax.html#create-procedure" title="13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax"><code class="literal">CREATE PROCEDURE</code></a> and
      <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> require the
      <a class="link" href="security.html#priv_create-routine"><code class="literal">CREATE ROUTINE</code></a> privilege. If the
      <code class="literal">DEFINER</code> clause is present, the privileges
      required depend on the <em class="replaceable"><code>user</code></em> value, as
      discussed in <a class="xref" href="stored-objects.html#stored-objects-security" title="24.6 Stored Object Access Control">Section 24.6, “Stored Object Access Control”</a>. If binary
      logging is enabled, <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a>
      might require the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege,
      as discussed in <a class="xref" href="stored-objects.html#stored-programs-logging" title="24.7 Stored Program Binary Logging">Section 24.7, “Stored Program Binary Logging”</a>.
    </p><p>
      By default, MySQL automatically grants the
      <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a> and
      <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a> privileges to the routine
      creator. This behavior can be changed by disabling the
      <a class="link" href="server-administration.html#sysvar_automatic_sp_privileges"><code class="literal">automatic_sp_privileges</code></a> system
      variable. See <a class="xref" href="stored-objects.html#stored-routines-privileges" title="24.2.2 Stored Routines and MySQL Privileges">Section 24.2.2, “Stored Routines and MySQL Privileges”</a>.
    </p><p>
      The <code class="literal">DEFINER</code> and <code class="literal">SQL SECURITY</code>
      clauses specify the security context to be used when checking
      access privileges at routine execution time, as described later in
      this section.
    </p><p>
      If the routine name is the same as the name of a built-in SQL
      function, a syntax error occurs unless you use a space between the
      name and the following parenthesis when defining the routine or
      invoking it later. For this reason, avoid using the names of
      existing SQL functions for your own stored routines.
    </p><p>
      The <a class="link" href="server-administration.html#sqlmode_ignore_space"><code class="literal">IGNORE_SPACE</code></a> SQL mode
      applies to built-in functions, not to stored routines. It is
      always permissible to have spaces after a stored routine name,
      regardless of whether
      <a class="link" href="server-administration.html#sqlmode_ignore_space"><code class="literal">IGNORE_SPACE</code></a> is enabled.
    </p><p>
      The parameter list enclosed within parentheses must always be
      present. If there are no parameters, an empty parameter list of
      <code class="literal">()</code> should be used. Parameter names are not case
      sensitive.
    </p><p>
      Each parameter is an <code class="literal">IN</code> parameter by default.
      To specify otherwise for a parameter, use the keyword
      <code class="literal">OUT</code> or <code class="literal">INOUT</code> before the
      parameter name.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Specifying a parameter as <code class="literal">IN</code>,
        <code class="literal">OUT</code>, or <code class="literal">INOUT</code> is valid
        only for a <code class="literal">PROCEDURE</code>. For a
        <code class="literal">FUNCTION</code>, parameters are always regarded as
        <code class="literal">IN</code> parameters.
</p>
</div>
<p>
      An <code class="literal">IN</code> parameter passes a value into a
      procedure. The procedure might modify the value, but the
      modification is not visible to the caller when the procedure
      returns. An <code class="literal">OUT</code> parameter passes a value from
      the procedure back to the caller. Its initial value is
      <code class="literal">NULL</code> within the procedure, and its value is
      visible to the caller when the procedure returns. An
      <code class="literal">INOUT</code> parameter is initialized by the caller,
      can be modified by the procedure, and any change made by the
      procedure is visible to the caller when the procedure returns.
    </p><p>
      For each <code class="literal">OUT</code> or <code class="literal">INOUT</code>
      parameter, pass a user-defined variable in the
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statement that invokes the
      procedure so that you can obtain its value when the procedure
      returns. If you are calling the procedure from within another
      stored procedure or function, you can also pass a routine
      parameter or local routine variable as an <code class="literal">OUT</code>
      or <code class="literal">INOUT</code> parameter. If you are calling the
      procedure from within a trigger, you can also pass
      <code class="literal">NEW.<em class="replaceable"><code>col_name</code></em></code> as an
      <code class="literal">OUT</code> or <code class="literal">INOUT</code> parameter.
    </p><p>
      For information about the effect of unhandled conditions on
      procedure parameters, see
      <a class="xref" href="sql-syntax.html#conditions-and-parameters" title="13.6.7.8 Condition Handling and OUT or INOUT Parameters">Section 13.6.7.8, “Condition Handling and OUT or INOUT Parameters”</a>.
    </p><p>
      Routine parameters cannot be referenced in statements prepared
      within the routine; see
      <a class="xref" href="restrictions.html#stored-program-restrictions" title="C.1 Restrictions on Stored Programs">Section C.1, “Restrictions on Stored Programs”</a>.
    </p><p>
      The following example shows a simple stored procedure that uses an
      <code class="literal">OUT</code> parameter:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>delimiter //</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE simpleproc (OUT param1 INT)</code></strong>
    -&gt; <strong class="userinput"><code>BEGIN</code></strong>
    -&gt;   <strong class="userinput"><code>SELECT COUNT(*) INTO param1 FROM t;</code></strong>
    -&gt; <strong class="userinput"><code>END//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>delimiter ;</code></strong>

mysql&gt; <strong class="userinput"><code>CALL simpleproc(@a);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @a;</code></strong>
+------+
| @a   |
+------+
| 3    |
+------+
1 row in set (0.00 sec)
</pre><p>
      The example uses the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client
      <code class="literal">delimiter</code> command to change the statement
      delimiter from <code class="literal">;</code> to <code class="literal">//</code> while
      the procedure is being defined. This enables the
      <code class="literal">;</code> delimiter used in the procedure body to be
      passed through to the server rather than being interpreted by
      <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> itself. See
      <a class="xref" href="stored-objects.html#stored-programs-defining" title="24.1 Defining Stored Programs">Section 24.1, “Defining Stored Programs”</a>.
    </p><p>
      The <code class="literal">RETURNS</code> clause may be specified only for a
      <code class="literal">FUNCTION</code>, for which it is mandatory. It
      indicates the return type of the function, and the function body
      must contain a <code class="literal">RETURN
      <em class="replaceable"><code>value</code></em></code> statement. If the
      <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> statement returns a value of
      a different type, the value is coerced to the proper type. For
      example, if a function specifies an
      <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> or
      <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> value in the
      <code class="literal">RETURNS</code> clause, but the
      <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> statement returns an
      integer, the value returned from the function is the string for
      the corresponding <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> member of
      set of <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> members.
    </p><p>
      The following example function takes a parameter, performs an
      operation using an SQL function, and returns the result. In this
      case, it is unnecessary to use <code class="literal">delimiter</code>
      because the function definition contains no internal
      <code class="literal">;</code> statement delimiters:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE FUNCTION hello (s CHAR(20))</code></strong>
mysql&gt; <strong class="userinput"><code>RETURNS CHAR(50) DETERMINISTIC</code></strong>
    -&gt; <strong class="userinput"><code>RETURN CONCAT('Hello, ',s,'!');</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT hello('world');</code></strong>
+----------------+
| hello('world') |
+----------------+
| Hello, world!  |
+----------------+
1 row in set (0.00 sec)
</pre><p>
      Parameter types and function return types can be declared to use
      any valid data type. The <code class="literal">COLLATE</code> attribute can
      be used if preceded by a <code class="literal">CHARACTER SET</code>
      specification.
    </p><p>
      The <em class="replaceable"><code>routine_body</code></em> consists of a valid
      SQL routine statement. This can be a simple statement such as
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> or
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>, or a compound statement
      written using <code class="literal">BEGIN</code> and <code class="literal">END</code>.
      Compound statements can contain declarations, loops, and other
      control structure statements. The syntax for these statements is
      described in <a class="xref" href="sql-syntax.html#sql-syntax-compound-statements" title="13.6 Compound-Statement Syntax">Section 13.6, “Compound-Statement Syntax”</a>. In
      practice, stored functions tend to use compound statements, unless
      the body consists of a single
      <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> statement.
    </p><p>
      MySQL permits routines to contain DDL statements, such as
      <code class="literal">CREATE</code> and <code class="literal">DROP</code>. MySQL also
      permits stored procedures (but not stored functions) to contain
      SQL transaction statements such as
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a>. Stored functions may not
      contain statements that perform explicit or implicit commit or
      rollback. Support for these statements is not required by the SQL
      standard, which states that each DBMS vendor may decide whether to
      permit them.
    </p><p>
      Statements that return a result set can be used within a stored
      procedure but not within a stored function. This prohibition
      includes <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements that do
      not have an <code class="literal">INTO
      <em class="replaceable"><code>var_list</code></em></code> clause and other
      statements such as <a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax"><code class="literal">SHOW</code></a>,
      <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>, and
      <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a>. For statements that
      can be determined at function definition time to return a result
      set, a <code class="literal">Not allowed to return a result set from a
      function</code> error occurs
      (<a class="link" href="error-handling.html#error_er_sp_no_retset"><code class="literal">ER_SP_NO_RETSET</code></a>). For statements
      that can be determined only at runtime to return a result set, a
      <code class="literal">PROCEDURE %s can't return a result set in the given
      context</code> error occurs
      (<a class="link" href="error-handling.html#error_er_sp_badselect"><code class="literal">ER_SP_BADSELECT</code></a>).
    </p><p>
      <a class="link" href="sql-syntax.html#use" title="13.8.4 USE Syntax"><code class="literal">USE</code></a> statements within stored
      routines are not permitted. When a routine is invoked, an implicit
      <code class="literal">USE <em class="replaceable"><code>db_name</code></em></code> is
      performed (and undone when the routine terminates). The causes the
      routine to have the given default database while it executes.
      References to objects in databases other than the routine default
      database should be qualified with the appropriate database name.
    </p><p>
      For additional information about statements that are not permitted
      in stored routines, see
      <a class="xref" href="restrictions.html#stored-program-restrictions" title="C.1 Restrictions on Stored Programs">Section C.1, “Restrictions on Stored Programs”</a>.
    </p><p>
      For information about invoking stored procedures from within
      programs written in a language that has a MySQL interface, see
      <a class="xref" href="sql-syntax.html#call" title="13.2.1 CALL Syntax">Section 13.2.1, “CALL Syntax”</a>.
    </p><p>
      MySQL stores the <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> system
      variable setting in effect when a routine is created or altered,
      and always executes the routine with this setting in force,
      <span class="emphasis"><em>regardless of the current server SQL mode when the
      routine begins executing</em></span>.
    </p><p>
      The switch from the SQL mode of the invoker to that of the routine
      occurs after evaluation of arguments and assignment of the
      resulting values to routine parameters. If you define a routine in
      strict SQL mode but invoke it in nonstrict mode, assignment of
      arguments to routine parameters does not take place in strict
      mode. If you require that expressions passed to a routine be
      assigned in strict SQL mode, you should invoke the routine with
      strict mode in effect.
    </p><p>
      The <code class="literal">COMMENT</code> characteristic is a MySQL
      extension, and may be used to describe the stored routine. This
      information is displayed by the <a class="link" href="sql-syntax.html#show-create-procedure" title="13.7.6.9 SHOW CREATE PROCEDURE Syntax"><code class="literal">SHOW CREATE
      PROCEDURE</code></a> and <a class="link" href="sql-syntax.html#show-create-function" title="13.7.6.8 SHOW CREATE FUNCTION Syntax"><code class="literal">SHOW CREATE
      FUNCTION</code></a> statements.
    </p><p>
      The <code class="literal">LANGUAGE</code> characteristic indicates the
      language in which the routine is written. The server ignores this
      characteristic; only SQL routines are supported.
    </p><p>
      A routine is considered <span class="quote">“<span class="quote">deterministic</span>”</span> if it always
      produces the same result for the same input parameters, and
      <span class="quote">“<span class="quote">not deterministic</span>”</span> otherwise. If neither
      <code class="literal">DETERMINISTIC</code> nor <code class="literal">NOT
      DETERMINISTIC</code> is given in the routine definition, the
      default is <code class="literal">NOT DETERMINISTIC</code>. To declare that a
      function is deterministic, you must specify
      <code class="literal">DETERMINISTIC</code> explicitly.
    </p><p>
      Assessment of the nature of a routine is based on the
      <span class="quote">“<span class="quote">honesty</span>”</span> of the creator: MySQL does not check that a
      routine declared <code class="literal">DETERMINISTIC</code> is free of
      statements that produce nondeterministic results. However,
      misdeclaring a routine might affect results or affect performance.
      Declaring a nondeterministic routine as
      <code class="literal">DETERMINISTIC</code> might lead to unexpected results
      by causing the optimizer to make incorrect execution plan choices.
      Declaring a deterministic routine as
      <code class="literal">NONDETERMINISTIC</code> might diminish performance by
      causing available optimizations not to be used.
    </p><p>
      If binary logging is enabled, the <code class="literal">DETERMINISTIC</code>
      characteristic affects which routine definitions MySQL accepts.
      See <a class="xref" href="stored-objects.html#stored-programs-logging" title="24.7 Stored Program Binary Logging">Section 24.7, “Stored Program Binary Logging”</a>.
    </p><p>
      A routine that contains the <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>
      function (or its synonyms) or
      <a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a> is nondeterministic, but it
      might still be replication-safe. For
      <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>, the binary log includes the
      timestamp and replicates correctly.
      <a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a> also replicates correctly as
      long as it is called only a single time during the execution of a
      routine. (You can consider the routine execution timestamp and
      random number seed as implicit inputs that are identical on the
      master and slave.)
    </p><p>
      Several characteristics provide information about the nature of
      data use by the routine. In MySQL, these characteristics are
      advisory only. The server does not use them to constrain what
      kinds of statements a routine will be permitted to execute.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">CONTAINS SQL</code> indicates that the routine
          does not contain statements that read or write data. This is
          the default if none of these characteristics is given
          explicitly. Examples of such statements are <code class="literal">SET @x =
          1</code> or <code class="literal">DO RELEASE_LOCK('abc')</code>,
          which execute but neither read nor write data.
        </p></li><li class="listitem"><p>
          <code class="literal">NO SQL</code> indicates that the routine contains
          no SQL statements.
        </p></li><li class="listitem"><p>
          <code class="literal">READS SQL DATA</code> indicates that the routine
          contains statements that read data (for example,
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>), but not statements
          that write data.
        </p></li><li class="listitem"><p>
          <code class="literal">MODIFIES SQL DATA</code> indicates that the
          routine contains statements that may write data (for example,
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> or
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>).
</p></li></ul>
</div>
<p>
      The <code class="literal">SQL SECURITY</code> characteristic can be
      <code class="literal">DEFINER</code> or <code class="literal">INVOKER</code> to
      specify the security context; that is, whether the routine
      executes using the privileges of the account named in the routine
      <code class="literal">DEFINER</code> clause or the user who invokes it. This
      account must have permission to access the database with which the
      routine is associated. The default value is
      <code class="literal">DEFINER</code>. The user who invokes the routine must
      have the <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a> privilege for it,
      as must the <code class="literal">DEFINER</code> account if the routine
      executes in definer security context.
    </p><p>
      The <code class="literal">DEFINER</code> clause specifies the MySQL account
      to be used when checking access privileges at routine execution
      time for routines that have the <code class="literal">SQL SECURITY
      DEFINER</code> characteristic.
    </p><p>
      If the <code class="literal">DEFINER</code> clause is present, the
      <em class="replaceable"><code>user</code></em> value should be a MySQL account
      specified as
      <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>,
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>, or
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>. The permitted
      <em class="replaceable"><code>user</code></em> values depend on the privileges
      you hold, as discussed in
      <a class="xref" href="stored-objects.html#stored-objects-security" title="24.6 Stored Object Access Control">Section 24.6, “Stored Object Access Control”</a>. Also see that section
      for additional information about stored routine security.
    </p><p>
      If the <code class="literal">DEFINER</code> clause is omitted, the default
      definer is the user who executes the <a class="link" href="sql-syntax.html#create-procedure" title="13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax"><code class="literal">CREATE
      PROCEDURE</code></a> or <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE
      FUNCTION</code></a> statement. This is the same as specifying
      <code class="literal">DEFINER = CURRENT_USER</code> explicitly.
    </p><p>
      Within the body of a stored routine that is defined with the
      <code class="literal">SQL SECURITY DEFINER</code> characteristic, the
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> function returns the
      routine's <code class="literal">DEFINER</code> value. For information about
      user auditing within stored routines, see
      <a class="xref" href="security.html#account-activity-auditing" title="6.2.22 SQL-Based Account Activity Auditing">Section 6.2.22, “SQL-Based Account Activity Auditing”</a>.
    </p><p>
      Consider the following procedure, which displays a count of the
      number of MySQL accounts listed in the
      <code class="literal">mysql.user</code> system table:
    </p><pre data-lang="sql" class="programlisting">
CREATE DEFINER = 'admin'@'localhost' PROCEDURE account_count()
BEGIN
  SELECT 'Number of accounts:', COUNT(*) FROM mysql.user;
END;
</pre><p>
      The procedure is assigned a <code class="literal">DEFINER</code> account of
      <code class="literal">'admin'@'localhost'</code> no matter which user
      defines it. It executes with the privileges of that account no
      matter which user invokes it (because the default security
      characteristic is <code class="literal">DEFINER</code>). The procedure
      succeeds or fails depending on whether invoker has the
      <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a> privilege for it and
      <code class="literal">'admin'@'localhost'</code> has the
      <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the
      <code class="literal">mysql.user</code> table.
    </p><p>
      Now suppose that the procedure is defined with the <code class="literal">SQL
      SECURITY INVOKER</code> characteristic:
    </p><pre data-lang="sql" class="programlisting">
CREATE DEFINER = 'admin'@'localhost' PROCEDURE account_count()
SQL SECURITY INVOKER
BEGIN
  SELECT 'Number of accounts:', COUNT(*) FROM mysql.user;
END;
</pre><p>
      The procedure still has a <code class="literal">DEFINER</code> of
      <code class="literal">'admin'@'localhost'</code>, but in this case, it
      executes with the privileges of the invoking user. Thus, the
      procedure succeeds or fails depending on whether the invoker has
      the <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a> privilege for it and
      the <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the
      <code class="literal">mysql.user</code> table.
    </p><p>
      The server handles the data type of a routine parameter, local
      routine variable created with
      <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a>, or function return value
      as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Assignments are checked for data type mismatches and overflow.
          Conversion and overflow problems result in warnings, or errors
          in strict SQL mode.
        </p></li><li class="listitem"><p>
          Only scalar values can be assigned. For example, a statement
          such as <code class="literal">SET x = (SELECT 1, 2)</code> is invalid.
        </p></li><li class="listitem"><p>
          For character data types, if <code class="literal">CHARACTER SET</code>
          is includedd in the declaration, the specified character set
          and its default collation is used. If the
          <code class="literal">COLLATE</code> attribute is also present, that
          collation is used rather than the default collation.
        </p><p>
          If <code class="literal">CHARACTER SET</code> and
          <code class="literal">COLLATE</code> are not present, the database
          character set and collation in effect at routine creation time
          are used. To avoid having the server use the database
          character set and collation, provide an explicit
          <code class="literal">CHARACTER SET</code> and a
          <code class="literal">COLLATE</code> attribute for character data
          parameters.
        </p><p>
          If you change the database default character set or collation,
          stored routines that use the database defaults must be dropped
          and recreated so that they use the new defaults.
        </p><p>
          The database character set and collation are given by the
          value of the
          <a class="link" href="server-administration.html#sysvar_character_set_database"><code class="literal">character_set_database</code></a> and
          <a class="link" href="server-administration.html#sysvar_collation_database"><code class="literal">collation_database</code></a> system
          variables. For more information, see
          <a class="xref" href="charset.html#charset-database" title="10.3.3 Database Character Set and Collation">Section 10.3.3, “Database Character Set and Collation”</a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-server"></a>13.1.18 CREATE SERVER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091670331872"></a><pre data-lang="sql" class="programlisting">
CREATE SERVER <em class="replaceable"><code>server_name</code></em>
    FOREIGN DATA WRAPPER <em class="replaceable"><code>wrapper_name</code></em>
    OPTIONS (<em class="replaceable"><code>option</code></em> [, <em class="replaceable"><code>option</code></em>] ...)

<em class="replaceable"><code>option</code></em>:
  { HOST <em class="replaceable"><code>character-literal</code></em>
  | DATABASE <em class="replaceable"><code>character-literal</code></em>
  | USER <em class="replaceable"><code>character-literal</code></em>
  | PASSWORD <em class="replaceable"><code>character-literal</code></em>
  | SOCKET <em class="replaceable"><code>character-literal</code></em>
  | OWNER <em class="replaceable"><code>character-literal</code></em>
  | PORT <em class="replaceable"><code>numeric-literal</code></em> }
</pre><p>
      This statement creates the definition of a server for use with the
      <code class="literal">FEDERATED</code> storage engine. The <code class="literal">CREATE
      SERVER</code> statement creates a new row in the
      <code class="literal">servers</code> table in the <code class="literal">mysql</code>
      database. This statement requires the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
    </p><p>
      The <code class="literal"><em class="replaceable"><code>server_name</code></em></code>
      should be a unique reference to the server. Server definitions are
      global within the scope of the server, it is not possible to
      qualify the server definition to a specific database.
      <code class="literal"><em class="replaceable"><code>server_name</code></em></code> has a
      maximum length of 64 characters (names longer than 64 characters
      are silently truncated), and is case insensitive. You may specify
      the name as a quoted string.
    </p><p>
      The <code class="literal"><em class="replaceable"><code>wrapper_name</code></em></code> is
      an identifier and may be quoted with single quotation marks.
    </p><p>
      For each <code class="literal"><em class="replaceable"><code>option</code></em></code> you
      must specify either a character literal or numeric literal.
      Character literals are UTF-8, support a maximum length of 64
      characters and default to a blank (empty) string. String literals
      are silently truncated to 64 characters. Numeric literals must be
      a number between 0 and 9999, default value is 0.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        The <code class="literal">OWNER</code> option is currently not applied,
        and has no effect on the ownership or operation of the server
        connection that is created.
</p>
</div>
<p>
      The <code class="literal">CREATE SERVER</code> statement creates an entry in
      the <code class="literal">mysql.servers</code> table that can later be used
      with the <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement
      when creating a <code class="literal">FEDERATED</code> table. The options
      that you specify will be used to populate the columns in the
      <code class="literal">mysql.servers</code> table. The table columns are
      <code class="literal">Server_name</code>, <code class="literal">Host</code>,
      <code class="literal">Db</code>, <code class="literal">Username</code>,
      <code class="literal">Password</code>, <code class="literal">Port</code> and
      <code class="literal">Socket</code>.
    </p><p>
      For example:
    </p><pre data-lang="sql" class="programlisting">
CREATE SERVER s
FOREIGN DATA WRAPPER mysql
OPTIONS (USER 'Remote', HOST '198.51.100.106', DATABASE 'test');
</pre><p>
      Be sure to specify all options necessary to establish a connection
      to the server. The user name, host name, and database name are
      mandatory. Other options might be required as well, such as
      password.
    </p><p>
      The data stored in the table can be used when creating a
      connection to a <code class="literal">FEDERATED</code> table:
    </p><pre data-lang="sql" class="programlisting">CREATE TABLE t (s1 INT) ENGINE=FEDERATED CONNECTION='s';</pre><p>
      For more information, see
      <a class="xref" href="storage-engines.html#federated-storage-engine" title="16.8 The FEDERATED Storage Engine">Section 16.8, “The FEDERATED Storage Engine”</a>.
    </p><p>
      <code class="literal">CREATE SERVER</code> causes an implicit commit. See
      <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
    </p><p>
      <code class="literal">CREATE SERVER</code> is not written to the binary log,
      regardless of the logging format that is in use.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-spatial-reference-system"></a>13.1.19 CREATE SPATIAL REFERENCE SYSTEM Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091670289088"></a><pre data-lang="sql" class="programlisting">
CREATE OR REPLACE SPATIAL REFERENCE SYSTEM
    <em class="replaceable"><code>srid</code></em> <em class="replaceable"><code>srs_attribute</code></em> ...

CREATE SPATIAL REFERENCE SYSTEM
    [IF NOT EXISTS]
    <em class="replaceable"><code>srid</code></em> <em class="replaceable"><code>srs_attribute</code></em> ...

<em class="replaceable"><code>srs_attribute</code></em>: {
    NAME '<em class="replaceable"><code>srs_name</code></em>'
  | DEFINITION '<em class="replaceable"><code>definition</code></em>'
  | ORGANIZATION '<em class="replaceable"><code>org_name</code></em>' IDENTIFIED BY <em class="replaceable"><code>org_id</code></em>
  | DESCRIPTION '<em class="replaceable"><code>description</code></em>'
}

<em class="replaceable"><code>srid</code></em>, <em class="replaceable"><code>org_id</code></em>: <em class="replaceable"><code>32-bit unsigned integer</code></em>
</pre><p>
      This statement creates a
      <a class="link" href="data-types.html#spatial-reference-systems" title="11.5.5 Spatial Reference System Support">spatial reference
      system</a> (SRS) definition and stores it in the data
      dictionary. The definition can be inspected using the
      <code class="literal">INFORMATION_SCHEMA</code>
      <a class="link" href="information-schema.html#st-spatial-reference-systems-table" title="25.28 The INFORMATION_SCHEMA ST_SPATIAL_REFERENCE_SYSTEMS Table"><code class="literal">ST_SPATIAL_REFERENCE_SYSTEMS</code></a> table.
      This statement requires the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
      privilege.
    </p><p>
      If neither <code class="literal">OR REPLACE</code> nor <code class="literal">IF NOT
      EXISTS</code> is specified, an error occurs if an SRS
      definition with the SRID value already exists.
    </p><p>
      With <code class="literal">CREATE OR REPLACE</code> syntax, any existing SRS
      definition with the same SRID value is replaced, unless the SRID
      value is used by some column in an existing table. In that case,
      an error occurs. For example:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE OR REPLACE SPATIAL REFERENCE SYSTEM 4326 ...;</code></strong>
ERROR 3716 (SR005): Can't modify SRID 4326. There is at
least one column depending on it.
</pre><p>
      To identify which column or columns use the SRID, use this query:
    </p><pre data-lang="sql" class="programlisting">
SELECT * FROM INFORMATION_SCHEMA.ST_GEOMETRY_COLUMNS WHERE SRS_ID=4326;
</pre><p>
      With <code class="literal">CREATE ... IF NOT EXISTS</code> syntax, any
      existing SRS definition with the same SRID value causes the new
      definition to be ignored and a warning occurs.
    </p><p>
      SRID values must be in the range of 32-bit unsigned integers, with
      these restrictions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          SRID 0 is a valid SRID but cannot be used with
          <a class="link" href="sql-syntax.html#create-spatial-reference-system" title="13.1.19 CREATE SPATIAL REFERENCE SYSTEM Syntax"><code class="literal">CREATE SPATIAL REFERENCE
          SYSTEM</code></a>.
        </p></li><li class="listitem"><p>
          If the value is in a reserved SRID range, a warning occurs.
          Reserved ranges are [0, 32767] (reserved by EPSG),
          [60,000,000, 69,999,999] (reserved by EPSG), and
          [2,000,000,000, 2,147,483,647] (reserved by MySQL). EPSG
          stands for the <a class="ulink" href="http://epsg.org" target="_top">European Petroleum
          Survey Group</a>.
        </p></li><li class="listitem"><p>
          Users should not create SRSs with SRIDs in the reserved
          ranges. Doing so runs the risk that the SRIDs will conflict
          with future SRS definitions distributed with MySQL, with the
          result that the new system-provided SRSs are not installed for
          MySQL upgrades or that the user-defined SRSs are overwritten.
</p></li></ul>
</div>
<p>
      Attributes for the statement must satisfy these conditions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Attributes can be given in any order, but no attribute can be
          given more than once.
        </p></li><li class="listitem"><p>
          The <code class="literal">NAME</code> and <code class="literal">DEFINITION</code>
          attributes are mandatory.
        </p></li><li class="listitem"><p>
          The <code class="literal">NAME</code>
          <em class="replaceable"><code>srs_name</code></em> attribute value must be
          unique. The combination of the <code class="literal">ORGANIZATION</code>
          <em class="replaceable"><code>org_name</code></em> and
          <em class="replaceable"><code>org_id</code></em> attribute values must be
          unique.
        </p></li><li class="listitem"><p>
          The <code class="literal">NAME</code>
          <em class="replaceable"><code>srs_name</code></em> attribute value and
          <code class="literal">ORGANIZATION</code>
          <em class="replaceable"><code>org_name</code></em> attribute value cannot be
          empty or begin or end with whitespace.
        </p></li><li class="listitem"><p>
          String values in attribute specifications cannot contain
          control characters, including newline.
        </p></li><li class="listitem"><p>
          The following table shows the maximum lengths for string
          attribute values.
</p>
<div class="table">
<a name="spatial-reference-system-attribute-length"></a><p class="title"><b>Table 13.6 CREATE SPATIAL REFERENCE SYSTEM Attribute Lengths</b></p>
<div class="table-contents">
<table summary="Maximum string attribute lengths for CREATE SPATIAL REFERENCE SYSTEM"><col width="25%"><col width="50%"><thead><tr>
              <th scope="col" align="center">Attribute</th>
              <th scope="col" align="center">Maximum Length (characters)</th>
            </tr></thead><tbody><tr>
              <th scope="row" align="left"><code class="literal">NAME</code></th>
              <td>80</td>
            </tr><tr>
              <th scope="row" align="left"><code class="literal">DEFINITION</code></th>
              <td>4096</td>
            </tr><tr>
              <th scope="row" align="left"><code class="literal">ORGANIZATION</code></th>
              <td>256</td>
            </tr><tr>
              <th scope="row" align="left"><code class="literal">DESCRIPTION</code></th>
              <td>2048</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"></li></ul>
</div>
<p>
      Here is an example <a class="link" href="sql-syntax.html#create-spatial-reference-system" title="13.1.19 CREATE SPATIAL REFERENCE SYSTEM Syntax"><code class="literal">CREATE SPATIAL REFERENCE
      SYSTEM</code></a> statement. The <code class="literal">DEFINITION</code>
      value is reformatted across multiple lines for readability. (For
      the statement to be legal, the value actually must be given on a
      single line.)
    </p><pre data-lang="sql" class="programlisting">
CREATE SPATIAL REFERENCE SYSTEM 4120
NAME 'Greek'
ORGANIZATION 'EPSG' IDENTIFIED BY 4120
DEFINITION
  'GEOGCS["Greek",DATUM["Greek",SPHEROID["Bessel 1841",
  6377397.155,299.1528128,AUTHORITY["EPSG","7004"]],
  AUTHORITY["EPSG","6120"]],PRIMEM["Greenwich",0,
  AUTHORITY["EPSG","8901"]],UNIT["degree",0.017453292519943278,
  AUTHORITY["EPSG","9122"]],AXIS["Lat",NORTH],AXIS["Lon",EAST],
  AUTHORITY["EPSG","4120"]]';
</pre><p>
      The grammar for SRS definitions is based on the grammar defined in
      <em class="citetitle">OpenGIS Implementation Specification: Coordinate
      Transformation Services</em>, Revision 1.00, OGC 01-009,
      January 12, 2001, Section 7.2. This specification is available at
      <a class="ulink" href="http://www.opengeospatial.org/standards/ct" target="_top">http://www.opengeospatial.org/standards/ct</a>.
    </p><p>
      MySQL incorporates these changes to the specification:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Only the <code class="literal">&lt;horz cs&gt;</code> production rule is
          implemented (that is, geographic and projected SRSs).
        </p></li><li class="listitem"><p>
          There is an optional, nonstandard
          <code class="literal">&lt;authority&gt;</code> clause for
          <code class="literal">&lt;parameter&gt;</code>. This makes it possible
          to recognize projection parameters by authority instead of
          name.
        </p></li><li class="listitem"><p>
          The specification does not make <code class="literal">AXIS</code>
          clauses mandatory in <code class="literal">GEOGCS</code> spatial
          reference system definitions. However, if there are no
          <code class="literal">AXIS</code> clauses, MySQL cannot determine
          whether a definition has axes in latitude-longitude order or
          longitude-latitude order. MySQL enforces the nonstandard
          requirement that each <code class="literal">GEOGCS</code> definition
          must include two <code class="literal">AXIS</code> clauses. One must be
          <code class="literal">NORTH</code> or <code class="literal">SOUTH</code>, and the
          other <code class="literal">EAST</code> or <code class="literal">WEST</code>. The
          <code class="literal">AXIS</code> clause order determines whether the
          definition has axes in latitude-longitude order or
          longitude-latitude order.
        </p></li><li class="listitem"><p>
          SRS definitions may not contain newlines.
</p></li></ul>
</div>
<p>
      If an SRS definition specifies an authority code for the
      projection (which is recommended), an error occurs if the
      definition is missing mandatory parameters. In this case, the
      error message indicates what the problem is. The projection
      methods and mandatory parameters that MySQL supports are shown in
      <a class="xref" href="sql-syntax.html#supported-srs-projections-table" title="Table 13.7 Supported Spatial Reference System Projection Methods">Table 13.7, “Supported Spatial Reference System Projection Methods”</a> and
      <a class="xref" href="sql-syntax.html#srs-projection-parameters-table" title="Table 13.8 Spatial Reference System Projection Parameters">Table 13.8, “Spatial Reference System Projection Parameters”</a>.
    </p><p>
      For additional information about writing SRS definitions for
      MySQL, see
      <a class="ulink" href="https://mysqlserverteam.com/geographic-spatial-reference-systems-in-mysql-8-0/" target="_top">Geographic
      Spatial Reference Systems in MySQL 8.0</a> and
      <a class="ulink" href="https://mysqlserverteam.com/projected-spatial-reference-systems-in-mysql-8-0/" target="_top">Projected
      Spatial Reference Systems in MySQL 8.0</a>
    </p><p>
      The following table shows the projection methods that MySQL
      supports. MySQL permits unknown projection methods but cannot
      check the defintion for mandatory paramters and cannot convert
      spatial data to or from an unknown projection. For detailed
      explanations of how each projection works, including formulas, see
      <a class="ulink" href="http://www.epsg.org/Portals/0/373-07-2.pdf" target="_top">EPSG
      Guidance Note 7-2</a>.
</p>
<div class="table">
<a name="supported-srs-projections-table"></a><p class="title"><b>Table 13.7 Supported Spatial Reference System Projection Methods</b></p>
<div class="table-contents">
<table summary="Supported spatial reference system projection codes, names, and mandatory EPSG parameters."><col width="10*"><col width="45*"><col width="35*"><thead><tr>
          <th scope="col">EPSG Code</th>
          <th scope="col">Projection Name</th>
          <th scope="col">Mandatory Parameters (EPSG Codes)</th>
        </tr></thead><tbody><tr>
          <td scope="row">1024</td>
          <td>Popular Visualisation Pseudo Mercator</td>
          <td>8801, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">1027</td>
          <td>Lambert Azimuthal Equal Area (Spherical)</td>
          <td>8801, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">1028</td>
          <td>Equidistant Cylindrical</td>
          <td>8823, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">1029</td>
          <td>Equidistant Cylindrical (Spherical)</td>
          <td>8823, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">1041</td>
          <td>Krovak (North Orientated)</td>
          <td>8811, 8833, 1036, 8818, 8819, 8806, 8807</td>
        </tr><tr>
          <td scope="row">1042</td>
          <td>Krovak Modified</td>
          <td>8811, 8833, 1036, 8818, 8819, 8806, 8807, 8617, 8618, 1026, 1027, 1028,
            1029, 1030, 1031, 1032, 1033, 1034, 1035</td>
        </tr><tr>
          <td scope="row">1043</td>
          <td>Krovak Modified (North Orientated)</td>
          <td>8811, 8833, 1036, 8818, 8819, 8806, 8807, 8617, 8618, 1026, 1027, 1028,
            1029, 1030, 1031, 1032, 1033, 1034, 1035</td>
        </tr><tr>
          <td scope="row">1051</td>
          <td>Lambert Conic Conformal (2SP Michigan)</td>
          <td>8821, 8822, 8823, 8824, 8826, 8827, 1038</td>
        </tr><tr>
          <td scope="row">1052</td>
          <td>Colombia Urban</td>
          <td>8801, 8802, 8806, 8807, 1039</td>
        </tr><tr>
          <td scope="row">9801</td>
          <td>Lambert Conic Conformal (1SP)</td>
          <td>8801, 8802, 8805, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9802</td>
          <td>Lambert Conic Conformal (2SP)</td>
          <td>8821, 8822, 8823, 8824, 8826, 8827</td>
        </tr><tr>
          <td scope="row">9803</td>
          <td>Lambert Conic Conformal (2SP Belgium)</td>
          <td>8821, 8822, 8823, 8824, 8826, 8827</td>
        </tr><tr>
          <td scope="row">9804</td>
          <td>Mercator (variant A)</td>
          <td>8801, 8802, 8805, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9805</td>
          <td>Mercator (variant B)</td>
          <td>8823, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9806</td>
          <td>Cassini-Soldner</td>
          <td>8801, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9807</td>
          <td>Transverse Mercator</td>
          <td>8801, 8802, 8805, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9808</td>
          <td>Transverse Mercator (South Orientated)</td>
          <td>8801, 8802, 8805, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9809</td>
          <td>Oblique Stereographic</td>
          <td>8801, 8802, 8805, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9810</td>
          <td>Polar Stereographic (variant A)</td>
          <td>8801, 8802, 8805, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9811</td>
          <td>New Zealand Map Grid</td>
          <td>8801, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9812</td>
          <td>Hotine Oblique Mercator (variant A)</td>
          <td>8811, 8812, 8813, 8814, 8815, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9813</td>
          <td>Laborde Oblique Mercator</td>
          <td>8811, 8812, 8813, 8815, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9815</td>
          <td>Hotine Oblique Mercator (variant B)</td>
          <td>8811, 8812, 8813, 8814, 8815, 8816, 8817</td>
        </tr><tr>
          <td scope="row">9816</td>
          <td>Tunisia Mining Grid</td>
          <td>8821, 8822, 8826, 8827</td>
        </tr><tr>
          <td scope="row">9817</td>
          <td>Lambert Conic Near-Conformal</td>
          <td>8801, 8802, 8805, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9818</td>
          <td>American Polyconic</td>
          <td>8801, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9819</td>
          <td>Krovak</td>
          <td>8811, 8833, 1036, 8818, 8819, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9820</td>
          <td>Lambert Azimuthal Equal Area</td>
          <td>8801, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9822</td>
          <td>Albers Equal Area</td>
          <td>8821, 8822, 8823, 8824, 8826, 8827</td>
        </tr><tr>
          <td scope="row">9824</td>
          <td>Transverse Mercator Zoned Grid System</td>
          <td>8801, 8830, 8831, 8805, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9826</td>
          <td>Lambert Conic Conformal (West Orientated)</td>
          <td>8801, 8802, 8805, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9828</td>
          <td>Bonne (South Orientated)</td>
          <td>8801, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9829</td>
          <td>Polar Stereographic (variant B)</td>
          <td>8832, 8833, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9830</td>
          <td>Polar Stereographic (variant C)</td>
          <td>8832, 8833, 8826, 8827</td>
        </tr><tr>
          <td scope="row">9831</td>
          <td>Guam Projection</td>
          <td>8801, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9832</td>
          <td>Modified Azimuthal Equidistant</td>
          <td>8801, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9833</td>
          <td>Hyperbolic Cassini-Soldner</td>
          <td>8801, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9834</td>
          <td>Lambert Cylindrical Equal Area (Spherical)</td>
          <td>8823, 8802, 8806, 8807</td>
        </tr><tr>
          <td scope="row">9835</td>
          <td>Lambert Cylindrical Equal Area</td>
          <td>8823, 8802, 8806, 8807</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
      The following table shows the projection parameters that MySQL
      recognizes. Recognition occurs primarily by authority code. If
      there is no authority code, MySQL falls back to case-insensitive
      string matching on the parameter name. For details about each
      parameter, look it up by code in the
      <a class="ulink" href="https://www.epsg-registry.org" target="_top">EPSG Online
      Registry</a>.
</p>
<div class="table">
<a name="srs-projection-parameters-table"></a><p class="title"><b>Table 13.8 Spatial Reference System Projection Parameters</b></p>
<div class="table-contents">
<table summary="Spatial reference system projection codes, fallback names, and EPSG names."><col width="10*"><col width="45*"><col width="35*"><thead><tr>
          <th scope="col">EPSG Code</th>
          <th scope="col">Fallback Name (Recognized by MySQL)</th>
          <th scope="col">EPSG Name</th>
        </tr></thead><tbody><tr>
          <td scope="row">1026</td>
          <td>c1</td>
          <td>C1</td>
        </tr><tr>
          <td scope="row">1027</td>
          <td>c2</td>
          <td>C2</td>
        </tr><tr>
          <td scope="row">1028</td>
          <td>c3</td>
          <td>C3</td>
        </tr><tr>
          <td scope="row">1029</td>
          <td>c4</td>
          <td>C4</td>
        </tr><tr>
          <td scope="row">1030</td>
          <td>c5</td>
          <td>C5</td>
        </tr><tr>
          <td scope="row">1031</td>
          <td>c6</td>
          <td>C6</td>
        </tr><tr>
          <td scope="row">1032</td>
          <td>c7</td>
          <td>C7</td>
        </tr><tr>
          <td scope="row">1033</td>
          <td>c8</td>
          <td>C8</td>
        </tr><tr>
          <td scope="row">1034</td>
          <td>c9</td>
          <td>C9</td>
        </tr><tr>
          <td scope="row">1035</td>
          <td>c10</td>
          <td>C10</td>
        </tr><tr>
          <td scope="row">1036</td>
          <td>azimuth</td>
          <td>Co-latitude of cone axis</td>
        </tr><tr>
          <td scope="row">1038</td>
          <td>ellipsoid_scale_factor</td>
          <td>Ellipsoid scaling factor</td>
        </tr><tr>
          <td scope="row">1039</td>
          <td>projection_plane_height_at_origin</td>
          <td>Projection plane origin height</td>
        </tr><tr>
          <td scope="row">8617</td>
          <td>evaluation_point_ordinate_1</td>
          <td>Ordinate 1 of evaluation point</td>
        </tr><tr>
          <td scope="row">8618</td>
          <td>evaluation_point_ordinate_2</td>
          <td>Ordinate 2 of evaluation point</td>
        </tr><tr>
          <td scope="row">8801</td>
          <td>latitude_of_origin</td>
          <td>Latitude of natural origin</td>
        </tr><tr>
          <td scope="row">8802</td>
          <td>central_meridian</td>
          <td>Longitude of natural origin</td>
        </tr><tr>
          <td scope="row">8805</td>
          <td>scale_factor</td>
          <td>Scale factor at natural origin</td>
        </tr><tr>
          <td scope="row">8806</td>
          <td>false_easting</td>
          <td>False easting</td>
        </tr><tr>
          <td scope="row">8807</td>
          <td>false_northing</td>
          <td>False northing</td>
        </tr><tr>
          <td scope="row">8811</td>
          <td>latitude_of_center</td>
          <td>Latitude of projection centre</td>
        </tr><tr>
          <td scope="row">8812</td>
          <td>longitude_of_center</td>
          <td>Longitude of projection centre</td>
        </tr><tr>
          <td scope="row">8813</td>
          <td>azimuth</td>
          <td>Azimuth of initial line</td>
        </tr><tr>
          <td scope="row">8814</td>
          <td>rectified_grid_angle</td>
          <td>Angle from Rectified to Skew Grid</td>
        </tr><tr>
          <td scope="row">8815</td>
          <td>scale_factor</td>
          <td>Scale factor on initial line</td>
        </tr><tr>
          <td scope="row">8816</td>
          <td>false_easting</td>
          <td>Easting at projection centre</td>
        </tr><tr>
          <td scope="row">8817</td>
          <td>false_northing</td>
          <td>Northing at projection centre</td>
        </tr><tr>
          <td scope="row">8818</td>
          <td>pseudo_standard_parallel_1</td>
          <td>Latitude of pseudo standard parallel</td>
        </tr><tr>
          <td scope="row">8819</td>
          <td>scale_factor</td>
          <td>Scale factor on pseudo standard parallel</td>
        </tr><tr>
          <td scope="row">8821</td>
          <td>latitude_of_origin</td>
          <td>Latitude of false origin</td>
        </tr><tr>
          <td scope="row">8822</td>
          <td>central_meridian</td>
          <td>Longitude of false origin</td>
        </tr><tr>
          <td scope="row">8823</td>
          <td>standard_parallel_1, standard_parallel1</td>
          <td>Latitude of 1st standard parallel</td>
        </tr><tr>
          <td scope="row">8824</td>
          <td>standard_parallel_2, standard_parallel2</td>
          <td>Latitude of 2nd standard parallel</td>
        </tr><tr>
          <td scope="row">8826</td>
          <td>false_easting</td>
          <td>Easting at false origin</td>
        </tr><tr>
          <td scope="row">8827</td>
          <td>false_northing</td>
          <td>Northing at false origin</td>
        </tr><tr>
          <td scope="row">8830</td>
          <td>initial_longitude</td>
          <td>Initial longitude</td>
        </tr><tr>
          <td scope="row">8831</td>
          <td>zone_width</td>
          <td>Zone width</td>
        </tr><tr>
          <td scope="row">8832</td>
          <td>standard_parallel</td>
          <td>Latitude of standard parallel</td>
        </tr><tr>
          <td scope="row">8833</td>
          <td>longitude_of_center</td>
          <td>Longitude of origin</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-table"></a>13.1.20 CREATE TABLE Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#create-table-statement-retention">13.1.20.1 CREATE TABLE Statement Retention</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table-files">13.1.20.2 Files Created by CREATE TABLE</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-temporary-table">13.1.20.3 CREATE TEMPORARY TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table-like">13.1.20.4 CREATE TABLE ... LIKE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table-select">13.1.20.5 CREATE TABLE ... SELECT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table-foreign-keys">13.1.20.6 Using FOREIGN KEY Constraints</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table-check-constraints">13.1.20.7 CHECK Constraints</a></span></dt><dt><span class="section"><a href="sql-syntax.html#silent-column-changes">13.1.20.8 Silent Column Specification Changes</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table-generated-columns">13.1.20.9 CREATE TABLE and Generated Columns</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table-secondary-indexes">13.1.20.10 Secondary Indexes and Generated Columns</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table-ndb-table-comment-options">13.1.20.11 Setting NDB_TABLE Options</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091669920768"></a><pre data-lang="sql" class="programlisting">
CREATE [TEMPORARY] TABLE [IF NOT EXISTS] <em class="replaceable"><code>tbl_name</code></em>
    (<em class="replaceable"><code>create_definition</code></em>,...)
    [<em class="replaceable"><code>table_options</code></em>]
    [<em class="replaceable"><code>partition_options</code></em>]

CREATE [TEMPORARY] TABLE [IF NOT EXISTS] <em class="replaceable"><code>tbl_name</code></em>
    [(<em class="replaceable"><code>create_definition</code></em>,...)]
    [<em class="replaceable"><code>table_options</code></em>]
    [<em class="replaceable"><code>partition_options</code></em>]
    [IGNORE | REPLACE]
    [AS] <em class="replaceable"><code>query_expression</code></em>

CREATE [TEMPORARY] TABLE [IF NOT EXISTS] <em class="replaceable"><code>tbl_name</code></em>
    { LIKE <em class="replaceable"><code>old_tbl_name</code></em> | (LIKE <em class="replaceable"><code>old_tbl_name</code></em>) }

<em class="replaceable"><code>create_definition</code></em>:
    <em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definition</code></em>
  | {INDEX|KEY} [<em class="replaceable"><code>index_name</code></em>] [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>key_part</code></em>,...)
      [<em class="replaceable"><code>index_option</code></em>] ...
  | {FULLTEXT|SPATIAL} [INDEX|KEY] [<em class="replaceable"><code>index_name</code></em>] (<em class="replaceable"><code>key_part</code></em>,...)
      [<em class="replaceable"><code>index_option</code></em>] ...
  | [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] PRIMARY KEY
      [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>key_part</code></em>,...)
      [<em class="replaceable"><code>index_option</code></em>] ...
  | [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] UNIQUE [INDEX|KEY]
      [<em class="replaceable"><code>index_name</code></em>] [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>key_part</code></em>,...)
      [<em class="replaceable"><code>index_option</code></em>] ...
  | [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] FOREIGN KEY
      [<em class="replaceable"><code>index_name</code></em>] (<em class="replaceable"><code>col_name</code></em>,...)
      <em class="replaceable"><code>reference_definition</code></em>
  | <em class="replaceable"><code>check_constraint_definition</code></em>

<em class="replaceable"><code>column_definition</code></em>:
    <em class="replaceable"><code>data_type</code></em> [NOT NULL | NULL] [DEFAULT {<em class="replaceable"><code>literal</code></em> | (<em class="replaceable"><code>expr</code></em>)} ]
      [AUTO_INCREMENT] [UNIQUE [KEY]] [[PRIMARY] KEY]
      [COMMENT '<em class="replaceable"><code>string</code></em>']
      [COLLATE <em class="replaceable"><code>collation_name</code></em>]
      [COLUMN_FORMAT {FIXED|DYNAMIC|DEFAULT}]
      [STORAGE {DISK|MEMORY}]
      [<em class="replaceable"><code>reference_definition</code></em>]
      [<em class="replaceable"><code>check_constraint_definition</code></em>]
  | <em class="replaceable"><code>data_type</code></em>
      [COLLATE <em class="replaceable"><code>collation_name</code></em>]
      [GENERATED ALWAYS] AS (<em class="replaceable"><code>expr</code></em>)
      [VIRTUAL | STORED] [NOT NULL | NULL]
      [UNIQUE [KEY]] [[PRIMARY] KEY]
      [COMMENT '<em class="replaceable"><code>string</code></em>']
      [<em class="replaceable"><code>reference_definition</code></em>]
      [<em class="replaceable"><code>check_constraint_definition</code></em>]

<em class="replaceable"><code>data_type</code></em>:
    (see <a class="xref" href="data-types.html" title="Chapter 11 Data Types">Chapter 11, <i>Data Types</i></a>)

<em class="replaceable"><code>key_part</code></em>: {<em class="replaceable"><code>col_name</code></em> [(<em class="replaceable"><code>length</code></em>)] | (<em class="replaceable"><code>expr</code></em>)} [ASC | DESC]

<em class="replaceable"><code>index_type</code></em>:
    USING {BTREE | HASH}

<em class="replaceable"><code>index_option</code></em>:
    KEY_BLOCK_SIZE [=] <em class="replaceable"><code>value</code></em>
  | <em class="replaceable"><code>index_type</code></em>
  | WITH PARSER <em class="replaceable"><code>parser_name</code></em>
  | COMMENT '<em class="replaceable"><code>string</code></em>'
  | {VISIBLE | INVISIBLE}

<em class="replaceable"><code>check_constraint_definition</code></em>:
    [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] CHECK (<em class="replaceable"><code>expr</code></em>) [[NOT] ENFORCED]

<em class="replaceable"><code>reference_definition</code></em>:
    REFERENCES <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>key_part</code></em>,...)
      [MATCH FULL | MATCH PARTIAL | MATCH SIMPLE]
      [ON DELETE <em class="replaceable"><code>reference_option</code></em>]
      [ON UPDATE <em class="replaceable"><code>reference_option</code></em>]

<em class="replaceable"><code>reference_option</code></em>:
    RESTRICT | CASCADE | SET NULL | NO ACTION | SET DEFAULT

<em class="replaceable"><code>table_options</code></em>:
    <em class="replaceable"><code>table_option</code></em> [[,] <em class="replaceable"><code>table_option</code></em>] ...

<em class="replaceable"><code>table_option</code></em>:
    AUTO_INCREMENT [=] <em class="replaceable"><code>value</code></em>
  | AVG_ROW_LENGTH [=] <em class="replaceable"><code>value</code></em>
  | [DEFAULT] CHARACTER SET [=] <em class="replaceable"><code>charset_name</code></em>
  | CHECKSUM [=] {0 | 1}
  | [DEFAULT] COLLATE [=] <em class="replaceable"><code>collation_name</code></em>
  | COMMENT [=] '<em class="replaceable"><code>string</code></em>'
  | COMPRESSION [=] {'ZLIB'|'LZ4'|'NONE'}
  | CONNECTION [=] '<em class="replaceable"><code>connect_string</code></em>'
  | {DATA|INDEX} DIRECTORY [=] '<em class="replaceable"><code>absolute path to directory</code></em>'
  | DELAY_KEY_WRITE [=] {0 | 1}
  | ENCRYPTION [=] {'Y' | 'N'}
  | ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
  | INSERT_METHOD [=] { NO | FIRST | LAST }
  | KEY_BLOCK_SIZE [=] <em class="replaceable"><code>value</code></em>
  | MAX_ROWS [=] <em class="replaceable"><code>value</code></em>
  | MIN_ROWS [=] <em class="replaceable"><code>value</code></em>
  | PACK_KEYS [=] {0 | 1 | DEFAULT}
  | PASSWORD [=] '<em class="replaceable"><code>string</code></em>'
  | ROW_FORMAT [=] {DEFAULT|DYNAMIC|FIXED|COMPRESSED|REDUNDANT|COMPACT}
  | STATS_AUTO_RECALC [=] {DEFAULT|0|1}
  | STATS_PERSISTENT [=] {DEFAULT|0|1}
  | STATS_SAMPLE_PAGES [=] <em class="replaceable"><code>value</code></em>
  | TABLESPACE <em class="replaceable"><code>tablespace_name</code></em> [STORAGE {DISK|MEMORY}]
  | UNION [=] (<em class="replaceable"><code>tbl_name</code></em>[,<em class="replaceable"><code>tbl_name</code></em>]...)

<em class="replaceable"><code>partition_options</code></em>:
    PARTITION BY
        { [LINEAR] HASH(<em class="replaceable"><code>expr</code></em>)
        | [LINEAR] KEY [ALGORITHM={1|2}] (<em class="replaceable"><code>column_list</code></em>)
        | RANGE{(<em class="replaceable"><code>expr</code></em>) | COLUMNS(<em class="replaceable"><code>column_list</code></em>)}
        | LIST{(<em class="replaceable"><code>expr</code></em>) | COLUMNS(<em class="replaceable"><code>column_list</code></em>)} }
    [PARTITIONS <em class="replaceable"><code>num</code></em>]
    [SUBPARTITION BY
        { [LINEAR] HASH(<em class="replaceable"><code>expr</code></em>)
        | [LINEAR] KEY [ALGORITHM={1|2}] (<em class="replaceable"><code>column_list</code></em>) }
      [SUBPARTITIONS <em class="replaceable"><code>num</code></em>]
    ]
    [(<em class="replaceable"><code>partition_definition</code></em> [, <em class="replaceable"><code>partition_definition</code></em>] ...)]

<em class="replaceable"><code>partition_definition</code></em>:
    PARTITION <em class="replaceable"><code>partition_name</code></em>
        [VALUES
            {LESS THAN {(<em class="replaceable"><code>expr</code></em> | <em class="replaceable"><code>value_list</code></em>) | MAXVALUE}
            |
            IN (<em class="replaceable"><code>value_list</code></em>)}]
        [[STORAGE] ENGINE [=] <em class="replaceable"><code>engine_name</code></em>]
        [COMMENT [=] '<em class="replaceable"><code>string</code></em>' ]
        [DATA DIRECTORY [=] '<code class="filename"><em class="replaceable"><code>data_dir</code></em></code>']
        [INDEX DIRECTORY [=] '<code class="filename"><em class="replaceable"><code>index_dir</code></em></code>']
        [MAX_ROWS [=] <em class="replaceable"><code>max_number_of_rows</code></em>]
        [MIN_ROWS [=] <em class="replaceable"><code>min_number_of_rows</code></em>]
        [TABLESPACE [=] tablespace_name]
        [(<em class="replaceable"><code>subpartition_definition</code></em> [, <em class="replaceable"><code>subpartition_definition</code></em>] ...)]

<em class="replaceable"><code>subpartition_definition</code></em>:
    SUBPARTITION <em class="replaceable"><code>logical_name</code></em>
        [[STORAGE] ENGINE [=] <em class="replaceable"><code>engine_name</code></em>]
        [COMMENT [=] '<em class="replaceable"><code>string</code></em>' ]
        [DATA DIRECTORY [=] '<code class="filename"><em class="replaceable"><code>data_dir</code></em></code>']
        [INDEX DIRECTORY [=] '<code class="filename"><em class="replaceable"><code>index_dir</code></em></code>']
        [MAX_ROWS [=] <em class="replaceable"><code>max_number_of_rows</code></em>]
        [MIN_ROWS [=] <em class="replaceable"><code>min_number_of_rows</code></em>]
        [TABLESPACE [=] tablespace_name]

<em class="replaceable"><code>query_expression:</code></em>
    SELECT ...   (<em class="replaceable"><code>Some valid select or union statement</code></em>)
</pre><p>
      <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> creates a table with
      the given name. You must have the
      <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a> privilege for the table.
    </p><p>
      By default, tables are created in the default database, using the
      <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> storage engine. An error
      occurs if the table exists, if there is no default database, or if
      the database does not exist.
    </p><p>
      For information about the physical representation of a table, see
      <a class="xref" href="sql-syntax.html#create-table-files" title="13.1.20.2 Files Created by CREATE TABLE">Section 13.1.20.2, “Files Created by CREATE TABLE”</a>.
    </p><p>
      The original <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
      statement, including all specifications and table options are
      stored by MySQL when the table is created. For more information,
      see <a class="xref" href="sql-syntax.html#create-table-statement-retention" title="13.1.20.1 CREATE TABLE Statement Retention">Section 13.1.20.1, “CREATE TABLE Statement Retention”</a>.
    </p><p>
      There are several aspects to the <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
      TABLE</code></a> statement, described under the following topics in
      this section:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-table-name" title="Table Name">Table Name</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-table-temporary-tables" title="Temporary Tables">Temporary Tables</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-table-clone-copy" title="Table Cloning and Copying">Table Cloning and Copying</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-table-types-attributes" title="Column Data Types and Attributes">Column Data Types and Attributes</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-table-indexes-keys" title="Indexes, Foreign Keys, and CHECK Constraints">Indexes, Foreign Keys, and CHECK Constraints</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-table-options" title="Table Options">Table Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-table-partitioning" title="Table Partitioning">Table Partitioning</a></p></li></ul>
</div>
<h4><a name="create-table-name"></a>Table Name</h4>

<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal"><em class="replaceable"><code>tbl_name</code></em></code>
        </p><p>
          The table name can be specified as
          <em class="replaceable"><code>db_name.tbl_name</code></em> to create the
          table in a specific database. This works regardless of whether
          there is a default database, assuming that the database
          exists. If you use quoted identifiers, quote the database and
          table names separately. For example, write
          <code class="literal">`mydb`.`mytbl`</code>, not
          <code class="literal">`mydb.mytbl`</code>.
        </p><p>
          Rules for permissible table names are given in
          <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">IF NOT EXISTS</code>
        </p><p>
          Prevents an error from occurring if the table exists. However,
          there is no verification that the existing table has a
          structure identical to that indicated by the
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement.
</p></li></ul>
</div>
<h4><a name="create-table-temporary-tables"></a>Temporary Tables</h4>
<p>
      You can use the <code class="literal">TEMPORARY</code> keyword when creating
      a table. A <code class="literal">TEMPORARY</code> table is visible only
      within the current session, and is dropped automatically when the
      session is closed. For more information, see
      <a class="xref" href="sql-syntax.html#create-temporary-table" title="13.1.20.3 CREATE TEMPORARY TABLE Syntax">Section 13.1.20.3, “CREATE TEMPORARY TABLE Syntax”</a>.
</p>
<h4><a name="create-table-clone-copy"></a>Table Cloning and Copying</h4>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">LIKE</code>
        </p><p>
          Use <code class="literal">CREATE TABLE ... LIKE</code> to create an
          empty table based on the definition of another table,
          including any column attributes and indexes defined in the
          original table:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE <em class="replaceable"><code>new_tbl</code></em> LIKE <em class="replaceable"><code>orig_tbl</code></em>;
</pre><p>
          For more information, see <a class="xref" href="sql-syntax.html#create-table-like" title="13.1.20.4 CREATE TABLE ... LIKE Syntax">Section 13.1.20.4, “CREATE TABLE ... LIKE Syntax”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">[AS]
          <em class="replaceable"><code>query_expression</code></em></code>
        </p><p>
          To create one table from another, add a
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement at the end of
          the <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE <em class="replaceable"><code>new_tbl</code></em> AS SELECT * FROM <em class="replaceable"><code>orig_tbl</code></em>;
</pre><p>
          For more information, see
          <a class="xref" href="sql-syntax.html#create-table-select" title="13.1.20.5 CREATE TABLE ... SELECT Syntax">Section 13.1.20.5, “CREATE TABLE ... SELECT Syntax”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">IGNORE|REPLACE</code>
        </p><p>
          The <code class="literal">IGNORE</code> and <code class="literal">REPLACE</code>
          options indicate how to handle rows that duplicate unique key
          values when copying a table using a
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
        </p><p>
          For more information, see
          <a class="xref" href="sql-syntax.html#create-table-select" title="13.1.20.5 CREATE TABLE ... SELECT Syntax">Section 13.1.20.5, “CREATE TABLE ... SELECT Syntax”</a>.
</p></li></ul>
</div>
<h4><a name="create-table-types-attributes"></a>Column Data Types and Attributes</h4>
<p>
      There is a hard limit of 4096 columns per table, but the effective
      maximum may be less for a given table and depends on the factors
      discussed in <a class="xref" href="restrictions.html#column-count-limit" title="C.10.4 Limits on Table Column Count and Row Size">Section C.10.4, “Limits on Table Column Count and Row Size”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal"><em class="replaceable"><code>data_type</code></em></code>
        </p><p>
          <em class="replaceable"><code>data_type</code></em> represents the data type
          in a column definition. For a full description of the syntax
          available for specifying column data types, as well as
          information about the properties of each type, see
          <a class="xref" href="data-types.html" title="Chapter 11 Data Types">Chapter 11, <i>Data Types</i></a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Some attributes do not apply to all data types.
              <code class="literal">AUTO_INCREMENT</code> applies only to integer
              and floating-point types. Prior to MySQL 8.0.13,
              <code class="literal">DEFAULT</code> does not apply to the
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>,
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>,
              <code class="literal">GEOMETRY</code>, and
              <a class="link" href="data-types.html#json" title="11.6 The JSON Data Type"><code class="literal">JSON</code></a> types.
            </p></li><li class="listitem"><p>
              Character data types (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
              <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, the
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> types,
              <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a>,
              <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a>, and any synonyms)
              synonyms) can include <code class="literal">CHARACTER SET</code> to
              specify the character set for the column.
              <code class="literal">CHARSET</code> is a synonym for
              <code class="literal">CHARACTER SET</code>. A collation for the
              character set can be specified with the
              <code class="literal">COLLATE</code> attribute, along with any other
              attributes. For details, see <a class="xref" href="charset.html" title="Chapter 10 Character Sets, Collations, Unicode">Chapter 10, <i>Character Sets, Collations, Unicode</i></a>.
              Example:
            </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t (c CHAR(20) CHARACTER SET utf8 COLLATE utf8_bin);
</pre><p>
              MySQL 8.0 interprets length specifications in
              character column definitions in characters. Lengths for
              <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a> and
              <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> are in bytes.
            </p></li><li class="listitem"><p>
              For <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
              <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
              <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>, and
              <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> columns, indexes
              can be created that use only the leading part of column
              values, using
              <code class="literal"><em class="replaceable"><code>col_name</code></em>(<em class="replaceable"><code>length</code></em>)</code>
              syntax to specify an index prefix length.
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> and
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns also can be
              indexed, but a prefix length <span class="emphasis"><em>must</em></span> be
              given. Prefix lengths are given in characters for
              nonbinary string types and in bytes for binary string
              types. That is, index entries consist of the first
              <em class="replaceable"><code>length</code></em> characters of each
              column value for <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
              <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, and
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns, and the first
              <em class="replaceable"><code>length</code></em> bytes of each column
              value for <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
              <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>, and
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> columns. Indexing only
              a prefix of column values like this can make the index
              file much smaller. For additional information about index
              prefixes, see <a class="xref" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax">Section 13.1.15, “CREATE INDEX Syntax”</a>.
            </p><a class="indexterm" name="idm140091669755040"></a><a class="indexterm" name="idm140091669753552"></a><a class="indexterm" name="idm140091669752064"></a><a class="indexterm" name="idm140091669750576"></a><p>
              Only the <code class="literal">InnoDB</code> and
              <code class="literal">MyISAM</code> storage engines support indexing
              on <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> and
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns. For example:
            </p><pre data-lang="sql" class="programlisting">
CREATE TABLE test (blob_col BLOB, INDEX(blob_col(10)));
</pre><p>
              If a specified index prefix exceeds the maximum column
              data type size, <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
              TABLE</code></a> handles the index as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  For a nonunique index, either an error occurs (if
                  strict SQL mode is enabled), or the index length is
                  reduced to lie within the maximum column data type
                  size and a warning is produced (if strict SQL mode is
                  not enabled).
                </p></li><li class="listitem"><p>
                  For a unique index, an error occurs regardless of SQL
                  mode because reducing the index length might enable
                  insertion of nonunique entries that do not meet the
                  specified uniqueness requirement.
</p></li></ul>
</div>
</li><li class="listitem"><p>
              <a class="link" href="data-types.html#json" title="11.6 The JSON Data Type"><code class="literal">JSON</code></a> columns cannot be
              indexed. You can work around this restriction by creating
              an index on a generated column that extracts a scalar
              value from the <code class="literal">JSON</code> column. See
              <a class="xref" href="sql-syntax.html#json-column-indirect-index" title="Indexing a Generated Column to Provide a JSON Column Index">Indexing a Generated Column to Provide a JSON Column Index</a>, for a
              detailed example.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal">NOT NULL | NULL</code>
        </p><a class="indexterm" name="idm140091669733968"></a><a class="indexterm" name="idm140091669732480"></a><p>
          If neither <code class="literal">NULL</code> nor <code class="literal">NOT
          NULL</code> is specified, the column is treated as though
          <code class="literal">NULL</code> had been specified.
        </p><p>
          In MySQL 8.0, only the <code class="literal">InnoDB</code>,
          <code class="literal">MyISAM</code>, and <code class="literal">MEMORY</code>
          storage engines support indexes on columns that can have
          <code class="literal">NULL</code> values. In other cases, you must
          declare indexed columns as <code class="literal">NOT NULL</code> or an
          error results.
        </p></li><li class="listitem"><p>
          <code class="literal">DEFAULT</code>
        </p><a class="indexterm" name="idm140091669722768"></a><a class="indexterm" name="idm140091669721696"></a><p>
          Specifies a default value for a column. For more information
          about default value handling, including the case that a column
          definition includes no explicit <code class="literal">DEFAULT</code>
          value, see <a class="xref" href="data-types.html#data-type-defaults" title="11.7 Data Type Default Values">Section 11.7, “Data Type Default Values”</a>.
        </p><p>
          If the <a class="link" href="server-administration.html#sqlmode_no_zero_date"><code class="literal">NO_ZERO_DATE</code></a> or
          <a class="link" href="server-administration.html#sqlmode_no_zero_in_date"><code class="literal">NO_ZERO_IN_DATE</code></a> SQL mode is
          enabled and a date-valued default is not correct according to
          that mode, <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
          produces a warning if strict SQL mode is not enabled and an
          error if strict mode is enabled. For example, with
          <a class="link" href="server-administration.html#sqlmode_no_zero_in_date"><code class="literal">NO_ZERO_IN_DATE</code></a> enabled,
          <code class="literal">c1 DATE DEFAULT '2010-00-00'</code> produces a
          warning.
        </p></li><li class="listitem"><p>
          <code class="literal">AUTO_INCREMENT</code>
        </p><p>
          An integer or floating-point column can have the additional
          attribute <code class="literal">AUTO_INCREMENT</code>. When you insert a
          value of <code class="literal">NULL</code> (recommended) or
          <code class="literal">0</code> into an indexed
          <code class="literal">AUTO_INCREMENT</code> column, the column is set to
          the next sequence value. Typically this is
          <code class="literal"><em class="replaceable"><code>value</code></em>+1</code>, where
          <em class="replaceable"><code>value</code></em> is the largest value for the
          column currently in the table.
          <code class="literal">AUTO_INCREMENT</code> sequences begin with
          <code class="literal">1</code>.
        </p><p>
          To retrieve an <code class="literal">AUTO_INCREMENT</code> value after
          inserting a row, use the
          <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> SQL function
          or the <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> C API
          function. See <a class="xref" href="functions.html#information-functions" title="12.15 Information Functions">Section 12.15, “Information Functions”</a>, and
          <a class="xref" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id()">Section 28.7.7.38, “mysql_insert_id()”</a>.
        </p><p>
          If the <a class="link" href="server-administration.html#sqlmode_no_auto_value_on_zero"><code class="literal">NO_AUTO_VALUE_ON_ZERO</code></a>
          SQL mode is enabled, you can store <code class="literal">0</code> in
          <code class="literal">AUTO_INCREMENT</code> columns as
          <code class="literal">0</code> without generating a new sequence value.
          See <a class="xref" href="server-administration.html#sql-mode" title="5.1.11 Server SQL Modes">Section 5.1.11, “Server SQL Modes”</a>.
        </p><p>
          There can be only one <code class="literal">AUTO_INCREMENT</code> column
          per table, it must be indexed, and it cannot have a
          <code class="literal">DEFAULT</code> value. An
          <code class="literal">AUTO_INCREMENT</code> column works properly only
          if it contains only positive values. Inserting a negative
          number is regarded as inserting a very large positive number.
          This is done to avoid precision problems when numbers
          <span class="quote">“<span class="quote">wrap</span>”</span> over from positive to negative and also to
          ensure that you do not accidentally get an
          <code class="literal">AUTO_INCREMENT</code> column that contains
          <code class="literal">0</code>.
        </p><p>
          For <code class="literal">MyISAM</code> tables, you can specify an
          <code class="literal">AUTO_INCREMENT</code> secondary column in a
          multiple-column key. See
          <a class="xref" href="tutorial.html#example-auto-increment" title="3.6.9 Using AUTO_INCREMENT">Section 3.6.9, “Using AUTO_INCREMENT”</a>.
        </p><a class="indexterm" name="idm140091669687344"></a><a class="indexterm" name="idm140091669686272"></a><p>
          To make MySQL compatible with some ODBC applications, you can
          find the <code class="literal">AUTO_INCREMENT</code> value for the last
          inserted row with the following query:
        </p><pre data-lang="sql" class="programlisting">
SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>auto_col</code></em> IS NULL
</pre><p>
          This method requires that
          <a class="link" href="server-administration.html#sysvar_sql_auto_is_null"><code class="literal">sql_auto_is_null</code></a> variable is
          not set to 0. See <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>.
        </p><p>
          For information about <code class="literal">InnoDB</code> and
          <code class="literal">AUTO_INCREMENT</code>, see
          <a class="xref" href="innodb-storage-engine.html#innodb-auto-increment-handling" title="15.6.1.4 AUTO_INCREMENT Handling in InnoDB">Section 15.6.1.4, “AUTO_INCREMENT Handling in InnoDB”</a>. For
          information about <code class="literal">AUTO_INCREMENT</code> and MySQL
          Replication, see
          <a class="xref" href="replication.html#replication-features-auto-increment" title="17.4.1.1 Replication and AUTO_INCREMENT">Section 17.4.1.1, “Replication and AUTO_INCREMENT”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">COMMENT</code>
        </p><a class="indexterm" name="idm140091669673744"></a><p>
          A comment for a column can be specified with the
          <code class="literal">COMMENT</code> option, up to 1024 characters long.
          The comment is displayed by the <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW
          CREATE TABLE</code></a> and
          <a class="link" href="sql-syntax.html#show-columns" title="13.7.6.5 SHOW COLUMNS Syntax"><code class="literal">SHOW FULL
          COLUMNS</code></a> statements.
        </p></li><li class="listitem"><p>
          <code class="literal">COLUMN_FORMAT</code>
        </p><a class="indexterm" name="idm140091669667520"></a><p>
          In NDB Cluster, it is also possible to specify a data storage
          format for individual columns of
          <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables using
          <code class="literal">COLUMN_FORMAT</code>. Permissible column formats
          are <code class="literal">FIXED</code>, <code class="literal">DYNAMIC</code>, and
          <code class="literal">DEFAULT</code>. <code class="literal">FIXED</code> is used
          to specify fixed-width storage, <code class="literal">DYNAMIC</code>
          permits the column to be variable-width, and
          <code class="literal">DEFAULT</code> causes the column to use
          fixed-width or variable-width storage as determined by the
          column's data type (possibly overridden by a
          <code class="literal">ROW_FORMAT</code> specifier).
        </p><p>
          For <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables, the default value
          for <code class="literal">COLUMN_FORMAT</code> is
          <code class="literal">FIXED</code>.
        </p><p>
          In NDB Cluster, the maximum possible offset for a column
          defined with <code class="literal">COLUMN_FORMAT=FIXED</code> is 8188
          bytes. For more information and possible workarounds, see
          <a class="xref" href="mysql-cluster.html#mysql-cluster-limitations-database-objects" title="22.1.7.5 Limits Associated with Database Objects in NDB Cluster">Section 22.1.7.5, “Limits Associated with Database Objects in NDB Cluster”</a>.
        </p><p>
          <code class="literal">COLUMN_FORMAT</code> currently has no effect on
          columns of tables using storage engines other than
          <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a>. MySQL 8.0
          silently ignores <code class="literal">COLUMN_FORMAT</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">STORAGE</code>
        </p><a class="indexterm" name="idm140091669649008"></a><p>
          For <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables, it is possible to
          specify whether the column is stored on disk or in memory by
          using a <code class="literal">STORAGE</code> clause. <code class="literal">STORAGE
          DISK</code> causes the column to be stored on disk, and
          <code class="literal">STORAGE MEMORY</code> causes in-memory storage to
          be used. The <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
          statement used must still include a
          <code class="literal">TABLESPACE</code> clause:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
    -&gt;     <strong class="userinput"><code>c1 INT STORAGE DISK,</code></strong>
    -&gt;     <strong class="userinput"><code>c2 INT STORAGE MEMORY</code></strong>
    -&gt; <strong class="userinput"><code>) ENGINE NDB;</code></strong>
<span class="errortext">ERROR 1005 (HY000): Can't create table 'c.t1' (errno: 140)</span>

mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
    -&gt;     <strong class="userinput"><code>c1 INT STORAGE DISK,</code></strong>
    -&gt;     <strong class="userinput"><code>c2 INT STORAGE MEMORY</code></strong>
    -&gt; <strong class="userinput"><code>) TABLESPACE ts_1 ENGINE NDB;</code></strong>
Query OK, 0 rows affected (1.06 sec)
</pre><p>
          For <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables, <code class="literal">STORAGE
          DEFAULT</code> is equivalent to <code class="literal">STORAGE
          MEMORY</code>.
        </p><p>
          The <code class="literal">STORAGE</code> clause has no effect on tables
          using storage engines other than
          <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a>. The
          <code class="literal">STORAGE</code> keyword is supported only in the
          build of <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> that is supplied with NDB
          Cluster; it is not recognized in any other version of MySQL,
          where any attempt to use the <code class="literal">STORAGE</code>
          keyword causes a syntax error.
        </p></li><li class="listitem"><p>
          <code class="literal">GENERATED ALWAYS</code>
        </p><p>
          Used to specify a generated column expression. For information
          about <a class="link" href="glossary.html#glos_generated_column" title="generated column">generated
          columns</a>, see
          <a class="xref" href="sql-syntax.html#create-table-generated-columns" title="13.1.20.9 CREATE TABLE and Generated Columns">Section 13.1.20.9, “CREATE TABLE and Generated Columns”</a>.
        </p><p>
          <a class="link" href="glossary.html#glos_stored_generated_column" title="stored generated column">Stored generated
          columns</a> can be indexed. <code class="literal">InnoDB</code>
          supports secondary indexes on
          <a class="link" href="glossary.html#glos_virtual_generated_column" title="virtual generated column">virtual
          generated columns</a>. See
          <a class="xref" href="sql-syntax.html#create-table-secondary-indexes" title="13.1.20.10 Secondary Indexes and Generated Columns">Section 13.1.20.10, “Secondary Indexes and Generated Columns”</a>.
</p></li></ul>
</div>
<h4><a name="create-table-indexes-keys"></a>Indexes, Foreign Keys, and CHECK Constraints</h4>
<p>
      Several keywords apply to creation of indexes, foreign keys, and
      <code class="literal">CHECK</code> constraints. For general background in
      addition to the following descriptions, see
      <a class="xref" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax">Section 13.1.15, “CREATE INDEX Syntax”</a>,
      <a class="xref" href="sql-syntax.html#create-table-foreign-keys" title="13.1.20.6 Using FOREIGN KEY Constraints">Section 13.1.20.6, “Using FOREIGN KEY Constraints”</a>, and
      <a class="xref" href="sql-syntax.html#create-table-check-constraints" title="13.1.20.7 CHECK Constraints">Section 13.1.20.7, “CHECK Constraints”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">CONSTRAINT
          <em class="replaceable"><code>symbol</code></em></code>
        </p><p>
          The <code class="literal">CONSTRAINT
          <em class="replaceable"><code>symbol</code></em></code> clause may be
          given to name a constraint. If the clause is not given, or a
          <em class="replaceable"><code>symbol</code></em> is not included following
          the <code class="literal">CONSTRAINT</code> keyword, MySQL automatically
          generates a constraint name, with the exception noted below.
          The <em class="replaceable"><code>symbol</code></em> value, if used, must be
          unique per schema (database), per constraint type. A duplicate
          <em class="replaceable"><code>symbol</code></em> results in an error.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            If the <code class="literal">CONSTRAINT
            <em class="replaceable"><code>symbol</code></em></code> clause is not
            given in a foreign key definition, or a
            <em class="replaceable"><code>symbol</code></em> is not included following
            the <code class="literal">CONSTRAINT</code> keyword, MySQL uses the
            foreign key index name up to MySQL 8.0.15, and automatically
            generates a constraint name thereafter.
</p>
</div>
<p>
          The SQL standard specifies that all types of constraints
          (primary key, unique index, foreign key, check) belong to the
          same namespace. In MySQL, each constraint type has its own
          namespace per schema. Consequently, names for each type of
          constraint must be unique per schema.
        </p></li><li class="listitem"><p>
          <code class="literal">PRIMARY KEY</code>
        </p><a class="indexterm" name="idm140091669603216"></a><p>
          A unique index where all key columns must be defined as
          <code class="literal">NOT NULL</code>. If they are not explicitly
          declared as <code class="literal">NOT NULL</code>, MySQL declares them
          so implicitly (and silently). A table can have only one
          <code class="literal">PRIMARY KEY</code>. The name of a <code class="literal">PRIMARY
          KEY</code> is always <code class="literal">PRIMARY</code>, which thus
          cannot be used as the name for any other kind of index.
        </p><p>
          If you do not have a <code class="literal">PRIMARY KEY</code> and an
          application asks for the <code class="literal">PRIMARY KEY</code> in
          your tables, MySQL returns the first <code class="literal">UNIQUE</code>
          index that has no <code class="literal">NULL</code> columns as the
          <code class="literal">PRIMARY KEY</code>.
        </p><p>
          In <code class="literal">InnoDB</code> tables, keep the <code class="literal">PRIMARY
          KEY</code> short to minimize storage overhead for secondary
          indexes. Each secondary index entry contains a copy of the
          primary key columns for the corresponding row. (See
          <a class="xref" href="innodb-storage-engine.html#innodb-index-types" title="15.6.2.1 Clustered and Secondary Indexes">Section 15.6.2.1, “Clustered and Secondary Indexes”</a>.)
        </p><p>
          In the created table, a <code class="literal">PRIMARY KEY</code> is
          placed first, followed by all <code class="literal">UNIQUE</code>
          indexes, and then the nonunique indexes. This helps the MySQL
          optimizer to prioritize which index to use and also more
          quickly to detect duplicated <code class="literal">UNIQUE</code> keys.
        </p><p>
          A <code class="literal">PRIMARY KEY</code> can be a multiple-column
          index. However, you cannot create a multiple-column index
          using the <code class="literal">PRIMARY KEY</code> key attribute in a
          column specification. Doing so only marks that single column
          as primary. You must use a separate <code class="literal">PRIMARY
          KEY(<em class="replaceable"><code>key_part</code></em>, ...)</code>
          clause.
        </p><a class="indexterm" name="idm140091669585008"></a><p>
          If a table has a <code class="literal">PRIMARY KEY</code> or
          <code class="literal">UNIQUE NOT NULL</code> index that consists of a
          single column that has an integer type, you can use
          <code class="literal">_rowid</code> to refer to the indexed column in
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements, as described
          in <a class="xref" href="sql-syntax.html#create-index-unique" title="Unique Indexes">Unique Indexes</a>.
        </p><p>
          In MySQL, the name of a <code class="literal">PRIMARY KEY</code> is
          <code class="literal">PRIMARY</code>. For other indexes, if you do not
          assign a name, the index is assigned the same name as the
          first indexed column, with an optional suffix
          (<code class="literal">_2</code>, <code class="literal">_3</code>,
          <code class="literal">...</code>) to make it unique. You can see index
          names for a table using <code class="literal">SHOW INDEX FROM
          <em class="replaceable"><code>tbl_name</code></em></code>. See
          <a class="xref" href="sql-syntax.html#show-index" title="13.7.6.22 SHOW INDEX Syntax">Section 13.7.6.22, “SHOW INDEX Syntax”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">KEY | INDEX</code>
        </p><p>
          <code class="literal">KEY</code> is normally a synonym for
          <code class="literal">INDEX</code>. The key attribute <code class="literal">PRIMARY
          KEY</code> can also be specified as just
          <code class="literal">KEY</code> when given in a column definition. This
          was implemented for compatibility with other database systems.
        </p></li><li class="listitem"><p>
          <code class="literal">UNIQUE</code>
        </p><p>
          A <code class="literal">UNIQUE</code> index creates a constraint such
          that all values in the index must be distinct. An error occurs
          if you try to add a new row with a key value that matches an
          existing row. For all engines, a <code class="literal">UNIQUE</code>
          index permits multiple <code class="literal">NULL</code> values for
          columns that can contain <code class="literal">NULL</code>. If you
          specify a prefix value for a column in a
          <code class="literal">UNIQUE</code> index, the column values must be
          unique within the prefix length.
        </p><a class="indexterm" name="idm140091669562320"></a><p>
          If a table has a <code class="literal">PRIMARY KEY</code> or
          <code class="literal">UNIQUE NOT NULL</code> index that consists of a
          single column that has an integer type, you can use
          <code class="literal">_rowid</code> to refer to the indexed column in
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements, as described
          in <a class="xref" href="sql-syntax.html#create-index-unique" title="Unique Indexes">Unique Indexes</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">FULLTEXT</code>
        </p><p>
          A <code class="literal">FULLTEXT</code> index is a special type of index
          used for full-text searches. Only the
          <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
          <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> storage engines support
          <code class="literal">FULLTEXT</code> indexes. They can be created only
          from <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns. Indexing always
          happens over the entire column; column prefix indexing is not
          supported and any prefix length is ignored if specified. See
          <a class="xref" href="functions.html#fulltext-search" title="12.9 Full-Text Search Functions">Section 12.9, “Full-Text Search Functions”</a>, for details of operation. A
          <code class="literal">WITH PARSER</code> clause can be specified as an
          <em class="replaceable"><code>index_option</code></em> value to associate a
          parser plugin with the index if full-text indexing and
          searching operations need special handling. This clause is
          valid only for <code class="literal">FULLTEXT</code> indexes.
          <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
          <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> support full-text parser
          plugins. See <a class="xref" href="extending-mysql.html#full-text-plugin-type" title="Full-Text Parser Plugins">Full-Text Parser Plugins</a> and
          <a class="xref" href="extending-mysql.html#writing-full-text-plugins" title="29.2.4.4 Writing Full-Text Parser Plugins">Section 29.2.4.4, “Writing Full-Text Parser Plugins”</a> for more
          information.
        </p></li><li class="listitem"><p>
          <code class="literal">SPATIAL</code>
        </p><p>
          You can create <code class="literal">SPATIAL</code> indexes on spatial
          data types. Spatial types are supported only for
          <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code>
          tables, and indexed columns must be declared as <code class="literal">NOT
          NULL</code>. See <a class="xref" href="data-types.html#spatial-types" title="11.5 Spatial Data Types">Section 11.5, “Spatial Data Types”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">FOREIGN KEY</code>
        </p><p>
          MySQL supports foreign keys, which let you cross-reference
          related data across tables, and foreign key constraints, which
          help keep this spread-out data consistent. For definition and
          option information, see
          <a class="link" href="sql-syntax.html#create-table-reference-definition"><em class="replaceable"><code>reference_definition</code></em></a>,
          and
          <a class="link" href="sql-syntax.html#create-table-reference-option"><em class="replaceable"><code>reference_option</code></em></a>.
        </p><p>
          Partitioned tables employing the
          <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> storage engine do not
          support foreign keys. See
          <a class="xref" href="partitioning.html#partitioning-limitations" title="23.6 Restrictions and Limitations on Partitioning">Section 23.6, “Restrictions and Limitations on Partitioning”</a>, for more
          information.
        </p></li><li class="listitem"><p>
          <code class="literal">CHECK</code>
        </p><p>
          The <code class="literal">CHECK</code> clause enables the creation of
          constraints to be checked for data values in table rows. See
          <a class="xref" href="sql-syntax.html#create-table-check-constraints" title="13.1.20.7 CHECK Constraints">Section 13.1.20.7, “CHECK Constraints”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal"><em class="replaceable"><code>key_part</code></em></code>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              A <em class="replaceable"><code>key_part</code></em> specification can
              end with <code class="literal">ASC</code> or <code class="literal">DESC</code>
              to specify whether index values are stored in ascending or
              descending order. The default is ascending if no order
              specifier is given.
            </p></li><li class="listitem"><p>
              Prefixes, defined by the <em class="replaceable"><code>length</code></em>
              attribute, can be up to 767 bytes long for
              <code class="literal">InnoDB</code> tables that use the
              <code class="literal"><a class="link" href="glossary.html#glos_redundant_row_format" title="redundant row format">REDUNDANT</a></code>
              or
              <code class="literal"><a class="link" href="glossary.html#glos_compact_row_format" title="compact row format">COMPACT</a></code>
              row format. The prefix length limit is 3072 bytes for
              <code class="literal">InnoDB</code> tables that use the
              <code class="literal"><a class="link" href="glossary.html#glos_dynamic_row_format" title="dynamic row format">DYNAMIC</a></code>
              or
              <code class="literal"><a class="link" href="glossary.html#glos_compressed_row_format" title="compressed row format">COMPRESSED</a></code>
              row format. For <code class="literal">MyISAM</code> tables, the
              prefix length limit is 1000 bytes.
            </p><p>
              Prefix <span class="emphasis"><em>limits</em></span> are measured in bytes.
              However, prefix <span class="emphasis"><em>lengths</em></span> for index
              specifications in <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
              TABLE</code></a>, <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
              TABLE</code></a>, and <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE
              INDEX</code></a> statements are interpreted as number of
              characters for nonbinary string types
              (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
              <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>) and number of bytes
              for binary string types
              (<a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
              <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>,
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>). Take this into
              account when specifying a prefix length for a nonbinary
              string column that uses a multibyte character set.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal"><em class="replaceable"><code>index_type</code></em></code>
        </p><p>
          Some storage engines permit you to specify an index type when
          creating an index. The syntax for the
          <em class="replaceable"><code>index_type</code></em> specifier is
          <code class="literal">USING <em class="replaceable"><code>type_name</code></em></code>.
        </p><p>
          Example:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE lookup
  (id INT, INDEX USING BTREE (id))
  ENGINE = MEMORY;
</pre><p>
          The preferred position for <code class="literal">USING</code> is after
          the index column list. It can be given before the column list,
          but support for use of the option in that position is
          deprecated and will be removed in a future MySQL release.
        </p></li><li class="listitem"><p>
          <code class="literal"><em class="replaceable"><code>index_option</code></em></code>
        </p><p>
          <em class="replaceable"><code>index_option</code></em> values specify
          additional options for an index.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">KEY_BLOCK_SIZE</code>
            </p><p>
              For <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> tables,
              <code class="literal">KEY_BLOCK_SIZE</code> optionally specifies the
              size in bytes to use for index key blocks. The value is
              treated as a hint; a different size could be used if
              necessary. A <code class="literal">KEY_BLOCK_SIZE</code> value
              specified for an individual index definition overrides the
              table-level <code class="literal">KEY_BLOCK_SIZE</code> value.
            </p><p>
              For information about the table-level
              <code class="literal">KEY_BLOCK_SIZE</code> attribute, see
              <a class="xref" href="sql-syntax.html#create-table-options" title="Table Options">Table Options</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">WITH PARSER</code>
            </p><p>
              The <code class="literal">WITH PARSER</code> option can only be used
              with <code class="literal">FULLTEXT</code> indexes. It associates a
              parser plugin with the index if full-text indexing and
              searching operations need special handling.
              <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
              <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> support full-text
              parser plugins. If you have a
              <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> table with an
              associated full-text parser plugin, you can convert the
              table to <code class="literal">InnoDB</code> using <code class="literal">ALTER
              TABLE</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">COMMENT</code>
            </p><p>
              In MySQL 8.0, index definitions can include
              an optional comment of up to 1024 characters.
            </p><p>
              You can set the <code class="literal">InnoDB</code>
              <code class="literal">MERGE_THRESHOLD</code> value for an individual
              index using the
              <code class="literal"><em class="replaceable"><code>index_option</code></em></code>
              <code class="literal">COMMENT</code> clause. See
              <a class="xref" href="innodb-storage-engine.html#index-page-merge-threshold" title="15.8.11 Configuring the Merge Threshold for Index Pages">Section 15.8.11, “Configuring the Merge Threshold for Index Pages”</a>.
</p></li></ul>
</div>
<p>
          For more information about permissible
          <em class="replaceable"><code>index_option</code></em> values, see
          <a class="xref" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax">Section 13.1.15, “CREATE INDEX Syntax”</a>. For more information about
          indexes, see <a class="xref" href="optimization.html#mysql-indexes" title="8.3.1 How MySQL Uses Indexes">Section 8.3.1, “How MySQL Uses Indexes”</a>.
        </p></li><li class="listitem"><p><a name="create-table-reference-definition"></a>
          <code class="literal"><em class="replaceable"><code>reference_definition</code></em></code>
        </p><p>
          For <em class="replaceable"><code>reference_definition</code></em> syntax
          details and examples, see
          <a class="xref" href="sql-syntax.html#create-table-foreign-keys" title="13.1.20.6 Using FOREIGN KEY Constraints">Section 13.1.20.6, “Using FOREIGN KEY Constraints”</a>. For information
          specific to foreign keys in <code class="literal">InnoDB</code>, see
          <a class="xref" href="innodb-storage-engine.html#innodb-foreign-key-constraints" title="15.6.1.5 InnoDB and FOREIGN KEY Constraints">Section 15.6.1.5, “InnoDB and FOREIGN KEY Constraints”</a>.
        </p><p>
          <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
          <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables support checking of
          foreign key constraints. The columns of the referenced table
          must always be explicitly named. Both <code class="literal">ON
          DELETE</code> and <code class="literal">ON UPDATE</code> actions on
          foreign keys are supported. For more detailed information and
          examples, see <a class="xref" href="sql-syntax.html#create-table-foreign-keys" title="13.1.20.6 Using FOREIGN KEY Constraints">Section 13.1.20.6, “Using FOREIGN KEY Constraints”</a>. For
          information specific to foreign keys in
          <code class="literal">InnoDB</code>, see
          <a class="xref" href="innodb-storage-engine.html#innodb-foreign-key-constraints" title="15.6.1.5 InnoDB and FOREIGN KEY Constraints">Section 15.6.1.5, “InnoDB and FOREIGN KEY Constraints”</a>.
        </p><p>
          For other storage engines, MySQL Server parses and ignores the
          <code class="literal">FOREIGN KEY</code> and
          <code class="literal">REFERENCES</code> syntax in
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statements. See
          <a class="xref" href="introduction.html#ansi-diff-foreign-keys" title="1.8.2.3 Foreign Key Differences">Section 1.8.2.3, “Foreign Key Differences”</a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            For users familiar with the ANSI/ISO SQL Standard, please
            note that no storage engine, including
            <code class="literal">InnoDB</code>, recognizes or enforces the
            <code class="literal">MATCH</code> clause used in referential
            integrity constraint definitions. Use of an explicit
            <code class="literal">MATCH</code> clause will not have the specified
            effect, and also causes <code class="literal">ON DELETE</code> and
            <code class="literal">ON UPDATE</code> clauses to be ignored. For
            these reasons, specifying <code class="literal">MATCH</code> should be
            avoided.
          </p><p>
            The <code class="literal">MATCH</code> clause in the SQL standard
            controls how <code class="literal">NULL</code> values in a composite
            (multiple-column) foreign key are handled when comparing to
            a primary key. <code class="literal">InnoDB</code> essentially
            implements the semantics defined by <code class="literal">MATCH
            SIMPLE</code>, which permit a foreign key to be all or
            partially <code class="literal">NULL</code>. In that case, the (child
            table) row containing such a foreign key is permitted to be
            inserted, and does not match any row in the referenced
            (parent) table. It is possible to implement other semantics
            using triggers.
          </p><p>
            Additionally, MySQL requires that the referenced columns be
            indexed for performance. However, <code class="literal">InnoDB</code>
            does not enforce any requirement that the referenced columns
            be declared <code class="literal">UNIQUE</code> or <code class="literal">NOT
            NULL</code>. The handling of foreign key references to
            nonunique keys or keys that contain <code class="literal">NULL</code>
            values is not well defined for operations such as
            <code class="literal">UPDATE</code> or <code class="literal">DELETE
            CASCADE</code>. You are advised to use foreign keys that
            reference only keys that are both <code class="literal">UNIQUE</code>
            (or <code class="literal">PRIMARY</code>) and <code class="literal">NOT
            NULL</code>.
          </p><p>
            MySQL parses but ignores <span class="quote">“<span class="quote">inline
            <code class="literal">REFERENCES</code> specifications</span>”</span> (as
            defined in the SQL standard) where the references are
            defined as part of the column specification. MySQL accepts
            <code class="literal">REFERENCES</code> clauses only when specified as
            part of a separate <code class="literal">FOREIGN KEY</code>
            specification.
</p>
</div>
</li><li class="listitem"><p><a name="create-table-reference-option"></a>
          <code class="literal"><em class="replaceable"><code>reference_option</code></em></code>
        </p><p>
          For information about the <code class="literal">RESTRICT</code>,
          <code class="literal">CASCADE</code>, <code class="literal">SET NULL</code>,
          <code class="literal">NO ACTION</code>, and <code class="literal">SET
          DEFAULT</code> options, see
          <a class="xref" href="sql-syntax.html#create-table-foreign-keys" title="13.1.20.6 Using FOREIGN KEY Constraints">Section 13.1.20.6, “Using FOREIGN KEY Constraints”</a>.
</p></li></ul>
</div>
<h4><a name="create-table-options"></a>Table Options</h4>
<p>
      Table options are used to optimize the behavior of the table. In
      most cases, you do not have to specify any of them. These options
      apply to all storage engines unless otherwise indicated. Options
      that do not apply to a given storage engine may be accepted and
      remembered as part of the table definition. Such options then
      apply if you later use <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
      to convert the table to use a different storage engine.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">ENGINE</code>
        </p><p>
          Specifies the storage engine for the table, using one of the
          names shown in the following table. The engine name can be
          unquoted or quoted. The quoted name
          <code class="literal">'DEFAULT'</code> is recognized but ignored.
</p>
<div class="informaltable">
<table summary="Storage engine names permitted for the ENGINE table option and a description of each engine."><col width="25%"><col width="70%"><thead><tr>
              <th scope="col">Storage Engine</th>
              <th scope="col">Description</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">InnoDB</code></td>
              <td>Transaction-safe tables with row locking and foreign keys. The default
                storage engine for new tables. See
                <a class="xref" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine">Chapter 15, <i>The InnoDB Storage Engine</i></a>, and in
                particular <a class="xref" href="innodb-storage-engine.html#innodb-introduction" title="15.1 Introduction to InnoDB">Section 15.1, “Introduction to InnoDB”</a> if you
                have MySQL experience but are new to
                <code class="literal">InnoDB</code>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">MyISAM</code></td>
              <td>The binary portable storage engine that is primarily used for read-only
                or read-mostly workloads. See
                <a class="xref" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine">Section 16.2, “The MyISAM Storage Engine”</a>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">MEMORY</code></td>
              <td>The data for this storage engine is stored only in memory. See
                <a class="xref" href="storage-engines.html#memory-storage-engine" title="16.3 The MEMORY Storage Engine">Section 16.3, “The MEMORY Storage Engine”</a>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">CSV</code></td>
              <td>Tables that store rows in comma-separated values format. See
                <a class="xref" href="storage-engines.html#csv-storage-engine" title="16.4 The CSV Storage Engine">Section 16.4, “The CSV Storage Engine”</a>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">ARCHIVE</code></td>
              <td>The archiving storage engine. See
                <a class="xref" href="storage-engines.html#archive-storage-engine" title="16.5 The ARCHIVE Storage Engine">Section 16.5, “The ARCHIVE Storage Engine”</a>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">EXAMPLE</code></td>
              <td>An example engine. See <a class="xref" href="storage-engines.html#example-storage-engine" title="16.9 The EXAMPLE Storage Engine">Section 16.9, “The EXAMPLE Storage Engine”</a>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">FEDERATED</code></td>
              <td>Storage engine that accesses remote tables. See
                <a class="xref" href="storage-engines.html#federated-storage-engine" title="16.8 The FEDERATED Storage Engine">Section 16.8, “The FEDERATED Storage Engine”</a>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">HEAP</code></td>
              <td>This is a synonym for <code class="literal">MEMORY</code>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">MERGE</code></td>
              <td>A collection of <code class="literal">MyISAM</code> tables used as one table. Also
                known as <code class="literal">MRG_MyISAM</code>. See
                <a class="xref" href="storage-engines.html#merge-storage-engine" title="16.7 The MERGE Storage Engine">Section 16.7, “The MERGE Storage Engine”</a>.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a></td>
              <td>Clustered, fault-tolerant, memory-based tables, supporting transactions
                and foreign keys. Also known as
                <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDBCLUSTER</code></a>. See
                <a class="xref" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0">Chapter 22, <i>MySQL NDB Cluster 8.0</i></a>.</td>
</tr></tbody></table>
</div>
<p>
          By default, if a storage engine is specified that is not
          available, the statement fails with an error. You can override
          this behavior by removing
          <a class="link" href="server-administration.html#sqlmode_no_engine_substitution"><code class="literal">NO_ENGINE_SUBSTITUTION</code></a> from
          the server SQL mode (see <a class="xref" href="server-administration.html#sql-mode" title="5.1.11 Server SQL Modes">Section 5.1.11, “Server SQL Modes”</a>) so that
          MySQL allows substitution of the specified engine with the
          default storage engine instead. Normally in such cases, this
          is <code class="literal">InnoDB</code>, which is the default value for
          the <a class="link" href="server-administration.html#sysvar_default_storage_engine"><code class="literal">default_storage_engine</code></a>
          system variable. When
          <code class="literal">NO_ENGINE_SUBSTITUTION</code> is disabled, a
          warning occurs if the storage engine specification is not
          honored.
        </p></li><li class="listitem"><p>
          <code class="literal">AUTO_INCREMENT</code>
        </p><p>
          The initial <code class="literal">AUTO_INCREMENT</code> value for the
          table. In MySQL 8.0, this works for
          <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>,
          <code class="literal">InnoDB</code>, and <code class="literal">ARCHIVE</code>
          tables. To set the first auto-increment value for engines that
          do not support the <code class="literal">AUTO_INCREMENT</code> table
          option, insert a <span class="quote">“<span class="quote">dummy</span>”</span> row with a value one
          less than the desired value after creating the table, and then
          delete the dummy row.
        </p><p>
          For engines that support the <code class="literal">AUTO_INCREMENT</code>
          table option in <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
          statements, you can also use <code class="literal">ALTER TABLE
          <em class="replaceable"><code>tbl_name</code></em> AUTO_INCREMENT =
          <em class="replaceable"><code>N</code></em></code> to reset the
          <code class="literal">AUTO_INCREMENT</code> value. The value cannot be
          set lower than the maximum value currently in the column.
        </p></li><li class="listitem"><p>
          <code class="literal">AVG_ROW_LENGTH</code>
        </p><p>
          An approximation of the average row length for your table. You
          need to set this only for large tables with variable-size
          rows.
        </p><p>
          When you create a <code class="literal">MyISAM</code> table, MySQL uses
          the product of the <code class="literal">MAX_ROWS</code> and
          <code class="literal">AVG_ROW_LENGTH</code> options to decide how big
          the resulting table is. If you don't specify either option,
          the maximum size for <code class="literal">MyISAM</code> data and index
          files is 256TB by default. (If your operating system does not
          support files that large, table sizes are constrained by the
          file size limit.) If you want to keep down the pointer sizes
          to make the index smaller and faster and you don't really need
          big files, you can decrease the default pointer size by
          setting the
          <a class="link" href="server-administration.html#sysvar_myisam_data_pointer_size"><code class="literal">myisam_data_pointer_size</code></a>
          system variable. (See
          <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>.) If you want all
          your tables to be able to grow above the default limit and are
          willing to have your tables slightly slower and larger than
          necessary, you can increase the default pointer size by
          setting this variable. Setting the value to 7 permits table
          sizes up to 65,536TB.
        </p></li><li class="listitem"><p>
          <code class="literal">[DEFAULT] CHARACTER SET</code>
        </p><p>
          Specifies a default character set for the table.
          <code class="literal">CHARSET</code> is a synonym for <code class="literal">CHARACTER
          SET</code>. If the character set name is
          <code class="literal">DEFAULT</code>, the database character set is
          used.
        </p></li><li class="listitem"><p>
          <code class="literal">CHECKSUM</code>
        </p><p>
          Set this to 1 if you want MySQL to maintain a live checksum
          for all rows (that is, a checksum that MySQL updates
          automatically as the table changes). This makes the table a
          little slower to update, but also makes it easier to find
          corrupted tables. The <a class="link" href="sql-syntax.html#checksum-table" title="13.7.3.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM
          TABLE</code></a> statement reports the checksum.
          (<code class="literal">MyISAM</code> only.)
        </p></li><li class="listitem"><p>
          <code class="literal">[DEFAULT] COLLATE</code>
        </p><p>
          Specifies a default collation for the table.
        </p></li><li class="listitem"><p>
          <code class="literal">COMMENT</code>
        </p><p>
          A comment for the table, up to 2048 characters long.
        </p><p>
          You can set the <code class="literal">InnoDB</code>
          <code class="literal">MERGE_THRESHOLD</code> value for a table using the
          <code class="literal"><em class="replaceable"><code>table_option</code></em></code>
          <code class="literal">COMMENT</code> clause. See
          <a class="xref" href="innodb-storage-engine.html#index-page-merge-threshold" title="15.8.11 Configuring the Merge Threshold for Index Pages">Section 15.8.11, “Configuring the Merge Threshold for Index Pages”</a>.
        </p><p><a name="create-table-comment-ndb-table-options"></a><b>Setting NDB_TABLE options. </b>
            <a class="indexterm" name="idm140091669325376"></a>

            The table comment in a <code class="literal">CREATE TABLE</code> that
            creates an <code class="literal">NDB</code> table or an
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement which
            alters one can also be used to specify one to four of the
            <code class="literal">NDB_TABLE</code> options
            <code class="literal">NOLOGGING</code>,
            <code class="literal">READ_BACKUP</code>,
            <code class="literal">PARTITION_BALANCE</code>, or
            <code class="literal">FULLY_REPLICATED</code> as a set of name-value
            pairs, separated by commas if need be, immediately following
            the string <code class="literal">NDB_TABLE=</code> that begins the
            quoted comment text. An example statement using this syntax
            is shown here (emphasized text):
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (
    c1 INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    c2 VARCHAR(100),
    c3 VARCHAR(100) )
ENGINE=NDB
<span class="emphasis"><em>COMMENT="NDB_TABLE=READ_BACKUP=0,PARTITION_BALANCE=FOR_RP_BY_NODE"</em></span>;
</pre><p>
          Spaces are not permitted within the quoted string. The string
          is case-insensitive.
        </p><p>
          The comment is displayed as part of the ouput of
          <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>. The text of
          the comment is also available as the TABLE_COMMENT column of
          the MySQL Information Schema
          <a class="link" href="information-schema.html#tables-table" title="25.30 The INFORMATION_SCHEMA TABLES Table"><code class="literal">TABLES</code></a> table.
        </p><p>
          This comment syntax is also supported with
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statements for
          <code class="literal">NDB</code> tables. Keep in mind that a table
          comment used with <code class="literal">ALTER TABLE</code> replaces any
          existing comment which the table might have had perviously.
        </p><p>
          Setting the <code class="literal">MERGE_THRESHOLD</code> option in table
          comments is not supported for <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a>
          tables (it is ignored).
        </p><p>
          For complete syntax information and examples, see
          <a class="xref" href="sql-syntax.html#create-table-ndb-table-comment-options" title="13.1.20.11 Setting NDB_TABLE Options">Section 13.1.20.11, “Setting NDB_TABLE Options”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">COMPRESSION</code>
        </p><p>
          The compression algorithm used for page level compression for
          <code class="literal">InnoDB</code> tables. Supported values include
          <code class="literal">Zlib</code>, <code class="literal">LZ4</code>, and
          <code class="literal">None</code>. The <code class="literal">COMPRESSION</code>
          attribute was introduced with the transparent page compression
          feature. Page compression is only supported with
          <code class="literal">InnoDB</code> tables that reside in
          <a class="link" href="glossary.html#glos_file_per_table" title="file-per-table">file-per-table</a>
          tablespaces, and is only available on Linux and Windows
          platforms that support sparse files and hole punching. For
          more information, see
          <a class="xref" href="innodb-storage-engine.html#innodb-page-compression" title="15.9.2 InnoDB Page Compression">Section 15.9.2, “InnoDB Page Compression”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">CONNECTION</code>
        </p><p>
          The connection string for a <code class="literal">FEDERATED</code>
          table.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Older versions of MySQL used a <code class="literal">COMMENT</code>
            option for the connection string.
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">DATA DIRECTORY</code>, <code class="literal">INDEX
          DIRECTORY</code>
        </p><p>
          For <code class="literal">InnoDB</code>, the <code class="literal">DATA
          DIRECTORY='<em class="replaceable"><code>directory</code></em>'</code>
          clause permits creating a file-per-table tablespace outside of
          the data directory. The tablespace data file is created in the
          specified directory, inside a subdirectory with the same name
          as the schema. The
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a>
          variable must be enabled to use the <code class="literal">DATA
          DIRECTORY</code> clause. The full directory path must be
          specified. For more information, see
          <a class="xref" href="innodb-storage-engine.html#tablespace-placing" title="15.6.3.6 Creating a Tablespace Outside of the Data Directory">Section 15.6.3.6, “Creating a Tablespace Outside of the Data Directory”</a>.
        </p><p>
          When creating <code class="literal">MyISAM</code> tables, you can use
          the <code class="literal">DATA
          DIRECTORY='<em class="replaceable"><code>directory</code></em>'</code>
          clause, the <code class="literal">INDEX
          DIRECTORY='<em class="replaceable"><code>directory</code></em>'</code>
          clause, or both. They specify where to put a
          <code class="literal">MyISAM</code> table's data file and index file,
          respectively. Unlike <code class="literal">InnoDB</code> tables, MySQL
          does not create subdirectories that correspond to the database
          name when creating a <code class="literal">MyISAM</code> table with a
          <code class="literal">DATA DIRECTORY</code> or <code class="literal">INDEX
          DIRECTORY</code> option. Files are created in the directory
          that is specified.
        </p><p>
          You must have the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a>
          privilege to use the <code class="literal">DATA DIRECTORY</code> or
          <code class="literal">INDEX DIRECTORY</code> table option.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            Table-level <code class="literal">DATA DIRECTORY</code> and
            <code class="literal">INDEX DIRECTORY</code> options are ignored for
            partitioned tables. (Bug #32091)
</p>
</div>
<p>
          These options work only when you are not using the
          <a class="link" href="server-administration.html#option_mysqld_symbolic-links"><code class="option">--skip-symbolic-links</code></a>
          option. Your operating system must also have a working,
          thread-safe <code class="literal">realpath()</code> call. See
          <a class="xref" href="optimization.html#symbolic-links-to-tables" title="8.12.2.2 Using Symbolic Links for MyISAM Tables on Unix">Section 8.12.2.2, “Using Symbolic Links for MyISAM Tables on Unix”</a>, for more complete
          information.
        </p><p>
          If a <code class="literal">MyISAM</code> table is created with no
          <code class="literal">DATA DIRECTORY</code> option, the
          <code class="filename">.MYD</code> file is created in the database
          directory. By default, if <code class="literal">MyISAM</code> finds an
          existing <code class="filename">.MYD</code> file in this case, it
          overwrites it. The same applies to <code class="filename">.MYI</code>
          files for tables created with no <code class="literal">INDEX
          DIRECTORY</code> option. To suppress this behavior, start
          the server with the
          <a class="link" href="server-administration.html#sysvar_keep_files_on_create"><code class="option">--keep_files_on_create</code></a> option,
          in which case <code class="literal">MyISAM</code> will not overwrite
          existing files and returns an error instead.
        </p><p>
          If a <code class="literal">MyISAM</code> table is created with a
          <code class="literal">DATA DIRECTORY</code> or <code class="literal">INDEX
          DIRECTORY</code> option and an existing
          <code class="filename">.MYD</code> or <code class="filename">.MYI</code> file is
          found, MyISAM always returns an error. It will not overwrite a
          file in the specified directory.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            You cannot use path names that contain the MySQL data
            directory with <code class="literal">DATA DIRECTORY</code> or
            <code class="literal">INDEX DIRECTORY</code>. This includes
            partitioned tables and individual table partitions. (See Bug
            #32167.)
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">DELAY_KEY_WRITE</code>
        </p><p>
          Set this to 1 if you want to delay key updates for the table
          until the table is closed. See the description of the
          <a class="link" href="server-administration.html#sysvar_delay_key_write"><code class="literal">delay_key_write</code></a> system
          variable in <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>.
          (<code class="literal">MyISAM</code> only.)
        </p></li><li class="listitem"><p>
          <code class="literal">ENCRYPTION</code>
        </p><p>
          The <code class="literal">ENCRYPTION</code> clause enables or disables
          page-level data encryption for an <code class="literal">InnoDB</code>
          table. A keyring plugin must be installed and configured
          before encryption can be enabled. Prior to MySQL 8.0.16, the
          <code class="literal">ENCRYPTION</code> clause can only be specified
          when creating a table in an a file-per-table tablespace. As of
          MySQL 8.0.16, the <code class="literal">ENCRYPTION</code> clause can
          also be specified when creating a table in a general
          tablespace.
        </p><p>
          As of MySQL 8.0.16, a table inherits the default schema
          encryption if an <code class="literal">ENCRYPTION</code> clause is not
          specified. If the
          <a class="link" href="server-administration.html#sysvar_table_encryption_privilege_check"><code class="literal">table_encryption_privilege_check</code></a>
          variable is enabled, the
          <a class="link" href="security.html#priv_table-encryption-admin"><code class="literal">TABLE_ENCRYPTION_ADMIN</code></a>
          privilege is required to create a table with an
          <code class="literal">ENCRYPTION</code> clause setting that differs from
          the default schema encryption. When creating a table in a
          general tablespace, table and tablespace encryption must
          match.
        </p><p>
          As of MySQL 8.0.16, specifying an
          <code class="literal">ENCRYPTION</code> clause with a value other than
          <code class="literal">'N'</code> or <code class="literal">''</code> is not
          permitted when using a storage engine that does not support
          encryption. Previously, the clause was accepted.
        </p><p>
          For more information, see
          <a class="xref" href="innodb-storage-engine.html#innodb-tablespace-encryption" title="15.6.3.9 InnoDB Data-at-Rest Encryption">Section 15.6.3.9, “InnoDB Data-at-Rest Encryption”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">INSERT_METHOD</code>
        </p><p>
          If you want to insert data into a <code class="literal">MERGE</code>
          table, you must specify with <code class="literal">INSERT_METHOD</code>
          the table into which the row should be inserted.
          <code class="literal">INSERT_METHOD</code> is an option useful for
          <code class="literal">MERGE</code> tables only. Use a value of
          <code class="literal">FIRST</code> or <code class="literal">LAST</code> to have
          inserts go to the first or last table, or a value of
          <code class="literal">NO</code> to prevent inserts. See
          <a class="xref" href="storage-engines.html#merge-storage-engine" title="16.7 The MERGE Storage Engine">Section 16.7, “The MERGE Storage Engine”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">KEY_BLOCK_SIZE</code>
        </p><p>
          For <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> tables,
          <code class="literal">KEY_BLOCK_SIZE</code> optionally specifies the
          size in bytes to use for index key blocks. The value is
          treated as a hint; a different size could be used if
          necessary. A <code class="literal">KEY_BLOCK_SIZE</code> value specified
          for an individual index definition overrides the table-level
          <code class="literal">KEY_BLOCK_SIZE</code> value.
        </p><p>
          For <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables,
          <code class="literal">KEY_BLOCK_SIZE</code> specifies the
          <a class="link" href="glossary.html#glos_page" title="page">page</a> size in kilobytes to use
          for <a class="link" href="glossary.html#glos_compression" title="compression">compressed</a>
          <code class="literal">InnoDB</code> tables. The
          <code class="literal">KEY_BLOCK_SIZE</code> value is treated as a hint;
          a different size could be used by <code class="literal">InnoDB</code> if
          necessary. <code class="literal">KEY_BLOCK_SIZE</code> can only be less
          than or equal to the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a> value. A
          value of 0 represents the default compressed page size, which
          is half of the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a> value.
          Depending on
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a>, possible
          <code class="literal">KEY_BLOCK_SIZE</code> values include 0, 1, 2, 4,
          8, and 16. See <a class="xref" href="innodb-storage-engine.html#innodb-table-compression" title="15.9.1 InnoDB Table Compression">Section 15.9.1, “InnoDB Table Compression”</a> for
          more information.
        </p><p>
          Oracle recommends enabling
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> when
          specifying <code class="literal">KEY_BLOCK_SIZE</code> for
          <code class="literal">InnoDB</code> tables. When
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> is
          enabled, specifying an invalid
          <code class="literal">KEY_BLOCK_SIZE</code> value returns an error. If
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> is
          disabled, an invalid <code class="literal">KEY_BLOCK_SIZE</code> value
          results in a warning, and the
          <code class="literal">KEY_BLOCK_SIZE</code> option is ignored.
        </p><p>
          The <code class="literal">Create_options</code> column in response to
          <a class="link" href="sql-syntax.html#show-table-status" title="13.7.6.36 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a> reports the
          actual <code class="literal">KEY_BLOCK_SIZE</code> used by the table, as
          does <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>.
        </p><p>
          <code class="literal">InnoDB</code> only supports
          <code class="literal">KEY_BLOCK_SIZE</code> at the table level.
        </p><p>
          <code class="literal">KEY_BLOCK_SIZE</code> is not supported with 32KB
          and 64KB <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a>
          values. <code class="literal">InnoDB</code> table compression does not
          support these pages sizes.
        </p><p>
          <code class="literal">InnoDB</code> does not support the
          <code class="literal">KEY_BLOCK_SIZE</code> option when creating
          temporary tables.
        </p></li><li class="listitem"><p>
          <code class="literal">MAX_ROWS</code>
        </p><p>
          The maximum number of rows you plan to store in the table.
          This is not a hard limit, but rather a hint to the storage
          engine that the table must be able to store at least this many
          rows.
</p><a class="indexterm" name="idm140091669189264"></a><a class="indexterm" name="idm140091669187776"></a><a class="indexterm" name="idm140091669186288"></a><a class="indexterm" name="idm140091669184800"></a>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            The use of <code class="literal">MAX_ROWS</code> with
            <code class="literal">NDB</code> tables to control the number of table
            partitions is deprecated. It remains supported in later
            versions for backward compatibility, but is subject to
            removal in a future release. Use PARTITION_BALANCE instead;
            see
            <a class="xref" href="sql-syntax.html#create-table-comment-ndb-table-options" title="Setting NDB_TABLE options">Setting NDB_TABLE options</a>.
</p>
</div>
<p>
          The <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> storage engine treats
          this value as a maximum. If you plan to create very large NDB
          Cluster tables (containing millions of rows), you should use
          this option to insure that <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a>
          allocates sufficient number of index slots in the hash table
          used for storing hashes of the table's primary keys by
          setting <code class="literal">MAX_ROWS = 2 *
          <em class="replaceable"><code>rows</code></em></code>, where
          <em class="replaceable"><code>rows</code></em> is the number of rows that you
          expect to insert into the table.
        </p><p>
          The maximum <code class="literal">MAX_ROWS</code> value is 4294967295;
          larger values are truncated to this limit.
        </p></li><li class="listitem"><p>
          <code class="literal">MIN_ROWS</code>
        </p><p>
          The minimum number of rows you plan to store in the table. The
          <a class="link" href="storage-engines.html#memory-storage-engine" title="16.3 The MEMORY Storage Engine"><code class="literal">MEMORY</code></a> storage engine uses this
          option as a hint about memory use.
        </p></li><li class="listitem"><p>
          <code class="literal">PACK_KEYS</code>
        </p><p>
          Takes effect only with <code class="literal">MyISAM</code> tables. Set
          this option to 1 if you want to have smaller indexes. This
          usually makes updates slower and reads faster. Setting the
          option to 0 disables all packing of keys. Setting it to
          <code class="literal">DEFAULT</code> tells the storage engine to pack
          only long <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>, or
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> columns.
        </p><p>
          If you do not use <code class="literal">PACK_KEYS</code>, the default is
          to pack strings, but not numbers. If you use
          <code class="literal">PACK_KEYS=1</code>, numbers are packed as well.
        </p><p>
          When packing binary number keys, MySQL uses prefix
          compression:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Every key needs one extra byte to indicate how many bytes
              of the previous key are the same for the next key.
            </p></li><li class="listitem"><p>
              The pointer to the row is stored in high-byte-first order
              directly after the key, to improve compression.
</p></li></ul>
</div>
<p>
          This means that if you have many equal keys on two consecutive
          rows, all following <span class="quote">“<span class="quote">same</span>”</span> keys usually only take
          two bytes (including the pointer to the row). Compare this to
          the ordinary case where the following keys takes
          <code class="literal">storage_size_for_key + pointer_size</code> (where
          the pointer size is usually 4). Conversely, you get a
          significant benefit from prefix compression only if you have
          many numbers that are the same. If all keys are totally
          different, you use one byte more per key, if the key is not a
          key that can have <code class="literal">NULL</code> values. (In this
          case, the packed key length is stored in the same byte that is
          used to mark if a key is <code class="literal">NULL</code>.)
        </p></li><li class="listitem"><p>
          <code class="literal">PASSWORD</code>
        </p><p>
          This option is unused.
        </p></li><li class="listitem"><p>
          <code class="literal">ROW_FORMAT</code>
        </p><p>
          Defines the physical format in which the rows are stored.
        </p><p>
          When executing a <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
          statement with <a class="link" href="glossary.html#glos_strict_mode" title="strict mode">strict
          mode</a> disabled, if you specify a row format that is not
          supported by the storage engine that is used for the table,
          the table is created using that storage engine's default
          row format. The actual row format of the table is reported in
          the <code class="literal">Row_format</code> and
          <code class="literal">Create_options</code> columns in response to
          <a class="link" href="sql-syntax.html#show-table-status" title="13.7.6.36 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a>.
          <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a> also reports
          the actual row format of the table.
        </p><p>
          Row format choices differ depending on the storage engine used
          for the table.
        </p><p>
          For <code class="literal">InnoDB</code> tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              The default row format is defined by
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_default_row_format"><code class="literal">innodb_default_row_format</code></a>,
              which has a default setting of <code class="literal">DYNAMIC</code>.
              The default row format is used when the
              <code class="literal">ROW_FORMAT</code> option is not defined or
              when <code class="literal">ROW_FORMAT=DEFAULT</code> is used.
            </p><p>
              If the <code class="literal">ROW_FORMAT</code> option is not
              defined, or if <code class="literal">ROW_FORMAT=DEFAULT</code> is
              used, operations that rebuild a table also silently change
              the row format of the table to the default defined by
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_default_row_format"><code class="literal">innodb_default_row_format</code></a>.
              For more information, see
              <a class="xref" href="innodb-storage-engine.html#innodb-row-format-defining" title="Defining the Row Format of a Table">Defining the Row Format of a Table</a>.
            </p></li><li class="listitem"><p>
              For more efficient <code class="literal">InnoDB</code> storage of
              data types, especially <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>
              types, use the <code class="literal">DYNAMIC</code>. See
              <a class="xref" href="innodb-storage-engine.html#innodb-row-format-dynamic" title="DYNAMIC Row Format">DYNAMIC Row Format</a> for
              requirements associated with the
              <code class="literal">DYNAMIC</code> row format.
            </p></li><li class="listitem"><p>
              To enable compression for <code class="literal">InnoDB</code>
              tables, specify <code class="literal">ROW_FORMAT=COMPRESSED</code>.
              The <code class="literal">ROW_FORMAT=COMPRESSED</code> option is not
              supported when creating temporary tables. See
              <a class="xref" href="innodb-storage-engine.html#innodb-compression" title="15.9 InnoDB Table and Page Compression">Section 15.9, “InnoDB Table and Page Compression”</a> for requirements
              associated with the <code class="literal">COMPRESSED</code> row
              format.
            </p></li><li class="listitem"><p>
              The row format used in older versions of MySQL can still
              be requested by specifying the
              <code class="literal">REDUNDANT</code> row format.
            </p></li><li class="listitem"><p>
              When you specify a non-default
              <code class="literal">ROW_FORMAT</code> clause, consider also
              enabling the
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a>
              configuration option.
            </p></li><li class="listitem"><p>
              <code class="literal">ROW_FORMAT=FIXED</code> is not supported. If
              <code class="literal">ROW_FORMAT=FIXED</code> is specified while
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> is
              disabled, <code class="literal">InnoDB</code> issues a warning and
              assumes <code class="literal">ROW_FORMAT=DYNAMIC</code>. If
              <code class="literal">ROW_FORMAT=FIXED</code> is specified while
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> is
              enabled, which is the default, <code class="literal">InnoDB</code>
              returns an error.
            </p></li><li class="listitem"><p>
              For additional information about <code class="literal">InnoDB</code>
              row formats, see <a class="xref" href="innodb-storage-engine.html#innodb-row-format" title="15.10 InnoDB Row Formats">Section 15.10, “InnoDB Row Formats”</a>.
</p></li></ul>
</div>
<p>
          For <code class="literal">MyISAM</code> tables, the option value can be
          <code class="literal">FIXED</code> or <code class="literal">DYNAMIC</code> for
          static or variable-length row format.
          <a class="link" href="programs.html#myisampack" title="4.6.6 myisampack — Generate Compressed, Read-Only MyISAM Tables"><span class="command"><strong>myisampack</strong></span></a> sets the type to
          <code class="literal">COMPRESSED</code>. See
          <a class="xref" href="storage-engines.html#myisam-table-formats" title="16.2.3 MyISAM Table Storage Formats">Section 16.2.3, “MyISAM Table Storage Formats”</a>.
        </p><p>
          For <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables, the default
          <code class="literal">ROW_FORMAT</code> is <code class="literal">DYNAMIC</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">STATS_AUTO_RECALC</code>
        </p><p>
          Specifies whether to automatically recalculate
          <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/glossary.html#glos_persistent_statistics" target="_top">persistent
          statistics</a> for an <code class="literal">InnoDB</code> table. The
          value <code class="literal">DEFAULT</code> causes the persistent
          statistics setting for the table to be determined by the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_stats_auto_recalc"><code class="literal">innodb_stats_auto_recalc</code></a>
          configuration option. The value <code class="literal">1</code> causes
          statistics to be recalculated when 10% of the data in the
          table has changed. The value <code class="literal">0</code> prevents
          automatic recalculation for this table; with this setting,
          issue an <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a>
          statement to recalculate the statistics after making
          substantial changes to the table. For more information about
          the persistent statistics feature, see
          <a class="xref" href="innodb-storage-engine.html#innodb-persistent-stats" title="15.8.10.1 Configuring Persistent Optimizer Statistics Parameters">Section 15.8.10.1, “Configuring Persistent Optimizer Statistics Parameters”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">STATS_PERSISTENT</code>
        </p><p>
          Specifies whether to enable
          <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/glossary.html#glos_persistent_statistics" target="_top">persistent
          statistics</a> for an <code class="literal">InnoDB</code> table. The
          value <code class="literal">DEFAULT</code> causes the persistent
          statistics setting for the table to be determined by the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_stats_persistent"><code class="literal">innodb_stats_persistent</code></a>
          configuration option. The value <code class="literal">1</code> enables
          persistent statistics for the table, while the value
          <code class="literal">0</code> turns off this feature. After enabling
          persistent statistics through a <code class="literal">CREATE
          TABLE</code> or <code class="literal">ALTER TABLE</code> statement,
          issue an <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a>
          statement to calculate the statistics, after loading
          representative data into the table. For more information about
          the persistent statistics feature, see
          <a class="xref" href="innodb-storage-engine.html#innodb-persistent-stats" title="15.8.10.1 Configuring Persistent Optimizer Statistics Parameters">Section 15.8.10.1, “Configuring Persistent Optimizer Statistics Parameters”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">STATS_SAMPLE_PAGES</code>
        </p><p>
          The number of index pages to sample when estimating
          cardinality and other statistics for an indexed column, such
          as those calculated by <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
          TABLE</code></a>. For more information, see
          <a class="xref" href="innodb-storage-engine.html#innodb-persistent-stats" title="15.8.10.1 Configuring Persistent Optimizer Statistics Parameters">Section 15.8.10.1, “Configuring Persistent Optimizer Statistics Parameters”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">TABLESPACE</code>
        </p><p>
          The <code class="literal">TABLESPACE</code> clause can be used to create
          a table in an existing general tablespace, a file-per-table
          tablespace, or the system tablespace.
        </p><pre data-lang="sql" class="programlisting">CREATE TABLE <em class="replaceable"><code>tbl_name</code></em> ... TABLESPACE [=] <em class="replaceable"><code>tablespace_name</code></em></pre><p>
          The general tablespace that you specify must exist prior to
          using the <code class="literal">TABLESPACE</code> clause. For
          information about general tablespaces, see
          <a class="xref" href="innodb-storage-engine.html#general-tablespaces" title="15.6.3.3 General Tablespaces">Section 15.6.3.3, “General Tablespaces”</a>.
        </p><p>
          The
          <code class="literal"><em class="replaceable"><code>tablespace_name</code></em></code>
          is a case-sensitive identifier. It may be quoted or unquoted.
          The forward slash character (<span class="quote">“<span class="quote">/</span>”</span>) is not
          permitted. Names beginning with <span class="quote">“<span class="quote">innodb_</span>”</span> are
          reserved for special use.
        </p><p>
          To create a table in the system tablespace, specify
          <code class="literal">innodb_system</code> as the tablespace name.
        </p><pre data-lang="sql" class="programlisting">CREATE TABLE <em class="replaceable"><code>tbl_name</code></em> ... TABLESPACE [=] innodb_system</pre><p>
          Using <code class="literal">TABLESPACE [=] innodb_system</code>, you can
          place a table of any uncompressed row format in the system
          tablespace regardless of the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a>
          setting. For example, you can add a table with
          <code class="literal">ROW_FORMAT=DYNAMIC</code> to the system tablespace
          using <code class="literal">TABLESPACE [=] innodb_system</code>.
        </p><p>
          To create a table in a file-per-table tablespace, specify
          <code class="literal">innodb_file_per_table</code> as the tablespace
          name.
</p><pre data-lang="sql" class="programlisting">CREATE TABLE <em class="replaceable"><code>tbl_name</code></em> ... TABLESPACE [=] innodb_file_per_table</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            If <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a> is
            enabled, you need not specify
            <code class="literal">TABLESPACE=innodb_file_per_table</code> to
            create an <code class="literal">InnoDB</code> file-per-table
            tablespace. <code class="literal">InnoDB</code> tables are created in
            file-per-table tablespaces by default when
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a> is
            enabled.
</p>
</div>
<p>
          The <code class="literal">DATA DIRECTORY</code> clause is permitted with
          <code class="literal">CREATE TABLE ...
          TABLESPACE=innodb_file_per_table</code> but is otherwise
          not supported for use in combination with the
          <code class="literal">TABLESPACE</code> clause.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Support for <code class="literal">TABLESPACE =
            innodb_file_per_table</code> and <code class="literal">TABLESPACE =
            innodb_temporary</code> clauses with
            <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
            TEMPORARY TABLE</code></a> is deprecated as of MySQL 8.0.13
            and will be removed in a future version of MySQL.
</p>
</div>
<p>
          The <code class="literal">STORAGE</code> table option is employed only
          with <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables.
          <code class="literal">STORAGE</code> determines the type of storage used
          (disk or memory), and can be either <code class="literal">DISK</code> or
          <code class="literal">MEMORY</code>.
        </p><p>
          <code class="literal">TABLESPACE ... STORAGE DISK</code> assigns a table
          to an NDB Cluster Disk Data tablespace. The tablespace must
          already have been created using <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.21 CREATE TABLESPACE Syntax"><code class="literal">CREATE
          TABLESPACE</code></a>. See
          <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="22.5.13 NDB Cluster Disk Data Tables">Section 22.5.13, “NDB Cluster Disk Data Tables”</a>, for more
          information.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            A <code class="literal">STORAGE</code> clause cannot be used in a
            <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement
            without a <code class="literal">TABLESPACE</code> clause.
</p>
</div>
</li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a>
        </p><p>
          Used to access a collection of identical
          <code class="literal">MyISAM</code> tables as one. This works only with
          <code class="literal">MERGE</code> tables. See
          <a class="xref" href="storage-engines.html#merge-storage-engine" title="16.7 The MERGE Storage Engine">Section 16.7, “The MERGE Storage Engine”</a>.
        </p><p>
          You must have <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>,
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>, and
          <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privileges for the
          tables you map to a <code class="literal">MERGE</code> table.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Formerly, all tables used had to be in the same database as
            the <code class="literal">MERGE</code> table itself. This restriction
            no longer applies.
</p>
</div>
</li></ul>
</div>
<h4><a name="create-table-partitioning"></a>Table Partitioning</h4>
<p>
      <em class="replaceable"><code>partition_options</code></em> can be used to
      control partitioning of the table created with
      <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>.
    </p><p>
      Not all options shown in the syntax for
      <em class="replaceable"><code>partition_options</code></em> at the beginning of
      this section are available for all partitioning types. Please see
      the listings for the following individual types for information
      specific to each type, and see <a class="xref" href="partitioning.html" title="Chapter 23 Partitioning">Chapter 23, <i>Partitioning</i></a>, for
      more complete information about the workings of and uses for
      partitioning in MySQL, as well as additional examples of table
      creation and other statements relating to MySQL partitioning.
    </p><p>
      Partitions can be modified, merged, added to tables, and dropped
      from tables. For basic information about the MySQL statements to
      accomplish these tasks, see <a class="xref" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax">Section 13.1.9, “ALTER TABLE Syntax”</a>. For
      more detailed descriptions and examples, see
      <a class="xref" href="partitioning.html#partitioning-management" title="23.3 Partition Management">Section 23.3, “Partition Management”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">PARTITION BY</code>
        </p><p>
          If used, a <em class="replaceable"><code>partition_options</code></em> clause
          begins with <code class="literal">PARTITION BY</code>. This clause
          contains the function that is used to determine the partition;
          the function returns an integer value ranging from 1 to
          <em class="replaceable"><code>num</code></em>, where
          <em class="replaceable"><code>num</code></em> is the number of partitions.
          (The maximum number of user-defined partitions which a table
          may contain is 1024; the number of
          subpartitions—discussed later in this section—is
          included in this maximum.)
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The expression (<em class="replaceable"><code>expr</code></em>) used in a
            <code class="literal">PARTITION BY</code> clause cannot refer to any
            columns not in the table being created; such references are
            specifically not permitted and cause the statement to fail
            with an error. (Bug #29444)
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">HASH(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          Hashes one or more columns to create a key for placing and
          locating rows. <em class="replaceable"><code>expr</code></em> is an
          expression using one or more table columns. This can be any
          valid MySQL expression (including MySQL functions) that yields
          a single integer value. For example, these are both valid
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statements using
          <code class="literal">PARTITION BY HASH</code>:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (col1 INT, col2 CHAR(5))
    PARTITION BY HASH(col1);

CREATE TABLE t1 (col1 INT, col2 CHAR(5), col3 DATETIME)
    PARTITION BY HASH ( YEAR(col3) );
</pre><p>
          You may not use either <code class="literal">VALUES LESS THAN</code> or
          <code class="literal">VALUES IN</code> clauses with <code class="literal">PARTITION
          BY HASH</code>.
        </p><p>
          <code class="literal">PARTITION BY HASH</code> uses the remainder of
          <em class="replaceable"><code>expr</code></em> divided by the number of
          partitions (that is, the modulus). For examples and additional
          information, see <a class="xref" href="partitioning.html#partitioning-hash" title="23.2.4 HASH Partitioning">Section 23.2.4, “HASH Partitioning”</a>.
        </p><p>
          The <code class="literal">LINEAR</code> keyword entails a somewhat
          different algorithm. In this case, the number of the partition
          in which a row is stored is calculated as the result of one or
          more logical <a class="link" href="functions.html#operator_and"><code class="literal">AND</code></a> operations. For
          discussion and examples of linear hashing, see
          <a class="xref" href="partitioning.html#partitioning-linear-hash" title="23.2.4.1 LINEAR HASH Partitioning">Section 23.2.4.1, “LINEAR HASH Partitioning”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">KEY(<em class="replaceable"><code>column_list</code></em>)</code>
        </p><p>
          This is similar to <code class="literal">HASH</code>, except that MySQL
          supplies the hashing function so as to guarantee an even data
          distribution. The <em class="replaceable"><code>column_list</code></em>
          argument is simply a list of 1 or more table columns (maximum:
          16). This example shows a simple table partitioned by key,
          with 4 partitions:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE tk (col1 INT, col2 CHAR(5), col3 DATE)
    PARTITION BY KEY(col3)
    PARTITIONS 4;
</pre><p>
          For tables that are partitioned by key, you can employ linear
          partitioning by using the <code class="literal">LINEAR</code> keyword.
          This has the same effect as with tables that are partitioned
          by <code class="literal">HASH</code>. That is, the partition number is
          found using the
          <a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a>
          operator rather than the modulus (see
          <a class="xref" href="partitioning.html#partitioning-linear-hash" title="23.2.4.1 LINEAR HASH Partitioning">Section 23.2.4.1, “LINEAR HASH Partitioning”</a>, and
          <a class="xref" href="partitioning.html#partitioning-key" title="23.2.5 KEY Partitioning">Section 23.2.5, “KEY Partitioning”</a>, for details). This example
          uses linear partitioning by key to distribute data between 5
          partitions:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE tk (col1 INT, col2 CHAR(5), col3 DATE)
    PARTITION BY LINEAR KEY(col3)
    PARTITIONS 5;
</pre><p>
          The <code class="literal">ALGORITHM={1|2}</code> option is supported
          with <code class="literal">[SUB]PARTITION BY [LINEAR] KEY</code>.
          <code class="literal">ALGORITHM=1</code> causes the server to use the
          same key-hashing functions as MySQL 5.1;
          <code class="literal">ALGORITHM=2</code> means that the server employs
          the key-hashing functions implemented and used by default for
          new <code class="literal">KEY</code> partitioned tables in MySQL 5.5 and
          later. (Partitioned tables created with the key-hashing
          functions employed in MySQL 5.5 and later cannot be used by a
          MySQL 5.1 server.) Not specifying the option has the same
          effect as using <code class="literal">ALGORITHM=2</code>. This option is
          intended for use chiefly when upgrading or downgrading
          <code class="literal">[LINEAR] KEY</code> partitioned tables between
          MySQL 5.1 and later MySQL versions, or for creating tables
          partitioned by <code class="literal">KEY</code> or <code class="literal">LINEAR
          KEY</code> on a MySQL 5.5 or later server which can be used
          on a MySQL 5.1 server. For more information, see
          <a class="xref" href="sql-syntax.html#alter-table-partition-operations" title="13.1.9.1 ALTER TABLE Partition Operations">Section 13.1.9.1, “ALTER TABLE Partition Operations”</a>.
        </p><p>
          <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a> in MySQL 5.7 (and later) writes
          this option encased in versioned comments, like this:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (a INT)
/*!50100 PARTITION BY KEY */ <span class="emphasis"><em>/*!50611 ALGORITHM = 1 */</em></span> /*!50100 ()
      PARTITIONS 3 */
</pre><p>
          This causes MySQL 5.6.10 and earlier servers to ignore the
          option, which would otherwise cause a syntax error in those
          versions. If you plan to load a dump made on a MySQL 5.7
          server where you use tables that are partitioned or
          subpartitioned by <code class="literal">KEY</code> into a MySQL 5.6
          server previous to version 5.6.11, be sure to consult
          <a class="ulink" href="https://dev.mysql.com/doc/refman/5.6/en/upgrading-from-previous-series.html" target="_top">Changes in MySQL 5.6</a>,
          before proceeding. (The information found there also applies
          if you are loading a dump containing <code class="literal">KEY</code>
          partitioned or subpartitioned tables made from a MySQL
          5.7—actually 5.6.11 or later—server into a MySQL
          5.5.30 or earlier server.)
        </p><p>
          Also in MySQL 5.6.11 and later, <code class="literal">ALGORITHM=1</code>
          is shown when necessary in the output of
          <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a> using
          versioned comments in the same manner as
          <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a>. <code class="literal">ALGORITHM=2</code>
          is always omitted from <code class="literal">SHOW CREATE TABLE</code>
          output, even if this option was specified when creating the
          original table.
        </p><p>
          You may not use either <code class="literal">VALUES LESS THAN</code> or
          <code class="literal">VALUES IN</code> clauses with <code class="literal">PARTITION
          BY KEY</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">RANGE(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          In this case, <em class="replaceable"><code>expr</code></em> shows a range of
          values using a set of <code class="literal">VALUES LESS THAN</code>
          operators. When using range partitioning, you must define at
          least one partition using <code class="literal">VALUES LESS THAN</code>.
          You cannot use <code class="literal">VALUES IN</code> with range
          partitioning.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            For tables partitioned by <code class="literal">RANGE</code>,
            <code class="literal">VALUES LESS THAN</code> must be used with either
            an integer literal value or an expression that evaluates to
            a single integer value. In MySQL 8.0, you can
            overcome this limitation in a table that is defined using
            <code class="literal">PARTITION BY RANGE COLUMNS</code>, as described
            later in this section.
</p>
</div>
<p>
          Suppose that you have a table that you wish to partition on a
          column containing year values, according to the following
          scheme.
</p>
<div class="informaltable">
<table summary="A table partitioning scheme based on a column containing year values, as described in the preceding text. The table lists partition numbers and corresponding range of years."><col width="40%"><col width="60%"><thead><tr>
              <th scope="col">Partition Number:</th>
              <th scope="col">Years Range:</th>
            </tr></thead><tbody><tr>
              <td scope="row">0</td>
              <td>1990 and earlier</td>
            </tr><tr>
              <td scope="row">1</td>
              <td>1991 to 1994</td>
            </tr><tr>
              <td scope="row">2</td>
              <td>1995 to 1998</td>
            </tr><tr>
              <td scope="row">3</td>
              <td>1999 to 2002</td>
            </tr><tr>
              <td scope="row">4</td>
              <td>2003 to 2005</td>
            </tr><tr>
              <td scope="row">5</td>
              <td>2006 and later</td>
</tr></tbody></table>
</div>
<p>
          A table implementing such a partitioning scheme can be
          realized by the <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
          statement shown here:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (
    year_col  INT,
    some_data INT
)
PARTITION BY RANGE (year_col) (
    PARTITION p0 VALUES LESS THAN (1991),
    PARTITION p1 VALUES LESS THAN (1995),
    PARTITION p2 VALUES LESS THAN (1999),
    PARTITION p3 VALUES LESS THAN (2002),
    PARTITION p4 VALUES LESS THAN (2006),
    PARTITION p5 VALUES LESS THAN MAXVALUE
);
</pre><p>
          <code class="literal">PARTITION ... VALUES LESS THAN ...</code>
          statements work in a consecutive fashion. <code class="literal">VALUES LESS
          THAN MAXVALUE</code> works to specify
          <span class="quote">“<span class="quote">leftover</span>”</span> values that are greater than the
          maximum value otherwise specified.
        </p><p>
          <code class="literal">VALUES LESS THAN</code> clauses work sequentially
          in a manner similar to that of the <code class="literal">case</code>
          portions of a <code class="literal">switch ... case</code> block (as
          found in many programming languages such as C, Java, and PHP).
          That is, the clauses must be arranged in such a way that the
          upper limit specified in each successive <code class="literal">VALUES LESS
          THAN</code> is greater than that of the previous one, with
          the one referencing <code class="literal">MAXVALUE</code> coming last of
          all in the list.
        </p></li><li class="listitem"><p>
          <code class="literal">RANGE
          COLUMNS(<em class="replaceable"><code>column_list</code></em>)</code>
        </p><p>
          This variant on <code class="literal">RANGE</code> facilitates partition
          pruning for queries using range conditions on multiple columns
          (that is, having conditions such as <code class="literal">WHERE a = 1 AND b
          &lt; 10</code> or <code class="literal">WHERE a = 1 AND b = 10 AND c
          &lt; 10</code>). It enables you to specify value ranges in
          multiple columns by using a list of columns in the
          <code class="literal">COLUMNS</code> clause and a set of column values
          in each <code class="literal">PARTITION ... VALUES LESS THAN
          (<em class="replaceable"><code>value_list</code></em>)</code> partition
          definition clause. (In the simplest case, this set consists of
          a single column.) The maximum number of columns that can be
          referenced in the <em class="replaceable"><code>column_list</code></em> and
          <em class="replaceable"><code>value_list</code></em> is 16.
        </p><p>
          The <em class="replaceable"><code>column_list</code></em> used in the
          <code class="literal">COLUMNS</code> clause may contain only names of
          columns; each column in the list must be one of the following
          MySQL data types: the integer types; the string types; and
          time or date column types. Columns using
          <code class="literal">BLOB</code>, <code class="literal">TEXT</code>,
          <code class="literal">SET</code>, <code class="literal">ENUM</code>,
          <code class="literal">BIT</code>, or spatial data types are not
          permitted; columns that use floating-point number types are
          also not permitted. You also may not use functions or
          arithmetic expressions in the <code class="literal">COLUMNS</code>
          clause.
        </p><p>
          The <code class="literal">VALUES LESS THAN</code> clause used in a
          partition definition must specify a literal value for each
          column that appears in the <code class="literal">COLUMNS()</code>
          clause; that is, the list of values used for each
          <code class="literal">VALUES LESS THAN</code> clause must contain the
          same number of values as there are columns listed in the
          <code class="literal">COLUMNS</code> clause. An attempt to use more or
          fewer values in a <code class="literal">VALUES LESS THAN</code> clause
          than there are in the <code class="literal">COLUMNS</code> clause causes
          the statement to fail with the error <span class="errortext">Inconsistency
          in usage of column lists for partitioning...</span>. You
          cannot use <code class="literal">NULL</code> for any value appearing in
          <code class="literal">VALUES LESS THAN</code>. It is possible to use
          <code class="literal">MAXVALUE</code> more than once for a given column
          other than the first, as shown in this example:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE rc (
    a INT NOT NULL,
    b INT NOT NULL
)
PARTITION BY RANGE COLUMNS(a,b) (
    PARTITION p0 VALUES LESS THAN (10,5),
    PARTITION p1 VALUES LESS THAN (20,10),
    PARTITION p2 VALUES LESS THAN (50,MAXVALUE),
    PARTITION p3 VALUES LESS THAN (65,MAXVALUE),
    PARTITION p4 VALUES LESS THAN (MAXVALUE,MAXVALUE)
);
</pre><p>
          Each value used in a <code class="literal">VALUES LESS THAN</code> value
          list must match the type of the corresponding column exactly;
          no conversion is made. For example, you cannot use the string
          <code class="literal">'1'</code> for a value that matches a column that
          uses an integer type (you must use the numeral
          <code class="literal">1</code> instead), nor can you use the numeral
          <code class="literal">1</code> for a value that matches a column that
          uses a string type (in such a case, you must use a quoted
          string: <code class="literal">'1'</code>).
        </p><p>
          For more information, see
          <a class="xref" href="partitioning.html#partitioning-range" title="23.2.1 RANGE Partitioning">Section 23.2.1, “RANGE Partitioning”</a>, and
          <a class="xref" href="partitioning.html#partitioning-pruning" title="23.4 Partition Pruning">Section 23.4, “Partition Pruning”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">LIST(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          This is useful when assigning partitions based on a table
          column with a restricted set of possible values, such as a
          state or country code. In such a case, all rows pertaining to
          a certain state or country can be assigned to a single
          partition, or a partition can be reserved for a certain set of
          states or countries. It is similar to
          <code class="literal">RANGE</code>, except that only <code class="literal">VALUES
          IN</code> may be used to specify permissible values for
          each partition.
        </p><p>
          <code class="literal">VALUES IN</code> is used with a list of values to
          be matched. For instance, you could create a partitioning
          scheme such as the following:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE client_firms (
    id   INT,
    name VARCHAR(35)
)
PARTITION BY LIST (id) (
    PARTITION r0 VALUES IN (1, 5, 9, 13, 17, 21),
    PARTITION r1 VALUES IN (2, 6, 10, 14, 18, 22),
    PARTITION r2 VALUES IN (3, 7, 11, 15, 19, 23),
    PARTITION r3 VALUES IN (4, 8, 12, 16, 20, 24)
);
</pre><p>
          When using list partitioning, you must define at least one
          partition using <code class="literal">VALUES IN</code>. You cannot use
          <code class="literal">VALUES LESS THAN</code> with <code class="literal">PARTITION BY
          LIST</code>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            For tables partitioned by <code class="literal">LIST</code>, the value
            list used with <code class="literal">VALUES IN</code> must consist of
            integer values only. In MySQL 8.0, you can
            overcome this limitation using partitioning by <code class="literal">LIST
            COLUMNS</code>, which is described later in this section.
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">LIST
          COLUMNS(<em class="replaceable"><code>column_list</code></em>)</code>
        </p><p>
          This variant on <code class="literal">LIST</code> facilitates partition
          pruning for queries using comparison conditions on multiple
          columns (that is, having conditions such as <code class="literal">WHERE a =
          5 AND b = 5</code> or <code class="literal">WHERE a = 1 AND b = 10 AND c
          = 5</code>). It enables you to specify values in multiple
          columns by using a list of columns in the
          <code class="literal">COLUMNS</code> clause and a set of column values
          in each <code class="literal">PARTITION ... VALUES IN
          (<em class="replaceable"><code>value_list</code></em>)</code> partition
          definition clause.
        </p><p>
          The rules governing regarding data types for the column list
          used in <code class="literal">LIST
          COLUMNS(<em class="replaceable"><code>column_list</code></em>)</code> and
          the value list used in <code class="literal">VALUES
          IN(<em class="replaceable"><code>value_list</code></em>)</code> are the
          same as those for the column list used in <code class="literal">RANGE
          COLUMNS(<em class="replaceable"><code>column_list</code></em>)</code> and
          the value list used in <code class="literal">VALUES LESS
          THAN(<em class="replaceable"><code>value_list</code></em>)</code>,
          respectively, except that in the <code class="literal">VALUES IN</code>
          clause, <code class="literal">MAXVALUE</code> is not permitted, and you
          may use <code class="literal">NULL</code>.
        </p><p>
          There is one important difference between the list of values
          used for <code class="literal">VALUES IN</code> with <code class="literal">PARTITION
          BY LIST COLUMNS</code> as opposed to when it is used with
          <code class="literal">PARTITION BY LIST</code>. When used with
          <code class="literal">PARTITION BY LIST COLUMNS</code>, each element in
          the <code class="literal">VALUES IN</code> clause must be a
          <span class="emphasis"><em>set</em></span> of column values; the number of
          values in each set must be the same as the number of columns
          used in the <code class="literal">COLUMNS</code> clause, and the data
          types of these values must match those of the columns (and
          occur in the same order). In the simplest case, the set
          consists of a single column. The maximum number of columns
          that can be used in the <em class="replaceable"><code>column_list</code></em>
          and in the elements making up the
          <em class="replaceable"><code>value_list</code></em> is 16.
        </p><p>
          The table defined by the following <code class="literal">CREATE
          TABLE</code> statement provides an example of a table using
          <code class="literal">LIST COLUMNS</code> partitioning:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE lc (
    a INT NULL,
    b INT NULL
)
PARTITION BY LIST COLUMNS(a,b) (
    PARTITION p0 VALUES IN( (0,0), (NULL,NULL) ),
    PARTITION p1 VALUES IN( (0,1), (0,2), (0,3), (1,1), (1,2) ),
    PARTITION p2 VALUES IN( (1,0), (2,0), (2,1), (3,0), (3,1) ),
    PARTITION p3 VALUES IN( (1,3), (2,2), (2,3), (3,2), (3,3) )
);
</pre></li><li class="listitem"><p>
          <code class="literal">PARTITIONS <em class="replaceable"><code>num</code></em></code>
        </p><p>
          The number of partitions may optionally be specified with a
          <code class="literal">PARTITIONS <em class="replaceable"><code>num</code></em></code>
          clause, where <em class="replaceable"><code>num</code></em> is the number of
          partitions. If both this clause <span class="emphasis"><em>and</em></span> any
          <code class="literal">PARTITION</code> clauses are used,
          <em class="replaceable"><code>num</code></em> must be equal to the total
          number of any partitions that are declared using
          <code class="literal">PARTITION</code> clauses.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Whether or not you use a <code class="literal">PARTITIONS</code>
            clause in creating a table that is partitioned by
            <code class="literal">RANGE</code> or <code class="literal">LIST</code>, you
            must still include at least one <code class="literal">PARTITION
            VALUES</code> clause in the table definition (see below).
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">SUBPARTITION BY</code>
        </p><p>
          A partition may optionally be divided into a number of
          subpartitions. This can be indicated by using the optional
          <code class="literal">SUBPARTITION BY</code> clause. Subpartitioning may
          be done by <code class="literal">HASH</code> or <code class="literal">KEY</code>.
          Either of these may be <code class="literal">LINEAR</code>. These work
          in the same way as previously described for the equivalent
          partitioning types. (It is not possible to subpartition by
          <code class="literal">LIST</code> or <code class="literal">RANGE</code>.)
        </p><p>
          The number of subpartitions can be indicated using the
          <code class="literal">SUBPARTITIONS</code> keyword followed by an
          integer value.
        </p></li><li class="listitem"><p>
          Rigorous checking of the value used in
          <code class="literal">PARTITIONS</code> or
          <code class="literal">SUBPARTITIONS</code> clauses is applied and this
          value must adhere to the following rules:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              The value must be a positive, nonzero integer.
            </p></li><li class="listitem"><p>
              No leading zeros are permitted.
            </p></li><li class="listitem"><p>
              The value must be an integer literal, and cannot not be an
              expression. For example, <code class="literal">PARTITIONS
              0.2E+01</code> is not permitted, even though
              <code class="literal">0.2E+01</code> evaluates to
              <code class="literal">2</code>. (Bug #15890)
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal"><em class="replaceable"><code>partition_definition</code></em></code>
        </p><p>
          Each partition may be individually defined using a
          <em class="replaceable"><code>partition_definition</code></em> clause. The
          individual parts making up this clause are as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">PARTITION
              <em class="replaceable"><code>partition_name</code></em></code>
            </p><p>
              Specifies a logical name for the partition.
            </p></li><li class="listitem"><p>
              <code class="literal">VALUES</code>
            </p><p>
              For range partitioning, each partition must include a
              <code class="literal">VALUES LESS THAN</code> clause; for list
              partitioning, you must specify a <code class="literal">VALUES
              IN</code> clause for each partition. This is used to
              determine which rows are to be stored in this partition.
              See the discussions of partitioning types in
              <a class="xref" href="partitioning.html" title="Chapter 23 Partitioning">Chapter 23, <i>Partitioning</i></a>, for syntax examples.
            </p></li><li class="listitem"><p>
              <code class="literal">[STORAGE] ENGINE</code>
            </p><p>
              MySQL accepts a <code class="literal">[STORAGE] ENGINE</code> option
              for both <code class="literal">PARTITION</code> and
              <code class="literal">SUBPARTITION</code>. Currently, the only way
              in which this option can be used is to set all partitions
              or all subpartitions to the same storage engine, and an
              attempt to set different storage engines for partitions or
              subpartitions in the same table will give rise to the
              error <span class="errortext">ERROR 1469 (HY000): The mix of handlers
              in the partitions is not permitted in this version of
              MySQL</span>.
            </p></li><li class="listitem"><p>
              <code class="literal">COMMENT</code>
            </p><p>
              An optional <code class="literal">COMMENT</code> clause may be used
              to specify a string that describes the partition. Example:
            </p><pre data-lang="sql" class="programlisting">
COMMENT = 'Data for the years previous to 1999'
</pre><p>
              The maximum length for a partition comment is 1024
              characters.
            </p></li><li class="listitem"><p>
              <code class="literal">DATA DIRECTORY</code> and <code class="literal">INDEX
              DIRECTORY</code>
            </p><p>
              <code class="literal">DATA DIRECTORY</code> and <code class="literal">INDEX
              DIRECTORY</code> may be used to indicate the directory
              where, respectively, the data and indexes for this
              partition are to be stored. Both the
              <code class="filename"><em class="replaceable"><code>data_dir</code></em></code>
              and the
              <code class="filename"><em class="replaceable"><code>index_dir</code></em></code>
              must be absolute system path names.
            </p><p>
              You must have the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a>
              privilege to use the <code class="literal">DATA DIRECTORY</code> or
              <code class="literal">INDEX DIRECTORY</code> partition option.
            </p><p>
              Example:
            </p><pre data-lang="sql" class="programlisting">
CREATE TABLE th (id INT, name VARCHAR(30), adate DATE)
PARTITION BY LIST(YEAR(adate))
(
  PARTITION p1999 VALUES IN (1995, 1999, 2003)
    DATA DIRECTORY = '<code class="filename">/var/appdata/95/data</code>'
    INDEX DIRECTORY = '<code class="filename">/var/appdata/95/idx</code>',
  PARTITION p2000 VALUES IN (1996, 2000, 2004)
    DATA DIRECTORY = '<code class="filename">/var/appdata/96/data</code>'
    INDEX DIRECTORY = '<code class="filename">/var/appdata/96/idx</code>',
  PARTITION p2001 VALUES IN (1997, 2001, 2005)
    DATA DIRECTORY = '<code class="filename">/var/appdata/97/data</code>'
    INDEX DIRECTORY = '<code class="filename">/var/appdata/97/idx</code>',
  PARTITION p2002 VALUES IN (1998, 2002, 2006)
    DATA DIRECTORY = '<code class="filename">/var/appdata/98/data</code>'
    INDEX DIRECTORY = '<code class="filename">/var/appdata/98/idx</code>'
);
</pre><p>
              <code class="literal">DATA DIRECTORY</code> and <code class="literal">INDEX
              DIRECTORY</code> behave in the same way as in the
              <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
              statement's <em class="replaceable"><code>table_option</code></em>
              clause as used for <code class="literal">MyISAM</code> tables.
            </p><p>
              One data directory and one index directory may be
              specified per partition. If left unspecified, the data and
              indexes are stored by default in the table's database
              directory.
            </p><p>
              The <code class="literal">DATA DIRECTORY</code> and <code class="literal">INDEX
              DIRECTORY</code> options are ignored for creating
              partitioned tables if
              <a class="link" href="server-administration.html#sqlmode_no_dir_in_create"><code class="literal">NO_DIR_IN_CREATE</code></a> is in
              effect.
            </p></li><li class="listitem"><p>
              <code class="literal">MAX_ROWS</code> and
              <code class="literal">MIN_ROWS</code>
            </p><p>
              May be used to specify, respectively, the maximum and
              minimum number of rows to be stored in the partition. The
              values for <em class="replaceable"><code>max_number_of_rows</code></em>
              and <em class="replaceable"><code>min_number_of_rows</code></em> must be
              positive integers. As with the table-level options with
              the same names, these act only as
              <span class="quote">“<span class="quote">suggestions</span>”</span> to the server and are not hard
              limits.
            </p></li><li class="listitem"><p>
              <code class="literal">TABLESPACE</code>
            </p><p>
              May be used to designate an <code class="literal">InnoDB</code>
              file-per-table tablespace for the partition by specifying
              <code class="literal">TABLESPACE `innodb_file_per_table`</code>. All
              partitions must belong to the same storage engine.
            </p><p>
              Placing <code class="literal">InnoDB</code> table partitions in
              shared <code class="literal">InnoDB</code> tablespaces is not
              supported. Shared tablespaces include the
              <code class="literal">InnoDB</code> system tablespace and general
              tablespaces.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal"><em class="replaceable"><code>subpartition_definition</code></em></code>
        </p><p>
          The partition definition may optionally contain one or more
          <em class="replaceable"><code>subpartition_definition</code></em> clauses.
          Each of these consists at a minimum of the
          <code class="literal">SUBPARTITION
          <em class="replaceable"><code>name</code></em></code>, where
          <em class="replaceable"><code>name</code></em> is an identifier for the
          subpartition. Except for the replacement of the
          <code class="literal">PARTITION</code> keyword with
          <code class="literal">SUBPARTITION</code>, the syntax for a subpartition
          definition is identical to that for a partition definition.
        </p><p>
          Subpartitioning must be done by <code class="literal">HASH</code> or
          <code class="literal">KEY</code>, and can be done only on
          <code class="literal">RANGE</code> or <code class="literal">LIST</code>
          partitions. See <a class="xref" href="partitioning.html#partitioning-subpartitions" title="23.2.6 Subpartitioning">Section 23.2.6, “Subpartitioning”</a>.
</p></li></ul>
</div>
<p>
      <span class="bold"><strong>Partitioning by Generated Columns</strong></span>
    </p><p>
      Partitioning by generated columns is permitted. For example:
    </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (
  s1 INT,
  s2 INT AS (EXP(s1)) STORED
)
PARTITION BY LIST (s2) (
  PARTITION p1 VALUES IN (1)
);
</pre><p>
      Partitioning sees a generated column as a regular column, which
      enables workarounds for limitations on functions that are not
      permitted for partitioning (see
      <a class="xref" href="partitioning.html#partitioning-limitations-functions" title="23.6.3 Partitioning Limitations Relating to Functions">Section 23.6.3, “Partitioning Limitations Relating to Functions”</a>). The
      preceding example demonstrates this technique:
      <a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a> cannot be used directly in
      the <code class="literal">PARTITION BY</code> clause, but a generated column
      defined using <a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a> is permitted.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-statement-retention"></a>13.1.20.1 CREATE TABLE Statement Retention</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091668759104"></a><a class="indexterm" name="idm140091668757616"></a><a class="indexterm" name="idm140091668756128"></a><p>
        The original <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
        statement, including all specifications and table options are
        stored by MySQL when the table is created. The information is
        retained so that if you change storage engines, collations or
        other settings using an <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a> statement, the original table options specified
        are retained. This enables you to change between
        <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
        <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> table types even though the
        row formats supported by the two engines are different.
      </p><p>
        Because the text of the original statement is retained, but due
        to the way that certain values and options may be silently
        reconfigured, the active table definition (accessible through
        <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> or with
        <a class="link" href="sql-syntax.html#show-table-status" title="13.7.6.36 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a>) and the table
        creation string (accessible through <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW
        CREATE TABLE</code></a>) may report different values.
      </p><p>
        For <code class="literal">InnoDB</code> tables, <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW
        CREATE TABLE</code></a> and the <code class="literal">Create_options</code>
        column reported by <a class="link" href="sql-syntax.html#show-table-status" title="13.7.6.36 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE
        STATUS</code></a> show the actual <code class="literal">ROW_FORMAT</code>
        and <code class="literal">KEY_BLOCK_SIZE</code> attributes used by the
        table. In previous MySQL releases, the originally specified
        values for these attributes were reported.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-files"></a>13.1.20.2 Files Created by CREATE TABLE</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091668736592"></a><p>
        For an <code class="literal">InnoDB</code> table created in a
        file-per-table tablespace or general tablespace, table data and
        associated indexes are stored in an
        <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file">ibd file</a> in the database
        directory. When an <code class="literal">InnoDB</code> table is created in
        the system tablespace, table data and indexes are stored in the
        <a class="link" href="glossary.html#glos_ibdata_file" title="ibdata file">ibdata* files</a> that
        represent the system tablespace. The
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a> option
        controls whether tables are created in file-per-table
        tablespaces or the system tablespace, by default. The
        <code class="literal">TABLESPACE</code> option can be used to place a
        table in a file-per-table tablespace, general tablespace, or the
        system tablespace, regardless of the
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a> setting.
      </p><p>
        For <code class="literal">MyISAM</code> tables, the storage engine creates
        data and index files. Thus, for each <code class="literal">MyISAM</code>
        table <em class="replaceable"><code>tbl_name</code></em>, there are two disk
        files.
</p>
<div class="informaltable">
<table summary="The purpose of MyISAM table tbl_name disk files."><col width="30%"><col width="70%"><thead><tr>
            <th scope="col">File</th>
            <th scope="col">Purpose</th>
          </tr></thead><tbody><tr>
            <td scope="row"><code class="filename"><em class="replaceable"><code>tbl_name</code></em>.MYD</code></td>
            <td>Data file</td>
          </tr><tr>
            <td scope="row"><code class="filename"><em class="replaceable"><code>tbl_name</code></em>.MYI</code></td>
            <td>Index file</td>
</tr></tbody></table>
</div>
<p>
        <a class="xref" href="storage-engines.html" title="Chapter 16 Alternative Storage Engines">Chapter 16, <i>Alternative Storage Engines</i></a>, describes what files each
        storage engine creates to represent tables. If a table name
        contains special characters, the names for the table files
        contain encoded versions of those characters as described in
        <a class="xref" href="language-structure.html#identifier-mapping" title="9.2.3 Mapping of Identifiers to File Names">Section 9.2.3, “Mapping of Identifiers to File Names”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-temporary-table"></a>13.1.20.3 CREATE TEMPORARY TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091668710032"></a><a class="indexterm" name="idm140091668708992"></a><p>
        You can use the <code class="literal">TEMPORARY</code> keyword when
        creating a table. A <code class="literal">TEMPORARY</code> table is
        visible only within the current session, and is dropped
        automatically when the session is closed. This means that two
        different sessions can use the same temporary table name without
        conflicting with each other or with an existing
        non-<code class="literal">TEMPORARY</code> table of the same name. (The
        existing table is hidden until the temporary table is dropped.)
      </p><p>
        <code class="literal">InnoDB</code> does not support compressed temporary
        tables. When <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a>
        is enabled (the default),
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TEMPORARY
        TABLE</code></a> returns an error if
        <code class="literal">ROW_FORMAT=COMPRESSED</code> or
        <code class="literal">KEY_BLOCK_SIZE</code> is specified. If
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> is disabled,
        warnings are issued and the temporary table is created using a
        non-compressed row format. The
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per-table</code></a> option
        does not affect the creation of <code class="literal">InnoDB</code>
        temporary tables.
      </p><p>
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> causes an implicit
        commit, except when used with the <code class="literal">TEMPORARY</code>
        keyword. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        <code class="literal">TEMPORARY</code> tables have a very loose
        relationship with databases (schemas). Dropping a database does
        not automatically drop any <code class="literal">TEMPORARY</code> tables
        created within that database. Also, you can create a
        <code class="literal">TEMPORARY</code> table in a nonexistent database if
        you qualify the table name with the database name in the
        <code class="literal">CREATE TABLE</code> statement. In this case, all
        subsequent references to the table must be qualified with the
        database name.
      </p><a class="indexterm" name="idm140091668689232"></a><a class="indexterm" name="idm140091668687744"></a><p>
        To create a temporary table, you must have the
        <a class="link" href="security.html#priv_create-temporary-tables"><code class="literal">CREATE TEMPORARY TABLES</code></a>
        privilege. After a session has created a temporary table, the
        server performs no further privilege checks on the table. The
        creating session can perform any operation on the table, such as
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>,
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>,
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>, or
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>.
      </p><p>
        One implication of this behavior is that a session can
        manipulate its temporary tables even if the current user has no
        privilege to create them. Suppose that the current user does not
        have the <a class="link" href="security.html#priv_create-temporary-tables"><code class="literal">CREATE TEMPORARY TABLES</code></a>
        privilege but is able to execute a definer-context stored
        procedure that executes with the privileges of a user who does
        have <a class="link" href="security.html#priv_create-temporary-tables"><code class="literal">CREATE TEMPORARY TABLES</code></a> and
        that creates a temporary table. While the procedure executes,
        the session uses the privileges of the defining user. After the
        procedure returns, the effective privileges revert to those of
        the current user, which can still see the temporary table and
        perform any operation on it.
      </p><p>
        You cannot use <code class="literal">CREATE TEMPORY TABLE ... LIKE</code>
        to create an empty table based on the definition of a table that
        resides in the <code class="literal">mysql</code> tablespace,
        <code class="literal">InnoDB</code> system tablespace
        (<code class="literal">innodb_system</code>), or a general tablespace. The
        tablespace definition for such a table includes a
        <code class="literal">TABLESPACE</code> attribute that defines the
        tablespace where the table resides, and the aforementioned
        tablespaces do not support temporary tables. To create a
        temporary table based on the definition of such a table, use
        this syntax instead:
      </p><pre data-lang="sql" class="programlisting">
CREATE TEMPORARY TABLE <em class="replaceable"><code>new_tbl</code></em> SELECT * FROM <em class="replaceable"><code>orig_tbl</code></em> LIMIT 0;        
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Support for <code class="literal">TABLESPACE =
          innodb_file_per_table</code> and <code class="literal">TABLESPACE =
          innodb_temporary</code> clauses with
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TEMPORARY
          TABLE</code></a> is deprecated as of MySQL 8.0.13 and will be
          removed in a future version of MySQL.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-like"></a>13.1.20.4 CREATE TABLE ... LIKE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091668663888"></a><a class="indexterm" name="idm140091668662848"></a><p>
        Use <code class="literal">CREATE TABLE ... LIKE</code> to create an empty
        table based on the definition of another table, including any
        column attributes and indexes defined in the original table:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE <em class="replaceable"><code>new_tbl</code></em> LIKE <em class="replaceable"><code>orig_tbl</code></em>;
</pre><p>
        The copy is created using the same version of the table storage
        format as the original table. The
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege is required on
        the original table.
      </p><p>
        <code class="literal">LIKE</code> works only for base tables, not for
        views.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          You cannot execute <code class="literal">CREATE TABLE</code> or
          <code class="literal">CREATE TABLE ... LIKE</code> while a
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement is in
          effect.
        </p><p>
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
          LIKE</code></a> makes the same checks as
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>. This means that
          if the current SQL mode is different from the mode in effect
          when the original table was created, the table definition
          might be considered invalid for the new mode and the statement
          will fail.
</p>
</div>
<p>
        For <code class="literal">CREATE TABLE ... LIKE</code>, the destination
        table preserves generated column information from the original
        table.
      </p><p>
        For <code class="literal">CREATE TABLE ... LIKE</code>, the destination
        table preserves expression default values from the original
        table.
      </p><p>
        For <code class="literal">CREATE TABLE ... LIKE</code>, the destination
        table preserves <code class="literal">CHECK</code> constraints from the
        original table, except that all the constraint names are
        generated.
      </p><p>
        <code class="literal">CREATE TABLE ... LIKE</code> does not preserve any
        <code class="literal">DATA DIRECTORY</code> or <code class="literal">INDEX
        DIRECTORY</code> table options that were specified for the
        original table, or any foreign key definitions.
      </p><p>
        If the original table is a <code class="literal">TEMPORARY</code> table,
        <code class="literal">CREATE TABLE ... LIKE</code> does not preserve
        <code class="literal">TEMPORARY</code>. To create a
        <code class="literal">TEMPORARY</code> destination table, use
        <code class="literal">CREATE TEMPORARY TABLE ... LIKE</code>.
      </p><p>
        Tables created in the <code class="literal">mysql</code> tablespace, the
        <code class="literal">InnoDB</code> system tablespace
        (<code class="literal">innodb_system</code>), or general tablespaces
        include a <code class="literal">TABLESPACE</code> attribute in the table
        definition, which defines the tablespace where the table
        resides. Due to a temporary regression, <code class="literal">CREATE TABLE
        ... LIKE</code> preserves the <code class="literal">TABLESPACE</code>
        attribute and creates the table in the defined tablespace
        regardless of the
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a> setting.
        To avoid the <code class="literal">TABLESPACE</code> attribute when
        creating an empty table based on the definition of such a table,
        use this syntax instead:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE <em class="replaceable"><code>new_tbl</code></em> SELECT * FROM <em class="replaceable"><code>orig_tbl</code></em> LIMIT 0;        
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-select"></a>13.1.20.5 CREATE TABLE ... SELECT Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091668626464"></a><a class="indexterm" name="idm140091668625424"></a><p>
        You can create one table from another by adding a
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement at the end of
        the <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE <em class="replaceable"><code>new_tbl</code></em> [AS] SELECT * FROM <em class="replaceable"><code>orig_tbl</code></em>;
</pre><p>
        MySQL creates new columns for all elements in the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>. For example:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE test (a INT NOT NULL AUTO_INCREMENT,</code></strong>
    -&gt;        <strong class="userinput"><code>PRIMARY KEY (a), KEY(b))</code></strong>
    -&gt;        <strong class="userinput"><code>ENGINE=MyISAM SELECT b,c FROM test2;</code></strong>
</pre><p>
        This creates a <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> table with
        three columns, <code class="literal">a</code>, <code class="literal">b</code>, and
        <code class="literal">c</code>. The <code class="literal">ENGINE</code> option is
        part of the <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
        statement, and should not be used following the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>; this would result in a
        syntax error. The same is true for other
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> options such as
        <code class="literal">CHARSET</code>.
      </p><p>
        Notice that the columns from the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement are appended to
        the right side of the table, not overlapped onto it. Take the
        following example:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM foo;</code></strong>
+---+
| n |
+---+
| 1 |
+---+

mysql&gt; <strong class="userinput"><code>CREATE TABLE bar (m INT) SELECT n FROM foo;</code></strong>
Query OK, 1 row affected (0.02 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM bar;</code></strong>
+------+---+
| m    | n |
+------+---+
| NULL | 1 |
+------+---+
1 row in set (0.00 sec)
</pre><p>
        For each row in table <code class="literal">foo</code>, a row is inserted
        in <code class="literal">bar</code> with the values from
        <code class="literal">foo</code> and default values for the new columns.
      </p><p>
        In a table resulting from
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
        SELECT</code></a>, columns named only in the
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> part come first.
        Columns named in both parts or only in the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part come after that. The
        data type of <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> columns can
        be overridden by also specifying the column in the
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> part.
      </p><p>
        If any errors occur while copying the data to the table, it is
        automatically dropped and not created.
      </p><p>
        You can precede the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> by
        <code class="literal">IGNORE</code> or <code class="literal">REPLACE</code> to
        indicate how to handle rows that duplicate unique key values.
        With <code class="literal">IGNORE</code>, rows that duplicate an existing
        row on a unique key value are discarded. With
        <code class="literal">REPLACE</code>, new rows replace rows that have the
        same unique key value. If neither <code class="literal">IGNORE</code> nor
        <code class="literal">REPLACE</code> is specified, duplicate unique key
        values result in an error. For more information, see
        <a class="xref" href="server-administration.html#ignore-strict-comparison" title="Comparison of the IGNORE Keyword and Strict SQL Mode">Comparison of the IGNORE Keyword and Strict SQL Mode</a>.
      </p><p>
        Because the ordering of the rows in the underlying
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements cannot always
        be determined, <code class="literal">CREATE TABLE ... IGNORE SELECT</code>
        and <code class="literal">CREATE TABLE ... REPLACE SELECT</code>
        statements are flagged as unsafe for statement-based
        replication. Such statements produce a warning in the error log
        when using statement-based mode and are written to the binary
        log using the row-based format when using
        <code class="literal">MIXED</code> mode. See also
        <a class="xref" href="replication.html#replication-sbr-rbr" title="17.2.1.1 Advantages and Disadvantages of Statement-Based and Row-Based Replication">Section 17.2.1.1, “Advantages and Disadvantages of Statement-Based and Row-Based
        Replication”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
        SELECT</code></a> does not automatically create any indexes for
        you. This is done intentionally to make the statement as
        flexible as possible. If you want to have indexes in the created
        table, you should specify these before the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE bar (UNIQUE (n)) SELECT n FROM foo;</code></strong>
</pre><p>
        For <code class="literal">CREATE TABLE ... SELECT</code>, the destination
        table does not preserve information about whether columns in the
        selected-from table are generated columns. The
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part of the statement
        cannot assign values to generated columns in the destination
        table.
      </p><p>
        For <code class="literal">CREATE TABLE ... SELECT</code>, the destination
        table does preserve expression default values from the original
        table.
      </p><p>
        Some conversion of data types might occur. For example, the
        <code class="literal">AUTO_INCREMENT</code> attribute is not preserved,
        and <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> columns can become
        <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a> columns. Retrained
        attributes are <code class="literal">NULL</code> (or <code class="literal">NOT
        NULL</code>) and, for those columns that have them,
        <code class="literal">CHARACTER SET</code>, <code class="literal">COLLATION</code>,
        <code class="literal">COMMENT</code>, and the <code class="literal">DEFAULT</code>
        clause.
      </p><p>
        When creating a table with
        <a class="link" href="sql-syntax.html#create-table-select" title="13.1.20.5 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE ... SELECT</code></a>, make sure to alias any function
        calls or expressions in the query. If you do not, the
        <code class="literal">CREATE</code> statement might fail or result in
        undesirable column names.
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE artists_and_works
  SELECT artist.name, COUNT(work.artist_id) AS number_of_works
  FROM artist LEFT JOIN work ON artist.id = work.artist_id
  GROUP BY artist.id;
</pre><p>
        You can also explicitly specify the data type for a column in
        the created table:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE foo (a TINYINT NOT NULL) SELECT b+1 AS a FROM bar;
</pre><p>
        For <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE
        ... SELECT</code></a>, if <code class="literal">IF NOT EXISTS</code> is
        given and the target table exists, nothing is inserted into the
        destination table, and the statement is not logged.
      </p><p>
        To ensure that the binary log can be used to re-create the
        original tables, MySQL does not permit concurrent inserts during
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
        SELECT</code></a>.
      </p><p>
        You cannot use <code class="literal">FOR UPDATE</code> as part of the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> in a statement such as
        <a class="link" href="sql-syntax.html#create-table-select" title="13.1.20.5 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE <em class="replaceable"><code>new_table</code></em> SELECT ... FROM
        <em class="replaceable"><code>old_table</code></em> ...</code></a>. If you
        attempt to do so, the statement fails.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-foreign-keys"></a>13.1.20.6 Using FOREIGN KEY Constraints</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091668545712"></a><a class="indexterm" name="idm140091668544640"></a><p>
        MySQL supports foreign keys, which let you cross-reference
        related data across tables, and
        <a class="link" href="glossary.html#glos_foreign_key_constraint" title="FOREIGN KEY constraint">foreign key
        constraints</a>, which help keep this spread-out data
        consistent. The essential syntax for a foreign key constraint
        definition in a <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> or
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement looks like
        this:
      </p><pre data-lang="sql" class="programlisting">
[CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] FOREIGN KEY
    [<em class="replaceable"><code>index_name</code></em>] (<em class="replaceable"><code>col_name</code></em>, ...)
    REFERENCES <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>col_name</code></em>,...)
    [ON DELETE <em class="replaceable"><code>reference_option</code></em>]
    [ON UPDATE <em class="replaceable"><code>reference_option</code></em>]

<em class="replaceable"><code>reference_option</code></em>:
    RESTRICT | CASCADE | SET NULL | NO ACTION | SET DEFAULT
</pre><p>
        <em class="replaceable"><code>index_name</code></em> represents a foreign key
        ID. The <em class="replaceable"><code>index_name</code></em> value is ignored
        if there is already an explicitly defined index on the child
        table that can support the foreign key. Otherwise, MySQL
        implicitly creates a foreign key index that is named according
        to the following rules:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If defined, the <code class="literal">CONSTRAINT</code>
            <em class="replaceable"><code>symbol</code></em> value is used. Otherwise,
            the <code class="literal">FOREIGN KEY</code>
            <em class="replaceable"><code>index_name</code></em> value is used.
          </p></li><li class="listitem"><p>
            If neither a <code class="literal">CONSTRAINT</code>
            <em class="replaceable"><code>symbol</code></em> or <code class="literal">FOREIGN
            KEY</code> <em class="replaceable"><code>index_name</code></em> is
            defined, the foreign key index name is generated using the
            name of the referencing foreign key column.
</p></li></ul>
</div>
<p>
        Foreign keys definitions are subject to the following
        conditions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Foreign key relationships involve a
            <a class="link" href="glossary.html#glos_parent_table" title="parent table">parent table</a> that
            holds the central data values, and a
            <a class="link" href="glossary.html#glos_child_table" title="child table">child table</a> with
            identical values pointing back to its parent. The
            <code class="literal">FOREIGN KEY</code> clause is specified in the
            child table. The parent and child tables must use the same
            storage engine. They must not be
            <code class="literal">TEMPORARY</code> tables.
          </p><p>
            In MySQL 8.0, creation of a foreign key
            constraint requires the
            <a class="link" href="security.html#priv_references"><code class="literal">REFERENCES</code></a> privilege for the
            parent table.
          </p></li><li class="listitem"><p>
            Corresponding columns in the foreign key and the referenced
            key must have similar data types. <span class="emphasis"><em>The size and
            sign of integer types must be the same</em></span>. The
            length of string types need not be the same. For nonbinary
            (character) string columns, the character set and collation
            must be the same.
          </p></li><li class="listitem"><p>
            When <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a> is
            enabled, which is the default setting, character set
            conversion is not permitted on tables that include a
            character string column used in a foreign key constraint.
            The workaround is described in
            <a class="xref" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax">Section 13.1.9, “ALTER TABLE Syntax”</a>.
          </p></li><li class="listitem"><p>
            MySQL requires indexes on foreign keys and referenced keys
            so that foreign key checks can be fast and not require a
            table scan. In the referencing table, there must be an index
            where the foreign key columns are listed as the
            <span class="emphasis"><em>first</em></span> columns in the same order. Such
            an index is created on the referencing table automatically
            if it does not exist. This index might be silently dropped
            later, if you create another index that can be used to
            enforce the foreign key constraint.
            <em class="replaceable"><code>index_name</code></em>, if given, is used as
            described previously.
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> permits a foreign key to reference
            any index column or group of columns. However, in the
            referenced table, there must be an index where the
            referenced columns are the <span class="emphasis"><em>first</em></span>
            columns in the same order. Hidden columns that
            <code class="literal">InnoDB</code> adds to an index are also
            considered (see <a class="xref" href="innodb-storage-engine.html#innodb-index-types" title="15.6.2.1 Clustered and Secondary Indexes">Section 15.6.2.1, “Clustered and Secondary Indexes”</a>).
          </p><p>
            <code class="literal">NDB</code> requires an explicit unique key (or
            primary key) on any column referenced as a foreign key.
          </p></li><li class="listitem"><p>
            Index prefixes on foreign key columns are not supported. One
            consequence of this is that
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> and
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns cannot be
            included in a foreign key because indexes on those columns
            must always include a prefix length.
          </p></li><li class="listitem"><p>
            If the <code class="literal">CONSTRAINT
            <em class="replaceable"><code>symbol</code></em></code> clause is given,
            the <em class="replaceable"><code>symbol</code></em> value, if used, must
            be unique in the database. A duplicate
            <em class="replaceable"><code>symbol</code></em> will result in an error
            similar to: <span class="errortext">ERROR 1022 (2300): Can't write;
            duplicate key in table '#sql- 464_1'</span>. If the
            clause is not given, or a <em class="replaceable"><code>symbol</code></em>
            is not included following the <code class="literal">CONSTRAINT</code>
            keyword, MySQL uses the foreign key index name up to MySQL
            8.0.15, and automatically generates a constraint name
            thereafter.
          </p></li><li class="listitem"><p>
            <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> does not currently
            support foreign keys for tables with user-defined
            partitioning. This includes both parent and child tables.
          </p><p>
            This restriction does not apply for
            <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables that are partitioned
            by <code class="literal">KEY</code> or <code class="literal">LINEAR KEY</code>
            (the only user partitioning types supported by the
            <code class="literal">NDB</code> storage engine); these may have
            foreign key references or be the targets of such references.
          </p></li><li class="listitem"><p>
            For <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables, <code class="literal">ON
            UPDATE CASCADE</code> is not supported where the
            reference is to the parent table's primary key.
</p></li></ul>
</div>
<p>
        Additional aspects of <code class="literal">FOREIGN KEY</code> constraint
        usage are described under the following topics in this section:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#foreign-keys-referential-actions" title="Referential Actions">Referential Actions</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#foreign-keys-examples" title="Examples of Foreign Key Clauses">Examples of Foreign Key Clauses</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#foreign-keys-adding" title="Adding Foreign Keys">Adding Foreign Keys</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#foreign-keys-dropping" title="Dropping Foreign Keys">Dropping Foreign Keys</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#foreign-keys-other-statements" title="Foreign Keys and Other MySQL Statements">Foreign Keys and Other MySQL Statements</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#foreign-keys-ansi-iso-sql-standard" title="Foreign Keys and the ANSI/ISO SQL Standard">Foreign Keys and the ANSI/ISO SQL Standard</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#foreign-key-metadata" title="Foreign Key Metadata">Foreign Key Metadata</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#foreign-key-errors" title="Foreign Key Errors">Foreign Key Errors</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="foreign-keys-referential-actions"></a>Referential Actions</h5>

</div>

</div>

</div>
<p>
          This section describes how foreign keys help guarantee
          <a class="link" href="glossary.html#glos_referential_integrity" title="referential integrity">referential
          integrity</a>.
        </p><p>
          For storage engines supporting foreign keys, MySQL rejects any
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> or
          <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> operation that attempts
          to create a foreign key value in a child table if there is no
          a matching candidate key value in the parent table.
        </p><p>
          When an <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> or
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> operation affects a key
          value in the parent table that has matching rows in the child
          table, the result depends on the <span class="emphasis"><em>referential
          action</em></span> specified using <code class="literal">ON UPDATE</code>
          and <code class="literal">ON DELETE</code> subclauses of the
          <code class="literal">FOREIGN KEY</code> clause. MySQL supports five
          options regarding the action to be taken, listed here:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CASCADE</code>: Delete or update the row from
              the parent table, and automatically delete or update the
              matching rows in the child table. Both <code class="literal">ON DELETE
              CASCADE</code> and <code class="literal">ON UPDATE CASCADE</code>
              are supported. Between two tables, do not define several
              <code class="literal">ON UPDATE CASCADE</code> clauses that act on
              the same column in the parent table or in the child table.
            </p><p>
              If a <code class="literal">FOREIGN KEY</code> clause is defined on
              both tables in a foreign key relationship, making both
              tables a parent and child, an <code class="literal">ON UPDATE
              CASCADE</code> or <code class="literal">ON DELETE CASCADE</code>
              subclause defined for one <code class="literal">FOREIGN KEY</code>
              clause must be defined for the other in order for
              cascading operations to succeed. If an <code class="literal">ON UPDATE
              CASCADE</code> or <code class="literal">ON DELETE CASCADE</code>
              subclause is only defined for one <code class="literal">FOREIGN
              KEY</code> clause, cascading operations fail with an
              error.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
                Cascaded foreign key actions do not activate triggers.
</p>
</div>
</li><li class="listitem"><p>
              <code class="literal">SET NULL</code>: Delete or update the row from
              the parent table, and set the foreign key column or
              columns in the child table to <code class="literal">NULL</code>.
              Both <code class="literal">ON DELETE SET NULL</code> and <code class="literal">ON
              UPDATE SET NULL</code> clauses are supported.
            </p><p>
              If you specify a <code class="literal">SET NULL</code> action,
              <span class="emphasis"><em>make sure that you have not declared the columns
              in the child table as <code class="literal">NOT
              NULL</code></em></span>.
            </p></li><li class="listitem"><p>
              <code class="literal">RESTRICT</code>: Rejects the delete or update
              operation for the parent table. Specifying
              <code class="literal">RESTRICT</code> (or <code class="literal">NO
              ACTION</code>) is the same as omitting the <code class="literal">ON
              DELETE</code> or <code class="literal">ON UPDATE</code> clause.
            </p></li><li class="listitem"><p>
              <code class="literal">NO ACTION</code>: A keyword from standard SQL.
              In MySQL, equivalent to <code class="literal">RESTRICT</code>. The
              MySQL Server rejects the delete or update operation for
              the parent table if there is a related foreign key value
              in the referenced table. Some database systems have
              deferred checks, and <code class="literal">NO ACTION</code> is a
              deferred check. In MySQL, foreign key constraints are
              checked immediately, so <code class="literal">NO ACTION</code> is
              the same as <code class="literal">RESTRICT</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">SET DEFAULT</code>: This action is recognized
              by the MySQL parser, but both
              <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
              <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> reject table definitions
              containing <code class="literal">ON DELETE SET DEFAULT</code> or
              <code class="literal">ON UPDATE SET DEFAULT</code> clauses.
</p></li></ul>
</div>
<p>
          For an <code class="literal">ON DELETE</code> or <code class="literal">ON
          UPDATE</code> that is not specified, the default action is
          always <code class="literal">RESTRICT</code>.
        </p><p>
          MySQL supports foreign key references between one column and
          another within a table. (A column cannot have a foreign key
          reference to itself.) In these cases, <span class="quote">“<span class="quote">child table
          records</span>”</span> really refers to dependent records within the
          same table.
        </p><p>
          A foreign key constraint on a stored generated column cannot
          use <code class="literal">CASCADE</code>, <code class="literal">SET NULL</code>,
          or <code class="literal">SET DEFAULT</code> as <code class="literal">ON
          UPDATE</code> referential actions, nor can it use
          <code class="literal">SET NULL</code> or <code class="literal">SET DEFAULT</code>
          as <code class="literal">ON DELETE</code> referential actions.
        </p><p>
          A foreign key constraint on the base column of a stored
          generated column cannot use <code class="literal">CASCADE</code>,
          <code class="literal">SET NULL</code>, or <code class="literal">SET DEFAULT</code>
          as <code class="literal">ON UPDATE</code> or <code class="literal">ON
          DELETE</code> referential actions.
        </p><p>
          A foreign key constraint cannot reference a virtual generated
          column.
        </p><p>
          For <code class="literal">InnoDB</code> restrictions related to foreign
          keys and generated columns, see
          <a class="xref" href="innodb-storage-engine.html#innodb-foreign-key-constraints" title="15.6.1.5 InnoDB and FOREIGN KEY Constraints">Section 15.6.1.5, “InnoDB and FOREIGN KEY Constraints”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="foreign-keys-examples"></a>Examples of Foreign Key Clauses</h5>

</div>

</div>

</div>
<p>
          Here is a simple example that relates
          <code class="literal">parent</code> and <code class="literal">child</code> tables
          through a single-column foreign key:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE parent (
    id INT NOT NULL,
    PRIMARY KEY (id)
) ENGINE=INNODB;

CREATE TABLE child (
    id INT,
    parent_id INT,
    INDEX par_ind (parent_id),
    FOREIGN KEY (parent_id)
        REFERENCES parent(id)
        ON DELETE CASCADE
) ENGINE=INNODB;
</pre><p>
          A more complex example in which a
          <code class="literal">product_order</code> table has foreign keys for
          two other tables. One foreign key references a two-column
          index in the <code class="literal">product</code> table. The other
          references a single-column index in the
          <code class="literal">customer</code> table:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE product (
    category INT NOT NULL, id INT NOT NULL,
    price DECIMAL,
    PRIMARY KEY(category, id)
)   ENGINE=INNODB;

CREATE TABLE customer (
    id INT NOT NULL,
    PRIMARY KEY (id)
)   ENGINE=INNODB;

CREATE TABLE product_order (
    no INT NOT NULL AUTO_INCREMENT,
    product_category INT NOT NULL,
    product_id INT NOT NULL,
    customer_id INT NOT NULL,

    PRIMARY KEY(no),
    INDEX (product_category, product_id),
    INDEX (customer_id),

    FOREIGN KEY (product_category, product_id)
      REFERENCES product(category, id)
      ON UPDATE CASCADE ON DELETE RESTRICT,

    FOREIGN KEY (customer_id)
      REFERENCES customer(id)
)   ENGINE=INNODB;
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="foreign-keys-adding"></a>Adding Foreign Keys</h5>

</div>

</div>

</div>
<p>
          You can add a new foreign key constraint to an existing table
          by using <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>. The
          syntax relating to foreign keys for this statement is shown
          here:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em>
    ADD [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] FOREIGN KEY
    [<em class="replaceable"><code>index_name</code></em>] (<em class="replaceable"><code>col_name</code></em>, ...)
    REFERENCES <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>col_name</code></em>,...)
    [ON DELETE <em class="replaceable"><code>reference_option</code></em>]
    [ON UPDATE <em class="replaceable"><code>reference_option</code></em>]
</pre><p>
          The foreign key can be self referential (referring to the same
          table). When you add a foreign key constraint to a table using
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>, <span class="emphasis"><em>remember
          to create the required indexes first.</em></span>
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="foreign-keys-dropping"></a>Dropping Foreign Keys</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091668397168"></a><a class="indexterm" name="idm140091668396096"></a><a class="indexterm" name="idm140091668394608"></a><p>
          You can also use <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> to
          drop foreign keys, using the syntax shown here:
        </p><pre data-lang="sql" class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DROP FOREIGN KEY <em class="replaceable"><code>fk_symbol</code></em>;
</pre><p>
          If the <code class="literal">FOREIGN KEY</code> clause included a
          <code class="literal">CONSTRAINT</code> name when you created the
          foreign key, you can refer to that name to drop the foreign
          key. Otherwise, the <em class="replaceable"><code>fk_symbol</code></em> value
          is generated internally when the foreign key is created. To
          find out the symbol value when you want to drop a foreign key,
          use a <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>
          statement, as shown here:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE ibtest11c\G</code></strong>
*************************** 1. row ***************************
       Table: ibtest11c
Create Table: CREATE TABLE `ibtest11c` (
  `A` int(11) NOT NULL auto_increment,
  `D` int(11) NOT NULL default '0',
  `B` varchar(200) NOT NULL default '',
  `C` varchar(175) default NULL,
  PRIMARY KEY  (`A`,`D`,`B`),
  KEY `B` (`B`,`C`),
  KEY `C` (`C`),
  CONSTRAINT `0_38775` FOREIGN KEY (`A`, `D`)
REFERENCES `ibtest11a` (`A`, `D`)
ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `0_38776` FOREIGN KEY (`B`, `C`)
REFERENCES `ibtest11a` (`B`, `C`)
ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=INNODB CHARSET=utf8mb4
1 row in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>ALTER TABLE ibtest11c DROP FOREIGN KEY `0_38775`;</code></strong>
</pre><p>
          Adding and dropping a foreign key in the same
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement is
          supported for
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          ALGORITHM=INPLACE</code></a> but is unsupported for
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          ALGORITHM=COPY</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="foreign-keys-other-statements"></a>Foreign Keys and Other MySQL Statements</h5>

</div>

</div>

</div>
<p>
          Table and column identifiers in a <code class="literal">FOREIGN KEY ...
          REFERENCES ...</code> clause can be quoted within backticks
          (<code class="literal">`</code>). Alternatively, double quotation marks
          (<code class="literal">"</code>) can be used if the
          <a class="link" href="server-administration.html#sqlmode_ansi_quotes"><code class="literal">ANSI_QUOTES</code></a> SQL mode is
          enabled. The setting of the
          <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> system
          variable is also taken into account.
        </p><p>
          You can view a child table's foreign key definitions as
          part of the output of the <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE
          TABLE</code></a> statement:
        </p><pre data-lang="sql" class="programlisting">
SHOW CREATE TABLE <em class="replaceable"><code>tbl_name</code></em>;
</pre><p>
          You can also obtain information about foreign keys by querying
          the
          <a class="link" href="information-schema.html#key-column-usage-table" title="25.12 The INFORMATION_SCHEMA KEY_COLUMN_USAGE Table"><code class="literal">INFORMATION_SCHEMA.KEY_COLUMN_USAGE</code></a>
          table.
        </p><p>
          You can find information about foreign keys used by
          <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables in the
          <a class="link" href="information-schema.html#innodb-foreign-table" title="25.39.11 The INFORMATION_SCHEMA INNODB_FOREIGN Table"><code class="literal">INNODB_FOREIGN</code></a> and
          <a class="link" href="information-schema.html#innodb-foreign-cols-table" title="25.39.12 The INFORMATION_SCHEMA INNODB_FOREIGN_COLS Table"><code class="literal">INNODB_FOREIGN_COLS</code></a> tables, also
          in the <code class="literal">INFORMATION_SCHEMA</code> database.
        </p><p>
          <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a> produces correct definitions of
          tables in the dump file, including the foreign keys for child
          tables.
        </p><p>
          To make it easier to reload dump files for tables that have
          foreign key relationships, <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a>
          automatically includes a statement in the dump output to set
          <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a> to 0. This
          avoids problems with tables having to be reloaded in a
          particular order when the dump is reloaded. It is also
          possible to set this variable manually:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET foreign_key_checks = 0;</code></strong>
mysql&gt; <strong class="userinput"><code>SOURCE <em class="replaceable"><code>dump_file_name</code></em>;</code></strong>
mysql&gt; <strong class="userinput"><code>SET foreign_key_checks = 1;</code></strong>
</pre><p>
          This enables you to import the tables in any order if the dump
          file contains tables that are not correctly ordered for
          foreign keys. It also speeds up the import operation. Setting
          <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a> to 0 can
          also be useful for ignoring foreign key constraints during
          <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> and
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operations.
          However, even if <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks =
          0</code></a>, MySQL does not permit the creation of a foreign
          key constraint where a column references a nonmatching column
          type. Also, if a table has foreign key constraints,
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> cannot be used to
          alter the table to use another storage engine. To change the
          storage engine, you must drop any foreign key constraints
          first.
        </p><p>
          You cannot issue <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> for
          a table that is referenced by a <code class="literal">FOREIGN KEY</code>
          constraint, unless you do <code class="literal">SET foreign_key_checks =
          0</code>. When you drop a table, any constraints that were
          defined in the statement used to create that table are also
          dropped.
        </p><p>
          If you re-create a table that was dropped, it must have a
          definition that conforms to the foreign key constraints
          referencing it. It must have the correct column names and
          types, and it must have indexes on the referenced keys, as
          stated earlier. If these are not satisfied, MySQL returns
          Error 1005 and refers to Error 150 in the error message, which
          means that a foreign key constraint was not correctly formed.
          Similarly, if an <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
          fails due to Error 150, this means that a foreign key
          definition would be incorrectly formed for the altered table.
        </p><p>
          For <code class="literal">InnoDB</code> tables, you can obtain a
          detailed explanation of the most recent
          <code class="literal">InnoDB</code> foreign key error in the MySQL
          Server, by checking the output of
          <a class="link" href="sql-syntax.html#show-engine" title="13.7.6.15 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE
          INNODB STATUS</code></a>.
        </p><p>
          MySQL extends metadata locks, as necessary, to tables that are
          related by a foreign key constraint. Extending metadata locks
          prevents conflicting DML and DDL operations from executing
          concurrently on related tables. This feature also enables
          updates to foreign key metadata when a parent table is
          modified. In earlier MySQL releases, foreign key metadata,
          which is owned by the child table, could not be updated
          safely.
        </p><p>
          If a table is locked explicitly with <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
          TABLES</code></a>, any tables related by a foreign key
          constraint are opened and locked implicitly. For foreign key
          checks, a shared read-only lock
          (<a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES
          READ</code></a>) is taken on related tables. For cascading
          updates, a shared-nothing write lock
          (<a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES
          WRITE</code></a>) is taken on related tables that are involved
          in the operation.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="foreign-keys-ansi-iso-sql-standard"></a>Foreign Keys and the ANSI/ISO SQL Standard</h5>

</div>

</div>

</div>
<p>
          For users familiar with the ANSI/ISO SQL Standard, please note
          that no storage engine, including <code class="literal">InnoDB</code>,
          recognizes or enforces the <code class="literal">MATCH</code> clause
          used in referential-integrity constraint definitions. Use of
          an explicit <code class="literal">MATCH</code> clause will not have the
          specified effect, and also causes <code class="literal">ON DELETE</code>
          and <code class="literal">ON UPDATE</code> clauses to be ignored. For
          these reasons, specifying <code class="literal">MATCH</code> should be
          avoided.
        </p><p>
          The <code class="literal">MATCH</code> clause in the SQL standard
          controls how <code class="literal">NULL</code> values in a composite
          (multiple-column) foreign key are handled when comparing to a
          primary key. MySQL essentially implements the semantics
          defined by <code class="literal">MATCH SIMPLE</code>, which permit a
          foreign key to be all or partially <code class="literal">NULL</code>. In
          that case, the (child table) row containing such a foreign key
          is permitted to be inserted, and does not match any row in the
          referenced (parent) table. It is possible to implement other
          semantics using triggers.
        </p><p>
          Additionally, MySQL requires that the referenced columns be
          indexed for performance reasons. However, the system does not
          enforce a requirement that the referenced columns be
          <code class="literal">UNIQUE</code> or be declared <code class="literal">NOT
          NULL</code>. The handling of foreign key references to
          nonunique keys or keys that contain <code class="literal">NULL</code>
          values is not well defined for operations such as
          <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> or <code class="literal">DELETE
          CASCADE</code>. You are advised to use foreign keys that
          reference only <code class="literal">UNIQUE</code> (including
          <code class="literal">PRIMARY</code>) and <code class="literal">NOT NULL</code>
          keys.
        </p><p>
          Furthermore, MySQL parses but ignores <span class="quote">“<span class="quote">inline
          <code class="literal">REFERENCES</code> specifications</span>”</span> (as
          defined in the SQL standard) where the references are defined
          as part of the column specification. MySQL accepts
          <code class="literal">REFERENCES</code> clauses only when specified as
          part of a separate <code class="literal">FOREIGN KEY</code>
          specification. For storage engines that do not support foreign
          keys (such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>), MySQL
          Server parses and ignores foreign key specifications.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="foreign-key-metadata"></a>Foreign Key Metadata</h5>

</div>

</div>

</div>
<p>
          The
          <a class="link" href="information-schema.html#key-column-usage-table" title="25.12 The INFORMATION_SCHEMA KEY_COLUMN_USAGE Table"><code class="literal">INFORMATION_SCHEMA.KEY_COLUMN_USAGE</code></a>
          table identifies the key columns that have constraints.
          Metadata specific to <code class="literal">InnoDB</code> foreign keys is
          found in the <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/innodb-sys-foreign-table.html" target="_top"><code class="literal">INNODB_SYS_FOREIGN</code></a>
          and <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/innodb-sys-foreign-cols-table.html" target="_top"><code class="literal">INNODB_SYS_FOREIGN_COLS</code></a>
          tables.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="foreign-key-errors"></a>Foreign Key Errors</h5>

</div>

</div>

</div>
<p>
          In the event of a foreign key error involving
          <code class="literal">InnoDB</code> tables (usually Error 150 in the
          MySQL Server), information about the most recent
          <code class="literal">InnoDB</code> foreign key error can be obtained by
          checking <a class="link" href="sql-syntax.html#show-engine" title="13.7.6.15 SHOW ENGINE Syntax"><code class="literal">SHOW
          ENGINE INNODB STATUS</code></a> output.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
            If a user has table-level privileges for all parent tables,
            <a class="link" href="error-handling.html#error_er_no_referenced_row_2"><code class="literal">ER_NO_REFERENCED_ROW_2</code></a> and
            <a class="link" href="error-handling.html#error_er_row_is_referenced_2"><code class="literal">ER_ROW_IS_REFERENCED_2</code></a> error
            messages for foreign key operations expose information about
            parent tables. If a user does not have table-level
            privileges for all parent tables, more generic error
            messages are displayed instead
            (<a class="link" href="error-handling.html#error_er_no_referenced_row"><code class="literal">ER_NO_REFERENCED_ROW</code></a> and
            <a class="link" href="error-handling.html#error_er_row_is_referenced"><code class="literal">ER_ROW_IS_REFERENCED</code></a>).
          </p><p>
            An exception is that, for stored programs defined to execute
            with <code class="literal">DEFINER</code> privileges, the user against
            which privileges are assessed is the user in the program
            <code class="literal">DEFINER</code> clause, not the invoking user. If
            that user has table-level parent table privileges, parent
            table information is still displayed. In this case, it is
            the responsibility of the stored program creator to hide the
            information by including appropriate condition handlers.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-check-constraints"></a>13.1.20.7 CHECK Constraints</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091668287824"></a><p>
        Prior to MySQL 8.0.16, <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
        TABLE</code></a> permits only the following limited version of
        table <code class="literal">CHECK</code> constraint syntax, which is
        parsed and ignored:
      </p><pre data-lang="sql" class="programlisting">
CHECK (<em class="replaceable"><code>expr</code></em>)
</pre><p>
        As of MySQL 8.0.16, <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
        permits the core features of table and column
        <code class="literal">CHECK</code> constraints, for all storage engines.
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> permits the
        following <code class="literal">CHECK</code> constraint syntax, for both
        table constraints and column constraints:
      </p><pre data-lang="sql" class="programlisting">
[CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] CHECK (<em class="replaceable"><code>expr</code></em>) [[NOT] ENFORCED]
</pre><p>
        The optional <em class="replaceable"><code>symbol</code></em> specifies a name
        for the constraint. If omitted, MySQL generates a name from the
        table name, a literal <code class="literal">_chk_</code>, and an ordinal
        number (1, 2, 3, ...). Constraint names have a maximum length of
        64 characters. They are case sensitive, but not accent
        sensitive.
      </p><p>
        <em class="replaceable"><code>expr</code></em> specifies the constraint
        condition as a boolean expression that must evaluate to
        <code class="literal">TRUE</code> or <code class="literal">UNKNOWN</code> (for
        <code class="literal">NULL</code> values) for each row of the table. If
        the condition evaluates to <code class="literal">FALSE</code>, it fails
        and a constraint violation occurs. The effect of a violation
        depends on the statement being executed, as described later in
        this section.
      </p><p>
        The optional enforcement clause indicates whether the constraint
        is enforced:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If omitted or specified as <code class="literal">ENFORCED</code>, the
            constraint is created and enforced.
          </p></li><li class="listitem"><p>
            If specified as <code class="literal">NOT ENFORCED</code>, the
            constraint is created but not enforced.
</p></li></ul>
</div>
<p>
        A <code class="literal">CHECK</code> constraint is specified as either a
        table constraint or column constraint:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A table constraint does not appear within a column
            definition and can refer to any table column or columns.
            Forward references are permitted to columns appearing later
            in the table definition.
          </p></li><li class="listitem"><p>
            A column constraint appears within a column definition and
            can refer only to that column.
</p></li></ul>
</div>
<p>
        Consider this table definition:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1
(
  CHECK (c1 &lt;&gt; c2),
  c1 INT CHECK (c1 &gt; 10),
  c2 INT CONSTRAINT c2_positive CHECK (c2 &gt; 0),
  c3 INT CHECK (c3 &lt; 100),
  CONSTRAINT c1_nonzero CHECK (c1 &lt;&gt; 0),
  CHECK (c1 &gt; c3)
);
</pre><p>
        The definition includes table constraints and column
        constraints, in named and unnamed formats:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The first constraint is a table constraint: It occurs
            outside any column definition, so it can (and does) refer to
            multiple table columns. This constraint contains forward
            references to columns not defined yet. No constraint name is
            specified, so MySQL generates a name.
          </p></li><li class="listitem"><p>
            The next three constraints are column constraints: Each
            occurs within a column definition, and thus can refer only
            to the column being defined. One of the constraints is named
            explicitly. MySQL generates a name for each of the other
            two.
          </p></li><li class="listitem"><p>
            The last two contraints are table constraints. One of them
            is named explicitly. MySQL generates a name for the other
            one.
</p></li></ul>
</div>
<p>
        As mentioned, MySQL generates a name for any
        <code class="literal">CHECK</code> constraint specified without one. To
        see the names generated for the preceding table definition, use
        <code class="literal">SHOW CREATE TABLE</code>:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t1\G</code></strong>
*************************** 1. row ***************************
       Table: t1
Create Table: CREATE TABLE `t1` (
  `c1` int(11) DEFAULT NULL,
  `c2` int(11) DEFAULT NULL,
  `c3` int(11) DEFAULT NULL,
  CONSTRAINT `c1_nonzero` CHECK ((`c1` &lt;&gt; 0)),
  CONSTRAINT `c2_positive` CHECK ((`c2` &gt; 0)),
  CONSTRAINT `t1_chk_1` CHECK ((`c1` &lt;&gt; `c2`)),
  CONSTRAINT `t1_chk_2` CHECK ((`c1` &gt; 10)),
  CONSTRAINT `t1_chk_3` CHECK ((`c3` &lt; 100)),
  CONSTRAINT `t1_chk_4` CHECK ((`c1` &gt; `c3`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
</pre><p>
        The SQL standard specifies that all types of constraints
        (primary key, unique index, foreign key, check) belong to the
        same namespace. In MySQL, each constraint type has its own
        namespace per schema (database). Consequently,
        <code class="literal">CHECK</code> constraint names must be unique per
        schema; no two tables in the same schema can share a
        <code class="literal">CHECK</code> constraint name. (Exception: A
        <code class="literal">TEMPORARY</code> table hides a
        non-<code class="literal">TEMPORARY</code> table of the same name, so it
        can have the same <code class="literal">CHECK</code> constraint names as
        well.)
      </p><p>
        Beginning generated constraint names with the table name helps
        ensure schema uniqueness because table names also must be unique
        within the schema.
      </p><p>
        <code class="literal">CHECK</code> condition expressions must adhere to
        the following rules. An error occurs if an expression contains
        disallowed constructs.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Nongenerated and generated columns are permitted, except
            columns with the <code class="literal">AUTO_INCREMENT</code> attribute
            and columns in other tables.
          </p></li><li class="listitem"><p>
            Literals, deterministic built-in functions, and operators
            are permitted. A function is deterministic if, given the
            same data in tables, multiple invocations produce the same
            result, independently of the connected user. Examples of
            functions that are nondeterministic and fail this
            definition: <a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a>,
            <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>,
            <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>.
          </p></li><li class="listitem"><p>
            Stored functions and user-defined functions are not
            permitted.
          </p></li><li class="listitem"><p>
            Stored procedure and function parameters are not permitted.
          </p></li><li class="listitem"><p>
            Variables (system variables, user-defined variables, and
            stored program local variables) are not permitted.
          </p></li><li class="listitem"><p>
            Subqueries are not permitted.
</p></li></ul>
</div>
<p>
        Foreign key referential actions (<code class="literal">ON UPDATE</code>,
        <code class="literal">ON DELETE</code>) are prohibited on columns used in
        <code class="literal">CHECK</code> constraints. Likewise,
        <code class="literal">CHECK</code> constraints are prohibited on columns
        used in foreign key referential actions.
      </p><p>
        <code class="literal">CHECK</code> constraints are evaluated for
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>,
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>,
        <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a>,
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>, and
        <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> statements and an error
        occurs if a constraint evaluates to <code class="literal">FALSE</code>. If
        an error occurs, handling of changes already applied differs for
        transactional and nontransactional storage engines, and also
        depends on whether strict SQL mode is in effect, as described in
        <a class="xref" href="server-administration.html#sql-mode-strict" title="Strict SQL Mode">Strict SQL Mode</a>.
      </p><p>
        <code class="literal">CHECK</code> constraints are evaluated for
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT IGNORE</code></a>,
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE IGNORE</code></a>,
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA ...
        IGNORE</code></a>, and
        <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML ...
        IGNORE</code></a> statements and a warning occurs if a constraint
        evaluates to <code class="literal">FALSE</code>. The insert or update for
        any offending row is skipped.
      </p><p>
        If the constraint expression evaluates to a data type that
        differs from the declared column type, implicit coercion to the
        declared type occurs according to the usual MySQL
        type-conversion rules. See <a class="xref" href="functions.html#type-conversion" title="12.2 Type Conversion in Expression Evaluation">Section 12.2, “Type Conversion in Expression Evaluation”</a>. If
        type conversion fails or results in a loss of precision, an
        error occurs.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Constraint expression evaluation uses the SQL mode in effect
          at evaluation time. If any component of the expression depends
          on the SQL mode, different results may occur for different
          uses of the table unless the SQL mode is the same during all
          uses.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="silent-column-changes"></a>13.1.20.8 Silent Column Specification Changes</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091668212624"></a><p>
        In some cases, MySQL silently changes column specifications from
        those given in a <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> or
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement. These
        might be changes to a data type, to attributes associated with a
        data type, or to an index specification.
      </p><p>
        All changes are subject to the internal row-size limit of 65,535
        bytes, which may cause some attempts at data type changes to
        fail. See <a class="xref" href="restrictions.html#column-count-limit" title="C.10.4 Limits on Table Column Count and Row Size">Section C.10.4, “Limits on Table Column Count and Row Size”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Columns that are part of a <code class="literal">PRIMARY KEY</code>
            are made <code class="literal">NOT NULL</code> even if not declared
            that way.
          </p></li><li class="listitem"><p>
            Trailing spaces are automatically deleted from
            <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> and
            <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> member values when the
            table is created.
          </p></li><li class="listitem"><p>
            MySQL maps certain data types used by other SQL database
            vendors to MySQL types. See
            <a class="xref" href="data-types.html#other-vendor-data-types" title="11.10 Using Data Types from Other Database Engines">Section 11.10, “Using Data Types from Other Database Engines”</a>.
          </p></li><li class="listitem"><p>
            If you include a <code class="literal">USING</code> clause to specify
            an index type that is not permitted for a given storage
            engine, but there is another index type available that the
            engine can use without affecting query results, the engine
            uses the available type.
          </p></li><li class="listitem"><p>
            If strict SQL mode is not enabled, a
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> column with a length
            specification greater than 65535 is converted to
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>, and a
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> column with a
            length specification greater than 65535 is converted to
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>. Otherwise, an error
            occurs in either of these cases.
          </p></li><li class="listitem"><p>
            Specifying the <code class="literal">CHARACTER SET binary</code>
            attribute for a character data type causes the column to be
            created as the corresponding binary data type:
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a> becomes
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> becomes
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>, and
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> becomes
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>. For the
            <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> and
            <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> data types, this does not
            occur; they are created as declared. Suppose that you
            specify a table using this definition:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t
(
  c1 VARCHAR(10) CHARACTER SET binary,
  c2 TEXT CHARACTER SET binary,
  c3 ENUM('a','b','c') CHARACTER SET binary
);
</pre><p>
            The resulting table has this definition:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t
(
  c1 VARBINARY(10),
  c2 BLOB,
  c3 ENUM('a','b','c') CHARACTER SET binary
);
</pre></li></ul>
</div>
<p>
        To see whether MySQL used a data type other than the one you
        specified, issue a <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> or
        <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a> statement after
        creating or altering the table.
      </p><a class="indexterm" name="idm140091668174688"></a><p>
        Certain other data type changes can occur if you compress a
        table using <a class="link" href="programs.html#myisampack" title="4.6.6 myisampack — Generate Compressed, Read-Only MyISAM Tables"><span class="command"><strong>myisampack</strong></span></a>. See
        <a class="xref" href="storage-engines.html#compressed-format" title="16.2.3.3 Compressed Table Characteristics">Section 16.2.3.3, “Compressed Table Characteristics”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-generated-columns"></a>13.1.20.9 CREATE TABLE and Generated Columns</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091668170000"></a><p>
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> supports the
        specification of generated columns. Values of a generated column
        are computed from an expression included in the column
        definition.
      </p><p>
        Generated columns are also supported by the
        <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> storage engine.
      </p><p>
        The following simple example shows a table that stores the
        lengths of the sides of right triangles in the
        <code class="literal">sidea</code> and <code class="literal">sideb</code> columns,
        and computes the length of the hypotenuse in
        <code class="literal">sidec</code> (the square root of the sums of the
        squares of the other sides):
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE triangle (
  sidea DOUBLE,
  sideb DOUBLE,
  sidec DOUBLE AS (SQRT(sidea * sidea + sideb * sideb))
);
INSERT INTO triangle (sidea, sideb) VALUES(1,1),(3,4),(6,8);
</pre><p>
        Selecting from the table yields this result:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM triangle;</code></strong>
+-------+-------+--------------------+
| sidea | sideb | sidec              |
+-------+-------+--------------------+
|     1 |     1 | 1.4142135623730951 |
|     3 |     4 |                  5 |
|     6 |     8 |                 10 |
+-------+-------+--------------------+
</pre><p>
        Any application that uses the <code class="literal">triangle</code> table
        has access to the hypotenuse values without having to specify
        the expression that calculates them.
      </p><p>
        Generated column definitions have this syntax:
      </p><pre data-lang="sql" class="programlisting">
<em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>data_type</code></em> [GENERATED ALWAYS] AS (<em class="replaceable"><code>expr</code></em>)
  [VIRTUAL | STORED] [NOT NULL | NULL]
  [UNIQUE [KEY]] [[PRIMARY] KEY]
  [COMMENT '<em class="replaceable"><code>string</code></em>']
</pre><p>
        <code class="literal">AS (<em class="replaceable"><code>expr</code></em>)</code>
        indicates that the column is generated and defines the
        expression used to compute column values. <code class="literal">AS</code>
        may be preceded by <code class="literal">GENERATED ALWAYS</code> to make
        the generated nature of the column more explicit. Constructs
        that are permitted or prohibited in the expression are discussed
        later.
      </p><p>
        The <code class="literal">VIRTUAL</code> or <code class="literal">STORED</code>
        keyword indicates how column values are stored, which has
        implications for column use:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">VIRTUAL</code>: Column values are not stored,
            but are evaluated when rows are read, immediately after any
            <code class="literal">BEFORE</code> triggers. A virtual column takes
            no storage.
          </p><p>
            <code class="literal">InnoDB</code> supports secondary indexes on
            virtual columns. See
            <a class="xref" href="sql-syntax.html#create-table-secondary-indexes" title="13.1.20.10 Secondary Indexes and Generated Columns">Section 13.1.20.10, “Secondary Indexes and Generated Columns”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">STORED</code>: Column values are evaluated and
            stored when rows are inserted or updated. A stored column
            does require storage space and can be indexed.
</p></li></ul>
</div>
<p>
        The default is <code class="literal">VIRTUAL</code> if neither keyword is
        specified.
      </p><p>
        It is permitted to mix <code class="literal">VIRTUAL</code> and
        <code class="literal">STORED</code> columns within a table.
      </p><p>
        Other attributes may be given to indicate whether the column is
        indexed or can be <code class="literal">NULL</code>, or provide a comment.
      </p><p>
        Generated column expressions must adhere to the following rules.
        An error occurs if an expression contains disallowed constructs.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Literals, deterministic built-in functions, and operators
            are permitted. A function is deterministic if, given the
            same data in tables, multiple invocations produce the same
            result, independently of the connected user. Examples of
            functions that are nondeterministic and fail this
            definition: <a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a>,
            <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>,
            <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>.
          </p></li><li class="listitem"><p>
            Stored functions and user-defined functions are not
            permitted.
          </p></li><li class="listitem"><p>
            Stored procedure and function parameters are not permitted.
          </p></li><li class="listitem"><p>
            Variables (system variables, user-defined variables, and
            stored program local variables) are not permitted.
          </p></li><li class="listitem"><p>
            Subqueries are not permitted.
          </p></li><li class="listitem"><p>
            A generated column definition can refer to other generated
            columns, but only those occurring earlier in the table
            definition. A generated column definition can refer to any
            base (nongenerated) column in the table whether its
            definition occurs earlier or later.
          </p></li><li class="listitem"><p>
            The <code class="literal">AUTO_INCREMENT</code> attribute cannot be
            used in a generated column definition.
          </p></li><li class="listitem"><p>
            An <code class="literal">AUTO_INCREMENT</code> column cannot be used
            as a base column in a generated column definition.
          </p></li><li class="listitem"><p>
            If expression evaluation causes truncation or provides
            incorrect input to a function, the
            <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement
            terminates with an error and the DDL operation is rejected.
</p></li></ul>
</div>
<p>
        If the expression evaluates to a data type that differs from the
        declared column type, implicit coercion to the declared type
        occurs according to the usual MySQL type-conversion rules. See
        <a class="xref" href="functions.html#type-conversion" title="12.2 Type Conversion in Expression Evaluation">Section 12.2, “Type Conversion in Expression Evaluation”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Expression evaluation uses the SQL mode in effect at
          evaluation time. If any component of the expression depends on
          the SQL mode, different results may occur for different uses
          of the table unless the SQL mode is the same during all uses.
</p>
</div>
<p>
        For <a class="link" href="sql-syntax.html#create-table-like" title="13.1.20.4 CREATE TABLE ... LIKE Syntax"><code class="literal">CREATE
        TABLE ... LIKE</code></a>, the destination table preserves
        generated column information from the original table.
      </p><p>
        For <a class="link" href="sql-syntax.html#create-table-select" title="13.1.20.5 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE ... SELECT</code></a>, the destination table does not
        preserve information about whether columns in the selected-from
        table are generated columns. The
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part of the statement
        cannot assign values to generated columns in the destination
        table.
      </p><p>
        Partitioning by generated columns is permitted. See
        <a class="xref" href="sql-syntax.html#create-table-partitioning" title="Table Partitioning">Table Partitioning</a>.
      </p><p>
        A foreign key constraint on a stored generated column cannot use
        <code class="literal">CASCADE</code>, <code class="literal">SET NULL</code>, or
        <code class="literal">SET DEFAULT</code> as <code class="literal">ON UPDATE</code>
        referential actions, nor can it use <code class="literal">SET NULL</code>
        or <code class="literal">SET DEFAULT</code> as <code class="literal">ON
        DELETE</code> referential actions.
      </p><p>
        A foreign key constraint on the base column of a stored
        generated column cannot use <code class="literal">CASCADE</code>,
        <code class="literal">SET NULL</code>, or <code class="literal">SET DEFAULT</code>
        as <code class="literal">ON UPDATE</code> or <code class="literal">ON DELETE</code>
        referential actions.
      </p><p>
        A foreign key constraint cannot reference a virtual generated
        column.
      </p><p>
        For <code class="literal">InnoDB</code> restrictions related to foreign
        keys and generated columns, see
        <a class="xref" href="innodb-storage-engine.html#innodb-foreign-key-constraints" title="15.6.1.5 InnoDB and FOREIGN KEY Constraints">Section 15.6.1.5, “InnoDB and FOREIGN KEY Constraints”</a>.
      </p><p>
        Triggers cannot use
        <code class="literal">NEW.<em class="replaceable"><code>col_name</code></em></code> or
        use <code class="literal">OLD.<em class="replaceable"><code>col_name</code></em></code>
        to refer to generated columns.
      </p><p>
        For <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>,
        <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a>, and
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>, if a generated column is
        inserted into, replaced, or updated explicitly, the only
        permitted value is <code class="literal">DEFAULT</code>.
      </p><p>
        A generated column in a view is considered updatable because it
        is possible to assign to it. However, if such a column is
        updated explicitly, the only permitted value is
        <code class="literal">DEFAULT</code>.
      </p><p>
        Generated columns have several use cases, such as these:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Virtual generated columns can be used as a way to simplify
            and unify queries. A complicated condition can be defined as
            a generated column and referred to from multiple queries on
            the table to ensure that all of them use exactly the same
            condition.
          </p></li><li class="listitem"><p>
            Stored generated columns can be used as a materialized cache
            for complicated conditions that are costly to calculate on
            the fly.
          </p></li><li class="listitem"><p>
            Generated columns can simulate functional indexes: Use a
            generated column to define a functional expression and index
            it. This can be useful for working with columns of types
            that cannot be indexed directly, such as
            <a class="link" href="data-types.html#json" title="11.6 The JSON Data Type"><code class="literal">JSON</code></a> columns; see
            <a class="xref" href="sql-syntax.html#json-column-indirect-index" title="Indexing a Generated Column to Provide a JSON Column Index">Indexing a Generated Column to Provide a JSON Column Index</a>, for a detailed
            example.
          </p><p>
            For stored generated columns, the disadvantage of this
            approach is that values are stored twice; once as the value
            of the generated column and once in the index.
          </p></li><li class="listitem"><p>
            If a generated column is indexed, the optimizer recognizes
            query expressions that match the column definition and uses
            indexes from the column as appropriate during query
            execution, even if a query does not refer to the column
            directly by name. For details, see
            <a class="xref" href="optimization.html#generated-column-index-optimizations" title="8.3.11 Optimizer Use of Generated Column Indexes">Section 8.3.11, “Optimizer Use of Generated Column Indexes”</a>.
</p></li></ul>
</div>
<p>
        Example:
      </p><p>
        Suppose that a table <code class="literal">t1</code> contains
        <code class="literal">first_name</code> and <code class="literal">last_name</code>
        columns and that applications frequently construct the full name
        using an expression like this:
      </p><pre data-lang="sql" class="programlisting">
SELECT CONCAT(first_name,' ',last_name) AS full_name FROM t1;
</pre><p>
        One way to avoid writing out the expression is to create a view
        <code class="literal">v1</code> on <code class="literal">t1</code>, which simplifies
        applications by enabling them to select
        <code class="literal">full_name</code> directly without using an
        expression:
      </p><pre data-lang="sql" class="programlisting">
CREATE VIEW v1 AS
SELECT *, CONCAT(first_name,' ',last_name) AS full_name FROM t1;

SELECT full_name FROM v1;
</pre><p>
        A generated column also enables applications to select
        <code class="literal">full_name</code> directly without the need to define
        a view:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (
  first_name VARCHAR(10),
  last_name VARCHAR(10),
  full_name VARCHAR(255) AS (CONCAT(first_name,' ',last_name))
);

SELECT full_name FROM t1;
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-secondary-indexes"></a>13.1.20.10 Secondary Indexes and Generated Columns</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091668073792"></a><p>
        <code class="literal">InnoDB</code> supports secondary indexes on virtual
        generated columns. Other index types are not supported. A
        secondary index defined on a virtual column is sometimes
        referred to as a <span class="quote">“<span class="quote">virtual index</span>”</span>.
      </p><p>
        A secondary index may be created on one or more virtual columns
        or on a combination of virtual columns and regular columns or
        stored generated columns. Secondary indexes that include virtual
        columns may be defined as <code class="literal">UNIQUE</code>.
      </p><p>
        When a secondary index is created on a virtual generated column,
        generated column values are materialized in the records of the
        index. If the index is a
        <a class="link" href="glossary.html#glos_covering_index" title="covering index">covering index</a> (one
        that includes all the columns retrieved by a query), generated
        column values are retrieved from materialized values in the
        index structure instead of computed <span class="quote">“<span class="quote">on the fly</span>”</span>.
      </p><p>
        There are additional write costs to consider when using a
        secondary index on a virtual column due to computation performed
        when materializing virtual column values in secondary index
        records during <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> and
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> operations. Even with
        additional write costs, secondary indexes on virtual columns may
        be preferable to generated <span class="emphasis"><em>stored</em></span> columns,
        which are materialized in the clustered index, resulting in
        larger tables that require more disk space and memory. If a
        secondary index is not defined on a virtual column, there are
        additional costs for reads, as virtual column values must be
        computed each time the column's row is examined.
      </p><p>
        Values of an indexed virtual column are MVCC-logged to avoid
        unnecessary recomputation of generated column values during
        rollback or during a purge operation. The data length of logged
        values is limited by the index key limit of 767 bytes for
        <code class="literal">COMPACT</code> and <code class="literal">REDUNDANT</code> row
        formats, and 3072 bytes for <code class="literal">DYNAMIC</code> and
        <code class="literal">COMPRESSED</code> row formats.
      </p><p>
        Adding or dropping a secondary index on a virtual column is an
        in-place operation.
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="json-column-indirect-index"></a>Indexing a Generated Column to Provide a JSON Column Index</h5>
</div>
</div>
</div>
<p>
          As noted elsewhere, <a class="link" href="data-types.html#json" title="11.6 The JSON Data Type"><code class="literal">JSON</code></a>
          columns cannot be indexed directly. To create an index that
          references such a column indirectly, you can define a
          generated column that extracts the information that should be
          indexed, then create an index on the generated column, as
          shown in this example:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE jemp (</code></strong>
    -&gt;     <strong class="userinput"><code>c JSON,</code></strong>
    -&gt;     <strong class="userinput"><code>g INT GENERATED ALWAYS AS (c-&gt;"$.id")),</code></strong>
    -&gt;     <strong class="userinput"><code>INDEX i (g)</code></strong>
    -&gt; <strong class="userinput"><code>);</code></strong>
Query OK, 0 rows affected (0.28 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO jemp (c) VALUES</code></strong>
     &gt;   <strong class="userinput"><code>('{"id": "1", "name": "Fred"}'), ('{"id": "2", "name": "Wilma"}'),</code></strong>
     &gt;   <strong class="userinput"><code>('{"id": "3", "name": "Barney"}'), ('{"id": "4", "name": "Betty"}');</code></strong>
Query OK, 4 rows affected (0.04 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT c-&gt;&gt;"$.name" AS name</code></strong>
     &gt;     <strong class="userinput"><code>FROM jemp WHERE g &gt; 2;</code></strong>
+--------+
| name   |
+--------+
| Barney |
| Betty  |
+--------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>EXPLAIN SELECT c-&gt;&gt;"$.name" AS name</code></strong>
     &gt;    <strong class="userinput"><code>FROM jemp WHERE g &gt; 2\G</code></strong>
*************************** 1. row ***************************
           id: 1
  select_type: SIMPLE
        table: jemp
   partitions: NULL
         type: range
possible_keys: i
          key: i
      key_len: 5
          ref: NULL
         rows: 2
     filtered: 100.00
        Extra: Using where
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Note
   Code: 1003
Message: /* select#1 */ select json_unquote(json_extract(`test`.`jemp`.`c`,'$.name'))
AS `name` from `test`.`jemp` where (`test`.`jemp`.`g` &gt; 2)
1 row in set (0.00 sec)
</pre><p>
          (We have wrapped the output from the last statement in this
          example to fit the viewing area.)
        </p><p>
          When you use <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> on a
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> or other SQL statement
          containing one or more expressions that use the
          <code class="literal">-&gt;</code> or <code class="literal">-&gt;&gt;</code>
          operator, these expressions are translated into their
          equivalents using <code class="literal">JSON_EXTRACT()</code> and (if
          needed) <code class="literal">JSON_UNQUOTE()</code> instead, as shown
          here in the output from <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW
          WARNINGS</code></a> immediately following this
          <code class="literal">EXPLAIN</code> statement:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>EXPLAIN SELECT c-&gt;&gt;"$.name"</code></strong>
     &gt; <strong class="userinput"><code>FROM jemp WHERE g &gt; 2 ORDER BY c-&gt;"$.name"\G</code></strong>
*************************** 1. row ***************************
           id: 1
  select_type: SIMPLE
        table: jemp
   partitions: NULL
         type: range
possible_keys: i
          key: i
      key_len: 5
          ref: NULL
         rows: 2
     filtered: 100.00
        Extra: Using where; Using filesort
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Note
   Code: 1003
Message: /* select#1 */ select json_unquote(json_extract(`test`.`jemp`.`c`,'$.name')) AS
`c-&gt;&gt;"$.name"` from `test`.`jemp` where (`test`.`jemp`.`g` &gt; 2) order by
json_extract(`test`.`jemp`.`c`,'$.name')
1 row in set (0.00 sec)
</pre><p>
          See the descriptions of the
          <a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a>
          and
          <a class="link" href="functions.html#operator_json-inline-path"><code class="literal">-&gt;&gt;</code></a>
          operators, as well as those of the
          <a class="link" href="functions.html#function_json-extract"><code class="literal">JSON_EXTRACT()</code></a> and
          <a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE()</code></a> functions, for
          additional information and examples.
        </p><p>
          This technique also can be used to provide indexes that
          indirectly reference columns of other types that cannot be
          indexed directly, such as <code class="literal">GEOMETRY</code> columns.
        </p><h6><a name="json-column-indirect-index-mysql-cluster"></a>JSON columns and indirect indexing in NDB Cluster</h6><p>
          <a class="indexterm" name="idm140091668022720"></a>

          <a class="indexterm" name="idm140091668021232"></a>

          <a class="indexterm" name="idm140091668019744"></a>

          <a class="indexterm" name="idm140091668018256"></a>

          It is also possible to use indirect indexing of JSON columns
          in MySQL NDB Cluster, subject to the following conditions:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
              <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> handles a
              <a class="link" href="data-types.html#json" title="11.6 The JSON Data Type"><code class="literal">JSON</code></a> column value
              internally as a <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>. This
              means that any <code class="literal">NDB</code> table having one or
              more JSON columns must have a primary key, else it cannot
              be recorded in the binary log.
            </p></li><li class="listitem"><p>
              The <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> storage engine does
              not support indexing of virtual columns. Since the default
              for generated columns is <code class="literal">VIRTUAL</code>, you
              must specify explicitly the generated column to which to
              apply the indirect index as <code class="literal">STORED</code>.
</p></li></ol>
</div>
<p>
          The <strong class="userinput"><code>CREATE TABLE</code></strong> statement
          used to create the table <code class="literal">jempn</code> shown here
          is a version of the <code class="literal">jemp</code> table shown
          previously, with modifications making it compatible with
          <code class="literal">NDB</code>:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLE jempn (
  a BIGINT(20) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  c JSON DEFAULT NULL,
  g INT GENERATED ALWAYS AS (c-&gt;"$.name") STORED,
  INDEX i (g)
) ENGINE=NDB;
</pre><p>
          We can populate this table using the following
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statement:
        </p><pre data-lang="sql" class="programlisting">
INSERT INTO jempn (a, c) VALUES   
  (NULL, '{"id": "1", "name": "Fred"}'), 
  (NULL, '{"id": "2", "name": "Wilma"}'),   
  (NULL, '{"id": "3", "name": "Barney"}'), 
  (NULL, '{"id": "4", "name": "Betty"}');
</pre><p>
          Now <code class="literal">NDB</code> can use index <code class="literal">i</code>,
          as shown here:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>EXPLAIN SELECT c-&gt;&gt;"$.name" AS name         
          FROM jempn WHERE g &gt; 2\G</code></strong>
*************************** 1. row ***************************
           id: 1
  select_type: SIMPLE
        table: jempn
   partitions: p0,p1
         type: range
possible_keys: i
          key: i
      key_len: 5
          ref: NULL
         rows: 3
     filtered: 100.00
        Extra: Using where with pushed condition (`test`.`jempn`.`g` &gt; 2)
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Note
   Code: 1003
Message: /* select#1 */ select
json_unquote(json_extract(`test`.`jempn`.`c`,'$.name')) AS `name` from
`test`.`jempn` where (`test`.`jempn`.`g` &gt; 2)  
1 row in set (0.00 sec)
</pre><p>
          You should keep in mind that a stored generated column uses
          <a class="link" href="mysql-cluster.html#ndbparam-ndbd-datamemory"><code class="literal">DataMemory</code></a>, and that
          an index on such a column uses
          <a class="link" href="mysql-cluster.html#ndbparam-ndbd-indexmemory"><code class="literal">IndexMemory</code></a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-ndb-table-comment-options"></a>13.1.20.11 Setting NDB_TABLE Options</h4>

</div>

</div>

</div>
<p>
        <a class="indexterm" name="idm140091667988416"></a>

        <a class="indexterm" name="idm140091667987344"></a>

        <a class="indexterm" name="idm140091667985856"></a>

        <a class="indexterm" name="idm140091667984784"></a>

        <a class="indexterm" name="idm140091667983712"></a>

        In MySQL NDB Cluster, the table comment in a <code class="literal">CREATE
        TABLE</code> or <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
        statement can also be used to specify an
        <code class="literal">NDB_TABLE</code> option, which consists of one or
        more name-value pairs, separated by commas if need be, following
        the string <code class="literal">NDB_TABLE=</code>. Complete syntax for
        names and values syntax is shown here:
      </p><pre data-lang="sql" class="programlisting">
COMMENT="NDB_TABLE=<em class="replaceable"><code>ndb_table_option</code></em>[,<em class="replaceable"><code>ndb_table_option</code></em>[,...]]"

<em class="replaceable"><code>ndb_table_option</code></em>:
    NOLOGGING={1|0}
  | READ_BACKUP={1|0}
  | PARTITION_BALANCE={FOR_RP_BY_NODE|FOR_RA_BY_NODE|FOR_RP_BY_LDM
                      |FOR_RA_BY_LDM|FOR_RA_BY_LDM_X_2
                      |FOR_RA_BY_LDM_X_3|FOR_RA_BY_LDM_X_4}
  | FULLY_REPLICATED={1|0}
</pre><p>
        Spaces are not permitted within the quoted string. The string is
        case-insensitive.
      </p><p>
        The four <code class="literal">NDB</code> table options that can be set as
        part of a comment in this way are described in more detail in
        the next few paragraphs.
      </p><p>
        <a class="indexterm" name="idm140091667974352"></a>

        <a class="indexterm" name="idm140091667972864"></a>

        <code class="literal">NOLOGGING</code>: Using 1 corresponds to having
        <a class="link" href="mysql-cluster.html#sysvar_ndb_table_no_logging"><code class="literal">ndb_table_no_logging</code></a> enabled,
        but has no actual effect. Provided as a placeholder, mostly for
        completeness of <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
        statements.
      </p><p>
        <a class="indexterm" name="idm140091667967632"></a>

        <a class="indexterm" name="idm140091667966144"></a>

        <a class="indexterm" name="idm140091667964656"></a>

        <code class="literal">READ_BACKUP</code>: Setting this option to 1 has the
        same effect as though
        <a class="link" href="mysql-cluster.html#sysvar_ndb_read_backup"><code class="literal">ndb_read_backup</code></a> were enabled;
        enables reading from any replica. You can set
        <code class="literal">READ_BACKUP</code> for an existing table online,
        using an <code class="literal">ALTER TABLE</code> statement similar to one
        of those shown here:
      </p><pre data-lang="sql" class="programlisting">
ALTER TABLE ... ALGORITHM=INPLACE, COMMENT="NDB_TABLE=READ_BACKUP=1";

ALTER TABLE ... ALGORITHM=INPLACE, COMMENT="NDB_TABLE=READ_BACKUP=0";
</pre><p>
        For more information about the <code class="literal">ALGORITHM</code>
        option for <code class="literal">ALTER TABLE</code>, see
        <a class="xref" href="mysql-cluster.html#mysql-cluster-online-operations" title="22.5.14 Online Operations with ALTER TABLE in NDB Cluster">Section 22.5.14, “Online Operations with ALTER TABLE in NDB Cluster”</a>.
      </p><p>
        <a class="indexterm" name="idm140091667955488"></a>

        <a class="indexterm" name="idm140091667954032"></a>

        <a class="indexterm" name="idm140091667952528"></a>

        <code class="literal">PARTITION_BALANCE</code>: Provides additional
        control over assignment and placement of partitions. The
        following four schemes are supported:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            <code class="literal">FOR_RP_BY_NODE</code>: One partition per node.
          </p><p>
            Only one LDM on each node stores a primary partition. Each
            partition is stored in the same LDM (same ID) on all nodes.
          </p></li><li class="listitem"><p>
            <code class="literal">FOR_RA_BY_NODE</code>: One partition per node
            group.
          </p><p>
            Each node stores a single partition, which can be either a
            primary replica or a backup replica. Each partition is
            stored in the same LDM on all nodes.
          </p></li><li class="listitem"><p>
            <code class="literal">FOR_RP_BY_LDM</code>: One partition for each LDM
            on each node; the default.
          </p><p>
            This is the same behavior as prior to MySQL NDB Cluster
            7.5.2, except for a slightly different mapping of partitions
            to LDMs, starting with LDM 0 and placing one partition per
            node group, then moving on to the next LDM.
          </p><p>
            This is the setting used if <code class="literal">READ_BACKUP</code>
            is set to 1.
          </p></li><li class="listitem"><p>
            <code class="literal">FOR_RA_BY_LDM</code>: One partition per LDM in
            each node group.
          </p><p>
            These partitions can be primary or backup partitions.
          </p></li><li class="listitem"><p>
            <code class="literal">FOR_RA_BY_LDM_X_2</code>: Two partitions per LDM
            in each node group.
          </p><p>
            These partitions can be primary or backup partitions.
          </p></li><li class="listitem"><p>
            <code class="literal">FOR_RA_BY_LDM_X_3</code>: Three partitions per
            LDM in each node group.
          </p><p>
            These partitions can be primary or backup partitions.
          </p></li><li class="listitem"><p>
            <code class="literal">FOR_RA_BY_LDM_X_4</code>: Four partitions per
            LDM in each node group.
          </p><p>
            These partitions can be primary or backup partitions.
</p></li></ol>
</div>
<p>
        <code class="literal">PARTITION_BALANCE</code> is the preferred interface
        for setting the number of partitions per table. Using
        <code class="literal">MAX_ROWS</code> to force the number of partitions is
        deprecated but continues to be supported for backward
        compatibility; it is subject to removal in a future release of
        MySQL NDB Cluster. (Bug #81759, Bug #23544301)
      </p><p>
        <a class="indexterm" name="idm140091667931072"></a>

        <a class="indexterm" name="idm140091667929568"></a>

        <code class="literal">FULLY_REPLICATED</code> controls whether the table
        is fully replicated, that is, whether each data node has a
        complete copy of the table. To enable full replication of the
        table, use <code class="literal">FULLY_REPLICATED=1</code>.
      </p><p>
        This setting can also be controlled using the
        <code class="literal">ndb_fully_replicated</code> system variable. Setting
        it to <code class="literal">ON</code> enables the option by default for
        all new <code class="literal">NDB</code> tables; the default is
        <code class="literal">OFF</code>. The
        <a class="link" href="mysql-cluster.html#sysvar_ndb_data_node_neighbour"><code class="literal">ndb_data_node_neighbour</code></a> system
        variable is also used for fully replicated tables, to ensure
        that when a fully replicated table is accessed, we access the
        data node which is local to this MySQL Server.
      </p><p>
        An example of a <code class="literal">CREATE TABLE</code> statement using
        such a comment when creating an <code class="literal">NDB</code> table is
        shown here:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
     &gt;     <strong class="userinput"><code>c1 INT NOT NULL AUTO_INCREMENT PRIMARY KEY,</code></strong>
     &gt;     <strong class="userinput"><code>c2 VARCHAR(100),</code></strong>
     &gt;     <strong class="userinput"><code>c3 VARCHAR(100) )</code></strong>
     &gt; <strong class="userinput"><code>ENGINE=NDB</code></strong>
     &gt;
<strong class="userinput"><code>COMMENT="NDB_TABLE=READ_BACKUP=0,PARTITION_BALANCE=FOR_RP_BY_NODE";</code></strong>
</pre><p>
        The comment is displayed as part of the ouput of
        <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>. The text of
        the comment is also available from querying the MySQL
        Information Schema <a class="link" href="information-schema.html#tables-table" title="25.30 The INFORMATION_SCHEMA TABLES Table"><code class="literal">TABLES</code></a> table, as
        in this example:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME, TABLE_SCHEMA, TABLE_COMMENT</code></strong>
     &gt; <strong class="userinput"><code>FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME="t1";</code></strong>
+------------+--------------+----------------------------------------------------------+
| TABLE_NAME | TABLE_SCHEMA | TABLE_COMMENT                                            |
+------------+--------------+----------------------------------------------------------+
| t1         | c            | NDB_TABLE=READ_BACKUP=0,PARTITION_BALANCE=FOR_RP_BY_NODE |
| t1         | d            |                                                          |
+------------+--------------+----------------------------------------------------------+
2 rows in set (0.00 sec)
</pre><p>
        This comment syntax is also supported with
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statements for
        <code class="literal">NDB</code> tables. Keep in mind that a table comment
        used with <code class="literal">ALTER TABLE</code> replaces any existing
        comment which the table might have.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER TABLE t1 COMMENT="NDB_TABLE=PARTITION_BALANCE=FOR_RA_BY_NODE";</code></strong>
Query OK, 0 rows affected (0.40 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME, TABLE_SCHEMA, TABLE_COMMENT</code></strong>
     &gt; <strong class="userinput"><code>FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME="t1";</code></strong>
+------------+--------------+--------------------------------------------------+
| TABLE_NAME | TABLE_SCHEMA | TABLE_COMMENT                                    |
+------------+--------------+--------------------------------------------------+
| t1         | c            | NDB_TABLE=PARTITION_BALANCE=FOR_RA_BY_NODE       |
| t1         | d            |                                                  |
+------------+--------------+--------------------------------------------------+
2 rows in set (0.01 sec)
</pre><p>
        You can also see the value of the
        <code class="literal">PARTITION_BALANCE</code> option in the output of
        <a class="link" href="mysql-cluster.html#mysql-cluster-programs-ndb-desc" title="22.4.9 ndb_desc — Describe NDB Tables"><span class="command"><strong>ndb_desc</strong></span></a>. <a class="link" href="mysql-cluster.html#mysql-cluster-programs-ndb-desc" title="22.4.9 ndb_desc — Describe NDB Tables"><span class="command"><strong>ndb_desc</strong></span></a> also
        shows whether the <code class="literal">READ_BACKUP</code> and
        <code class="literal">FULLY_REPLICATED</code> options are set for the
        table. See the description of this program for more information.
      </p><p>
        Because the <code class="literal">READ_BACKUP</code> value was not carried
        over to the new comment set by the <code class="literal">ALTER
        TABLE</code> statement, there is no longer a way using SQL to
        retrieve the value previously set for it. To keep this from
        happening, it is suggested that you preserve any such values
        from the existing comment string, like this:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME, TABLE_SCHEMA, TABLE_COMMENT</code></strong>
     &gt; <strong class="userinput"><code>FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME="t1";</code></strong>
+------------+--------------+----------------------------------------------------------+
| TABLE_NAME | TABLE_SCHEMA | TABLE_COMMENT                                            |
+------------+--------------+----------------------------------------------------------+
| t1         | c            | NDB_TABLE=READ_BACKUP=0,PARTITION_BALANCE=FOR_RP_BY_NODE |
| t1         | d            |                                                          |
+------------+--------------+----------------------------------------------------------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>ALTER TABLE t1 COMMENT="NDB_TABLE=READ_BACKUP=0,PARTITION_BALANCE=FOR_RA_BY_NODE";</code></strong>
Query OK, 0 rows affected (1.56 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME, TABLE_SCHEMA, TABLE_COMMENT</code></strong>
     &gt; <strong class="userinput"><code>FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME="t1";</code></strong>
+------------+--------------+----------------------------------------------------------------+
| TABLE_NAME | TABLE_SCHEMA | TABLE_COMMENT                                                  |
+------------+--------------+----------------------------------------------------------------+
| t1         | c            | NDB_TABLE=READ_BACKUP=0,PARTITION_BALANCE=FOR_RA_BY_NODE       |
| t1         | d            |                                                                |
+------------+--------------+----------------------------------------------------------------+
2 rows in set (0.01 sec)
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-tablespace"></a>13.1.21 CREATE TABLESPACE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667884976"></a><a class="indexterm" name="idm140091667883936"></a><a class="indexterm" name="idm140091667882448"></a><pre data-lang="sql" class="programlisting">
CREATE [UNDO] TABLESPACE <em class="replaceable"><code>tablespace_name</code></em>

  <span class="emphasis"><em>InnoDB and NDB:</em></span>
    [ADD DATAFILE '<em class="replaceable"><code>file_name</code></em>']

  <span class="emphasis"><em>InnoDB only:</em></span>
    [FILE_BLOCK_SIZE = value]
    [ENCRYPTION [=] {'Y' | 'N'}]

  <span class="emphasis"><em>NDB only:</em></span>
    USE LOGFILE GROUP <em class="replaceable"><code>logfile_group</code></em>
    [EXTENT_SIZE [=] <em class="replaceable"><code>extent_size</code></em>]
    [INITIAL_SIZE [=] <em class="replaceable"><code>initial_size</code></em>]
    [AUTOEXTEND_SIZE [=] <em class="replaceable"><code>autoextend_size</code></em>]
    [MAX_SIZE [=] <em class="replaceable"><code>max_size</code></em>]
    [NODEGROUP [=] <em class="replaceable"><code>nodegroup_id</code></em>]
    [WAIT]
    [COMMENT [=] '<em class="replaceable"><code>string</code></em>']

  <span class="emphasis"><em>InnoDB and NDB:</em></span>
    [ENGINE [=] <em class="replaceable"><code>engine_name</code></em>]
</pre><p>
      This statement is used to create a tablespace. The precise syntax
      and semantics depend on the storage engine used. In standard MySQL
      releases, this is always an <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>
      tablespace. MySQL NDB Cluster also supports tablespaces using the
      <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> storage engine.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-tablespace-innodb" title="Considerations for InnoDB">Considerations for InnoDB</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-tablespace-ndb" title="Considerations for NDB Cluster">Considerations for NDB Cluster</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-tablespace-options" title="Options">Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-tablespace-notes" title="Notes">Notes</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-tablespace-innodb-examples" title="InnoDB Examples">InnoDB Examples</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-tablespace-ndb-examples" title="NDB Example">NDB Example</a></p></li></ul>
</div>
<h4><a name="create-tablespace-innodb"></a>Considerations for InnoDB</h4>
<p>
      <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.21 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a> syntax is used to
      create general tablespaces or undo tablespaces. The
      <code class="literal">UNDO</code> keyword, introduced in MySQL 8.0.14, must
      be specified to create an undo tablespace.
    </p><p>
      A general tablespace is a shared tablespace. It can hold multiple
      tables, and supports all table row formats. General tablespaces
      can be created in a location relative to or independent of the
      data directory.
    </p><p>
      After creating an <code class="literal">InnoDB</code> general tablespace,
      use <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE
      <em class="replaceable"><code>tbl_name</code></em> ... TABLESPACE [=]
      <em class="replaceable"><code>tablespace_name</code></em></code></a> or
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
      <em class="replaceable"><code>tbl_name</code></em> TABLESPACE [=]
      <em class="replaceable"><code>tablespace_name</code></em></code></a> to add tables
      to the tablespace. For more information, see
      <a class="xref" href="innodb-storage-engine.html#general-tablespaces" title="15.6.3.3 General Tablespaces">Section 15.6.3.3, “General Tablespaces”</a>.
    </p><p>
      Undo tablespaces contain undo logs. Undo tablespaces can be
      created in a chosen location by specifying a fully qualified data
      file path. For more information, see
      <a class="xref" href="innodb-storage-engine.html#innodb-undo-tablespaces" title="15.6.3.4 Undo Tablespaces">Section 15.6.3.4, “Undo Tablespaces”</a>.
</p>
<h4><a name="create-tablespace-ndb"></a>Considerations for NDB Cluster</h4>
<p>
      This statement is used to create a tablespace, which can contain
      one or more data files, providing storage space for NDB Cluster
      Disk Data tables (see <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="22.5.13 NDB Cluster Disk Data Tables">Section 22.5.13, “NDB Cluster Disk Data Tables”</a>).
      One data file is created and added to the tablespace using this
      statement. Additional data files may be added to the tablespace by
      using the <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.10 ALTER TABLESPACE Syntax"><code class="literal">ALTER TABLESPACE</code></a>
      statement (see <a class="xref" href="sql-syntax.html#alter-tablespace" title="13.1.10 ALTER TABLESPACE Syntax">Section 13.1.10, “ALTER TABLESPACE Syntax”</a>).
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        All NDB Cluster Disk Data objects share the same namespace. This
        means that <span class="emphasis"><em>each Disk Data object</em></span> must be
        uniquely named (and not merely each Disk Data object of a given
        type). For example, you cannot have a tablespace and a log file
        group with the same name, or a tablespace and a data file with
        the same name.
</p>
</div>
<p>
      A log file group of one or more <code class="literal">UNDO</code> log files
      must be assigned to the tablespace to be created with the
      <code class="literal">USE LOGFILE GROUP</code> clause.
      <em class="replaceable"><code>logfile_group</code></em> must be an existing log
      file group created with <a class="link" href="sql-syntax.html#create-logfile-group" title="13.1.16 CREATE LOGFILE GROUP Syntax"><code class="literal">CREATE LOGFILE
      GROUP</code></a> (see <a class="xref" href="sql-syntax.html#create-logfile-group" title="13.1.16 CREATE LOGFILE GROUP Syntax">Section 13.1.16, “CREATE LOGFILE GROUP Syntax”</a>).
      Multiple tablespaces may use the same log file group for
      <code class="literal">UNDO</code> logging.
    </p><p>
      When setting <code class="literal">EXTENT_SIZE</code> or
      <code class="literal">INITIAL_SIZE</code>, you may optionally follow the
      number with a one-letter abbreviation for an order of magnitude,
      similar to those used in <code class="filename">my.cnf</code>. Generally,
      this is one of the letters <code class="literal">M</code> (for megabytes) or
      <code class="literal">G</code> (for gigabytes).
    </p><p>
      <code class="literal">INITIAL_SIZE</code> and <code class="literal">EXTENT_SIZE</code>
      are subject to rounding as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">EXTENT_SIZE</code> is rounded up to the nearest
          whole multiple of 32K.
        </p></li><li class="listitem"><p>
          <code class="literal">INITIAL_SIZE</code> is rounded
          <span class="emphasis"><em>down</em></span> to the nearest whole multiple of
          32K; this result is rounded up to the nearest whole multiple
          of <code class="literal">EXTENT_SIZE</code> (after any rounding).
</p></li></ul>
</div>
<p>
      The rounding just described is done explicitly, and a warning is
      issued by the MySQL Server when any such rounding is performed.
      The rounded values are also used by the NDB kernel for calculating
      <a class="link" href="information-schema.html#files-table" title="25.11 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> column
      values and other purposes. However, to avoid an unexpected result,
      we suggest that you always use whole multiples of 32K in
      specifying these options.
    </p><p>
      When <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.21 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a> is used with
      <code class="literal">ENGINE [=] NDB</code>, a tablespace and associated
      data file are created on each Cluster data node. You can verify
      that the data files were created and obtain information about them
      by querying the
      <a class="link" href="information-schema.html#files-table" title="25.11 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> table. (See
      the example later in this section.)
    </p><p>
      (See <a class="xref" href="information-schema.html#files-table" title="25.11 The INFORMATION_SCHEMA FILES Table">Section 25.11, “The INFORMATION_SCHEMA FILES Table”</a>.)
</p>
<h4><a name="create-tablespace-options"></a>Options</h4>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">ADD DATAFILE</code>: Defines the name of a
          tablespace data file. The <code class="literal">ADD DATAFILE</code>
          clause is required when creating undo tablespaces. Otherwise,
          it is optional as of MySQL 8.0.14.
        </p><p>
          An <code class="literal">InnoDB</code> tablespace supports only a single
          data file, whose name must include a <code class="literal">.ibd</code>
          extension. An NDB Cluster tablespace supports multiple data
          files which can have any legal file names; more data files can
          be added to an NDB Cluster tablespace following its creation
          by using an <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.10 ALTER TABLESPACE Syntax"><code class="literal">ALTER TABLESPACE</code></a>
          statement.
        </p><p>
          To place a general tablespace data file in a location outside
          of the data directory, include a fully qualified path or a
          path relative to the data directory. Only a fully qualified
          path is permitted for undo tablespaces. If you do not specify
          a path, a general tablespace is created in the data directory.
          An undo tablespace created without specifying a path is
          created in the directory defined by the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_undo_directory"><code class="literal">innodb_undo_directory</code></a>
          variable. If the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_undo_directory"><code class="literal">innodb_undo_directory</code></a>
          variable is undefined, undo tablespaces are created in the
          data directory.
        </p><p>
          Creating a general tablespace in a subdirectory under the data
          directory is not supported to avoid conflicts with implicitly
          created file-per-table tablespaces. When creating a general
          tablespace or undo tablespace outside of the data directory,
          the directory must exist and must be known to
          <code class="literal">InnoDB</code> prior to creating the tablespace. To
          make a directory known to <code class="literal">InnoDB</code>, add it to
          the <a class="link" href="innodb-storage-engine.html#sysvar_innodb_directories"><code class="literal">innodb_directories</code></a> value
          or to one of the variables whose values are appended to the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_directories"><code class="literal">innodb_directories</code></a> value.
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_directories"><code class="literal">innodb_directories</code></a> is a
          read-only variable. Configuring it requires restarting the
          server.
        </p><p>
          The <code class="literal"><em class="replaceable"><code>file_name</code></em></code>,
          including any specified path, must be quoted with single or
          double quotations marks. File names (not counting the file
          extension) and directory names must be at least one byte in
          length. Zero length file names and directory names are not
          supported.
        </p><p>
          If the <code class="literal">ADD DATAFILE</code> clause is not specified
          when creating a tablespace, a tablespace data file with a
          unique file name is created implicitly. The unique file name
          is a 128 bit UUID formatted into five groups of hexadecimal
          numbers separated by dashes
          (<em class="replaceable"><code>aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee</code></em>).
          A file extension is added if required by the storage engine.
          An <code class="filename">.ibd</code> file extension is added for
          <code class="literal">InnoDB</code> general tablespace data files. In a
          replication environment, the data file name created on the
          master is not the same as the data file name created on the
          slave.
        </p><p>
          As of MySQL 8.0.17, the <code class="literal">ADD DATAFILE</code> clause
          does not permit circular directory references when creating an
          <code class="literal">InnoDB</code> tablespace. For example, the
          circular directory reference (<code class="literal">/../</code>) in the
          following statement is not permitted:
        </p><pre data-lang="sql" class="programlisting">
CREATE TABLESPACE ts1 ADD DATAFILE ts1.ibd '<em class="replaceable"><code>any_directory</code></em>/../ts1.ibd';
</pre><p>
          An exception to this restriction exists on Linux, where a
          circular directory reference is permitted if the preceding
          directory is a symbolic link. For example, the data file path
          in the example above is permitted if
          <em class="replaceable"><code>any_directory</code></em> is a symbolic link.
          (It is still permitted for data file paths to begin with
          '<code class="literal">../</code>'.)
        </p></li><li class="listitem"><p>
          <code class="literal">FILE_BLOCK_SIZE</code>: This option—which is
          specific to <code class="literal">InnoDB</code> general tablespaces, and
          is ignored by <code class="literal">NDB</code>—defines the block
          size for the tablespace data file. Values can be specified in
          bytes or kilobytes. For example, an 8 kilobyte file block size
          can be specified as 8192 or 8K. If you do not specify this
          option, <code class="literal">FILE_BLOCK_SIZE</code> defaults to the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a> value.
          <code class="literal">FILE_BLOCK_SIZE</code> is required when you intend
          to use the tablespace for storing compressed
          <code class="literal">InnoDB</code> tables
          (<code class="literal">ROW_FORMAT=COMPRESSED</code>). In this case, you
          must define the tablespace <code class="literal">FILE_BLOCK_SIZE</code>
          when creating the tablespace.
        </p><p>
          If <code class="literal">FILE_BLOCK_SIZE</code> is equal the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a> value, the
          tablespace can contain only tables having an uncompressed row
          format (<code class="literal">COMPACT</code>,
          <code class="literal">REDUNDANT</code>, and <code class="literal">DYNAMIC</code>).
          Tables with a <code class="literal">COMPRESSED</code> row format have a
          different physical page size than uncompressed tables.
          Therefore, compressed tables cannot coexist in the same
          tablespace as uncompressed tables.
        </p><p>
          For a general tablespace to contain compressed tables,
          <code class="literal">FILE_BLOCK_SIZE</code> must be specified, and the
          <code class="literal">FILE_BLOCK_SIZE</code> value must be a valid
          compressed page size in relation to the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a> value. Also,
          the physical page size of the compressed table
          (<code class="literal">KEY_BLOCK_SIZE</code>) must be equal to
          <code class="literal">FILE_BLOCK_SIZE/1024</code>. For example, if
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size=16K</code></a>, and
          <code class="literal">FILE_BLOCK_SIZE=8K</code>, the
          <code class="literal">KEY_BLOCK_SIZE</code> of the table must be 8. For
          more information, see <a class="xref" href="innodb-storage-engine.html#general-tablespaces" title="15.6.3.3 General Tablespaces">Section 15.6.3.3, “General Tablespaces”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">USE LOGFILE GROUP</code>: Required for
          <code class="literal">NDB</code>, this is the name of a log file group
          previously created using <a class="link" href="sql-syntax.html#create-logfile-group" title="13.1.16 CREATE LOGFILE GROUP Syntax"><code class="literal">CREATE LOGFILE
          GROUP</code></a>. Not supported for <code class="literal">InnoDB</code>,
          where it fails with an error.
        </p></li><li class="listitem"><p>
          <code class="literal">EXTENT_SIZE</code>: This option is specific to
          NDB, and is not supported by InnoDB, where it fails with an
          error. <code class="literal">EXTENT_SIZE</code> sets the size, in bytes,
          of the extents used by any files belonging to the tablespace.
          The default value is 1M. The minimum size is 32K, and
          theoretical maximum is 2G, although the practical maximum size
          depends on a number of factors. In most cases, changing the
          extent size does not have any measurable effect on
          performance, and the default value is recommended for all but
          the most unusual situations.
        </p><p>
          An <span class="firstterm">extent</span> is a unit of
          disk space allocation. One extent is filled with as much data
          as that extent can contain before another extent is used. In
          theory, up to 65,535 (64K) extents may used per data file;
          however, the recommended maximum is 32,768 (32K). The
          recommended maximum size for a single data file is
          32G—that is, 32K extents × 1 MB per extent. In
          addition, once an extent is allocated to a given partition, it
          cannot be used to store data from a different partition; an
          extent cannot store data from more than one partition. This
          means, for example that a tablespace having a single datafile
          whose <code class="literal">INITIAL_SIZE</code> (described in the
          following item) is 256 MB and whose
          <code class="literal">EXTENT_SIZE</code> is 128M has just two extents,
          and so can be used to store data from at most two different
          disk data table partitions.
        </p><p>
          You can see how many extents remain free in a given data file
          by querying the
          <a class="link" href="information-schema.html#files-table" title="25.11 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> table,
          and so derive an estimate for how much space remains free in
          the file. For further discussion and examples, see
          <a class="xref" href="information-schema.html#files-table" title="25.11 The INFORMATION_SCHEMA FILES Table">Section 25.11, “The INFORMATION_SCHEMA FILES Table”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">INITIAL_SIZE</code>: This option is specific to
          <code class="literal">NDB</code>, and is not supported by
          <code class="literal">InnoDB</code>, where it fails with an error.
        </p><p>
          The <code class="literal">INITIAL_SIZE</code> parameter sets the total
          size in bytes of the data file that was specific using
          <code class="literal">ADD DATATFILE</code>. Once this file has been
          created, its size cannot be changed; however, you can add more
          data files to the tablespace using
          <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.10 ALTER TABLESPACE Syntax"><code class="literal">ALTER
          TABLESPACE ... ADD DATAFILE</code></a>.
        </p><p>
          <code class="literal">INITIAL_SIZE</code> is optional; its default value
          is 134217728 (128 MB).
        </p><p>
          On 32-bit systems, the maximum supported value for
          <code class="literal">INITIAL_SIZE</code> is 4294967296 (4 GB).
        </p></li><li class="listitem"><p>
          <code class="literal">AUTOEXTEND_SIZE</code>: Currently ignored by
          MySQL; reserved for possible future use. Has no effect in any
          release of MySQL 8.0 or MySQL NDB Cluster 8.0, regardless of
          the storage engine used.
        </p></li><li class="listitem"><p>
          <code class="literal">MAX_SIZE</code>: Currently ignored by MySQL;
          reserved for possible future use. Has no effect in any release
          of MySQL 8.0 or MySQL NDB Cluster 8.0, regardless of the
          storage engine used.
        </p></li><li class="listitem"><p>
          <code class="literal">NODEGROUP</code>: Currently ignored by MySQL;
          reserved for possible future use. Has no effect in any release
          of MySQL 8.0 or MySQL NDB Cluster 8.0, regardless of the
          storage engine used.
        </p></li><li class="listitem"><p>
          <code class="literal">WAIT</code>: Currently ignored by MySQL; reserved
          for possible future use. Has no effect in any release of MySQL
          8.0 or MySQL NDB Cluster 8.0, regardless of the storage engine
          used.
        </p></li><li class="listitem"><p>
          <code class="literal">COMMENT</code>: Currently ignored by MySQL;
          reserved for possible future use. Has no effect in any release
          of MySQL 8.0 or MySQL NDB Cluster 8.0, regardless of the
          storage engine used.
        </p></li><li class="listitem"><p>
          The <code class="literal">ENCRYPTION</code> clause enables or disables
          page-level data encryption for an <code class="literal">InnoDB</code>
          general tablespace. Encryption support for general tablespaces
          was introduced in MySQL 8.0.13.
        </p><p>
          As of MySQL 8.0.16, if the <code class="literal">ENCRYPTION</code>
          clause is not specified, the
          <a class="link" href="server-administration.html#sysvar_default_table_encryption"><code class="literal">default_table_encryption</code></a>
          setting controls whether encryption is enabled. The
          <code class="literal">ENCRYPTION</code> clause overrides the
          <a class="link" href="server-administration.html#sysvar_default_table_encryption"><code class="literal">default_table_encryption</code></a>
          setting. However, if the
          <a class="link" href="server-administration.html#sysvar_table_encryption_privilege_check"><code class="literal">table_encryption_privilege_check</code></a>
          variable is enabled, the
          <a class="link" href="security.html#priv_table-encryption-admin"><code class="literal">TABLE_ENCRYPTION_ADMIN</code></a>
          privilege is required to use an <code class="literal">ENCRYPTION</code>
          clause setting that differs from the
          <a class="link" href="server-administration.html#sysvar_default_table_encryption"><code class="literal">default_table_encryption</code></a>
          setting.
        </p><p>
          A keyring plugin must be installed and configured before an
          encryption-enabled tablespace can be created.
        </p><p>
          When a general tablespace is encrypted, all tables residing in
          the tablespace are encrypted. Likewise, a table created in an
          encrypted tablespace is encrypted.
        </p><p>
          For more information, see
          <a class="xref" href="innodb-storage-engine.html#innodb-tablespace-encryption" title="15.6.3.9 InnoDB Data-at-Rest Encryption">Section 15.6.3.9, “InnoDB Data-at-Rest Encryption”</a>
        </p></li><li class="listitem"><p>
          <code class="literal">ENGINE</code>: Defines the storage engine which
          uses the tablespace, where
          <em class="replaceable"><code>engine_name</code></em> is the name of the
          storage engine. Currently, only the <code class="literal">InnoDB</code>
          storage engine is supported by standard MySQL 8.0
          releases. MySQL NDB Cluster supports both
          <code class="literal">NDB</code> and <code class="literal">InnoDB</code>
          tablespaces. The value of the
          <a class="link" href="server-administration.html#sysvar_default_storage_engine"><code class="literal">default_storage_engine</code></a> system
          variable is used for <code class="literal">ENGINE</code> if the option
          is not specified.
</p></li></ul>
</div>
<h4><a name="create-tablespace-notes"></a>Notes</h4>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          For the rules covering the naming of MySQL tablespaces, see
          <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>. In addition to these rules, the
          slash character (<span class="quote">“<span class="quote">/</span>”</span>) is not permitted, nor can
          you use names beginning with <code class="literal">innodb_</code>, as
          this prefix is reserved for system use.
        </p></li><li class="listitem"><p>
          Creation of temporary general tablespaces is not supported.
        </p></li><li class="listitem"><p>
          General tablespaces do not support temporary tables.
        </p></li><li class="listitem"><p>
          The <code class="literal">TABLESPACE</code> option may be used with
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> or
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> to assign an
          <code class="literal">InnoDB</code> table partition or subpartition to a
          file-per-table tablespace. All partitions must belong to the
          same storage engine. Assigning table partitions to shared
          <code class="literal">InnoDB</code> tablespaces is not supported. Shared
          tablespaces include the <code class="literal">InnoDB</code> system
          tablespace and general tablespaces.
        </p></li><li class="listitem"><p>
          General tablespaces support the addition of tables of any row
          format using
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
          TABLESPACE</code></a>.
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a> does
          not need to be enabled.
        </p></li><li class="listitem"><p>
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> is not
          applicable to general tablespaces. Tablespace management rules
          are strictly enforced independently of
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a>. If
          <code class="literal">CREATE TABLESPACE</code> parameters are incorrect
          or incompatible, the operation fails regardless of the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> setting.
          When a table is added to a general tablespace using
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
          TABLESPACE</code></a> or
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          TABLESPACE</code></a>,
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> is ignored
          but the statement is evaluated as if
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> is
          enabled.
        </p></li><li class="listitem"><p>
          Use <code class="literal">DROP TABLESPACE</code> to remove a tablespace.
          All tables must be dropped from a tablespace using
          <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> prior to dropping
          the tablespace. Before dropping an NDB Cluster tablespace you
          must also remove all its data files using one or more
          <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.10 ALTER TABLESPACE Syntax"><code class="literal">ALTER
          TABLESPACE ... DROP DATATFILE</code></a> statements. See
          <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data-objects" title="22.5.13.1 NDB Cluster Disk Data Objects">Section 22.5.13.1, “NDB Cluster Disk Data Objects”</a>.
        </p></li><li class="listitem"><p>
          All parts of an <code class="literal">InnoDB</code> table added to an
          <code class="literal">InnoDB</code> general tablespace reside in the
          general tablespace, including indexes and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> pages.
        </p><p>
          For an <code class="literal">NDB</code> table assigned to a tablespace,
          only those columns which are not indexed are stored on disk,
          and actually use the tablespace data files. Indexes and
          indexed columns for all <code class="literal">NDB</code> tables are
          always kept in memory.
        </p></li><li class="listitem"><p>
          Similar to the system tablespace, truncating or dropping
          tables stored in a general tablespace creates free space
          internally in the general tablespace
          <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file">.ibd data file</a> which can
          only be used for new <code class="literal">InnoDB</code> data. Space is
          not released back to the operating system as it is for
          file-per-table tablespaces.
        </p></li><li class="listitem"><p>
          A general tablespace is not associated with any database or
          schema.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          DISCARD TABLESPACE</code></a> and
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
          ...IMPORT TABLESPACE</code></a> are not supported for tables
          that belong to a general tablespace.
        </p></li><li class="listitem"><p>
          The server uses tablespace-level metadata locking for DDL that
          references general tablespaces. By comparison, the server uses
          table-level metadata locking for DDL that references
          file-per-table tablespaces.
        </p></li><li class="listitem"><p>
          A generated or existing tablespace cannot be changed to a
          general tablespace.
        </p></li><li class="listitem"><p>
          There is no conflict between general tablespace names and
          file-per-table tablespace names. The <span class="quote">“<span class="quote">/</span>”</span>
          character, which is present in file-per-table tablespace
          names, is not permitted in general tablespace names.
        </p></li><li class="listitem"><p>
          <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a> and <a class="link" href="programs.html#mysqlpump" title="4.5.6 mysqlpump — A Database Backup Program"><span class="command"><strong>mysqlpump</strong></span></a>
          do not dump <code class="literal">InnoDB</code>
          <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.21 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a> statements.
</p></li></ul>
</div>
<h4><a name="create-tablespace-innodb-examples"></a>InnoDB Examples</h4>
<p>
      This example demonstrates creating a general tablespace and adding
      three uncompressed tables of different row formats.
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLESPACE `ts1` ADD DATAFILE 'ts1.ibd' ENGINE=INNODB;</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT PRIMARY KEY) TABLESPACE ts1 ROW_FORMAT=REDUNDANT;</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE TABLE t2 (c1 INT PRIMARY KEY) TABLESPACE ts1 ROW_FORMAT=COMPACT;</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE TABLE t3 (c1 INT PRIMARY KEY) TABLESPACE ts1 ROW_FORMAT=DYNAMIC;</code></strong>
</pre><p>
      This example demonstrates creating a general tablespace and adding
      a compressed table. The example assumes a default
      <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a> value of 16K.
      The <code class="literal">FILE_BLOCK_SIZE</code> of 8192 requires that the
      compressed table have a <code class="literal">KEY_BLOCK_SIZE</code> of 8.
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLESPACE `ts2` ADD DATAFILE 'ts2.ibd' FILE_BLOCK_SIZE = 8192 Engine=InnoDB;</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE TABLE t4 (c1 INT PRIMARY KEY) TABLESPACE ts2 ROW_FORMAT=COMPRESSED KEY_BLOCK_SIZE=8;</code></strong>
</pre><p>
      This example demonstrates creating a general tablespace without
      specifying the <code class="literal">ADD DATAFILE</code> clause, which is
      optional as of MySQL 8.0.14.
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLESPACE `ts3` ENGINE=INNODB;</code></strong>
</pre><p>
      This example demonstrates creating an undo tablespace.
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE UNDO TABLESPACE <em class="replaceable"><code>undo_003</code></em> ADD DATAFILE '<em class="replaceable"><code>undo_003</code></em>.ibu';</code></strong>
</pre>
<h4><a name="create-tablespace-ndb-examples"></a>NDB Example</h4>
<p>
      Suppose that you wish to create an NDB Cluster Disk Data
      tablespace named <code class="literal">myts</code> using a datafile named
      <code class="filename">mydata-1.dat</code>. An <code class="filename">NDB</code>
      tablespace always requires the use of a log file group consisting
      of one or more undo log files. For this example, we first create a
      log file group named <code class="literal">mylg</code> that contains one
      undo long file named <code class="filename">myundo-1.dat</code>, using the
      <a class="link" href="sql-syntax.html#create-logfile-group" title="13.1.16 CREATE LOGFILE GROUP Syntax"><code class="literal">CREATE LOGFILE GROUP</code></a> statement
      shown here:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE LOGFILE GROUP myg1</code></strong>
    -&gt;     <strong class="userinput"><code>ADD UNDOFILE 'myundo-1.dat'</code></strong>
    -&gt;     <strong class="userinput"><code>ENGINE=NDB;</code></strong>
Query OK, 0 rows affected (3.29 sec)
</pre><p>
      Now you can create the tablespace previously described using the
      following statement:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLESPACE myts</code></strong>
    -&gt;     <strong class="userinput"><code>ADD DATAFILE 'mydata-1.dat'</code></strong>
    -&gt;     <strong class="userinput"><code>USE LOGFILE GROUP mylg</code></strong>
    -&gt;     <strong class="userinput"><code>ENGINE=NDB;</code></strong>
Query OK, 0 rows affected (2.98 sec)
</pre><p>
      You can now create a Disk Data table using a
      <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement with the
      <code class="literal">TABLESPACE</code> and <code class="literal">STORAGE DISK</code>
      options, similar to what is shown here:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE mytable (</code></strong>
    -&gt;     <strong class="userinput"><code>id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,</code></strong>
    -&gt;     <strong class="userinput"><code>lname VARCHAR(50) NOT NULL,</code></strong>
    -&gt;     <strong class="userinput"><code>fname VARCHAR(50) NOT NULL,</code></strong>
    -&gt;     <strong class="userinput"><code>dob DATE NOT NULL,</code></strong>
    -&gt;     <strong class="userinput"><code>joined DATE NOT NULL,</code></strong>
    -&gt;     <strong class="userinput"><code>INDEX(last_name, first_name)</code></strong>
    -&gt; <strong class="userinput"><code>)</code></strong>
    -&gt;     <strong class="userinput"><code>TABLESPACE myts STORAGE DISK</code></strong>
    -&gt;     <strong class="userinput"><code>ENGINE=NDB;</code></strong>
Query OK, 0 rows affected (1.41 sec)
</pre><p>
      It is important to note that only the <code class="literal">dob</code> and
      <code class="literal">joined</code> columns from <code class="literal">mytable</code>
      are actually stored on disk, due to the fact that the
      <code class="literal">id</code>, <code class="literal">lname</code>, and
      <code class="literal">fname</code> columns are all indexed.
    </p><p>
      As mentioned previously, when <code class="literal">CREATE TABLESPACE</code>
      is used with <code class="literal">ENGINE [=] NDB</code>, a tablespace and
      associated data file are created on each NDB Cluster data node.
      You can verify that the data files were created and obtain
      information about them by querying the
      <a class="link" href="information-schema.html#files-table" title="25.11 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> table, as
      shown here:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT FILE_NAME, FILE_TYPE, LOGFILE_GROUP_NAME, STATUS, EXTRA</code></strong>
    -&gt;     <strong class="userinput"><code>FROM INFORMATION_SCHEMA.FILES</code></strong>
    -&gt;     <strong class="userinput"><code>WHERE TABLESPACE_NAME = 'myts';</code></strong>

+--------------+------------+--------------------+--------+----------------+
| file_name    | file_type  | logfile_group_name | status | extra          |
+--------------+------------+--------------------+--------+----------------+
| mydata-1.dat | DATAFILE   | mylg               | NORMAL | CLUSTER_NODE=5 |
| mydata-1.dat | DATAFILE   | mylg               | NORMAL | CLUSTER_NODE=6 |
| NULL         | TABLESPACE | mylg               | NORMAL | NULL           |
+--------------+------------+--------------------+--------+----------------+
3 rows in set (0.01 sec)
</pre><p>
      For additional information and examples, see
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data-objects" title="22.5.13.1 NDB Cluster Disk Data Objects">Section 22.5.13.1, “NDB Cluster Disk Data Objects”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-trigger"></a>13.1.22 CREATE TRIGGER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667608848"></a><a class="indexterm" name="idm140091667607776"></a><pre data-lang="sql" class="programlisting">
CREATE
    [DEFINER = <em class="replaceable"><code>user</code></em>]
    TRIGGER <em class="replaceable"><code>trigger_name</code></em>
    <em class="replaceable"><code>trigger_time</code></em> <em class="replaceable"><code>trigger_event</code></em>
    ON <em class="replaceable"><code>tbl_name</code></em> FOR EACH ROW
    [<em class="replaceable"><code>trigger_order</code></em>]
    <em class="replaceable"><code>trigger_body</code></em>

<em class="replaceable"><code>trigger_time</code></em>: { BEFORE | AFTER }

<em class="replaceable"><code>trigger_event</code></em>: { INSERT | UPDATE | DELETE }

<em class="replaceable"><code>trigger_order</code></em>: { FOLLOWS | PRECEDES } <em class="replaceable"><code>other_trigger_name</code></em>
</pre><p>
      This statement creates a new trigger. A trigger is a named
      database object that is associated with a table, and that
      activates when a particular event occurs for the table. The
      trigger becomes associated with the table named
      <em class="replaceable"><code>tbl_name</code></em>, which must refer to a
      permanent table. You cannot associate a trigger with a
      <code class="literal">TEMPORARY</code> table or a view.
    </p><p>
      Trigger names exist in the schema namespace, meaning that all
      triggers must have unique names within a schema. Triggers in
      different schemas can have the same name.
    </p><p>
      This section describes <a class="link" href="sql-syntax.html#create-trigger" title="13.1.22 CREATE TRIGGER Syntax"><code class="literal">CREATE
      TRIGGER</code></a> syntax. For additional discussion, see
      <a class="xref" href="stored-objects.html#trigger-syntax" title="24.3.1 Trigger Syntax and Examples">Section 24.3.1, “Trigger Syntax and Examples”</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#create-trigger" title="13.1.22 CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a> requires the
      <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a> privilege for the table
      associated with the trigger. If the <code class="literal">DEFINER</code>
      clause is present, the privileges required depend on the
      <em class="replaceable"><code>user</code></em> value, as discussed in
      <a class="xref" href="stored-objects.html#stored-objects-security" title="24.6 Stored Object Access Control">Section 24.6, “Stored Object Access Control”</a>. If binary logging is
      enabled, <a class="link" href="sql-syntax.html#create-trigger" title="13.1.22 CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a> might
      require the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, as
      discussed in <a class="xref" href="stored-objects.html#stored-programs-logging" title="24.7 Stored Program Binary Logging">Section 24.7, “Stored Program Binary Logging”</a>.
    </p><p>
      The <code class="literal">DEFINER</code> clause determines the security
      context to be used when checking access privileges at trigger
      activation time, as described later in this section.
    </p><p>
      <em class="replaceable"><code>trigger_time</code></em> is the trigger action
      time. It can be <code class="literal">BEFORE</code> or
      <code class="literal">AFTER</code> to indicate that the trigger activates
      before or after each row to be modified.
    </p><p>
      Basic column value checks occur prior to trigger activation, so
      you cannot use <code class="literal">BEFORE</code> triggers to convert
      values inappropriate for the column type to valid values.
    </p><p>
      <em class="replaceable"><code>trigger_event</code></em> indicates the kind of
      operation that activates the trigger. These
      <em class="replaceable"><code>trigger_event</code></em> values are permitted:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>: The trigger activates
          whenever a new row is inserted into the table (for example,
          through <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>,
          <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>, and
          <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> statements).
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>: The trigger activates
          whenever a row is modified (for example, through
          <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements).
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>: The trigger activates
          whenever a row is deleted from the table (for example, through
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> and
          <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> statements).
          <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> and
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> statements on
          the table do <span class="emphasis"><em>not</em></span> activate this trigger,
          because they do not use <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>.
          Dropping a partition does not activate
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> triggers, either.
</p></li></ul>
</div>
<p>
      The <em class="replaceable"><code>trigger_event</code></em> does not represent a
      literal type of SQL statement that activates the trigger so much
      as it represents a type of table operation. For example, an
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> trigger activates not only
      for <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statements but also
      <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> statements because both
      statements insert rows into a table.
    </p><p>
      A potentially confusing example of this is the <code class="literal">INSERT
      INTO ... ON DUPLICATE KEY UPDATE ...</code> syntax: a
      <code class="literal">BEFORE INSERT</code> trigger activates for every row,
      followed by either an <code class="literal">AFTER INSERT</code> trigger or
      both the <code class="literal">BEFORE UPDATE</code> and <code class="literal">AFTER
      UPDATE</code> triggers, depending on whether there was a
      duplicate key for the row.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Cascaded foreign key actions do not activate triggers.
</p>
</div>
<p>
      It is possible to define multiple triggers for a given table that
      have the same trigger event and action time. For example, you can
      have two <code class="literal">BEFORE UPDATE</code> triggers for a table. By
      default, triggers that have the same trigger event and action time
      activate in the order they were created. To affect trigger order,
      specify a <em class="replaceable"><code>trigger_order</code></em> clause that
      indicates <code class="literal">FOLLOWS</code> or
      <code class="literal">PRECEDES</code> and the name of an existing trigger
      that also has the same trigger event and action time. With
      <code class="literal">FOLLOWS</code>, the new trigger activates after the
      existing trigger. With <code class="literal">PRECEDES</code>, the new
      trigger activates before the existing trigger.
    </p><p>
      <em class="replaceable"><code>trigger_body</code></em> is the statement to
      execute when the trigger activates. To execute multiple
      statements, use the
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      compound statement construct. This also enables you to use the
      same statements that are permitted within stored routines. See
      <a class="xref" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax">Section 13.6.1, “BEGIN ... END Compound-Statement Syntax”</a>. Some statements are not permitted in
      triggers; see <a class="xref" href="restrictions.html#stored-program-restrictions" title="C.1 Restrictions on Stored Programs">Section C.1, “Restrictions on Stored Programs”</a>.
    </p><p>
      Within the trigger body, you can refer to columns in the subject
      table (the table associated with the trigger) by using the aliases
      <code class="literal">OLD</code> and <code class="literal">NEW</code>.
      <code class="literal">OLD.<em class="replaceable"><code>col_name</code></em></code> refers
      to a column of an existing row before it is updated or deleted.
      <code class="literal">NEW.<em class="replaceable"><code>col_name</code></em></code> refers
      to the column of a new row to be inserted or an existing row after
      it is updated.
    </p><a class="indexterm" name="idm140091667535392"></a><p>
      Triggers cannot use
      <code class="literal">NEW.<em class="replaceable"><code>col_name</code></em></code> or use
      <code class="literal">OLD.<em class="replaceable"><code>col_name</code></em></code> to
      refer to generated columns. For information about generated
      columns, see <a class="xref" href="sql-syntax.html#create-table-generated-columns" title="13.1.20.9 CREATE TABLE and Generated Columns">Section 13.1.20.9, “CREATE TABLE and Generated Columns”</a>.
    </p><p>
      MySQL stores the <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> system
      variable setting in effect when a trigger is created, and always
      executes the trigger body with this setting in force,
      <span class="emphasis"><em>regardless of the current server SQL mode when the
      trigger begins executing</em></span>.
    </p><p>
      The <code class="literal">DEFINER</code> clause specifies the MySQL account
      to be used when checking access privileges at trigger activation
      time. If the <code class="literal">DEFINER</code> clause is present, the
      <em class="replaceable"><code>user</code></em> value should be a MySQL account
      specified as
      <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>,
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>, or
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>. The permitted
      <em class="replaceable"><code>user</code></em> values depend on the privileges
      you hold, as discussed in
      <a class="xref" href="stored-objects.html#stored-objects-security" title="24.6 Stored Object Access Control">Section 24.6, “Stored Object Access Control”</a>. Also see that section
      for additional information about trigger security.
    </p><p>
      If the <code class="literal">DEFINER</code> clause is omitted, the default
      definer is the user who executes the <a class="link" href="sql-syntax.html#create-trigger" title="13.1.22 CREATE TRIGGER Syntax"><code class="literal">CREATE
      TRIGGER</code></a> statement. This is the same as specifying
      <code class="literal">DEFINER = CURRENT_USER</code> explicitly.
    </p><p>
      MySQL takes the <code class="literal">DEFINER</code> user into account when
      checking trigger privileges as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          At <a class="link" href="sql-syntax.html#create-trigger" title="13.1.22 CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a> time, the
          user who issues the statement must have the
          <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a> privilege.
        </p></li><li class="listitem"><p>
          At trigger activation time, privileges are checked against the
          <code class="literal">DEFINER</code> user. This user must have these
          privileges:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              The <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a> privilege for
              the subject table.
            </p></li><li class="listitem"><p>
              The <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for
              the subject table if references to table columns occur
              using
              <code class="literal">OLD.<em class="replaceable"><code>col_name</code></em></code>
              or
              <code class="literal">NEW.<em class="replaceable"><code>col_name</code></em></code>
              in the trigger body.
            </p></li><li class="listitem"><p>
              The <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege for
              the subject table if table columns are targets of
              <code class="literal">SET NEW.<em class="replaceable"><code>col_name</code></em> =
              <em class="replaceable"><code>value</code></em></code> assignments in
              the trigger body.
            </p></li><li class="listitem"><p>
              Whatever other privileges normally are required for the
              statements executed by the trigger.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
      Within a trigger body, the
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> function returns the
      account used to check privileges at trigger activation time. This
      is the <code class="literal">DEFINER</code> user, not the user whose actions
      caused the trigger to be activated. For information about user
      auditing within triggers, see
      <a class="xref" href="security.html#account-activity-auditing" title="6.2.22 SQL-Based Account Activity Auditing">Section 6.2.22, “SQL-Based Account Activity Auditing”</a>.
    </p><p>
      If you use <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to lock a
      table that has triggers, the tables used within the trigger are
      also locked, as described in
      <a class="xref" href="sql-syntax.html#lock-tables-and-triggers" title="LOCK TABLES and Triggers">LOCK TABLES and Triggers</a>.
    </p><p>
      For additional discussion of trigger use, see
      <a class="xref" href="stored-objects.html#trigger-syntax" title="24.3.1 Trigger Syntax and Examples">Section 24.3.1, “Trigger Syntax and Examples”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-view"></a>13.1.23 CREATE VIEW Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667491536"></a><a class="indexterm" name="idm140091667490464"></a><a class="indexterm" name="idm140091667488976"></a><pre data-lang="sql" class="programlisting">
CREATE
    [OR REPLACE]
    [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}]
    [DEFINER = <em class="replaceable"><code>user</code></em>]
    [SQL SECURITY { DEFINER | INVOKER }]
    VIEW <em class="replaceable"><code>view_name</code></em> [(<em class="replaceable"><code>column_list</code></em>)]
    AS <em class="replaceable"><code>select_statement</code></em>
    [WITH [CASCADED | LOCAL] CHECK OPTION]
</pre><p>
      The <a class="link" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax"><code class="literal">CREATE VIEW</code></a> statement creates a
      new view, or replaces an existing view if the <code class="literal">OR
      REPLACE</code> clause is given. If the view does not exist,
      <a class="link" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax"><code class="literal">CREATE OR REPLACE
      VIEW</code></a> is the same as <a class="link" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax"><code class="literal">CREATE
      VIEW</code></a>. If the view does exist,
      <a class="link" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax"><code class="literal">CREATE OR REPLACE
      VIEW</code></a> replaces it.
    </p><p>
      For information about restrictions on view use, see
      <a class="xref" href="restrictions.html#view-restrictions" title="C.5 Restrictions on Views">Section C.5, “Restrictions on Views”</a>.
    </p><p>
      The <em class="replaceable"><code>select_statement</code></em> is a
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement that provides the
      definition of the view. (Selecting from the view selects, in
      effect, using the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
      statement.) The <em class="replaceable"><code>select_statement</code></em> can
      select from base tables or other views.
    </p><p>
      The view definition is <span class="quote">“<span class="quote">frozen</span>”</span> at creation time and
      is not affected by subsequent changes to the definitions of the
      underlying tables. For example, if a view is defined as
      <code class="literal">SELECT *</code> on a table, new columns added to the
      table later do not become part of the view, and columns dropped
      from the table will result in an error when selecting from the
      view.
    </p><p>
      The <code class="literal">ALGORITHM</code> clause affects how MySQL
      processes the view. The <code class="literal">DEFINER</code> and
      <code class="literal">SQL SECURITY</code> clauses specify the security
      context to be used when checking access privileges at view
      invocation time. The <code class="literal">WITH CHECK OPTION</code> clause
      can be given to constrain inserts or updates to rows in tables
      referenced by the view. These clauses are described later in this
      section.
    </p><p>
      The <a class="link" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax"><code class="literal">CREATE VIEW</code></a> statement requires
      the <a class="link" href="security.html#priv_create-view"><code class="literal">CREATE VIEW</code></a> privilege for the
      view, and some privilege for each column selected by the
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement. For columns used
      elsewhere in the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement,
      you must have the <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege.
      If the <code class="literal">OR REPLACE</code> clause is present, you must
      also have the <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> privilege for
      the view. If the <code class="literal">DEFINER</code> clause is present, the
      privileges required depend on the <em class="replaceable"><code>user</code></em>
      value, as discussed in <a class="xref" href="stored-objects.html#stored-objects-security" title="24.6 Stored Object Access Control">Section 24.6, “Stored Object Access Control”</a>.
    </p><p>
      When a view is referenced, privilege checking occurs as described
      later in this section.
    </p><p>
      A view belongs to a database. By default, a new view is created in
      the default database. To create the view explicitly in a given
      database, use <em class="replaceable"><code>db_name.view_name</code></em> syntax
      to qualify the view name with the database name:
    </p><pre data-lang="sql" class="programlisting">
CREATE VIEW test.v AS SELECT * FROM t;
</pre><p>
      Unqualified table or view names in the
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement are also
      interpreted with respect to the default database. A view can refer
      to tables or views in other databases by qualifying the table or
      view name with the appropriate database name.
    </p><p>
      Within a database, base tables and views share the same namespace,
      so a base table and a view cannot have the same name.
    </p><p>
      Columns retrieved by the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
      statement can be simple references to table columns, or
      expressions that use functions, constant values, operators, and so
      forth.
    </p><p>
      A view must have unique column names with no duplicates, just like
      a base table. By default, the names of the columns retrieved by
      the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement are used for
      the view column names. To define explicit names for the view
      columns, specify the optional
      <em class="replaceable"><code>column_list</code></em> clause as a list of
      comma-separated identifiers. The number of names in
      <em class="replaceable"><code>column_list</code></em> must be the same as the
      number of columns retrieved by the
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
    </p><p>
      A view can be created from many kinds of
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements. It can refer to
      base tables or other views. It can use joins,
      <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a>, and subqueries. The
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> need not even refer to any
      tables:
    </p><pre data-lang="sql" class="programlisting">
CREATE VIEW v_today (today) AS SELECT CURRENT_DATE;
</pre><p>
      The following example defines a view that selects two columns from
      another table as well as an expression calculated from those
      columns:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t (qty INT, price INT);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(3, 50);</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE VIEW v AS SELECT qty, price, qty*price AS value FROM t;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT * FROM v;</code></strong>
+------+-------+-------+
| qty  | price | value |
+------+-------+-------+
|    3 |    50 |   150 |
+------+-------+-------+
</pre><p>
      A view definition is subject to the following restrictions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement cannot
          refer to system variables or user-defined variables.
        </p></li><li class="listitem"><p>
          Within a stored program, the
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement cannot refer
          to program parameters or local variables.
        </p></li><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement cannot
          refer to prepared statement parameters.
        </p></li><li class="listitem"><p>
          Any table or view referred to in the definition must exist.
          If, after the view has been created, a table or view that the
          definition refers to is dropped, use of the view results in an
          error. To check a view definition for problems of this kind,
          use the <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> statement.
        </p></li><li class="listitem"><p>
          The definition cannot refer to a <code class="literal">TEMPORARY</code>
          table, and you cannot create a <code class="literal">TEMPORARY</code>
          view.
        </p></li><li class="listitem"><p>
          You cannot associate a trigger with a view.
        </p></li><li class="listitem"><p>
          Aliases for column names in the
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement are checked
          against the maximum column length of 64 characters (not the
          maximum alias length of 256 characters).
</p></li></ul>
</div>
<p>
      <code class="literal">ORDER BY</code> is permitted in a view definition, but
      it is ignored if you select from a view using a statement that has
      its own <code class="literal">ORDER BY</code>.
    </p><p>
      For other options or clauses in the definition, they are added to
      the options or clauses of the statement that references the view,
      but the effect is undefined. For example, if a view definition
      includes a <code class="literal">LIMIT</code> clause, and you select from
      the view using a statement that has its own
      <code class="literal">LIMIT</code> clause, it is undefined which limit
      applies. This same principle applies to options such as
      <code class="literal">ALL</code>, <code class="literal">DISTINCT</code>, or
      <code class="literal">SQL_SMALL_RESULT</code> that follow the
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> keyword, and to clauses such
      as <code class="literal">INTO</code>, <code class="literal">FOR UPDATE</code>,
      <code class="literal">FOR SHARE</code>, <code class="literal">LOCK IN SHARE
      MODE</code>, and <code class="literal">PROCEDURE</code>.
    </p><p>
      The results obtained from a view may be affected if you change the
      query processing environment by changing system variables:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE VIEW v (mycol) AS SELECT 'abc';</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SET sql_mode = '';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT "mycol" FROM v;</code></strong>
+-------+
| mycol |
+-------+
| mycol |
+-------+
1 row in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>SET sql_mode = 'ANSI_QUOTES';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT "mycol" FROM v;</code></strong>
+-------+
| mycol |
+-------+
| abc   |
+-------+
1 row in set (0.00 sec)
</pre><p>
      The <code class="literal">DEFINER</code> and <code class="literal">SQL SECURITY</code>
      clauses determine which MySQL account to use when checking access
      privileges for the view when a statement is executed that
      references the view. The valid <code class="literal">SQL SECURITY</code>
      characteristic values are <code class="literal">DEFINER</code> (the default)
      and <code class="literal">INVOKER</code>. These indicate that the required
      privileges must be held by the user who defined or invoked the
      view, respectively.
    </p><p>
      If the <code class="literal">DEFINER</code> clause is present, the
      <em class="replaceable"><code>user</code></em> value should be a MySQL account
      specified as
      <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>,
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>, or
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>. The permitted
      <em class="replaceable"><code>user</code></em> values depend on the privileges
      you hold, as discussed in
      <a class="xref" href="stored-objects.html#stored-objects-security" title="24.6 Stored Object Access Control">Section 24.6, “Stored Object Access Control”</a>. Also see that section
      for additional information about view security.
    </p><p>
      If the <code class="literal">DEFINER</code> clause is omitted, the default
      definer is the user who executes the <a class="link" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax"><code class="literal">CREATE
      VIEW</code></a> statement. This is the same as specifying
      <code class="literal">DEFINER = CURRENT_USER</code> explicitly.
    </p><p>
      Within a view definition, the
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> function returns the
      view's <code class="literal">DEFINER</code> value by default. For views
      defined with the <code class="literal">SQL SECURITY INVOKER</code>
      characteristic, <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>
      returns the account for the view's invoker. For information about
      user auditing within views, see
      <a class="xref" href="security.html#account-activity-auditing" title="6.2.22 SQL-Based Account Activity Auditing">Section 6.2.22, “SQL-Based Account Activity Auditing”</a>.
    </p><p>
      Within a stored routine that is defined with the <code class="literal">SQL
      SECURITY DEFINER</code> characteristic,
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> returns the routine's
      <code class="literal">DEFINER</code> value. This also affects a view defined
      within such a routine, if the view definition contains a
      <code class="literal">DEFINER</code> value of
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>.
    </p><p>
      MySQL checks view privileges like this:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          At view definition time, the view creator must have the
          privileges needed to use the top-level objects accessed by the
          view. For example, if the view definition refers to table
          columns, the creator must have some privilege for each column
          in the select list of the definition, and the
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for each
          column used elsewhere in the definition. If the definition
          refers to a stored function, only the privileges needed to
          invoke the function can be checked. The privileges required at
          function invocation time can be checked only as it executes:
          For different invocations, different execution paths within
          the function might be taken.
        </p></li><li class="listitem"><p>
          The user who references a view must have appropriate
          privileges to access it (<a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>
          to select from it, <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> to
          insert into it, and so forth.)
        </p></li><li class="listitem"><p>
          When a view has been referenced, privileges for objects
          accessed by the view are checked against the privileges held
          by the view <code class="literal">DEFINER</code> account or invoker,
          depending on whether the <code class="literal">SQL SECURITY</code>
          characteristic is <code class="literal">DEFINER</code> or
          <code class="literal">INVOKER</code>, respectively.
        </p></li><li class="listitem"><p>
          If reference to a view causes execution of a stored function,
          privilege checking for statements executed within the function
          depend on whether the function <code class="literal">SQL SECURITY</code>
          characteristic is <code class="literal">DEFINER</code> or
          <code class="literal">INVOKER</code>. If the security characteristic is
          <code class="literal">DEFINER</code>, the function runs with the
          privileges of the <code class="literal">DEFINER</code> account. If the
          characteristic is <code class="literal">INVOKER</code>, the function
          runs with the privileges determined by the view's <code class="literal">SQL
          SECURITY</code> characteristic.
</p></li></ul>
</div>
<p>
      Example: A view might depend on a stored function, and that
      function might invoke other stored routines. For example, the
      following view invokes a stored function <code class="literal">f()</code>:
    </p><pre data-lang="sql" class="programlisting">
CREATE VIEW v AS SELECT * FROM t WHERE t.id = f(t.name);
</pre><p>
      Suppose that <code class="literal">f()</code> contains a statement such as
      this:
    </p><pre data-lang="sql" class="programlisting">
IF name IS NULL then
  CALL p1();
ELSE
  CALL p2();
END IF;
</pre><p>
      The privileges required for executing statements within
      <code class="literal">f()</code> need to be checked when
      <code class="literal">f()</code> executes. This might mean that privileges
      are needed for <code class="literal">p1()</code> or <code class="literal">p2()</code>,
      depending on the execution path within <code class="literal">f()</code>.
      Those privileges must be checked at runtime, and the user who must
      possess the privileges is determined by the <code class="literal">SQL
      SECURITY</code> values of the view <code class="literal">v</code> and the
      function <code class="literal">f()</code>.
    </p><p>
      The <code class="literal">DEFINER</code> and <code class="literal">SQL SECURITY</code>
      clauses for views are extensions to standard SQL. In standard SQL,
      views are handled using the rules for <code class="literal">SQL SECURITY
      DEFINER</code>. The standard says that the definer of the view,
      which is the same as the owner of the view's schema, gets
      applicable privileges on the view (for example,
      <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>) and may grant them. MySQL
      has no concept of a schema <span class="quote">“<span class="quote">owner</span>”</span>, so MySQL adds a
      clause to identify the definer. The <code class="literal">DEFINER</code>
      clause is an extension where the intent is to have what the
      standard has; that is, a permanent record of who defined the view.
      This is why the default <code class="literal">DEFINER</code> value is the
      account of the view creator.
    </p><p>
      The optional <code class="literal">ALGORITHM</code> clause is a MySQL
      extension to standard SQL. It affects how MySQL processes the
      view. <code class="literal">ALGORITHM</code> takes three values:
      <code class="literal">MERGE</code>, <code class="literal">TEMPTABLE</code>, or
      <code class="literal">UNDEFINED</code>. For more information, see
      <a class="xref" href="stored-objects.html#view-algorithms" title="24.5.2 View Processing Algorithms">Section 24.5.2, “View Processing Algorithms”</a>, as well as
      <a class="xref" href="optimization.html#derived-table-optimization" title="8.2.2.4 Optimizing Derived Tables, View References, and Common Table Expressions with Merging or Materialization">Section 8.2.2.4, “Optimizing Derived Tables, View References, and Common Table Expressions
          with Merging or Materialization”</a>.
    </p><p>
      Some views are updatable. That is, you can use them in statements
      such as <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>,
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>, or
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> to update the contents of
      the underlying table. For a view to be updatable, there must be a
      one-to-one relationship between the rows in the view and the rows
      in the underlying table. There are also certain other constructs
      that make a view nonupdatable.
    </p><a class="indexterm" name="idm140091667334016"></a><p>
      A generated column in a view is considered updatable because it is
      possible to assign to it. However, if such a column is updated
      explicitly, the only permitted value is
      <code class="literal">DEFAULT</code>. For information about generated
      columns, see <a class="xref" href="sql-syntax.html#create-table-generated-columns" title="13.1.20.9 CREATE TABLE and Generated Columns">Section 13.1.20.9, “CREATE TABLE and Generated Columns”</a>.
    </p><p>
      The <code class="literal">WITH CHECK OPTION</code> clause can be given for
      an updatable view to prevent inserts or updates to rows except
      those for which the <code class="literal">WHERE</code> clause in the
      <em class="replaceable"><code>select_statement</code></em> is true.
    </p><p>
      In a <code class="literal">WITH CHECK OPTION</code> clause for an updatable
      view, the <code class="literal">LOCAL</code> and <code class="literal">CASCADED</code>
      keywords determine the scope of check testing when the view is
      defined in terms of another view. The <code class="literal">LOCAL</code>
      keyword restricts the <code class="literal">CHECK OPTION</code> only to the
      view being defined. <code class="literal">CASCADED</code> causes the checks
      for underlying views to be evaluated as well. When neither keyword
      is given, the default is <code class="literal">CASCADED</code>.
    </p><p>
      For more information about updatable views and the <code class="literal">WITH
      CHECK OPTION</code> clause, see
      <a class="xref" href="stored-objects.html#view-updatability" title="24.5.3 Updatable and Insertable Views">Section 24.5.3, “Updatable and Insertable Views”</a>, and
      <a class="xref" href="stored-objects.html#view-check-option" title="24.5.4 The View WITH CHECK OPTION Clause">Section 24.5.4, “The View WITH CHECK OPTION Clause”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-database"></a>13.1.24 DROP DATABASE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667317696"></a><a class="indexterm" name="idm140091667316624"></a><a class="indexterm" name="idm140091667315552"></a><a class="indexterm" name="idm140091667314064"></a><a class="indexterm" name="idm140091667312576"></a><a class="indexterm" name="idm140091667311088"></a><pre data-lang="sql" class="programlisting">
DROP {DATABASE | SCHEMA} [IF EXISTS] <em class="replaceable"><code>db_name</code></em>
</pre><p>
      <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> drops all tables in
      the database and deletes the database. Be
      <span class="emphasis"><em>very</em></span> careful with this statement! To use
      <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a>, you need the
      <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> privilege on the database.
      <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP
      SCHEMA</code></a> is a synonym for <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP
      DATABASE</code></a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        When a database is dropped, privileges granted specifically for
        the database are <span class="emphasis"><em>not</em></span> automatically dropped.
        They must be dropped manually. See <a class="xref" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax">Section 13.7.1.6, “GRANT Syntax”</a>.
</p>
</div>
<p>
      <code class="literal">IF EXISTS</code> is used to prevent an error from
      occurring if the database does not exist.
    </p><p>
      If the default database is dropped, the default database is unset
      (the <a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a> function returns
      <code class="literal">NULL</code>).
    </p><p>
      If you use <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> on a
      symbolically linked database, both the link and the original
      database are deleted.
    </p><p>
      <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> returns the number of
      tables that were removed.
    </p><p>
      The <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> statement removes
      from the given database directory those files and directories that
      MySQL itself may create during normal operation. This includes all
      files with the extensions shown in the following list:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="filename">.BAK</code>
        </p></li><li class="listitem"><p>
          <code class="filename">.DAT</code>
        </p></li><li class="listitem"><p>
          <code class="filename">.HSH</code>
        </p></li><li class="listitem"><p>
          <code class="filename">.MRG</code>
        </p></li><li class="listitem"><p>
          <code class="filename">.MYD</code>
        </p></li><li class="listitem"><p>
          <code class="filename">.MYI</code>
        </p></li><li class="listitem"><p>
          <code class="filename">.cfg</code>
        </p></li><li class="listitem"><p>
          <code class="filename">.db</code>
        </p></li><li class="listitem"><p>
          <code class="filename">.ibd</code>
        </p></li><li class="listitem"><p>
          <code class="filename">.ndb</code>
</p></li></ul>
</div>
<p>
      If other files or directories remain in the database directory
      after MySQL removes those just listed, the database directory
      cannot be removed. In this case, you must remove any remaining
      files or directories manually and issue the
      <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> statement again.
    </p><p>
      Dropping a database does not remove any
      <code class="literal">TEMPORARY</code> tables that were created in that
      database. <code class="literal">TEMPORARY</code> tables are automatically
      removed when the session that created them ends. See
      <a class="xref" href="sql-syntax.html#create-temporary-table" title="13.1.20.3 CREATE TEMPORARY TABLE Syntax">Section 13.1.20.3, “CREATE TEMPORARY TABLE Syntax”</a>.
    </p><a class="indexterm" name="idm140091667266816"></a><p>
      You can also drop databases with <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin</strong></span></a>.
      See <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-event"></a>13.1.25 DROP EVENT Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667262112"></a><a class="indexterm" name="idm140091667261040"></a><a class="indexterm" name="idm140091667259552"></a><pre data-lang="sql" class="programlisting">
DROP EVENT [IF EXISTS] <em class="replaceable"><code>event_name</code></em>
</pre><p>
      This statement drops the event named
      <em class="replaceable"><code>event_name</code></em>. The event immediately
      ceases being active, and is deleted completely from the server.
    </p><p>
      If the event does not exist, the error <span class="errortext">ERROR 1517
      (HY000): Unknown event
      '<em class="replaceable"><code>event_name</code></em>'</span> results. You
      can override this and cause the statement to generate a warning
      for nonexistent events instead using <code class="literal">IF EXISTS</code>.
    </p><p>
      This statement requires the <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a>
      privilege for the schema to which the event to be dropped belongs.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-function"></a>13.1.26 DROP FUNCTION Syntax</h3>

</div>

</div>

</div>
<p>
      The <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> statement is used
      to drop stored functions and user-defined functions (UDFs):
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          For information about dropping stored functions, see
          <a class="xref" href="sql-syntax.html#drop-procedure" title="13.1.29 DROP PROCEDURE and DROP FUNCTION Syntax">Section 13.1.29, “DROP PROCEDURE and DROP FUNCTION Syntax”</a>.
        </p></li><li class="listitem"><p>
          For information about dropping user-defined functions, see
          <a class="xref" href="sql-syntax.html#drop-function-udf" title="13.7.4.2 DROP FUNCTION Syntax">Section 13.7.4.2, “DROP FUNCTION Syntax”</a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-index"></a>13.1.27 DROP INDEX Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667240368"></a><a class="indexterm" name="idm140091667239296"></a><a class="indexterm" name="idm140091667237808"></a><pre data-lang="sql" class="programlisting">
DROP INDEX <em class="replaceable"><code>index_name</code></em> ON <em class="replaceable"><code>tbl_name</code></em>
    [<em class="replaceable"><code>algorithm_option</code></em> | <em class="replaceable"><code>lock_option</code></em>] ...

<em class="replaceable"><code>algorithm_option</code></em>:
    ALGORITHM [=] {DEFAULT|INPLACE|COPY}

<em class="replaceable"><code>lock_option</code></em>:
    LOCK [=] {DEFAULT|NONE|SHARED|EXCLUSIVE}
</pre><p>
      <a class="link" href="sql-syntax.html#drop-index" title="13.1.27 DROP INDEX Syntax"><code class="literal">DROP INDEX</code></a> drops the index named
      <em class="replaceable"><code>index_name</code></em> from the table
      <em class="replaceable"><code>tbl_name</code></em>. This statement is mapped to
      an <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement to drop
      the index. See <a class="xref" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax">Section 13.1.9, “ALTER TABLE Syntax”</a>.
    </p><p>
      To drop a primary key, the index name is always
      <code class="literal">PRIMARY</code>, which must be specified as a quoted
      identifier because <code class="literal">PRIMARY</code> is a reserved word:
    </p><pre data-lang="sql" class="programlisting">
DROP INDEX `PRIMARY` ON t;
</pre><p>
      Indexes on variable-width columns of
      <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables are dropped online; that
      is, without any table copying. The table is not locked against
      access from other NDB Cluster API nodes, although it is locked
      against other operations on the <span class="emphasis"><em>same</em></span> API node
      for the duration of the operation. This is done automatically by
      the server whenever it determines that it is possible to do so;
      you do not have to use any special SQL syntax or server options to
      cause it to happen.
    </p><p>
      <code class="literal">ALGORITHM</code> and <code class="literal">LOCK</code> clauses
      may be given to influence the table copying method and level of
      concurrency for reading and writing the table while its indexes
      are being modified. They have the same meaning as for the
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement. For more
      information, see <a class="xref" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax">Section 13.1.9, “ALTER TABLE Syntax”</a>
    </p><p>
      MySQL NDB Cluster supports online operations using the same
      <code class="literal">ALGORITHM=INPLACE</code> syntax supported in the
      standard MySQL Server. See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-online-operations" title="22.5.14 Online Operations with ALTER TABLE in NDB Cluster">Section 22.5.14, “Online Operations with ALTER TABLE in NDB Cluster”</a>, for more
      information.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-logfile-group"></a>13.1.28 DROP LOGFILE GROUP Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667212448"></a><pre data-lang="sql" class="programlisting">
DROP LOGFILE GROUP <em class="replaceable"><code>logfile_group</code></em>
    ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
</pre><p>
      This statement drops the log file group named
      <em class="replaceable"><code>logfile_group</code></em>. The log file group must
      already exist or an error results. (For information on creating
      log file groups, see <a class="xref" href="sql-syntax.html#create-logfile-group" title="13.1.16 CREATE LOGFILE GROUP Syntax">Section 13.1.16, “CREATE LOGFILE GROUP Syntax”</a>.)
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        Before dropping a log file group, you must drop all tablespaces
        that use that log file group for <code class="literal">UNDO</code>
        logging.
</p>
</div>
<p>
      The required <code class="literal">ENGINE</code> clause provides the name of
      the storage engine used by the log file group to be dropped.
      Currently, the only permitted values for
      <em class="replaceable"><code>engine_name</code></em> are
      <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> and
      <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDBCLUSTER</code></a>.
    </p><p>
      <a class="link" href="sql-syntax.html#drop-logfile-group" title="13.1.28 DROP LOGFILE GROUP Syntax"><code class="literal">DROP LOGFILE GROUP</code></a> is useful only
      with Disk Data storage for NDB Cluster. See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="22.5.13 NDB Cluster Disk Data Tables">Section 22.5.13, “NDB Cluster Disk Data Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-procedure"></a>13.1.29 DROP PROCEDURE and DROP FUNCTION Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667197968"></a><a class="indexterm" name="idm140091667196928"></a><pre data-lang="sql" class="programlisting">
DROP {PROCEDURE | FUNCTION} [IF EXISTS] <em class="replaceable"><code>sp_name</code></em>
</pre><p>
      This statement is used to drop a stored procedure or function.
      That is, the specified routine is removed from the server. You
      must have the <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a>
      privilege for the routine. (If the
      <code class="literal">automatic_sp_privileges</code> system variable is
      enabled, that privilege and <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a>
      are granted automatically to the routine creator when the routine
      is created and dropped from the creator when the routine is
      dropped. See <a class="xref" href="stored-objects.html#stored-routines-privileges" title="24.2.2 Stored Routines and MySQL Privileges">Section 24.2.2, “Stored Routines and MySQL Privileges”</a>.)
    </p><p>
      The <code class="literal">IF EXISTS</code> clause is a MySQL extension. It
      prevents an error from occurring if the procedure or function does
      not exist. A warning is produced that can be viewed with
      <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a>.
    </p><p>
      <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> is also used to drop
      user-defined functions (see <a class="xref" href="sql-syntax.html#drop-function-udf" title="13.7.4.2 DROP FUNCTION Syntax">Section 13.7.4.2, “DROP FUNCTION Syntax”</a>).
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-server"></a>13.1.30 DROP SERVER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667179840"></a><pre data-lang="sql" class="programlisting">
DROP SERVER [ IF EXISTS ] <em class="replaceable"><code>server_name</code></em>
</pre><p>
      Drops the server definition for the server named
      <code class="literal"><em class="replaceable"><code>server_name</code></em></code>. The
      corresponding row in the <code class="literal">mysql.servers</code> table is
      deleted. This statement requires the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
    </p><p>
      Dropping a server for a table does not affect any
      <code class="literal">FEDERATED</code> tables that used this connection
      information when they were created. See
      <a class="xref" href="sql-syntax.html#create-server" title="13.1.18 CREATE SERVER Syntax">Section 13.1.18, “CREATE SERVER Syntax”</a>.
    </p><p>
      <code class="literal">DROP SERVER</code> causes an implicit commit. See
      <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
    </p><p>
      <code class="literal">DROP SERVER</code> is not written to the binary log,
      regardless of the logging format that is in use.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-spatial-reference-system"></a>13.1.31 DROP SPATIAL REFERENCE SYSTEM Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667164048"></a><pre data-lang="sql" class="programlisting">
DROP SPATIAL REFERENCE SYSTEM
    [IF EXISTS]
    <em class="replaceable"><code>srid</code></em>

<em class="replaceable"><code>srid</code></em>: <em class="replaceable"><code>32-bit unsigned integer</code></em>
</pre><p>
      This statement removes a
      <a class="link" href="data-types.html#spatial-reference-systems" title="11.5.5 Spatial Reference System Support">spatial reference
      system</a> (SRS) definition from the data dictionary. It
      requires the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
    </p><p>
      Example:
    </p><pre data-lang="sql" class="programlisting">
DROP SPATIAL REFERENCE SYSTEM 4120;
</pre><p>
      If no SRS definition with the SRID value exists, an error occurs
      unless <code class="literal">IF EXISTS</code> is specified. In that case, a
      warning occurs rather than an error.
    </p><p>
      If the SRID value is used by some column in an existing table, an
      error occurs. For example:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>DROP SPATIAL REFERENCE SYSTEM 4326;</code></strong>
ERROR 3716 (SR005): Can't modify SRID 4326. There is at
least one column depending on it.
</pre><p>
      To identify which column or columns use the SRID, use this query:
    </p><pre data-lang="sql" class="programlisting">
SELECT * FROM INFORMATION_SCHEMA.ST_GEOMETRY_COLUMNS WHERE SRS_ID=4326;
</pre><p>
      SRID values must be in the range of 32-bit unsigned integers, with
      these restrictions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          SRID 0 is a valid SRID but cannot be used with
          <a class="link" href="sql-syntax.html#drop-spatial-reference-system" title="13.1.31 DROP SPATIAL REFERENCE SYSTEM Syntax"><code class="literal">DROP SPATIAL REFERENCE SYSTEM</code></a>.
        </p></li><li class="listitem"><p>
          If the value is in a reserved SRID range, a warning occurs.
          Reserved ranges are [0, 32767] (reserved by EPSG),
          [60,000,000, 69,999,999] (reserved by EPSG), and
          [2,000,000,000, 2,147,483,647] (reserved by MySQL). EPSG
          stands for the <a class="ulink" href="http://epsg.org" target="_top">European Petroleum
          Survey Group</a>.
        </p></li><li class="listitem"><p>
          Users should not drop SRSs with SRIDs in the reserved ranges.
          If system-installed SRSs are dropped, the SRS definitions may
          be recreated for MySQL upgrades.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-table"></a>13.1.32 DROP TABLE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667141632"></a><a class="indexterm" name="idm140091667140560"></a><a class="indexterm" name="idm140091667139072"></a><pre data-lang="sql" class="programlisting">
DROP [TEMPORARY] TABLE [IF EXISTS]
    <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ...
    [RESTRICT | CASCADE]
</pre><p>
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> removes one or more
      tables. You must have the <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a>
      privilege for each table.
    </p><p>
      <span class="emphasis"><em>Be careful</em></span> with this statement! For each
      table, it removes the table definition and all table data. If the
      table is partitioned, the statement removes the table definition,
      all its partitions, all data stored in those partitions, and all
      partition definitions associated with the dropped table.
    </p><p>
      Dropping a table also drops any triggers for the table.
    </p><p>
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> causes an implicit
      commit, except when used with the <code class="literal">TEMPORARY</code>
      keyword. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        When a table is dropped, privileges granted specifically for the
        table are <span class="emphasis"><em>not</em></span> automatically dropped. They
        must be dropped manually. See <a class="xref" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax">Section 13.7.1.6, “GRANT Syntax”</a>.
</p>
</div>
<p>
      If any tables named in the argument list do not exist,
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> behavior depends on
      whether the <code class="literal">IF EXISTS</code> clause is given:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Without <code class="literal">IF EXISTS</code>, the statement fails with
          an error indicating which nonexisting tables it was unable to
          drop, and no changes are made.
        </p></li><li class="listitem"><p>
          With <code class="literal">IF EXISTS</code>, no error occurs for
          nonexisting tables. The statement drops all named tables that
          do exist, and generates a <code class="literal">NOTE</code> diagnostic
          for each nonexistent table. These notes can be displayed with
          <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a>. See
          <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax">Section 13.7.6.40, “SHOW WARNINGS Syntax”</a>.
</p></li></ul>
</div>
<p>
      <code class="literal">IF EXISTS</code> can also be useful for dropping
      tables in unusual circumstances under which there is an entry in
      the data dictionary but no table managed by the storage engine.
      (For example, if an abnormal server exit occurs after removal of
      the table from the storage engine but before removal of the data
      dictionary entry.)
    </p><p>
      The <code class="literal">TEMPORARY</code> keyword has the following
      effects:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The statement drops only <code class="literal">TEMPORARY</code> tables.
        </p></li><li class="listitem"><p>
          The statement does not cause an implicit commit.
        </p></li><li class="listitem"><p>
          No access rights are checked. A <code class="literal">TEMPORARY</code>
          table is visible only with the session that created it, so no
          check is necessary.
</p></li></ul>
</div>
<p>
      Including the <code class="literal">TEMPORARY</code> keyword is a good way
      to prevent accidentally dropping non-<code class="literal">TEMPORARY</code>
      tables.
    </p><p>
      The <code class="literal">RESTRICT</code> and <code class="literal">CASCADE</code>
      keywords do nothing. They are permitted to make porting easier
      from other database systems.
    </p><p>
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> is not supported with
      all <a class="link" href="innodb-storage-engine.html#sysvar_innodb_force_recovery"><code class="literal">innodb_force_recovery</code></a>
      settings. See <a class="xref" href="innodb-storage-engine.html#forcing-innodb-recovery" title="15.20.2 Forcing InnoDB Recovery">Section 15.20.2, “Forcing InnoDB Recovery”</a>.
</p><a class="indexterm" name="idm140091667100304"></a>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-tablespace"></a>13.1.33 DROP TABLESPACE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667097040"></a><a class="indexterm" name="idm140091667095552"></a><a class="indexterm" name="idm140091667094064"></a><pre data-lang="sql" class="programlisting">
DROP [UNDO] TABLESPACE <em class="replaceable"><code>tablespace_name</code></em>
    [ENGINE [=] <em class="replaceable"><code>engine_name</code></em>]
</pre><p>
      This statement drops a tablespace that was previously created
      using <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.21 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a>. It is
      supported by the <code class="literal">NDB</code> and
      <code class="literal">InnoDB</code> storage engines.
    </p><p>
      The <code class="literal">UNDO</code> keyword, introduced in MySQL 8.0.14,
      must be specified to drop an undo tablespace. Only undo
      tablespaces created using
      <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.21 CREATE TABLESPACE Syntax"><code class="literal">CREATE UNDO
      TABLESPACE</code></a> syntax can be dropped. An undo tablespace
      must be in an <code class="literal">empty</code> state before it can be
      dropped. For more information, see
      <a class="xref" href="innodb-storage-engine.html#innodb-undo-tablespaces" title="15.6.3.4 Undo Tablespaces">Section 15.6.3.4, “Undo Tablespaces”</a>.
    </p><p>
      <code class="literal">ENGINE</code> sets the storage engine that uses the
      tablespace, where <em class="replaceable"><code>engine_name</code></em> is the
      name of the storage engine. Currently, the values
      <code class="literal">InnoDB</code> and <code class="literal">NDB</code> are
      supported. If not set, the value of
      <a class="link" href="server-administration.html#sysvar_default_storage_engine"><code class="literal">default_storage_engine</code></a> is used.
      If it is not the same as the storage engine used to create the
      tablespace, the <code class="literal">DROP TABLESPACE</code> statement
      fails.
    </p><p>
      <code class="literal"><em class="replaceable"><code>tablespace_name</code></em></code> is a
      case-sensitive identifier in MySQL.
    </p><p>
      For an <code class="literal">InnoDB</code> general tablespace, all tables
      must be dropped from the tablespace prior to a <code class="literal">DROP
      TABLESPACE</code> operation. If the tablespace is not empty,
      <code class="literal">DROP TABLESPACE</code> returns an error.
    </p><p>
      An <code class="literal">NDB</code> tablespace to be dropped must not
      contain any data files; in other words, before you can drop an
      <code class="literal">NDB</code> tablespace, you must first drop each of its
      data files using
      <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.10 ALTER TABLESPACE Syntax"><code class="literal">ALTER TABLESPACE
      ... DROP DATAFILE</code></a>.
</p>
<h4><a name="idm140091667068752"></a>Notes</h4>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A general <code class="literal">InnoDB</code> tablespace is not deleted
          automatically when the last table in the tablespace is
          dropped. The tablespace must be dropped explicitly using
          <code class="literal">DROP TABLESPACE
          <em class="replaceable"><code>tablespace_name</code></em></code>.
        </p></li><li class="listitem"><p>
          A <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> operation can
          drop tables that belong to a general tablespace but it cannot
          drop the tablespace, even if the operation drops all tables
          that belong to the tablespace. The tablespace must be dropped
          explicitly using <code class="literal">DROP TABLESPACE
          <em class="replaceable"><code>tablespace_name</code></em></code>.
        </p></li><li class="listitem"><p>
          Similar to the system tablespace, truncating or dropping
          tables stored in a general tablespace creates free space
          internally in the general tablespace
          <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file">.ibd data file</a> which can
          only be used for new <code class="literal">InnoDB</code> data. Space is
          not released back to the operating system as it is for
          file-per-table tablespaces.
</p></li></ul>
</div>
<h4><a name="idm140091667059008"></a>InnoDB Examples</h4>
<p>
      This example demonstrates how to drop an <code class="literal">InnoDB</code>
      general tablespace. The general tablespace <code class="literal">ts1</code>
      is created with a single table. Before dropping the tablespace,
      the table must be dropped.
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLESPACE `ts1` ADD DATAFILE 'ts1.ibd' Engine=InnoDB;</code></strong>     

mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT PRIMARY KEY) TABLESPACE ts10 Engine=InnoDB;</code></strong>     

mysql&gt; <strong class="userinput"><code>DROP TABLE t1;</code></strong>

mysql&gt; <strong class="userinput"><code>DROP TABLESPACE ts1;</code></strong>
</pre><p>
      This example demonstrates dropping an undo tablespace. An undo
      tablespace must be in an <code class="literal">empty</code> state before it
      can be dropped. For more information, see
      <a class="xref" href="innodb-storage-engine.html#innodb-undo-tablespaces" title="15.6.3.4 Undo Tablespaces">Section 15.6.3.4, “Undo Tablespaces”</a>.
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>DROP UNDO TABLESPACE <em class="replaceable"><code>undo_003</code></em>;</code></strong>
</pre>
<h4><a name="idm140091667048464"></a>NDB Example</h4>
<p>
      This example shows how to drop an <code class="literal">NDB</code>
      tablespace <code class="literal">myts</code> having a data file named
      <code class="filename">mydata-1.dat</code> after first creating the
      tablespace, and assumes the existence of a log file group named
      <code class="literal">mylg</code> (see
      <a class="xref" href="sql-syntax.html#create-logfile-group" title="13.1.16 CREATE LOGFILE GROUP Syntax">Section 13.1.16, “CREATE LOGFILE GROUP Syntax”</a>).
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLESPACE myts</code></strong>
    -&gt;     <strong class="userinput"><code>ADD DATAFILE 'mydata-1.dat'</code></strong>
    -&gt;     <strong class="userinput"><code>USE LOGFILE GROUP mylg</code></strong>
    -&gt;     <strong class="userinput"><code>ENGINE=NDB;</code></strong>
</pre><p>
      You must remove all data files from the tablespace using
      <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.10 ALTER TABLESPACE Syntax"><code class="literal">ALTER TABLESPACE</code></a>, as shown here,
      before it can be dropped:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER TABLESPACE myts</code></strong>
    -&gt;     <strong class="userinput"><code>DROP DATAFILE 'mydata-1.dat'</code></strong>
    -&gt;     <strong class="userinput"><code>ENGINE=NDB;</code></strong>

mysql&gt; <strong class="userinput"><code>DROP TABLESPACE myts;</code></strong>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-trigger"></a>13.1.34 DROP TRIGGER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667032640"></a><a class="indexterm" name="idm140091667031568"></a><pre data-lang="sql" class="programlisting">
DROP TRIGGER [IF EXISTS] [<em class="replaceable"><code>schema_name</code></em>.]<em class="replaceable"><code>trigger_name</code></em>
</pre><p>
      This statement drops a trigger. The schema (database) name is
      optional. If the schema is omitted, the trigger is dropped from
      the default schema. <a class="link" href="sql-syntax.html#drop-trigger" title="13.1.34 DROP TRIGGER Syntax"><code class="literal">DROP TRIGGER</code></a>
      requires the <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a> privilege for
      the table associated with the trigger.
    </p><p>
      Use <code class="literal">IF EXISTS</code> to prevent an error from
      occurring for a trigger that does not exist. A
      <code class="literal">NOTE</code> is generated for a nonexistent trigger
      when using <code class="literal">IF EXISTS</code>. See
      <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax">Section 13.7.6.40, “SHOW WARNINGS Syntax”</a>.
    </p><p>
      Triggers for a table are also dropped if you drop the table.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-view"></a>13.1.35 DROP VIEW Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091667017504"></a><pre data-lang="sql" class="programlisting">
DROP VIEW [IF EXISTS]
    <em class="replaceable"><code>view_name</code></em> [, <em class="replaceable"><code>view_name</code></em>] ...
    [RESTRICT | CASCADE]
</pre><p>
      <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a> removes one or more
      views. You must have the <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a>
      privilege for each view.
    </p><p>
      If any views named in the argument list do not exist, the
      statement fails with an error indicating by name which nonexisting
      views it was unable to drop, and no changes are made.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        In MySQL 5.7 and earlier,
        <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a> returns an error if any
        views named in the argument list do not exist, but also drops
        all views in the list that do exist. Due to the change in
        behavior in MySQL 8.0, a partially completed
        <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a> operation on a MySQL
        5.7 master fails when replicated on a MySQL
        8.0 slave. To avoid this failure scenario, use
        <code class="literal">IF EXISTS</code> syntax in <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP
        VIEW</code></a> statements to prevent an error from occurring for
        views that do not exist. For more information, see
        <a class="xref" href="sql-syntax.html#atomic-ddl" title="13.1.1 Atomic Data Definition Statement Support">Section 13.1.1, “Atomic Data Definition Statement Support”</a>.
</p>
</div>
<p>
      The <code class="literal">IF EXISTS</code> clause prevents an error from
      occurring for views that don't exist. When this clause is given, a
      <code class="literal">NOTE</code> is generated for each nonexistent view.
      See <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax">Section 13.7.6.40, “SHOW WARNINGS Syntax”</a>.
    </p><p>
      <code class="literal">RESTRICT</code> and <code class="literal">CASCADE</code>, if
      given, are parsed and ignored.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="rename-table"></a>13.1.36 RENAME TABLE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091666995152"></a><pre data-lang="sql" class="programlisting">
RENAME TABLE
    <em class="replaceable"><code>tbl_name</code></em> TO <em class="replaceable"><code>new_tbl_name</code></em>
    [, <em class="replaceable"><code>tbl_name2</code></em> TO <em class="replaceable"><code>new_tbl_name2</code></em>] ...
</pre><p>
      <a class="link" href="sql-syntax.html#rename-table" title="13.1.36 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a> renames one or more
      tables. You must have <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a> and
      <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> privileges for the original
      table, and <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a> and
      <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges for the new
      table.
    </p><p>
      For example, to rename a table named <code class="literal">old_table</code>
      to <code class="literal">new_table</code>, use this statement:
    </p><pre data-lang="sql" class="programlisting">
RENAME TABLE old_table TO new_table;
</pre><p>
      That statement is equivalent to the following
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement:
    </p><pre data-lang="sql" class="programlisting">
ALTER TABLE old_table RENAME new_table;
</pre><p>
      <code class="literal">RENAME TABLE</code>, unlike <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a>, can rename multiple tables within a single
      statement:
    </p><pre data-lang="sql" class="programlisting">
RENAME TABLE old_table1 TO new_table1,
             old_table2 TO new_table2,
             old_table3 TO new_table3;
</pre><p>
      Renaming operations are performed left to right. Thus, to swap two
      table names, do this (assuming that a table with the intermediary
      name <code class="literal">tmp_table</code> does not already exist):
    </p><pre data-lang="sql" class="programlisting">
RENAME TABLE old_table TO tmp_table,
             new_table TO old_table,
             tmp_table TO new_table;
</pre><p>
      Metadata locks on tables are acquired in name order, which in some
      cases can make a difference in operation outcome when multiple
      transactions execute concurrently. See
      <a class="xref" href="optimization.html#metadata-locking" title="8.11.4 Metadata Locking">Section 8.11.4, “Metadata Locking”</a>.
    </p><p>
      As of MySQL 8.0.13, you can rename tables locked with a
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement, provided
      that they are locked with a <code class="literal">WRITE</code> lock or are
      the product of renaming <code class="literal">WRITE</code>-locked tables
      from earlier steps in a multiple-table rename operation. For
      example, this is permitted:
    </p><pre data-lang="sql" class="programlisting">
LOCK TABLE old_table1 WRITE;
RENAME TABLE old_table1 TO new_table1,
             new_table1 TO new_table2;
</pre><p>
      This is not permitted:
    </p><pre data-lang="sql" class="programlisting">
LOCK TABLE old_table1 READ;
RENAME TABLE old_table1 TO new_table1,
             new_table1 TO new_table2;
</pre><p>
      Prior to MySQL 8.0.13, to execute <code class="literal">RENAME TABLE</code>,
      there must be no tables locked with <code class="literal">LOCK
      TABLES</code>.
    </p><p>
      With the transaction table locking conditions satisfied, the
      rename operation is done atomically; no other session can access
      any of the tables while the rename is in progress.
    </p><p>
      If any errors occur during a <code class="literal">RENAME TABLE</code>, the
      statement fails and no changes are made.
    </p><p>
      You can use <code class="literal">RENAME TABLE</code> to move a table from
      one database to another:
    </p><pre data-lang="sql" class="programlisting">
RENAME TABLE <em class="replaceable"><code>current_db.tbl_name</code></em> TO <em class="replaceable"><code>other_db.tbl_name;</code></em>
</pre><a class="indexterm" name="idm140091666957168"></a><a class="indexterm" name="idm140091666955680"></a><p>
      Using this method to move all tables from one database to a
      different one in effect renames the database (an operation for
      which MySQL has no single statement), except that the original
      database continues to exist, albeit with no tables.
    </p><p>
      Like <code class="literal">RENAME TABLE</code>, <code class="literal">ALTER TABLE ...
      RENAME</code> can also be used to move a table to a different
      database. Regardless of the statement used, if the rename
      operation would move the table to a database located on a
      different file system, the success of the outcome is platform
      specific and depends on the underlying operating system calls used
      to move table files.
    </p><p>
      If a table has triggers, attempts to rename the table into a
      different database fail with a <span class="errortext">Trigger in wrong
      schema</span>
      (<a class="link" href="error-handling.html#error_er_trg_in_wrong_schema"><code class="literal">ER_TRG_IN_WRONG_SCHEMA</code></a>) error.
    </p><p>
      An unencrypted table can be moved to an encryption-enabled
      database and vice versa. However, if the
      <a class="link" href="server-administration.html#sysvar_table_encryption_privilege_check"><code class="literal">table_encryption_privilege_check</code></a>
      variable is enabled, the
      <a class="link" href="security.html#priv_table-encryption-admin"><code class="literal">TABLE_ENCRYPTION_ADMIN</code></a> privilege is
      required if the table encryption setting differs from the default
      database encryption.
    </p><a class="indexterm" name="idm140091666946128"></a><p>
      To rename <code class="literal">TEMPORARY</code> tables, <code class="literal">RENAME
      TABLE</code> does not work. Use <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a> instead.
    </p><p>
      <code class="literal">RENAME TABLE</code> works for views, except that views
      cannot be renamed into a different database.
    </p><p>
      Any privileges granted specifically for a renamed table or view
      are not migrated to the new name. They must be changed manually.
    </p><p>
      <code class="literal">RENAME TABLE <em class="replaceable"><code>tbl_name</code></em> TO
      <em class="replaceable"><code>new_tbl_name</code></em></code> changes
      internally generated foreign key constraint names and user-defined
      foreign key constraint names that begin with the string
      <span class="quote">“<span class="quote"><em class="replaceable"><code>tbl_name</code></em>_ibfk_</span>”</span> to
      reflect the new table name. <code class="literal">InnoDB</code> interprets
      foreign key constraint names that begin with the string
      <span class="quote">“<span class="quote"><em class="replaceable"><code>tbl_name</code></em>_ibfk_</span>”</span> as
      internally generated names.
    </p><p>
      Foreign key constraint names that point to the renamed table are
      automatically updated unless there is a conflict, in which case
      the statement fails with an error. A conflict occurs if the
      renamed constraint name already exists. In such cases, you must
      drop and re-create the foreign keys for them to function properly.
    </p><a class="indexterm" name="idm140091666934848"></a><p>
      <code class="literal">RENAME TABLE <em class="replaceable"><code>tbl_name</code></em> TO
      <em class="replaceable"><code>new_tbl_name</code></em></code> changes
      internally generated and user-defined <code class="literal">CHECK</code>
      constraint names that begin with the string
      <span class="quote">“<span class="quote"><em class="replaceable"><code>tbl_name</code></em>_chk_</span>”</span> to reflect
      the new table name. MySQL interprets <code class="literal">CHECK</code>
      constraint names that begin with the string
      <span class="quote">“<span class="quote"><em class="replaceable"><code>tbl_name</code></em>_chk_</span>”</span> as
      internally generated names. Example:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t1\G</code></strong>
*************************** 1. row ***************************
       Table: t1
Create Table: CREATE TABLE `t1` (
  `i1` int(11) DEFAULT NULL,
  `i2` int(11) DEFAULT NULL,
  CONSTRAINT `t1_chk_1` CHECK ((`i1` &gt; 0)),
  CONSTRAINT `t1_chk_2` CHECK ((`i2` &lt; 0))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
1 row in set (0.02 sec)

mysql&gt; <strong class="userinput"><code>RENAME TABLE t1 TO t3;</code></strong>
Query OK, 0 rows affected (0.03 sec)

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t3\G</code></strong>
*************************** 1. row ***************************
       Table: t3
Create Table: CREATE TABLE `t3` (
  `i1` int(11) DEFAULT NULL,
  `i2` int(11) DEFAULT NULL,
  CONSTRAINT `t3_chk_1` CHECK ((`i1` &gt; 0)),
  CONSTRAINT `t3_chk_2` CHECK ((`i2` &lt; 0))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
1 row in set (0.01 sec)
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="truncate-table"></a>13.1.37 TRUNCATE TABLE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091666922688"></a><pre data-lang="sql" class="programlisting">
TRUNCATE [TABLE] <em class="replaceable"><code>tbl_name</code></em>
</pre><p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> empties a table
      completely. It requires the <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a>
      privilege. Logically, <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
      TABLE</code></a> is similar to a
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement that deletes all
      rows, or a sequence of <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>
      and <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statements.
    </p><p>
      To achieve high performance, <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
      TABLE</code></a> bypasses the DML method of deleting data. Thus, it
      does not cause <code class="literal">ON DELETE</code> triggers to fire, it
      cannot be performed for <code class="literal">InnoDB</code> tables with
      parent-child foreign key relationships, and it cannot be rolled
      back like a DML operation. However, <code class="literal">TRUNCATE
      TABLE</code> operations on tables that use an atomic
      DDL-supported storage engine are either fully committed or rolled
      back if the server halts during their operation. For more
      information, see <a class="xref" href="sql-syntax.html#atomic-ddl" title="13.1.1 Atomic Data Definition Statement Support">Section 13.1.1, “Atomic Data Definition Statement Support”</a>.
    </p><p>
      Although <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is similar
      to <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>, it is classified as a
      DDL statement rather than a DML statement. It differs from
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> in the following ways:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Truncate operations drop and re-create the table, which is
          much faster than deleting rows one by one, particularly for
          large tables.
        </p></li><li class="listitem"><p>
          Truncate operations cause an implicit commit, and so cannot be
          rolled back. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
        </p></li><li class="listitem"><p>
          Truncation operations cannot be performed if the session holds
          an active table lock.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> fails for an
          <code class="literal">InnoDB</code> table or
          <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> table if there are any
          <code class="literal">FOREIGN KEY</code> constraints from other tables
          that reference the table. Foreign key constraints between
          columns of the same table are permitted.
        </p></li><li class="listitem"><p>
          Truncation operations do not return a meaningful value for the
          number of deleted rows. The usual result is <span class="quote">“<span class="quote">0 rows
          affected,</span>”</span> which should be interpreted as <span class="quote">“<span class="quote">no
          information.</span>”</span>
        </p></li><li class="listitem"><p>
          As long as the table definition is valid, the table can be
          re-created as an empty table with
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>, even if the
          data or index files have become corrupted.
        </p></li><li class="listitem"><p>
          Any <code class="literal">AUTO_INCREMENT</code> value is reset to its
          start value. This is true even for <code class="literal">MyISAM</code>
          and <code class="literal">InnoDB</code>, which normally do not reuse
          sequence values.
        </p></li><li class="listitem"><p>
          When used with partitioned tables,
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> preserves the
          partitioning; that is, the data and index files are dropped
          and re-created, while the partition definitions are
          unaffected.
        </p></li><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> statement
          does not invoke <code class="literal">ON DELETE</code> triggers.
        </p></li><li class="listitem"><p>
          Truncating a corrupted <code class="literal">InnoDB</code> table is
          supported.
</p></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> for a table closes
      all handlers for the table that were opened with
      <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER Syntax"><code class="literal">HANDLER OPEN</code></a>.
    </p><p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is treated for
      purposes of binary logging and replication as
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> followed by
      <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>—that is, as DDL
      rather than DML. This is due to the fact that, when using
      <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and other transactional
      storage engines where the transaction isolation level does not
      permit statement-based logging (<a class="link" href="innodb-storage-engine.html#isolevel_read-committed"><code class="literal">READ
      COMMITTED</code></a> or <a class="link" href="innodb-storage-engine.html#isolevel_read-uncommitted"><code class="literal">READ
      UNCOMMITTED</code></a>), the statement was not logged and
      replicated when using <code class="literal">STATEMENT</code> or
      <code class="literal">MIXED</code> logging mode. (Bug #36763) However, it is
      still applied on replication slaves using
      <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> in the manner described
      previously.
    </p><p>
      In MySQL 5.7 and earlier, on a system with a large buffer pool and
      <a class="link" href="innodb-storage-engine.html#sysvar_innodb_adaptive_hash_index"><code class="literal">innodb_adaptive_hash_index</code></a>
      enabled, a <code class="literal">TRUNCATE TABLE</code> operation could cause
      a temporary drop in system performance due to an LRU scan that
      occurred when removing the table's adaptive hash index entries
      (Bug #68184). The remapping of <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
      TABLE</code></a> to <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> and
      <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> in MySQL 8.0 avoids
      the problematic LRU scan.
    </p><p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> can be used with
      Performance Schema summary tables, but the effect is to reset the
      summary columns to 0 or <code class="literal">NULL</code>, not to remove
      rows. See <a class="xref" href="performance-schema.html#performance-schema-summary-tables" title="26.12.16 Performance Schema Summary Tables">Section 26.12.16, “Performance Schema Summary Tables”</a>.
</p>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-data-manipulation"></a>13.2 Data Manipulation Statements</h2>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#call">13.2.1 CALL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#delete">13.2.2 DELETE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#do">13.2.3 DO Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#handler">13.2.4 HANDLER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#import-table">13.2.5 IMPORT TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#insert">13.2.6 INSERT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#load-data">13.2.7 LOAD DATA Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#load-xml">13.2.8 LOAD XML Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#replace">13.2.9 REPLACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#select">13.2.10 SELECT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#subqueries">13.2.11 Subquery Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#update">13.2.12 UPDATE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#with">13.2.13 WITH Syntax (Common Table Expressions)</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091666852192"></a>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="call"></a>13.2.1 CALL Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091666850000"></a><pre data-lang="sql" class="programlisting">
CALL <em class="replaceable"><code>sp_name</code></em>([<em class="replaceable"><code>parameter</code></em>[,...]])
CALL <em class="replaceable"><code>sp_name</code></em>[()]
</pre><p>
      The <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statement invokes a stored
      procedure that was defined previously with
      <a class="link" href="sql-syntax.html#create-procedure" title="13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax"><code class="literal">CREATE PROCEDURE</code></a>.
    </p><p>
      Stored procedures that take no arguments can be invoked without
      parentheses. That is, <code class="literal">CALL p()</code> and
      <code class="literal">CALL p</code> are equivalent.
    </p><p>
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> can pass back values to its
      caller using parameters that are declared as
      <code class="literal">OUT</code> or <code class="literal">INOUT</code> parameters.
      When the procedure returns, a client program can also obtain the
      number of rows affected for the final statement executed within
      the routine: At the SQL level, call the
      <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> function; from the C
      API, call the
      <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1 mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> function.
    </p><p>
      For information about the effect of unhandled conditions on
      procedure parameters, see
      <a class="xref" href="sql-syntax.html#conditions-and-parameters" title="13.6.7.8 Condition Handling and OUT or INOUT Parameters">Section 13.6.7.8, “Condition Handling and OUT or INOUT Parameters”</a>.
    </p><p>
      To get back a value from a procedure using an
      <code class="literal">OUT</code> or <code class="literal">INOUT</code> parameter, pass
      the parameter by means of a user variable, and then check the
      value of the variable after the procedure returns. (If you are
      calling the procedure from within another stored procedure or
      function, you can also pass a routine parameter or local routine
      variable as an <code class="literal">IN</code> or <code class="literal">INOUT</code>
      parameter.) For an <code class="literal">INOUT</code> parameter, initialize
      its value before passing it to the procedure. The following
      procedure has an <code class="literal">OUT</code> parameter that the
      procedure sets to the current server version, and an
      <code class="literal">INOUT</code> value that the procedure increments by
      one from its current value:
    </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p (OUT ver_param VARCHAR(25), INOUT incr_param INT)
BEGIN
  # Set value of OUT parameter
  SELECT VERSION() INTO ver_param;
  # Increment value of INOUT parameter
  SET incr_param = incr_param + 1;
END;
</pre><p>
      Before calling the procedure, initialize the variable to be passed
      as the <code class="literal">INOUT</code> parameter. After calling the
      procedure, the values of the two variables will have been set or
      modified:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @increment = 10;</code></strong>
mysql&gt; <strong class="userinput"><code>CALL p(@version, @increment);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @version, @increment;</code></strong>
+--------------------+------------+
| @version           | @increment |
+--------------------+------------+
| 8.0.3-rc-debug-log |         11 |
+--------------------+------------+
</pre><p>
      In prepared <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statements used
      with <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> and
      <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>, placeholders can be used
      for <code class="literal">IN</code> parameters, <code class="literal">OUT</code>, and
      <code class="literal">INOUT</code> parameters. These types of parameters can
      be used as follows:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @increment = 10;</code></strong>
mysql&gt; <strong class="userinput"><code>PREPARE s FROM 'CALL p(?, ?)';</code></strong>
mysql&gt; <strong class="userinput"><code>EXECUTE s USING @version, @increment;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @version, @increment;</code></strong>
+--------------------+------------+
| @version           | @increment |
+--------------------+------------+
| 8.0.3-rc-debug-log |         11 |
+--------------------+------------+
</pre><p>
      To write C programs that use the
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> SQL statement to execute
      stored procedures that produce result sets, the
      <code class="literal">CLIENT_MULTI_RESULTS</code> flag must be enabled. This
      is because each <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> returns a
      result to indicate the call status, in addition to any result sets
      that might be returned by statements executed within the
      procedure. <code class="literal">CLIENT_MULTI_RESULTS</code> must also be
      enabled if <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> is used to execute
      any stored procedure that contains prepared statements. It cannot
      be determined when such a procedure is loaded whether those
      statements will produce result sets, so it is necessary to assume
      that they will.
    </p><p>
      <code class="literal">CLIENT_MULTI_RESULTS</code> can be enabled when you
      call <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>, either
      explicitly by passing the <code class="literal">CLIENT_MULTI_RESULTS</code>
      flag itself, or implicitly by passing
      <code class="literal">CLIENT_MULTI_STATEMENTS</code> (which also enables
      <code class="literal">CLIENT_MULTI_RESULTS</code>).
      <code class="literal">CLIENT_MULTI_RESULTS</code> is enabled by default.
    </p><p>
      To process the result of a <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a>
      statement executed using
      <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query()"><code class="literal">mysql_query()</code></a> or
      <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query()"><code class="literal">mysql_real_query()</code></a>, use a loop
      that calls <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result()"><code class="literal">mysql_next_result()</code></a> to
      determine whether there are more results. For an example, see
      <a class="xref" href="connectors-apis.html#c-api-multiple-queries" title="28.7.23 C API Multiple Statement Execution Support">Section 28.7.23, “C API Multiple Statement Execution Support”</a>.
    </p><p>
      C programs can use the prepared-statement interface to execute
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statements and access
      <code class="literal">OUT</code> and <code class="literal">INOUT</code> parameters.
      This is done by processing the result of a
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statement using a loop that
      calls <a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="28.7.11.17 mysql_stmt_next_result()"><code class="literal">mysql_stmt_next_result()</code></a> to
      determine whether there are more results. For an example, see
      <a class="xref" href="connectors-apis.html#c-api-prepared-call-statements" title="28.7.25 C API Prepared CALL Statement Support">Section 28.7.25, “C API Prepared CALL Statement Support”</a>. Languages that
      provide a MySQL interface can use prepared
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statements to directly
      retrieve <code class="literal">OUT</code> and <code class="literal">INOUT</code>
      procedure parameters.
    </p><p>
      Metadata changes to objects referred to by stored programs are
      detected and cause automatic reparsing of the affected statements
      when the program is next executed. For more information, see
      <a class="xref" href="optimization.html#statement-caching" title="8.10.3 Caching of Prepared Statements and Stored Programs">Section 8.10.3, “Caching of Prepared Statements and Stored Programs”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="delete"></a>13.2.2 DELETE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091666779488"></a><a class="indexterm" name="idm140091666778416"></a><p>
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> is a DML statement that
      removes rows from a table.
    </p><p>
      A <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement can start with a
      <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause to define common table
      expressions accessible within the
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>. See <a class="xref" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)">Section 13.2.13, “WITH Syntax (Common Table Expressions)”</a>.
</p>
<h4><a name="idm140091666768352"></a>Single-Table Syntax</h4>
<pre data-lang="sql" class="programlisting">
DELETE [LOW_PRIORITY] [QUICK] [IGNORE] FROM <em class="replaceable"><code>tbl_name</code></em> [[AS] <em class="replaceable"><code>tbl_alias</code></em>]
    [PARTITION (<em class="replaceable"><code>partition_name</code></em> [, <em class="replaceable"><code>partition_name</code></em>] ...)]
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
    [ORDER BY ...]
    [LIMIT <em class="replaceable"><code>row_count</code></em>]
</pre><p>
      The <code class="literal">DELETE</code> statement deletes rows from
      <em class="replaceable"><code>tbl_name</code></em> and returns the number of
      deleted rows. To check the number of deleted rows, call the
      <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> function described in
      <a class="xref" href="functions.html#information-functions" title="12.15 Information Functions">Section 12.15, “Information Functions”</a>.
</p>
<h4><a name="idm140091666760432"></a>Main Clauses</h4>
<p>
      The conditions in the optional <code class="literal">WHERE</code> clause
      identify which rows to delete. With no <code class="literal">WHERE</code>
      clause, all rows are deleted.
    </p><p>
      <em class="replaceable"><code>where_condition</code></em> is an expression that
      evaluates to true for each row to be deleted. It is specified as
      described in <a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax">Section 13.2.10, “SELECT Syntax”</a>.
    </p><p>
      If the <code class="literal">ORDER BY</code> clause is specified, the rows
      are deleted in the order that is specified. The
      <code class="literal">LIMIT</code> clause places a limit on the number of
      rows that can be deleted. These clauses apply to single-table
      deletes, but not multi-table deletes.
</p>
<h4><a name="idm140091666754128"></a>Multiple-Table Syntax</h4>
<pre data-lang="sql" class="programlisting">
DELETE [LOW_PRIORITY] [QUICK] [IGNORE]
    <em class="replaceable"><code>tbl_name</code></em>[.*] [, <em class="replaceable"><code>tbl_name</code></em>[.*]] ...
    FROM <em class="replaceable"><code>table_references</code></em>
    [WHERE <em class="replaceable"><code>where_condition</code></em>]

DELETE [LOW_PRIORITY] [QUICK] [IGNORE]
    FROM <em class="replaceable"><code>tbl_name</code></em>[.*] [, <em class="replaceable"><code>tbl_name</code></em>[.*]] ...
    USING <em class="replaceable"><code>table_references</code></em>
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
</pre>
<h4><a name="idm140091666747840"></a>Privileges</h4>
<p>
      You need the <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege on a
      table to delete rows from it. You need only the
      <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for any columns
      that are only read, such as those named in the
      <code class="literal">WHERE</code> clause.
</p>
<h4><a name="idm140091666743424"></a>Performance</h4>
<p>
      When you do not need to know the number of deleted rows, the
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> statement is a
      faster way to empty a table than a
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement with no
      <code class="literal">WHERE</code> clause. Unlike
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>,
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> cannot be used
      within a transaction or if you have a lock on the table. See
      <a class="xref" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax">Section 13.1.37, “TRUNCATE TABLE Syntax”</a> and
      <a class="xref" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax">Section 13.3.6, “LOCK TABLES and UNLOCK TABLES Syntax”</a>.
    </p><p>
      The speed of delete operations may also be affected by factors
      discussed in <a class="xref" href="optimization.html#delete-optimization" title="8.2.5.3 Optimizing DELETE Statements">Section 8.2.5.3, “Optimizing DELETE Statements”</a>.
    </p><p>
      To ensure that a given <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>
      statement does not take too much time, the MySQL-specific
      <code class="literal">LIMIT <em class="replaceable"><code>row_count</code></em></code>
      clause for <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> specifies the
      maximum number of rows to be deleted. If the number of rows to
      delete is larger than the limit, repeat the
      <code class="literal">DELETE</code> statement until the number of affected
      rows is less than the <code class="literal">LIMIT</code> value.
</p>
<h4><a name="idm140091666728256"></a>Subqueries</h4>
<p>
      You cannot delete from a table and select from the same table in a
      subquery.
</p>
<h4><a name="idm140091666727072"></a>Partitioned Table Support</h4>
<p>
      <code class="literal">DELETE</code> supports explicit partition selection
      using the <code class="literal">PARTITION</code> option, which takes a list
      of the comma-separated names of one or more partitions or
      subpartitions (or both) from which to select rows to be dropped.
      Partitions not included in the list are ignored. Given a
      partitioned table <code class="literal">t</code> with a partition named
      <code class="literal">p0</code>, executing the statement <code class="literal">DELETE
      FROM t PARTITION (p0)</code> has the same effect on the table
      as executing <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE t TRUNCATE PARTITION (p0)</code></a>; in both cases, all rows
      in partition <code class="literal">p0</code> are dropped.
    </p><p>
      <code class="literal">PARTITION</code> can be used along with a
      <code class="literal">WHERE</code> condition, in which case the condition is
      tested only on rows in the listed partitions. For example,
      <code class="literal">DELETE FROM t PARTITION (p0) WHERE c &lt; 5</code>
      deletes rows only from partition <code class="literal">p0</code> for which
      the condition <code class="literal">c &lt; 5</code> is true; rows in any
      other partitions are not checked and thus not affected by the
      <code class="literal">DELETE</code>.
    </p><p>
      The <code class="literal">PARTITION</code> option can also be used in
      multiple-table <code class="literal">DELETE</code> statements. You can use
      up to one such option per table named in the
      <code class="literal">FROM</code> option.
    </p><p>
      For more information and examples, see
      <a class="xref" href="partitioning.html#partitioning-selection" title="23.5 Partition Selection">Section 23.5, “Partition Selection”</a>.
</p>
<h4><a name="idm140091666710624"></a>Auto-Increment Columns</h4>
<p>
      If you delete the row containing the maximum value for an
      <code class="literal">AUTO_INCREMENT</code> column, the value is not reused
      for a <code class="literal">MyISAM</code> or <code class="literal">InnoDB</code>
      table. If you delete all rows in the table with <code class="literal">DELETE
      FROM <em class="replaceable"><code>tbl_name</code></em></code> (without a
      <code class="literal">WHERE</code> clause) in
      <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> mode, the sequence
      starts over for all storage engines except
      <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code>. There are
      some exceptions to this behavior for <code class="literal">InnoDB</code>
      tables, as discussed in
      <a class="xref" href="innodb-storage-engine.html#innodb-auto-increment-handling" title="15.6.1.4 AUTO_INCREMENT Handling in InnoDB">Section 15.6.1.4, “AUTO_INCREMENT Handling in InnoDB”</a>.
    </p><p>
      For <code class="literal">MyISAM</code> tables, you can specify an
      <code class="literal">AUTO_INCREMENT</code> secondary column in a
      multiple-column key. In this case, reuse of values deleted from
      the top of the sequence occurs even for <code class="literal">MyISAM</code>
      tables. See <a class="xref" href="tutorial.html#example-auto-increment" title="3.6.9 Using AUTO_INCREMENT">Section 3.6.9, “Using AUTO_INCREMENT”</a>.
</p>
<h4><a name="idm140091666697920"></a>Modifiers</h4>
<p>
      The <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement supports the
      following modifiers:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you specify the <code class="literal">LOW_PRIORITY</code> modifier,
          the server delays execution of the
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> until no other clients
          are reading from the table. This affects only storage engines
          that use only table-level locking (such as
          <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>, and
          <code class="literal">MERGE</code>).
        </p><a class="indexterm" name="idm140091666690336"></a></li><li class="listitem"><p>
          For <code class="literal">MyISAM</code> tables, if you use the
          <code class="literal">QUICK</code> modifier, the storage engine does not
          merge index leaves during delete, which may speed up some
          kinds of delete operations.
        </p><a class="indexterm" name="idm140091666686448"></a></li><li class="listitem"><p>
          The <code class="literal">IGNORE</code> modifier causes MySQL to ignore
          errors during the process of deleting rows. (Errors
          encountered during the parsing stage are processed in the
          usual manner.) Errors that are ignored due to the use of
          <code class="literal">IGNORE</code> are returned as warnings. For more
          information, see <a class="xref" href="server-administration.html#ignore-strict-comparison" title="Comparison of the IGNORE Keyword and Strict SQL Mode">Comparison of the IGNORE Keyword and Strict SQL Mode</a>.
</p><a class="indexterm" name="idm140091666681696"></a></li></ul>
</div>
<h4><a name="idm140091666679952"></a>Order of Deletion</h4>
<p>
      If the <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement includes an
      <code class="literal">ORDER BY</code> clause, rows are deleted in the order
      specified by the clause. This is useful primarily in conjunction
      with <code class="literal">LIMIT</code>. For example, the following
      statement finds rows matching the <code class="literal">WHERE</code> clause,
      sorts them by <code class="literal">timestamp_column</code>, and deletes the
      first (oldest) one:
    </p><pre data-lang="sql" class="programlisting">
DELETE FROM somelog WHERE user = 'jcole'
ORDER BY timestamp_column LIMIT 1;
</pre><p>
      <code class="literal">ORDER BY</code> also helps to delete rows in an order
      required to avoid referential integrity violations.
</p>
<h4><a name="idm140091666672384"></a>InnoDB Tables</h4>
<p>
      If you are deleting many rows from a large table, you may exceed
      the lock table size for an <code class="literal">InnoDB</code> table. To
      avoid this problem, or simply to minimize the time that the table
      remains locked, the following strategy (which does not use
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> at all) might be helpful:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Select the rows <span class="emphasis"><em>not</em></span> to be deleted into an
          empty table that has the same structure as the original table:
        </p><pre data-lang="sql" class="programlisting">
INSERT INTO t_copy SELECT * FROM t WHERE ... ;
</pre></li><li class="listitem"><p>
          Use <a class="link" href="sql-syntax.html#rename-table" title="13.1.36 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a> to atomically
          move the original table out of the way and rename the copy to
          the original name:
        </p><pre data-lang="sql" class="programlisting">
RENAME TABLE t TO t_old, t_copy TO t;
</pre></li><li class="listitem"><p>
          Drop the original table:
        </p><pre data-lang="sql" class="programlisting">
DROP TABLE t_old;
</pre></li></ol>
</div>
<p>
      No other sessions can access the tables involved while
      <a class="link" href="sql-syntax.html#rename-table" title="13.1.36 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a> executes, so the
      rename operation is not subject to concurrency problems. See
      <a class="xref" href="sql-syntax.html#rename-table" title="13.1.36 RENAME TABLE Syntax">Section 13.1.36, “RENAME TABLE Syntax”</a>.
</p>
<h4><a name="idm140091666658512"></a>MyISAM Tables</h4>
<p>
      In <code class="literal">MyISAM</code> tables, deleted rows are maintained
      in a linked list and subsequent
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> operations reuse old row
      positions. To reclaim unused space and reduce file sizes, use the
      <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> statement or the
      <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk</strong></span></a> utility to reorganize tables.
      <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is easier to use,
      but <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk</strong></span></a> is faster. See
      <a class="xref" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax">Section 13.7.3.4, “OPTIMIZE TABLE Syntax”</a>, and <a class="xref" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility">Section 4.6.4, “<span class="command"><strong>myisamchk</strong></span> — MyISAM Table-Maintenance Utility”</a>.
    </p><p>
      The <code class="literal">QUICK</code> modifier affects whether index leaves
      are merged for delete operations. <code class="literal">DELETE QUICK</code>
      is most useful for applications where index values for deleted
      rows are replaced by similar index values from rows inserted
      later. In this case, the holes left by deleted values are reused.
    </p><p>
      <code class="literal">DELETE QUICK</code> is not useful when deleted values
      lead to underfilled index blocks spanning a range of index values
      for which new inserts occur again. In this case, use of
      <code class="literal">QUICK</code> can lead to wasted space in the index
      that remains unreclaimed. Here is an example of such a scenario:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Create a table that contains an indexed
          <code class="literal">AUTO_INCREMENT</code> column.
        </p></li><li class="listitem"><p>
          Insert many rows into the table. Each insert results in an
          index value that is added to the high end of the index.
        </p></li><li class="listitem"><p>
          Delete a block of rows at the low end of the column range
          using <code class="literal">DELETE QUICK</code>.
</p></li></ol>
</div>
<p>
      In this scenario, the index blocks associated with the deleted
      index values become underfilled but are not merged with other
      index blocks due to the use of <code class="literal">QUICK</code>. They
      remain underfilled when new inserts occur, because new rows do not
      have index values in the deleted range. Furthermore, they remain
      underfilled even if you later use
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> without
      <code class="literal">QUICK</code>, unless some of the deleted index values
      happen to lie in index blocks within or adjacent to the
      underfilled blocks. To reclaim unused index space under these
      circumstances, use <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a>.
    </p><p>
      If you are going to delete many rows from a table, it might be
      faster to use <code class="literal">DELETE QUICK</code> followed by
      <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a>. This rebuilds the
      index rather than performing many index block merge operations.
</p>
<h4><a name="idm140091666632416"></a>Multi-Table Deletes</h4>
<p>
      You can specify multiple tables in a
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement to delete rows
      from one or more tables depending on the condition in the
      <code class="literal">WHERE</code> clause. You cannot use <code class="literal">ORDER
      BY</code> or <code class="literal">LIMIT</code> in a multiple-table
      <code class="literal">DELETE</code>. The
      <em class="replaceable"><code>table_references</code></em> clause lists the
      tables involved in the join, as described in
      <a class="xref" href="sql-syntax.html#join" title="13.2.10.2 JOIN Syntax">Section 13.2.10.2, “JOIN Syntax”</a>.
    </p><p>
      For the first multiple-table syntax, only matching rows from the
      tables listed before the <code class="literal">FROM</code> clause are
      deleted. For the second multiple-table syntax, only matching rows
      from the tables listed in the <code class="literal">FROM</code> clause
      (before the <code class="literal">USING</code> clause) are deleted. The
      effect is that you can delete rows from many tables at the same
      time and have additional tables that are used only for searching:
    </p><pre data-lang="sql" class="programlisting">
DELETE t1, t2 FROM t1 INNER JOIN t2 INNER JOIN t3
WHERE t1.id=t2.id AND t2.id=t3.id;
</pre><p>
      Or:
    </p><pre data-lang="sql" class="programlisting">
DELETE FROM t1, t2 USING t1 INNER JOIN t2 INNER JOIN t3
WHERE t1.id=t2.id AND t2.id=t3.id;
</pre><p>
      These statements use all three tables when searching for rows to
      delete, but delete matching rows only from tables
      <code class="literal">t1</code> and <code class="literal">t2</code>.
    </p><p>
      The preceding examples use <code class="literal">INNER JOIN</code>, but
      multiple-table <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements
      can use other types of join permitted in
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements, such as
      <code class="literal">LEFT JOIN</code>. For example, to delete rows that
      exist in <code class="literal">t1</code> that have no match in
      <code class="literal">t2</code>, use a <code class="literal">LEFT JOIN</code>:
    </p><pre data-lang="sql" class="programlisting">
DELETE t1 FROM t1 LEFT JOIN t2 ON t1.id=t2.id WHERE t2.id IS NULL;
</pre><p>
      The syntax permits <code class="literal">.*</code> after each
      <em class="replaceable"><code>tbl_name</code></em> for compatibility with
      <span class="command"><strong>Access</strong></span>.
    </p><p>
      If you use a multiple-table <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>
      statement involving <code class="literal">InnoDB</code> tables for which
      there are foreign key constraints, the MySQL optimizer might
      process tables in an order that differs from that of their
      parent/child relationship. In this case, the statement fails and
      rolls back. Instead, you should delete from a single table and
      rely on the <code class="literal">ON DELETE</code> capabilities that
      <code class="literal">InnoDB</code> provides to cause the other tables to be
      modified accordingly.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        If you declare an alias for a table, you must use the alias when
        referring to the table:
      </p><pre data-lang="sql" class="programlisting">
DELETE t1 FROM test AS t1, test2 WHERE ...
</pre>
</div>
<p>
      Table aliases in a multiple-table
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> should be declared only in
      the <em class="replaceable"><code>table_references</code></em> part of the
      statement. Elsewhere, alias references are permitted but not alias
      declarations.
    </p><p>
      Correct:
    </p><pre data-lang="sql" class="programlisting">
DELETE a1, a2 FROM t1 AS a1 INNER JOIN t2 AS a2
WHERE a1.id=a2.id;

DELETE FROM a1, a2 USING t1 AS a1 INNER JOIN t2 AS a2
WHERE a1.id=a2.id;
</pre><p>
      Incorrect:
    </p><pre data-lang="sql" class="programlisting">
DELETE t1 AS a1, t2 AS a2 FROM t1 INNER JOIN t2
WHERE a1.id=a2.id;

DELETE FROM t1 AS a1, t2 AS a2 USING t1 INNER JOIN t2
WHERE a1.id=a2.id;
</pre><p>
      Table aliases are also supported for single-table
      <code class="literal">DELETE</code> statements beginning with MySQL 8.0.16.
      (Bug #89410,Bug #27455809)
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="do"></a>13.2.3 DO Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091666595072"></a><pre data-lang="sql" class="programlisting">
DO <em class="replaceable"><code>expr</code></em> [, <em class="replaceable"><code>expr</code></em>] ...
</pre><p>
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> executes the expressions but
      does not return any results. In most respects,
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> is shorthand for <code class="literal">SELECT
      <em class="replaceable"><code>expr</code></em>, ...</code>, but has the
      advantage that it is slightly faster when you do not care about
      the result.
    </p><p>
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> is useful primarily with
      functions that have side effects, such as
      <a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a>.
    </p><p>
      Example: This <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement
      pauses, but also produces a result set:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SLEEP(5);</code></strong>
+----------+
| SLEEP(5) |
+----------+
|        0 |
+----------+
1 row in set (5.02 sec)
</pre><p>
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a>, on the other hand, pauses
      without producing a result set.:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>DO SLEEP(5);</code></strong>
Query OK, 0 rows affected (4.99 sec)
</pre><p>
      This could be useful, for example in a stored function or trigger,
      which prohibit statements that produce result sets.
    </p><p>
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> only executes expressions. It
      cannot be used in all cases where <code class="literal">SELECT</code> can be
      used. For example, <code class="literal">DO id FROM t1</code> is invalid
      because it references a table.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="handler"></a>13.2.4 HANDLER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091666570768"></a><pre data-lang="sql" class="programlisting">
HANDLER <em class="replaceable"><code>tbl_name</code></em> OPEN [ [AS] <em class="replaceable"><code>alias</code></em>]

HANDLER <em class="replaceable"><code>tbl_name</code></em> READ <em class="replaceable"><code>index_name</code></em> { = | &lt;= | &gt;= | &lt; | &gt; } (<em class="replaceable"><code>value1</code></em>,<em class="replaceable"><code>value2</code></em>,...)
    [ WHERE <em class="replaceable"><code>where_condition</code></em> ] [LIMIT ... ]
HANDLER <em class="replaceable"><code>tbl_name</code></em> READ <em class="replaceable"><code>index_name</code></em> { FIRST | NEXT | PREV | LAST }
    [ WHERE <em class="replaceable"><code>where_condition</code></em> ] [LIMIT ... ]
HANDLER <em class="replaceable"><code>tbl_name</code></em> READ { FIRST | NEXT }
    [ WHERE <em class="replaceable"><code>where_condition</code></em> ] [LIMIT ... ]

HANDLER <em class="replaceable"><code>tbl_name</code></em> CLOSE
</pre><p>
      The <code class="literal">HANDLER</code> statement provides direct access to
      table storage engine interfaces. It is available for
      <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code> tables.
    </p><p>
      The <code class="literal">HANDLER ... OPEN</code> statement opens a table,
      making it accessible using subsequent <code class="literal">HANDLER ...
      READ</code> statements. This table object is not shared by
      other sessions and is not closed until the session calls
      <code class="literal">HANDLER ... CLOSE</code> or the session terminates.
    </p><p>
      If you open the table using an alias, further references to the
      open table with other <code class="literal">HANDLER</code> statements must
      use the alias rather than the table name. If you do not use an
      alias, but open the table using a table name qualified by the
      database name, further references must use the unqualified table
      name. For example, for a table opened using
      <code class="literal">mydb.mytable</code>, further references must use
      <code class="literal">mytable</code>.
    </p><p>
      The first <code class="literal">HANDLER ... READ</code> syntax fetches a row
      where the index specified satisfies the given values and the
      <code class="literal">WHERE</code> condition is met. If you have a
      multiple-column index, specify the index column values as a
      comma-separated list. Either specify values for all the columns in
      the index, or specify values for a leftmost prefix of the index
      columns. Suppose that an index <code class="literal">my_idx</code> includes
      three columns named <code class="literal">col_a</code>,
      <code class="literal">col_b</code>, and <code class="literal">col_c</code>, in that
      order. The <code class="literal">HANDLER</code> statement can specify values
      for all three columns in the index, or for the columns in a
      leftmost prefix. For example:
    </p><pre data-lang="sql" class="programlisting">
HANDLER ... READ my_idx = (col_a_val,col_b_val,col_c_val) ...
HANDLER ... READ my_idx = (col_a_val,col_b_val) ...
HANDLER ... READ my_idx = (col_a_val) ...
</pre><p>
      To employ the <code class="literal">HANDLER</code> interface to refer to a
      table's <code class="literal">PRIMARY KEY</code>, use the quoted identifier
      <code class="literal">`PRIMARY`</code>:
    </p><pre data-lang="sql" class="programlisting">
HANDLER <em class="replaceable"><code>tbl_name</code></em> READ `PRIMARY` ...
</pre><p>
      The second <code class="literal">HANDLER ... READ</code> syntax fetches a
      row from the table in index order that matches the
      <code class="literal">WHERE</code> condition.
    </p><p>
      The third <code class="literal">HANDLER ... READ</code> syntax fetches a row
      from the table in natural row order that matches the
      <code class="literal">WHERE</code> condition. It is faster than
      <code class="literal">HANDLER <em class="replaceable"><code>tbl_name</code></em> READ
      <em class="replaceable"><code>index_name</code></em></code> when a full table
      scan is desired. Natural row order is the order in which rows are
      stored in a <code class="literal">MyISAM</code> table data file. This
      statement works for <code class="literal">InnoDB</code> tables as well, but
      there is no such concept because there is no separate data file.
    </p><p>
      Without a <code class="literal">LIMIT</code> clause, all forms of
      <code class="literal">HANDLER ... READ</code> fetch a single row if one is
      available. To return a specific number of rows, include a
      <code class="literal">LIMIT</code> clause. It has the same syntax as for the
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement. See
      <a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax">Section 13.2.10, “SELECT Syntax”</a>.
    </p><p>
      <code class="literal">HANDLER ... CLOSE</code> closes a table that was
      opened with <code class="literal">HANDLER ... OPEN</code>.
    </p><p>
      There are several reasons to use the <code class="literal">HANDLER</code>
      interface instead of normal <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
      statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">HANDLER</code> is faster than
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              A designated storage engine handler object is allocated
              for the <code class="literal">HANDLER ... OPEN</code>. The object is
              reused for subsequent <code class="literal">HANDLER</code>
              statements for that table; it need not be reinitialized
              for each one.
            </p></li><li class="listitem"><p>
              There is less parsing involved.
            </p></li><li class="listitem"><p>
              There is no optimizer or query-checking overhead.
            </p></li><li class="listitem"><p>
              The handler interface does not have to provide a
              consistent look of the data (for example,
              <a class="link" href="glossary.html#glos_dirty_read" title="dirty read">dirty reads</a> are
              permitted), so the storage engine can use optimizations
              that <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> does not
              normally permit.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal">HANDLER</code> makes it easier to port to MySQL
          applications that use a low-level <code class="literal">ISAM</code>-like
          interface. (See <a class="xref" href="innodb-storage-engine.html#innodb-memcached" title="15.19 InnoDB memcached Plugin">Section 15.19, “InnoDB memcached Plugin”</a> for an
          alternative way to adapt applications that use the key-value
          store paradigm.)
        </p></li><li class="listitem"><p>
          <code class="literal">HANDLER</code> enables you to traverse a database
          in a manner that is difficult (or even impossible) to
          accomplish with <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>. The
          <code class="literal">HANDLER</code> interface is a more natural way to
          look at data when working with applications that provide an
          interactive user interface to the database.
</p></li></ul>
</div>
<p>
      <code class="literal">HANDLER</code> is a somewhat low-level statement. For
      example, it does not provide consistency. That is,
      <code class="literal">HANDLER ... OPEN</code> does <span class="emphasis"><em>not</em></span>
      take a snapshot of the table, and does <span class="emphasis"><em>not</em></span>
      lock the table. This means that after a <code class="literal">HANDLER ...
      OPEN</code> statement is issued, table data can be modified (by
      the current session or other sessions) and these modifications
      might be only partially visible to <code class="literal">HANDLER ...
      NEXT</code> or <code class="literal">HANDLER ... PREV</code> scans.
    </p><p>
      An open handler can be closed and marked for reopen, in which case
      the handler loses its position in the table. This occurs when both
      of the following circumstances are true:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Any session executes <a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH
          TABLES</code></a> or DDL statements on the handler's table.
        </p></li><li class="listitem"><p>
          The session in which the handler is open executes
          non-<code class="literal">HANDLER</code> statements that use tables.
</p></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> for a table closes
      all handlers for the table that were opened with
      <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER Syntax"><code class="literal">HANDLER OPEN</code></a>.
    </p><p>
      If a table is flushed with
      <a class="link" href="sql-syntax.html#flush-tables-with-read-lock-with-list"><code class="literal">FLUSH
      TABLES <em class="replaceable"><code>tbl_name</code></em> WITH READ
      LOCK</code></a> was opened with <code class="literal">HANDLER</code>, the
      handler is implicitly flushed and loses its position.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="import-table"></a>13.2.5 IMPORT TABLE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091666489632"></a><a class="indexterm" name="idm140091666488560"></a><a class="indexterm" name="idm140091666487520"></a><pre data-lang="sql" class="programlisting">
IMPORT TABLE FROM <em class="replaceable"><code>sdi_file</code></em> [, <em class="replaceable"><code>sdi_file</code></em>] ...
</pre><p>
      The <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT TABLE</code></a> statement imports
      <code class="literal">MyISAM</code> tables based on information contained in
      <code class="filename">.sdi</code> (Serialized Dictionary Information)
      metadata files. <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT TABLE</code></a>
      requires the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege to read
      the <code class="filename">.sdi</code> and table content files, and the
      <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a> privilege for the table to
      be created.
    </p><p>
      Tables can be exported from one server using
      <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a> to write a file of SQL statements and
      imported into another server using <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> to
      process the dump file. <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT TABLE</code></a>
      provides a faster alternative using the <span class="quote">“<span class="quote">raw</span>”</span> table
      files.
    </p><p>
      Prior to import, the files that provide the table content must be
      placed in the appropriate schema directory for the import server,
      and the <code class="filename">.sdi</code> file must be located in a
      directory accessible to the server. For example, the
      <code class="filename">.sdi</code> file can be placed in the directory
      named by the <a class="link" href="server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a>
      system variable, or (if
      <a class="link" href="server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a> is empty) in a
      directory under the server data directory.
    </p><p>
      The following example describes how to export
      <code class="literal">MyISAM</code> tables named
      <code class="literal">employees</code> and <code class="literal">managers</code> from
      the <code class="literal">hr</code> schema of one server and import them
      into the <code class="literal">hr</code> schema of another server. The
      example uses these assumptions (to perform a similar operation on
      your own system, modify the path names as appropriate):
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          For the export server,
          <em class="replaceable"><code>export_basedir</code></em> represents its base
          directory, and its data directory is
          <code class="filename"><em class="replaceable"><code>export_basedir</code></em>/data</code>.
        </p></li><li class="listitem"><p>
          For the import server,
          <em class="replaceable"><code>import_basedir</code></em> represents its base
          directory, and its data directory is
          <code class="filename"><em class="replaceable"><code>import_basedir</code></em>/data</code>.
        </p></li><li class="listitem"><p>
          Table files are exported from the export server into the
          <code class="filename">/tmp/export</code> directory and this directory
          is secure (not accessible to other users).
        </p></li><li class="listitem"><p>
          The import server uses <code class="filename">/tmp/mysql-files</code>
          as the directory named by its
          <a class="link" href="server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a> system
          variable.
</p></li></ul>
</div>
<p>
      To export tables from the export server, use this procedure:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Ensure a consistent snapshot by executing this statement to
          lock the tables so that they cannot be modified during export:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>FLUSH TABLES hr.employees, hr.managers WITH READ LOCK;</code></strong>
</pre><p>
          While the lock is in effect, the tables can still be used, but
          only for read access.
        </p></li><li class="listitem"><p>
          At the file system level, copy the <code class="filename">.sdi</code>
          and table content files from the <code class="literal">hr</code> schema
          directory to the secure export directory:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              The <code class="literal">.sdi</code> file is located in the
              <code class="literal">hr</code> schema directory, but might not have
              exactly the same basename as the table name. For example,
              the <code class="filename">.sdi</code> files for the
              <code class="literal">employees</code> and
              <code class="literal">managers</code> tables might be named
              <code class="filename">employees_125.sdi</code> and
              <code class="filename">managers_238.sdi</code>.
            </p></li><li class="listitem"><p>
              For a <code class="literal">MyISAM</code> table, the content files
              are its <code class="filename">.MYD</code> data file and
              <code class="filename">.MYI</code> index file.
</p></li></ul>
</div>
<p>
          Given those file names, the copy commands look like this:
        </p><pre data-lang="terminal" class="programlisting">
shell&gt; <strong class="userinput"><code>cd <em class="replaceable"><code>export_basedir</code></em>/data/hr</code></strong>
shell&gt; <strong class="userinput"><code>cp employees_125.sdi /tmp/export</code></strong>
shell&gt; <strong class="userinput"><code>cp managers_238.sdi /tmp/export</code></strong>
shell&gt; <strong class="userinput"><code>cp employees.{MYD,MYI} /tmp/export</code></strong>
shell&gt; <strong class="userinput"><code>cp managers.{MYD,MYI} /tmp/export</code></strong>
</pre></li><li class="listitem"><p>
          Unlock the tables:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>UNLOCK TABLES;</code></strong>
</pre></li></ol>
</div>
<p>
      To import tables into the import server, use this procedure:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          The import schema must exist. If necessary, execute this
          statement to create it:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE SCHEMA hr;</code></strong>
</pre></li><li class="listitem"><p>
          At the file system level, copy the <code class="filename">.sdi</code>
          files to the import server
          <a class="link" href="server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a> directory,
          <code class="filename">/tmp/mysql-files</code>. Also, copy the table
          content files to the <code class="literal">hr</code> schema directory:
        </p><pre data-lang="terminal" class="programlisting">
shell&gt; <strong class="userinput"><code>cd /tmp/export</code></strong>
shell&gt; <strong class="userinput"><code>cp employees_125.sdi /tmp/mysql-files</code></strong>
shell&gt; <strong class="userinput"><code>cp managers_238.sdi /tmp/mysql-files</code></strong>
shell&gt; <strong class="userinput"><code>cp employees.{MYD,MYI} <em class="replaceable"><code>import_basedir</code></em>/data/hr</code></strong>
shell&gt; <strong class="userinput"><code>cp managers.{MYD,MYI} <em class="replaceable"><code>import_basedir</code></em>/data/hr</code></strong>
</pre></li><li class="listitem"><p>
          Import the tables by executing an <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT
          TABLE</code></a> statement that names the
          <code class="filename">.sdi</code> files:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>IMPORT TABLE FROM</code></strong>
       <strong class="userinput"><code>'/tmp/mysql-files/employees.sdi',</code></strong>
       <strong class="userinput"><code>'/tmp/mysql-files/managers.sdi';</code></strong>
</pre></li></ol>
</div>
<p>
      The <code class="filename">.sdi</code> file need not be placed in the
      import server directory named by the
      <a class="link" href="server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a> system variable
      if that variable is empty; it can be in any directory accessible
      to the server, including the schema directory for the imported
      table. If the <code class="filename">.sdi</code> file is placed in that
      directory, however, it may be rewritten; the import operation
      creates a new <code class="filename">.sdi</code> file for the table, which
      will overwrite the old <code class="filename">.sdi</code> file if the
      operation uses the same file name for the new file.
    </p><p>
      Each <em class="replaceable"><code>sdi_file</code></em> value must be a string
      literal that names the <code class="filename">.sdi</code> file for a table
      or is a pattern that matches <code class="filename">.sdi</code> files. If
      the string is a pattern, any leading directory path and the
      <code class="filename">.sdi</code> file name suffix must be given
      literally. Pattern characters are permitted only in the base name
      part of the file name:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">?</code> matches any single character
        </p></li><li class="listitem"><p>
          <code class="literal">*</code> matches any sequence of characters,
          including no characters
</p></li></ul>
</div>
<p>
      Using a pattern, the previous <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT
      TABLE</code></a> statement could have been written like this
      (assuming that the <code class="filename">/tmp/mysql-files</code> directory
      contains no other <code class="filename">.sdi</code> files matching the
      pattern):
    </p><pre data-lang="sql" class="programlisting">
IMPORT TABLE FROM '/tmp/mysql-files/*.sdi';
</pre><p>
      To interpret the location of <code class="filename">.sdi</code> file path
      names, the server uses the same rules for
      <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT TABLE</code></a> as the server-side
      rules for <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> (that is, the
      non-<code class="literal">LOCAL</code> rules). See
      <a class="xref" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax">Section 13.2.7, “LOAD DATA Syntax”</a>, paying particular attention to the
      rules used to interpret relative path names.
    </p><p>
      <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT TABLE</code></a> fails if the
      <code class="literal">.sdi</code> or table files cannot be located. After
      importing a table, the server attempts to open it and reports as
      warnings any problems detected. To attempt a repair to correct any
      reported issues, use <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>.
    </p><p>
      <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT TABLE</code></a> is not written to the
      binary log.
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="import-table-restrictions"></a>Restrictions and Limitations</h4>
</div>
</div>
</div>
<p>
        <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT TABLE</code></a> applies only to
        non-<code class="literal">TEMPORARY</code> <code class="literal">MyISAM</code>
        tables. It does not apply to tables created with a transactional
        storage engine, tables created with
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TEMPORARY
        TABLE</code></a>, or views.
      </p><p>
        The table data and index files must be placed in the schema
        directory for the import server prior to the import operation,
        unless the table as defined on the export server uses the
        <code class="literal">DATA DIRECTORY</code> or <code class="literal">INDEX
        DIRECTORY</code> table options. In that case, modify the
        import procedure using one of these alternatives before
        executing the <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT TABLE</code></a>
        statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Put the data and index files into the same directory on the
            import server host as on the export server host, and create
            symlinks in the import server schema directory to those
            files.
          </p></li><li class="listitem"><p>
            Put the data and index files into an import server host
            directory different from that on the export server host, and
            create symlinks in the import server schema directory to
            those files. In addition, modify the
            <code class="filename">.sdi</code> file to reflect the different file
            locations.
          </p></li><li class="listitem"><p>
            Put the data and index files into the schema directory on
            the import server host, and modify the
            <code class="filename">.sdi</code> file to remove the data and index
            directory table options.
</p></li></ul>
</div>
<p>
        Any collation IDs stored in the <code class="filename">.sdi</code> file
        must refer to the same collations on the export and import
        servers.
      </p><p>
        Trigger information for a table is not serialized into the table
        <code class="filename">.sdi</code> file, so triggers are not restored by
        the import operation.
      </p><p>
        Some edits to an <code class="filename">.sdi</code> file are permissible
        prior to executing the <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT
        TABLE</code></a> statement, whereas others are problematic or may
        even cause the import operation to fail:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Changing the data directory and index directory table
            options is required if the locations of the data and index
            files differ between the export and import servers.
          </p></li><li class="listitem"><p>
            Changing the schema name is required to import the table
            into a different schema on the import server than on the
            export server.
          </p></li><li class="listitem"><p>
            Changing schema and table names may be required to
            accommodate differences between file system case-sensitivity
            semantics on the export and import servers or differences in
            <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a>
            settings. Changing the table names in the
            <code class="filename">.sdi</code> file may require renaming the
            table files as well.
          </p></li><li class="listitem"><p>
            In some cases, changes to column definitions are permitted.
            Changing data types is likely to cause problems.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="insert"></a>13.2.6 INSERT Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#insert-select">13.2.6.1 INSERT ... SELECT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#insert-on-duplicate">13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#insert-delayed">13.2.6.3 INSERT DELAYED Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091666351568"></a><a class="indexterm" name="idm140091666350496"></a><a class="indexterm" name="idm140091666349424"></a><pre data-lang="sql" class="programlisting">
INSERT [LOW_PRIORITY | DELAYED | HIGH_PRIORITY] [IGNORE]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em> [, <em class="replaceable"><code>partition_name</code></em>] ...)]
    [(<em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...)]
    {VALUES | VALUE} (<em class="replaceable"><code>value_list</code></em>) [, (<em class="replaceable"><code>value_list</code></em>)] ...
    [ON DUPLICATE KEY UPDATE <em class="replaceable"><code>assignment_list</code></em>]

INSERT [LOW_PRIORITY | DELAYED | HIGH_PRIORITY] [IGNORE]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em> [, <em class="replaceable"><code>partition_name</code></em>] ...)]
    SET <em class="replaceable"><code>assignment_list</code></em>
    [ON DUPLICATE KEY UPDATE <em class="replaceable"><code>assignment_list</code></em>]

INSERT [LOW_PRIORITY | HIGH_PRIORITY] [IGNORE]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em> [, <em class="replaceable"><code>partition_name</code></em>] ...)]
    [(<em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...)]
    SELECT ...
    [ON DUPLICATE KEY UPDATE <em class="replaceable"><code>assignment_list</code></em>]

<em class="replaceable"><code>value</code></em>:
    {<em class="replaceable"><code>expr</code></em> | DEFAULT}

<em class="replaceable"><code>value_list</code></em>:
    <em class="replaceable"><code>value</code></em> [, <em class="replaceable"><code>value</code></em>] ...

<em class="replaceable"><code>assignment</code></em>:
    <em class="replaceable"><code>col_name</code></em> = <em class="replaceable"><code>value</code></em>

<em class="replaceable"><code>assignment_list</code></em>:
    <em class="replaceable"><code>assignment</code></em> [, <em class="replaceable"><code>assignment</code></em>] ...
</pre><p>
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> inserts new rows into an
      existing table. The <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT
      ... VALUES</code></a> and
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT ... SET</code></a>
      forms of the statement insert rows based on explicitly specified
      values. The <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT
      ... SELECT</code></a> form inserts rows selected from another table
      or tables. <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> with an
      <code class="literal">ON DUPLICATE KEY UPDATE</code> clause enables existing
      rows to be updated if a row to be inserted would cause a duplicate
      value in a <code class="literal">UNIQUE</code> index or <code class="literal">PRIMARY
      KEY</code>.
    </p><p>
      For additional information about
      <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
      SELECT</code></a> and
      <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ... ON
      DUPLICATE KEY UPDATE</code></a>, see
      <a class="xref" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax">Section 13.2.6.1, “INSERT ... SELECT Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax">Section 13.2.6.2, “INSERT ... ON DUPLICATE KEY UPDATE Syntax”</a>.
    </p><p>
      In MySQL 8.0, the <code class="literal">DELAYED</code> keyword
      is accepted but ignored by the server. For the reasons for this,
      see <a class="xref" href="sql-syntax.html#insert-delayed" title="13.2.6.3 INSERT DELAYED Syntax">Section 13.2.6.3, “INSERT DELAYED Syntax”</a>,
    </p><p>
      Inserting into a table requires the
      <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for the table. If
      the <code class="literal">ON DUPLICATE KEY UPDATE</code> clause is used and
      a duplicate key causes an <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> to
      be performed instead, the statement requires the
      <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege for the columns to
      be updated. For columns that are read but not modified you need
      only the <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege (such as
      for a column referenced only on the right hand side of an
      <em class="replaceable"><code>col_name</code></em>=<em class="replaceable"><code>expr</code></em>
      assignment in an <code class="literal">ON DUPLICATE KEY UPDATE</code>
      clause).
    </p><p>
      When inserting into a partitioned table, you can control which
      partitions and subpartitions accept new rows. The
      <code class="literal">PARTITION</code> option takes a list of the
      comma-separated names of one or more partitions or subpartitions
      (or both) of the table. If any of the rows to be inserted by a
      given <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statement do not match
      one of the partitions listed, the
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statement fails with the
      error <span class="errortext">Found a row not matching the given partition
      set</span>. For more information and examples, see
      <a class="xref" href="partitioning.html#partitioning-selection" title="23.5 Partition Selection">Section 23.5, “Partition Selection”</a>.
    </p><p>
      You can use <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> instead of
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> to overwrite old rows.
      <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> is the counterpart to
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT IGNORE</code></a> in
      the treatment of new rows that contain unique key values that
      duplicate old rows: The new rows replace the old rows rather than
      being discarded. See <a class="xref" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax">Section 13.2.9, “REPLACE Syntax”</a>.
    </p><p>
      <em class="replaceable"><code>tbl_name</code></em> is the table into which rows
      should be inserted. Specify the columns for which the statement
      provides values as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Provide a parenthesized list of comma-separated column names
          following the table name. In this case, a value for each named
          column must be provided by the <code class="literal">VALUES</code> list
          or the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
        </p></li><li class="listitem"><p>
          If you do not specify a list of column names for
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT ...
          VALUES</code></a> or
          <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
          SELECT</code></a>, values for every column in the table must be
          provided by the <code class="literal">VALUES</code> list or the
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement. If you do not
          know the order of the columns in the table, use
          <code class="literal">DESCRIBE
          <em class="replaceable"><code>tbl_name</code></em></code> to find out.
        </p></li><li class="listitem"><p>
          A <code class="literal">SET</code> clause indicates columns explicitly
          by name, together with the value to assign each one.
</p></li></ul>
</div>
<p>
      Column values can be given in several ways:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If strict SQL mode is not enabled, any column not explicitly
          given a value is set to its default (explicit or implicit)
          value. For example, if you specify a column list that does not
          name all the columns in the table, unnamed columns are set to
          their default values. Default value assignment is described in
          <a class="xref" href="data-types.html#data-type-defaults" title="11.7 Data Type Default Values">Section 11.7, “Data Type Default Values”</a>. See also
          <a class="xref" href="introduction.html#constraint-invalid-data" title="1.8.3.3 Constraints on Invalid Data">Section 1.8.3.3, “Constraints on Invalid Data”</a>.
        </p><a class="indexterm" name="idm140091666279728"></a><p>
          If strict SQL mode is enabled, an
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statement generates an
          error if it does not specify an explicit value for every
          column that has no default value. See
          <a class="xref" href="server-administration.html#sql-mode" title="5.1.11 Server SQL Modes">Section 5.1.11, “Server SQL Modes”</a>.
        </p></li><li class="listitem"><p>
          If both the column list and the <code class="literal">VALUES</code> list
          are empty, <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> creates a row
          with each column set to its default value:
        </p><pre data-lang="sql" class="programlisting">
INSERT INTO <em class="replaceable"><code>tbl_name</code></em> () VALUES();
</pre><p>
          If strict mode is not enabled, MySQL uses the implicit default
          value for any column that has no explicitly defined default.
          If strict mode is enabled, an error occurs if any column has
          no default value.
        </p></li><li class="listitem"><p>
          Use the keyword <code class="literal">DEFAULT</code> to set a column
          explicitly to its default value. This makes it easier to write
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statements that assign
          values to all but a few columns, because it enables you to
          avoid writing an incomplete <code class="literal">VALUES</code> list
          that does not include a value for each column in the table.
          Otherwise, you must provide the list of column names
          corresponding to each value in the <code class="literal">VALUES</code>
          list.
        </p></li><li class="listitem"><p>
          If a generated column is inserted into explicitly, the only
          permitted value is <code class="literal">DEFAULT</code>. For information
          about generated columns, see
          <a class="xref" href="sql-syntax.html#create-table-generated-columns" title="13.1.20.9 CREATE TABLE and Generated Columns">Section 13.1.20.9, “CREATE TABLE and Generated Columns”</a>.
        </p><a class="indexterm" name="idm140091666264288"></a></li><li class="listitem"><p>
          In expressions, you can use
          <a class="link" href="functions.html#function_default"><code class="literal">DEFAULT(<em class="replaceable"><code>col_name</code></em>)</code></a>
          to produce the default value for column
          <em class="replaceable"><code>col_name</code></em>.
        </p></li><li class="listitem"><p>
          Type conversion of an expression
          <em class="replaceable"><code>expr</code></em> that provides a column value
          might occur if the expression data type does not match the
          column data type. Conversion of a given value can result in
          different inserted values depending on the column type. For
          example, inserting the string <code class="literal">'1999.0e-2'</code>
          into an <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INT</code></a>,
          <a class="link" href="data-types.html#floating-point-types" title="11.2.3 Floating-Point Types (Approximate Value) - FLOAT, DOUBLE"><code class="literal">FLOAT</code></a>,
          <a class="link" href="data-types.html#fixed-point-types" title="11.2.2 Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">DECIMAL(10,6)</code></a>, or
          <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR</code></a> column inserts the value
          <code class="literal">1999</code>, <code class="literal">19.9921</code>,
          <code class="literal">19.992100</code>, or <code class="literal">1999</code>,
          respectively. The value stored in the
          <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INT</code></a> and
          <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR</code></a> columns is
          <code class="literal">1999</code> because the string-to-number
          conversion looks only at as much of the initial part of the
          string as may be considered a valid integer or year. For the
          <a class="link" href="data-types.html#floating-point-types" title="11.2.3 Floating-Point Types (Approximate Value) - FLOAT, DOUBLE"><code class="literal">FLOAT</code></a> and
          <a class="link" href="data-types.html#fixed-point-types" title="11.2.2 Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">DECIMAL</code></a> columns, the
          string-to-number conversion considers the entire string a
          valid numeric value.
        </p></li><li class="listitem"><p>
          An expression <em class="replaceable"><code>expr</code></em> can refer to any
          column that was set earlier in a value list. For example, you
          can do this because the value for <code class="literal">col2</code>
          refers to <code class="literal">col1</code>, which has previously been
          assigned:
        </p><pre data-lang="sql" class="programlisting">
INSERT INTO <em class="replaceable"><code>tbl_name</code></em> (col1,col2) VALUES(15,col1*2);
</pre><p>
          But the following is not legal, because the value for
          <code class="literal">col1</code> refers to <code class="literal">col2</code>,
          which is assigned after <code class="literal">col1</code>:
        </p><pre data-lang="sql" class="programlisting">
INSERT INTO <em class="replaceable"><code>tbl_name</code></em> (col1,col2) VALUES(col2*2,15);
</pre><p>
          An exception occurs for columns that contain
          <code class="literal">AUTO_INCREMENT</code> values. Because
          <code class="literal">AUTO_INCREMENT</code> values are generated after
          other value assignments, any reference to an
          <code class="literal">AUTO_INCREMENT</code> column in the assignment
          returns a <code class="literal">0</code>.
</p></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statements that use
      <code class="literal">VALUES</code> syntax can insert multiple rows. To do
      this, include multiple lists of comma-separated column values,
      with lists enclosed within parentheses and separated by commas.
      Example:
    </p><pre data-lang="sql" class="programlisting">
INSERT INTO <em class="replaceable"><code>tbl_name</code></em> (a,b,c) VALUES(1,2,3),(4,5,6),(7,8,9);
</pre><p>
      Each values list must contain exactly as many values as are to be
      inserted per row. The following statement is invalid because it
      contains one list of nine values, rather than three lists of three
      values each:
    </p><pre data-lang="sql" class="programlisting">
INSERT INTO <em class="replaceable"><code>tbl_name</code></em> (a,b,c) VALUES(1,2,3,4,5,6,7,8,9);
</pre><p>
      <code class="literal">VALUE</code> is a synonym for
      <code class="literal">VALUES</code> in this context. Neither implies
      anything about the number of values lists, nor about the number of
      values per list. Either may be used whether there is a single
      values list or multiple lists, and regardless of the number of
      values per list.
    </p><p>
      The affected-rows value for an
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> can be obtained using the
      <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> SQL function or the
      <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1 mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> C API
      function. See <a class="xref" href="functions.html#information-functions" title="12.15 Information Functions">Section 12.15, “Information Functions”</a>, and
      <a class="xref" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1 mysql_affected_rows()">Section 28.7.7.1, “mysql_affected_rows()”</a>.
    </p><p>
      If you use an <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT ...
      VALUES</code></a> statement with multiple value lists or
      <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
      SELECT</code></a>, the statement returns an information string in
      this format:
    </p><pre data-lang="none" class="programlisting">
Records: <em class="replaceable"><code>N1</code></em> Duplicates: <em class="replaceable"><code>N2</code></em> Warnings: <em class="replaceable"><code>N3</code></em>
</pre><a class="indexterm" name="idm140091666212880"></a><p>
      If you are using the C API, the information string can be obtained
      by invoking the <a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info()"><code class="literal">mysql_info()</code></a>
      function. See <a class="xref" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info()">Section 28.7.7.36, “mysql_info()”</a>.
    </p><p>
      <code class="literal">Records</code> indicates the number of rows processed
      by the statement. (This is not necessarily the number of rows
      actually inserted because <code class="literal">Duplicates</code> can be
      nonzero.) <code class="literal">Duplicates</code> indicates the number of
      rows that could not be inserted because they would duplicate some
      existing unique index value. <code class="literal">Warnings</code> indicates
      the number of attempts to insert column values that were
      problematic in some way. Warnings can occur under any of the
      following conditions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Inserting <code class="literal">NULL</code> into a column that has been
          declared <code class="literal">NOT NULL</code>. For multiple-row
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statements or
          <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT INTO ...
          SELECT</code></a> statements, the column is set to the implicit
          default value for the column data type. This is
          <code class="literal">0</code> for numeric types, the empty string
          (<code class="literal">''</code>) for string types, and the
          <span class="quote">“<span class="quote">zero</span>”</span> value for date and time types.
          <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT INTO ...
          SELECT</code></a> statements are handled the same way as
          multiple-row inserts because the server does not examine the
          result set from the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> to
          see whether it returns a single row. (For a single-row
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>, no warning occurs when
          <code class="literal">NULL</code> is inserted into a <code class="literal">NOT
          NULL</code> column. Instead, the statement fails with an
          error.)
        </p></li><li class="listitem"><p>
          Setting a numeric column to a value that lies outside the
          column's range. The value is clipped to the closest endpoint
          of the range.
        </p></li><li class="listitem"><p>
          Assigning a value such as <code class="literal">'10.34 a'</code> to a
          numeric column. The trailing nonnumeric text is stripped off
          and the remaining numeric part is inserted. If the string
          value has no leading numeric part, the column is set to
          <code class="literal">0</code>.
        </p></li><li class="listitem"><p>
          Inserting a string into a string column
          (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>, or
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>) that exceeds the column's
          maximum length. The value is truncated to the column's maximum
          length.
        </p></li><li class="listitem"><p>
          Inserting a value into a date or time column that is illegal
          for the data type. The column is set to the appropriate zero
          value for the type.
        </p></li><li class="listitem"><p>
          For <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> examples involving
          <code class="literal">AUTO_INCREMET</code> column values, see
          <a class="xref" href="tutorial.html#example-auto-increment" title="3.6.9 Using AUTO_INCREMENT">Section 3.6.9, “Using AUTO_INCREMENT”</a>.
        </p><a class="indexterm" name="idm140091666179696"></a><a class="indexterm" name="idm140091666178624"></a><p>
          If <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> inserts a row into a
          table that has an <code class="literal">AUTO_INCREMENT</code> column,
          you can find the value used for that column by using the
          <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> SQL function
          or the <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> C API
          function.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            These two functions do not always behave identically. The
            behavior of <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statements
            with respect to <code class="literal">AUTO_INCREMENT</code> columns is
            discussed further in
            <a class="xref" href="functions.html#information-functions" title="12.15 Information Functions">Section 12.15, “Information Functions”</a>, and
            <a class="xref" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id()">Section 28.7.7.38, “mysql_insert_id()”</a>.
</p>
</div>
</li></ul>
</div>
<p>
      The <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statement supports the
      following modifiers:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you use the <code class="literal">LOW_PRIORITY</code> modifier,
          execution of the <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> is
          delayed until no other clients are reading from the table.
          This includes other clients that began reading while existing
          clients are reading, and while the <code class="literal">INSERT
          LOW_PRIORITY</code> statement is waiting. It is possible,
          therefore, for a client that issues an <code class="literal">INSERT
          LOW_PRIORITY</code> statement to wait for a very long time.
        </p><a class="indexterm" name="idm140091666161728"></a><p>
          <code class="literal">LOW_PRIORITY</code> affects only storage engines
          that use only table-level locking (such as
          <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>, and
          <code class="literal">MERGE</code>).
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <code class="literal">LOW_PRIORITY</code> should normally not be used
            with <code class="literal">MyISAM</code> tables because doing so
            disables concurrent inserts. See
            <a class="xref" href="optimization.html#concurrent-inserts" title="8.11.3 Concurrent Inserts">Section 8.11.3, “Concurrent Inserts”</a>.
</p>
</div>
</li><li class="listitem"><p>
          If you specify <code class="literal">HIGH_PRIORITY</code>, it overrides
          the effect of the
          <a class="link" href="server-administration.html#option_mysqld_low-priority-updates"><code class="option">--low-priority-updates</code></a> option
          if the server was started with that option. It also causes
          concurrent inserts not to be used. See
          <a class="xref" href="optimization.html#concurrent-inserts" title="8.11.3 Concurrent Inserts">Section 8.11.3, “Concurrent Inserts”</a>.
        </p><a class="indexterm" name="idm140091666150592"></a><p>
          <code class="literal">HIGH_PRIORITY</code> affects only storage engines
          that use only table-level locking (such as
          <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>, and
          <code class="literal">MERGE</code>).
        </p></li><li class="listitem"><p>
          If you use the <code class="literal">IGNORE</code> modifier, errors that
          occur while executing the
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statement are ignored.
          For example, without <code class="literal">IGNORE</code>, a row that
          duplicates an existing <code class="literal">UNIQUE</code> index or
          <code class="literal">PRIMARY KEY</code> value in the table causes a
          duplicate-key error and the statement is aborted. With
          <code class="literal">IGNORE</code>, the row is discarded and no error
          occurs. Ignored errors generate warnings instead.
        </p><a class="indexterm" name="idm140091666139840"></a><p>
          <a class="indexterm" name="idm140091666138096"></a>

          <code class="literal">IGNORE</code> has a similar effect on inserts into
          partitioned tables where no partition matching a given value
          is found. Without <code class="literal">IGNORE</code>, such
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statements are aborted
          with an error. When
          <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT
          IGNORE</code></a> is used, the insert operation fails silently
          for rows containing the unmatched value, but inserts rows that
          are matched. For an example, see
          <a class="xref" href="partitioning.html#partitioning-list" title="23.2.2 LIST Partitioning">Section 23.2.2, “LIST Partitioning”</a>.
        </p><p>
          Data conversions that would trigger errors abort the statement
          if <code class="literal">IGNORE</code> is not specified. With
          <code class="literal">IGNORE</code>, invalid values are adjusted to the
          closest values and inserted; warnings are produced but the
          statement does not abort. You can determine with the
          <a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info()"><code class="literal">mysql_info()</code></a> C API function
          how many rows were actually inserted into the table.
        </p><p>
          For more information, see
          <a class="xref" href="server-administration.html#ignore-strict-comparison" title="Comparison of the IGNORE Keyword and Strict SQL Mode">Comparison of the IGNORE Keyword and Strict SQL Mode</a>.
        </p></li><li class="listitem"><p>
          If you specify <code class="literal">ON DUPLICATE KEY UPDATE</code>, and
          a row is inserted that would cause a duplicate value in a
          <code class="literal">UNIQUE</code> index or <code class="literal">PRIMARY
          KEY</code>, an <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> of the
          old row occurs. The affected-rows value per row is 1 if the
          row is inserted as a new row, 2 if an existing row is updated,
          and 0 if an existing row is set to its current values. If you
          specify the <code class="literal">CLIENT_FOUND_ROWS</code> flag to the
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> C API
          function when connecting to <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>, the
          affected-rows value is 1 (not 0) if an existing row is set to
          its current values. See <a class="xref" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax">Section 13.2.6.2, “INSERT ... ON DUPLICATE KEY UPDATE Syntax”</a>.
        </p><a class="indexterm" name="idm140091666118368"></a></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.6.3 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> was deprecated
          in MySQL 5.6, and is scheduled for eventual removal. In MySQL
          8.0, the <code class="literal">DELAYED</code> modifier is
          accepted but ignored. Use <code class="literal">INSERT</code> (without
          <code class="literal">DELAYED</code>) instead. See
          <a class="xref" href="sql-syntax.html#insert-delayed" title="13.2.6.3 INSERT DELAYED Syntax">Section 13.2.6.3, “INSERT DELAYED Syntax”</a>.
</p><a class="indexterm" name="idm140091666111904"></a></li></ul>
</div>
<p>
      An <code class="literal">INSERT</code> statement affecting a partitioned
      table using a storage engine such as
      <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that employs table-level locks
      locks only those partitions into which rows are actually inserted.
      (For storage engines such as <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>
      that employ row-level locking, no locking of partitions takes
      place.) For more information, see
      <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/partitioning-limitations-locking.html" target="_top">Partitioning and Locking</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="insert-select"></a>13.2.6.1 INSERT ... SELECT Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091666104320"></a><pre data-lang="sql" class="programlisting">
INSERT [LOW_PRIORITY | HIGH_PRIORITY] [IGNORE]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em> [, <em class="replaceable"><code>partition_name</code></em>] ...)]
    [(<em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...)]
    SELECT ...
    [ON DUPLICATE KEY UPDATE <em class="replaceable"><code>assignment_list</code></em>]

<em class="replaceable"><code>value</code></em>:
    {<em class="replaceable"><code>expr</code></em> | DEFAULT}

<em class="replaceable"><code>assignment</code></em>:
    <em class="replaceable"><code>col_name</code></em> = <em class="replaceable"><code>value</code></em>

<em class="replaceable"><code>assignment_list</code></em>:
    <em class="replaceable"><code>assignment</code></em> [, <em class="replaceable"><code>assignment</code></em>] ...
</pre><p>
        With <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
        SELECT</code></a>, you can quickly insert many rows into a table
        from the result of a <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        statement, which can select from one or many tables. For
        example:
      </p><pre data-lang="sql" class="programlisting">
INSERT INTO tbl_temp2 (fld_id)
  SELECT tbl_temp1.fld_order_id
  FROM tbl_temp1 WHERE tbl_temp1.fld_order_id &gt; 100;
</pre><p>
        The following conditions hold for
        <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
        SELECT</code></a> statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Specify <code class="literal">IGNORE</code> to ignore rows that would
            cause duplicate-key violations.
          </p></li><li class="listitem"><p>
            The target table of the
            <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statement may appear
            in the <code class="literal">FROM</code> clause of the
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part of the query.
            However, you cannot insert into a table and select from the
            same table in a subquery.
          </p><p>
            When selecting from and inserting into the same table, MySQL
            creates an internal temporary table to hold the rows from
            the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> and then inserts
            those rows into the target table. However, you cannot use
            <code class="literal">INSERT INTO t ... SELECT ... FROM t</code> when
            <code class="literal">t</code> is a <code class="literal">TEMPORARY</code>
            table, because <code class="literal">TEMPORARY</code> tables cannot be
            referred to twice in the same statement. See
            <a class="xref" href="optimization.html#internal-temporary-tables" title="8.4.4 Internal Temporary Table Use in MySQL">Section 8.4.4, “Internal Temporary Table Use in MySQL”</a>, and
            <a class="xref" href="error-handling.html#temporary-table-problems" title="B.4.6.2 TEMPORARY Table Problems">Section B.4.6.2, “TEMPORARY Table Problems”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">AUTO_INCREMENT</code> columns work as usual.
          </p></li><li class="listitem"><p>
            To ensure that the binary log can be used to re-create the
            original tables, MySQL does not permit concurrent inserts
            for <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT
            ... SELECT</code></a> statements (see
            <a class="xref" href="optimization.html#concurrent-inserts" title="8.11.3 Concurrent Inserts">Section 8.11.3, “Concurrent Inserts”</a>).
          </p></li><li class="listitem"><p>
            To avoid ambiguous column reference problems when the
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> and the
            <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> refer to the same
            table, provide a unique alias for each table used in the
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part, and qualify
            column names in that part with the appropriate alias.
</p></li></ul>
</div>
<p>
        You can explicitly select which partitions or subpartitions (or
        both) of the source or target table (or both) are to be used
        with a <code class="literal">PARTITION</code> option following the name of
        the table. When <code class="literal">PARTITION</code> is used with the
        name of the source table in the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> portion of the statement,
        rows are selected only from the partitions or subpartitions
        named in its partition list. When <code class="literal">PARTITION</code>
        is used with the name of the target table for the
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> portion of the statement,
        it must be possible to insert all rows selected into the
        partitions or subpartitions named in the partition list
        following the option. Otherwise, the <code class="literal">INSERT ...
        SELECT</code> statement fails. For more information and
        examples, see <a class="xref" href="partitioning.html#partitioning-selection" title="23.5 Partition Selection">Section 23.5, “Partition Selection”</a>.
      </p><p>
        For <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT
        ... SELECT</code></a> statements, see
        <a class="xref" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax">Section 13.2.6.2, “INSERT ... ON DUPLICATE KEY UPDATE Syntax”</a> for conditions under which
        the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> columns can be
        referred to in an <code class="literal">ON DUPLICATE KEY UPDATE</code>
        clause.
      </p><p>
        The order in which a <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        statement with no <code class="literal">ORDER BY</code> clause returns
        rows is nondeterministic. This means that, when using
        replication, there is no guarantee that such a
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> returns rows in the same
        order on the master and the slave, which can lead to
        inconsistencies between them. To prevent this from occurring,
        always write <code class="literal">INSERT ... SELECT</code> statements
        that are to be replicated using an <code class="literal">ORDER BY</code>
        clause that produces the same row order on the master and the
        slave. See also <a class="xref" href="replication.html#replication-features-limit" title="17.4.1.18 Replication and LIMIT">Section 17.4.1.18, “Replication and LIMIT”</a>.
      </p><p>
        Due to this issue,
        <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ...
        SELECT ON DUPLICATE KEY UPDATE</code></a> and
        <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT IGNORE ...
        SELECT</code></a> statements are flagged as unsafe for
        statement-based replication. Such statements produce a warning
        in the error log when using statement-based mode and are written
        to the binary log using the row-based format when using
        <code class="literal">MIXED</code> mode. (Bug #11758262, Bug #50439)
      </p><p>
        See also <a class="xref" href="replication.html#replication-sbr-rbr" title="17.2.1.1 Advantages and Disadvantages of Statement-Based and Row-Based Replication">Section 17.2.1.1, “Advantages and Disadvantages of Statement-Based and Row-Based
        Replication”</a>.
      </p><p>
        An <code class="literal">INSERT ... SELECT</code> statement affecting
        partitioned tables using a storage engine such as
        <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that employs table-level
        locks locks all partitions of the target table; however, only
        those partitions that are actually read from the source table
        are locked. (This does not occur with tables using storage
        engines such as <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that employ
        row-level locking.) For more information, see
        <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/partitioning-limitations-locking.html" target="_top">Partitioning and Locking</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="insert-on-duplicate"></a>13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax</h4>

</div>

</div>

</div>
<p>
        If you specify an <code class="literal">ON DUPLICATE KEY UPDATE</code>
        clause and a row to be inserted would cause a duplicate value in
        a <code class="literal">UNIQUE</code> index or <code class="literal">PRIMARY
        KEY</code>, an <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> of the
        old row occurs. For example, if column <code class="literal">a</code> is
        declared as <code class="literal">UNIQUE</code> and contains the value
        <code class="literal">1</code>, the following two statements have similar
        effect:
      </p><pre data-lang="sql" class="programlisting">
INSERT INTO t1 (a,b,c) VALUES (1,2,3)
  ON DUPLICATE KEY UPDATE c=c+1;

UPDATE t1 SET c=c+1 WHERE a=1;
</pre><p>
        (The effects are not identical for an <code class="literal">InnoDB</code>
        table where <code class="literal">a</code> is an auto-increment column.
        With an auto-increment column, an <code class="literal">INSERT</code>
        statement increases the auto-increment value but
        <code class="literal">UPDATE</code> does not.)
      </p><p>
        If column <code class="literal">b</code> is also unique, the
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> is equivalent to this
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement instead:
      </p><pre data-lang="sql" class="programlisting">
UPDATE t1 SET c=c+1 WHERE a=1 OR b=2 LIMIT 1;
</pre><p>
        If <code class="literal">a=1 OR b=2</code> matches several rows, only
        <span class="emphasis"><em>one</em></span> row is updated. In general, you should
        try to avoid using an <code class="literal">ON DUPLICATE KEY UPDATE</code>
        clause on tables with multiple unique indexes.
      </p><p>
        With <code class="literal">ON DUPLICATE KEY UPDATE</code>, the
        affected-rows value per row is 1 if the row is inserted as a new
        row, 2 if an existing row is updated, and 0 if an existing row
        is set to its current values. If you specify the
        <code class="literal">CLIENT_FOUND_ROWS</code> flag to the
        <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> C API
        function when connecting to <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>, the
        affected-rows value is 1 (not 0) if an existing row is set to
        its current values.
      </p><p>
        If a table contains an <code class="literal">AUTO_INCREMENT</code> column
        and <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT
        ... ON DUPLICATE KEY UPDATE</code></a> inserts or updates a row,
        the <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> function
        returns the <code class="literal">AUTO_INCREMENT</code> value.
      </p><p>
        The <code class="literal">ON DUPLICATE KEY UPDATE</code> clause can
        contain multiple column assignments, separated by commas.
      </p><p>
        In assignment value expressions in the <code class="literal">ON DUPLICATE KEY
        UPDATE</code> clause, you can use the
        <a class="link" href="functions.html#function_values"><code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code></a>
        function to refer to column values from the
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> portion of the
        <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ...
        ON DUPLICATE KEY UPDATE</code></a> statement. In other words,
        <a class="link" href="functions.html#function_values"><code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code></a>
        in the <code class="literal">ON DUPLICATE KEY UPDATE</code> clause refers
        to the value of <em class="replaceable"><code>col_name</code></em> that would
        be inserted, had no duplicate-key conflict occurred. This
        function is especially useful in multiple-row inserts. The
        <a class="link" href="functions.html#function_values"><code class="literal">VALUES()</code></a> function is meaningful
        only in the <code class="literal">ON DUPLICATE KEY UPDATE</code> clause or
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statements and returns
        <code class="literal">NULL</code> otherwise. Example:
      </p><pre data-lang="sql" class="programlisting">
INSERT INTO t1 (a,b,c) VALUES (1,2,3),(4,5,6)
  ON DUPLICATE KEY UPDATE c=VALUES(a)+VALUES(b);
</pre><p>
        That statement is identical to the following two statements:
      </p><pre data-lang="sql" class="programlisting">
INSERT INTO t1 (a,b,c) VALUES (1,2,3)
  ON DUPLICATE KEY UPDATE c=3;
INSERT INTO t1 (a,b,c) VALUES (4,5,6)
  ON DUPLICATE KEY UPDATE c=9;
</pre><p>
        For <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT
        ... SELECT</code></a> statements, these rules apply regarding
        acceptable forms of <code class="literal">SELECT</code> query expressions
        that you can refer to in an <code class="literal">ON DUPLICATE KEY
        UPDATE</code> clause:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            References to columns from queries on a single table, which
            may be a derived table.
          </p></li><li class="listitem"><p>
            References to columns from queries on a join over multiple
            tables.
          </p></li><li class="listitem"><p>
            References to columns from <code class="literal">DISTINCT</code>
            queries.
          </p></li><li class="listitem"><p>
            References to columns in other tables, as long as the
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> does not use
            <code class="literal">GROUP BY</code>. One side effect is that you
            must qualify references to nonunique column names.
</p></li></ul>
</div>
<p>
        References to columns from a
        <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> are not supported. To work
        around this restriction, rewrite the
        <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> as a derived table so that
        its rows can be treated as a single-table result set. For
        example, this statement produces an error:
      </p><pre data-lang="sql" class="programlisting">
INSERT INTO t1 (a, b)
  SELECT c, d FROM t2
  UNION
  SELECT e, f FROM t3
ON DUPLICATE KEY UPDATE b = b + c;
</pre><p>
        Instead, use an equivalent statement that rewrites the
        <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> as a derived table:
      </p><pre data-lang="sql" class="programlisting">
INSERT INTO t1 (a, b)
SELECT * FROM
  (SELECT c, d FROM t2
   UNION
   SELECT e, f FROM t3) AS dt
ON DUPLICATE KEY UPDATE b = b + c;
</pre><p>
        The technique of rewriting a query as a derived table also
        enables references to columns from <code class="literal">GROUP BY</code>
        queries.
      </p><p>
        Because the results of
        <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
        SELECT</code></a> statements depend on the ordering of rows from
        the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> and this order cannot
        always be guaranteed, it is possible when logging
        <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ...
        SELECT ON DUPLICATE KEY UPDATE</code></a> statements for the
        master and the slave to diverge. Thus,
        <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ...
        SELECT ON DUPLICATE KEY UPDATE</code></a> statements are flagged
        as unsafe for statement-based replication. Such statements
        produce a warning in the error log when using statement-based
        mode and are written to the binary log using the row-based
        format when using <code class="literal">MIXED</code> mode. An
        <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ...
        ON DUPLICATE KEY UPDATE</code></a> statement against a table
        having more than one unique or primary key is also marked as
        unsafe. (Bug #11765650, Bug #58637)
      </p><p>
        See also <a class="xref" href="replication.html#replication-sbr-rbr" title="17.2.1.1 Advantages and Disadvantages of Statement-Based and Row-Based Replication">Section 17.2.1.1, “Advantages and Disadvantages of Statement-Based and Row-Based
        Replication”</a>.
      </p><p>
        An <code class="literal">INSERT ... ON DUPLICATE KEY UPDATE</code> on a
        partitioned table using a storage engine such as
        <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that employs table-level
        locks locks any partitions of the table in which a partitioning
        key column is updated. (This does not occur with tables using
        storage engines such as <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that
        employ row-level locking.) For more information, see
        <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/partitioning-limitations-locking.html" target="_top">Partitioning and Locking</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="insert-delayed"></a>13.2.6.3 INSERT DELAYED Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091665960880"></a><a class="indexterm" name="idm140091665959808"></a><a class="indexterm" name="idm140091665958736"></a><pre data-lang="sql" class="programlisting">
INSERT DELAYED ...
</pre><p>
        The <code class="literal">DELAYED</code> option for the
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statement is a MySQL
        extension to standard SQL. In previous versions of MySQL, it can
        be used for certain kinds of tables (such as
        <code class="literal">MyISAM</code>), such that when a client uses
        <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.6.3 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a>, it gets an okay
        from the server at once, and the row is queued to be inserted
        when the table is not in use by any other thread.
      </p><p>
        <code class="literal">DELAYED</code> inserts and replaces were deprecated
        in MySQL 5.6. In MySQL 8.0,
        <code class="literal">DELAYED</code> is not supported. The server
        recognizes but ignores the <code class="literal">DELAYED</code> keyword,
        handles the insert as a nondelayed insert, and generates an
        <code class="literal">ER_WARN_LEGACY_SYNTAX_CONVERTED</code> warning
        (<span class="quote">“<span class="quote">INSERT DELAYED is no longer supported. The statement was
        converted to INSERT</span>”</span>). The <code class="literal">DELAYED</code>
        keyword is scheduled for removal in a future release.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="load-data"></a>13.2.7 LOAD DATA Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091665942896"></a><a class="indexterm" name="idm140091665941824"></a><pre data-lang="sql" class="programlisting">
LOAD DATA
    [LOW_PRIORITY | CONCURRENT] [LOCAL]
    INFILE '<em class="replaceable"><code>file_name</code></em>'
    [REPLACE | IGNORE]
    INTO TABLE <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em> [, <em class="replaceable"><code>partition_name</code></em>] ...)]
    [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>]
    [{FIELDS | COLUMNS}
        [TERMINATED BY '<em class="replaceable"><code>string</code></em>']
        [[OPTIONALLY] ENCLOSED BY '<em class="replaceable"><code>char</code></em>']
        [ESCAPED BY '<em class="replaceable"><code>char</code></em>']
    ]
    [LINES
        [STARTING BY '<em class="replaceable"><code>string</code></em>']
        [TERMINATED BY '<em class="replaceable"><code>string</code></em>']
    ]
    [IGNORE <em class="replaceable"><code>number</code></em> {LINES | ROWS}]
    [(<em class="replaceable"><code>col_name_or_user_var</code></em>
        [, <em class="replaceable"><code>col_name_or_user_var</code></em>] ...)]
    [SET <em class="replaceable"><code>col_name</code></em>={<em class="replaceable"><code>expr</code></em> | DEFAULT},
        [, <em class="replaceable"><code>col_name</code></em>={<em class="replaceable"><code>expr</code></em> | DEFAULT}] ...]
</pre><p>
      The <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> statement reads rows
      from a text file into a table at a very high speed.
      <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> is the complement of
      <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
      OUTFILE</code></a>. (See <a class="xref" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax">Section 13.2.10.1, “SELECT ... INTO Syntax”</a>.) To write
      data from a table to a file, use
      <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
      OUTFILE</code></a>. To read the file back into a table, use
      <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>. The syntax of the
      <code class="literal">FIELDS</code> and <code class="literal">LINES</code> clauses is
      the same for both statements.
    </p><a class="indexterm" name="idm140091665919984"></a><p>
      You can also load data files by using the
      <a class="link" href="programs.html#mysqlimport" title="4.5.5 mysqlimport — A Data Import Program"><span class="command"><strong>mysqlimport</strong></span></a> utility; see
      <a class="xref" href="programs.html#mysqlimport" title="4.5.5 mysqlimport — A Data Import Program">Section 4.5.5, “<span class="command"><strong>mysqlimport</strong></span> — A Data Import Program”</a>. <a class="link" href="programs.html#mysqlimport" title="4.5.5 mysqlimport — A Data Import Program"><span class="command"><strong>mysqlimport</strong></span></a>
      operates by sending a <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>
      statement to the server.
    </p><p>
      For more information about the efficiency of
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> versus
      <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> and speeding up
      <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>, see
      <a class="xref" href="optimization.html#insert-optimization" title="8.2.5.1 Optimizing INSERT Statements">Section 8.2.5.1, “Optimizing INSERT Statements”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#load-data-partitioning-support" title="Partitioned Table Support">Partitioned Table Support</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#load-data-input-file" title="Input File Name, Location, and Content Interpretation">Input File Name, Location, and Content Interpretation</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#load-data-concurrency" title="Concurrency Considerations">Concurrency Considerations</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#load-data-duplicate-key-handling" title="Duplicate-Key Handling">Duplicate-Key Handling</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#load-data-index-handling" title="Index Handling">Index Handling</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#load-data-field-line-handling" title="Field and Line Handling">Field and Line Handling</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#load-data-column-list" title="Column List Specification">Column List Specification</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#load-data-input-preprocessing" title="Input Preprocessing">Input Preprocessing</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#load-data-statement-result-information" title="Statement Result Information">Statement Result Information</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#load-data-miscellaneous" title="Miscellaneous Topics">Miscellaneous Topics</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="load-data-partitioning-support"></a>Partitioned Table Support</h4>

</div>

</div>

</div>
<p>
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> supports explicit
        partition selection using the <code class="literal">PARTITION</code>
        option with a list of one or more comma-separated names of
        partitions, subpartitions, or both. When this option is used, if
        any rows from the file cannot be inserted into any of the
        partitions or subpartitions named in the list, the statement
        fails with the error <span class="errortext">Found a row not matching the
        given partition set</span>. For more information and
        examples, see <a class="xref" href="partitioning.html#partitioning-selection" title="23.5 Partition Selection">Section 23.5, “Partition Selection”</a>.
      </p><p>
        For partitioned tables using storage engines that employ table
        locks, such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>,
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> cannot prune any
        partition locks. This does not apply to tables using storage
        engines that employ row-level locking, such as
        <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>. For more information, see
        <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/partitioning-limitations-locking.html" target="_top">Partitioning and Locking</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="load-data-input-file"></a>Input File Name, Location, and Content Interpretation</h4>

</div>

</div>

</div>
<p>
        The file name must be given as a literal string. On Windows,
        specify backslashes in path names as forward slashes or doubled
        backslashes. The
        <a class="link" href="server-administration.html#sysvar_character_set_filesystem"><code class="literal">character_set_filesystem</code></a> system
        variable controls the interpretation of the file name character
        set.
      </p><p>
        The server uses the character set indicated by the
        <a class="link" href="server-administration.html#sysvar_character_set_database"><code class="literal">character_set_database</code></a> system
        variable to interpret the information in the file.
        <a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES Syntax"><code class="literal">SET NAMES</code></a> and the setting of
        <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> do not
        affect interpretation of input. If the contents of the input
        file use a character set that differs from the default, it is
        usually preferable to specify the character set of the file by
        using the <code class="literal">CHARACTER SET</code> clause. A character
        set of <code class="literal">binary</code> specifies <span class="quote">“<span class="quote">no
        conversion.</span>”</span>
      </p><p>
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> interprets all fields
        in the file as having the same character set, regardless of the
        data types of the columns into which field values are loaded.
        For proper interpretation of file contents, you must ensure that
        it was written with the correct character set. For example, if
        you write a data file with <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump -T</strong></span></a> or by
        issuing a <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT
        ... INTO OUTFILE</code></a> statement in
        <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a>, be sure to use a
        <code class="option">--default-character-set</code> option so that output
        is written in the character set to be used when the file is
        loaded with <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          It is not possible to load data files that use the
          <code class="literal">ucs2</code>, <code class="literal">utf16</code>,
          <code class="literal">utf16le</code>, or <code class="literal">utf32</code>
          character set.
</p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="load-data-concurrency"></a>Concurrency Considerations</h4>

</div>

</div>

</div>
<p>
        If you use the <code class="literal">LOW_PRIORITY</code> modifier,
        execution of the <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>
        statement is delayed until no other clients are reading from the
        table. This affects only storage engines that use only
        table-level locking (such as <code class="literal">MyISAM</code>,
        <code class="literal">MEMORY</code>, and <code class="literal">MERGE</code>).
      </p><p>
        If you specify the <code class="literal">CONCURRENT</code> modifier with a
        <code class="literal">MyISAM</code> table that satisfies the condition for
        concurrent inserts (that is, it contains no free blocks in the
        middle), other threads can retrieve data from the table while
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> is executing. This
        modifier affects the performance of <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
        DATA</code></a> a bit, even if no other thread is using the table
        at the same time.
      </p><p>
        For information about <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>
        in relation to replication, see
        <a class="xref" href="replication.html#replication-features-load-data" title="17.4.1.19 Replication and LOAD DATA">Section 17.4.1.19, “Replication and LOAD DATA”</a>.
      </p><p>
        The <code class="literal">LOCAL</code> modifier affects expected location
        of the file and error handling, as described later.
        <code class="literal">LOCAL</code> works only if your server and your
        client both have been configured to permit it. For example, if
        <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> was started with the
        <a class="link" href="server-administration.html#sysvar_local_infile"><code class="literal">local_infile</code></a> system variable
        disabled, <code class="literal">LOCAL</code> does not work. See
        <a class="xref" href="security.html#load-data-local" title="6.1.6 Security Issues with LOAD DATA LOCAL">Section 6.1.6, “Security Issues with LOAD DATA LOCAL”</a>.
      </p><p>
        The <code class="literal">LOCAL</code> modifier affects where the file is
        expected to be found:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If <code class="literal">LOCAL</code> is specified, the file is read
            by the client program on the client host and sent to the
            server. The file can be given as a full path name to specify
            its exact location. If given as a relative path name, the
            name is interpreted relative to the directory in which the
            client program was started.
          </p><p>
            When using <code class="literal">LOCAL</code> with
            <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>, a copy of the file
            is created in the directory where the MySQL server stores
            temporary files. See <a class="xref" href="error-handling.html#temporary-files" title="B.4.3.5 Where MySQL Stores Temporary Files">Section B.4.3.5, “Where MySQL Stores Temporary Files”</a>. Lack
            of sufficient space for the copy in this directory can cause
            the <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA
            LOCAL</code></a> statement to fail.
          </p></li><li class="listitem"><p>
            If <code class="literal">LOCAL</code> is not specified, the file must
            be located on the server host and is read directly by the
            server. The server uses the following rules to locate the
            file:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                If the file name is an absolute path name, the server
                uses it as given.
              </p></li><li class="listitem"><p>
                If the file name is a relative path name with one or
                more leading components, the server searches for the
                file relative to the server's data directory.
              </p></li><li class="listitem"><p>
                If a file name with no leading components is given, the
                server looks for the file in the database directory of
                the default database.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
        In the non-<code class="literal">LOCAL</code> case, these rules mean that
        a file named as <code class="filename">./myfile.txt</code> is read from
        the server's data directory, whereas the file named as
        <code class="filename">myfile.txt</code> is read from the database
        directory of the default database. For example, if
        <code class="literal">db1</code> is the default database, the following
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> statement reads the
        file <code class="filename">data.txt</code> from the database directory
        for <code class="literal">db1</code>, even though the statement explicitly
        loads the file into a table in the <code class="literal">db2</code>
        database:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE 'data.txt' INTO TABLE db2.my_table;
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          The server also uses the non-<code class="literal">LOCAL</code> rules to
          locate <code class="filename">.sdi</code> files for the
          <a class="link" href="sql-syntax.html#import-table" title="13.2.5 IMPORT TABLE Syntax"><code class="literal">IMPORT TABLE</code></a> statement.
</p>
</div>
<p>
        Non-<code class="literal">LOCAL</code> load operations read text files
        located on the server. For security reasons, such operations
        require that you have the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a>
        privilege. See <a class="xref" href="security.html#privileges-provided" title="6.2.2 Privileges Provided by MySQL">Section 6.2.2, “Privileges Provided by MySQL”</a>. Also,
        non-<code class="literal">LOCAL</code> load operations are subject to the
        <a class="link" href="server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a> system
        variable setting. If the variable value is a nonempty directory
        name, the file to be loaded must be located in that directory.
        If the variable value is empty (which is insecure), the file
        need only be readable by the server.
      </p><p>
        Using <code class="literal">LOCAL</code> is a bit slower than letting the
        server access the files directly, because the file contents must
        be sent over the connection by the client to the server. On the
        other hand, you do not need the
        <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege to load local
        files.
      </p><p>
        <code class="literal">LOCAL</code> also affects error handling:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            With <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>,
            data-interpretation and duplicate-key errors terminate the
            operation.
          </p></li><li class="listitem"><p>
            With <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA
            LOCAL</code></a>, data-interpretation and duplicate-key
            errors become warnings and the operation continues because
            the server has no way to stop transmission of the file in
            the middle of the operation. For duplicate-key errors, this
            is the same as if <code class="literal">IGNORE</code> is specified.
            <code class="literal">IGNORE</code> is explained further later in this
            section.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="load-data-duplicate-key-handling"></a>Duplicate-Key Handling</h4>

</div>

</div>

</div>
<p>
        The <code class="literal">REPLACE</code> and <code class="literal">IGNORE</code>
        modifiers control handling of input rows that duplicate existing
        rows on unique key values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If you specify <code class="literal">REPLACE</code>, input rows
            replace existing rows. In other words, rows that have the
            same value for a primary key or unique index as an existing
            row. See <a class="xref" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax">Section 13.2.9, “REPLACE Syntax”</a>.
          </p></li><li class="listitem"><p>
            If you specify <code class="literal">IGNORE</code>, rows that
            duplicate an existing row on a unique key value are
            discarded. For more information, see
            <a class="xref" href="server-administration.html#ignore-strict-comparison" title="Comparison of the IGNORE Keyword and Strict SQL Mode">Comparison of the IGNORE Keyword and Strict SQL Mode</a>.
          </p><a class="indexterm" name="idm140091665799600"></a></li><li class="listitem"><p>
            If you do not specify either modifier, the behavior depends
            on whether the <code class="literal">LOCAL</code> modifier is
            specified. Without <code class="literal">LOCAL</code>, an error occurs
            when a duplicate key value is found, and the rest of the
            text file is ignored. With <code class="literal">LOCAL</code>, the
            default behavior is the same as if <code class="literal">IGNORE</code>
            is specified; this is because the server has no way to stop
            transmission of the file in the middle of the operation.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="load-data-index-handling"></a>Index Handling</h4>

</div>

</div>

</div>
<p>
        To ignore foreign key constraints during the load operation,
        execute a <code class="literal">SET foreign_key_checks = 0</code>
        statement before executing <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
        DATA</code></a>.
      </p><p>
        If you use <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> on an empty
        <code class="literal">MyISAM</code> table, all nonunique indexes are
        created in a separate batch (as for <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
        TABLE</code></a>). Normally, this makes <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
        DATA</code></a> much faster when you have many indexes. In some
        extreme cases, you can create the indexes even faster by turning
        them off with <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE ... DISABLE KEYS</code></a> before loading the file into
        the table and using
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
        ENABLE KEYS</code></a> to re-create the indexes after loading the
        file. See <a class="xref" href="optimization.html#insert-optimization" title="8.2.5.1 Optimizing INSERT Statements">Section 8.2.5.1, “Optimizing INSERT Statements”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="load-data-field-line-handling"></a>Field and Line Handling</h4>

</div>

</div>

</div>
<p>
        For both the <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> and
        <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE</code></a> statements, the syntax of the
        <code class="literal">FIELDS</code> and <code class="literal">LINES</code> clauses
        is the same. Both clauses are optional, but
        <code class="literal">FIELDS</code> must precede <code class="literal">LINES</code>
        if both are specified.
      </p><p>
        If you specify a <code class="literal">FIELDS</code> clause, each of its
        subclauses (<code class="literal">TERMINATED BY</code>,
        <code class="literal">[OPTIONALLY] ENCLOSED BY</code>, and
        <code class="literal">ESCAPED BY</code>) is also optional, except that you
        must specify at least one of them. Arguments to these clauses
        are permitted to contain only ASCII characters.
      </p><p>
        If you specify no <code class="literal">FIELDS</code> or
        <code class="literal">LINES</code> clause, the defaults are the same as if
        you had written this:
      </p><pre data-lang="sql" class="programlisting">
FIELDS TERMINATED BY '\t' ENCLOSED BY '' ESCAPED BY '\\'
LINES TERMINATED BY '\n' STARTING BY ''
</pre><p>
        Backslash is the MySQL escape character within strings in SQL
        statements. Thus, to specify a literal backslash, you must
        specify two backslashes for the value to be interpreted as a
        single backslash. The escape sequences <code class="literal">'\t'</code>
        and <code class="literal">'\n'</code> specify tab and newline characters,
        respectively.
      </p><p>
        In other words, the defaults cause <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
        DATA</code></a> to act as follows when reading input:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Look for line boundaries at newlines.
          </p></li><li class="listitem"><p>
            Do not skip any line prefix.
          </p></li><li class="listitem"><p>
            Break lines into fields at tabs.
          </p></li><li class="listitem"><p>
            Do not expect fields to be enclosed within any quoting
            characters.
          </p></li><li class="listitem"><p>
            Interpret characters preceded by the escape character
            <code class="literal">\</code> as escape sequences. For example,
            <code class="literal">\t</code>, <code class="literal">\n</code>, and
            <code class="literal">\\</code> signify tab, newline, and backslash,
            respectively. See the discussion of <code class="literal">FIELDS ESCAPED
            BY</code> later for the full list of escape sequences.
</p></li></ul>
</div>
<p>
        Conversely, the defaults cause
        <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE</code></a> to act as follows when writing output:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Write tabs between fields.
          </p></li><li class="listitem"><p>
            Do not enclose fields within any quoting characters.
          </p></li><li class="listitem"><p>
            Use <code class="literal">\</code> to escape instances of tab,
            newline, or <code class="literal">\</code> that occur within field
            values.
          </p></li><li class="listitem"><p>
            Write newlines at the ends of lines.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          For a text file generated on a Windows system, proper file
          reading might require <code class="literal">LINES TERMINATED BY
          '\r\n'</code> because Windows programs typically use two
          characters as a line terminator. Some programs, such as
          <span class="command"><strong>WordPad</strong></span>, might use <code class="literal">\r</code> as
          a line terminator when writing files. To read such files, use
          <code class="literal">LINES TERMINATED BY '\r'</code>.
</p>
</div>
<p>
        If all the input lines have a common prefix that you want to
        ignore, you can use <code class="literal">LINES STARTING BY
        '<em class="replaceable"><code>prefix_string</code></em>'</code> to skip the
        prefix <span class="emphasis"><em>and anything before it</em></span>. If a line
        does not include the prefix, the entire line is skipped. Suppose
        that you issue the following statement:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE '/tmp/test.txt' INTO TABLE test
  FIELDS TERMINATED BY ','  LINES STARTING BY 'xxx';
</pre><p>
        If the data file looks like this:
      </p><pre data-lang="none" class="programlisting">
xxx"abc",1
something xxx"def",2
"ghi",3
</pre><p>
        The resulting rows will be <code class="literal">("abc",1)</code> and
        <code class="literal">("def",2)</code>. The third row in the file is
        skipped because it does not contain the prefix.
      </p><p>
        The <code class="literal">IGNORE <em class="replaceable"><code>number</code></em>
        LINES</code> option can be used to ignore lines at the start
        of the file. For example, you can use <code class="literal">IGNORE 1
        LINES</code> to skip an initial header line containing column
        names:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE '/tmp/test.txt' INTO TABLE test IGNORE 1 LINES;
</pre><p>
        When you use <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT
        ... INTO OUTFILE</code></a> in tandem with
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> to write data from a
        database into a file and then read the file back into the
        database later, the field- and line-handling options for both
        statements must match. Otherwise, <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
        DATA</code></a> will not interpret the contents of the file
        properly. Suppose that you use
        <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE</code></a> to write a file with fields delimited by
        commas:
      </p><pre data-lang="sql" class="programlisting">
SELECT * INTO OUTFILE 'data.txt'
  FIELDS TERMINATED BY ','
  FROM table2;
</pre><p>
        To read the comma-delimited file, the correct statement would
        be:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE 'data.txt' INTO TABLE table2
  FIELDS TERMINATED BY ',';
</pre><p>
        If instead you tried to read the file with the statement shown
        following, it wouldn't work because it instructs
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> to look for tabs
        between fields:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE 'data.txt' INTO TABLE table2
  FIELDS TERMINATED BY '\t';
</pre><p>
        The likely result is that each input line would be interpreted
        as a single field.
      </p><a class="indexterm" name="idm140091665723760"></a><a class="indexterm" name="idm140091665722688"></a><p>
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> can be used to read
        files obtained from external sources. For example, many programs
        can export data in comma-separated values (CSV) format, such
        that lines have fields separated by commas and enclosed within
        double quotation marks, with an initial line of column names. If
        the lines in such a file are terminated by carriage
        return/newline pairs, the statement shown here illustrates the
        field- and line-handling options you would use to load the file:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE 'data.txt' INTO TABLE <em class="replaceable"><code>tbl_name</code></em>
  FIELDS TERMINATED BY ',' ENCLOSED BY '"'
  LINES TERMINATED BY '\r\n'
  IGNORE 1 LINES;
</pre><p>
        If the input values are not necessarily enclosed within
        quotation marks, use <code class="literal">OPTIONALLY</code> before the
        <code class="literal">ENCLOSED BY</code> option.
      </p><p>
        Any of the field- or line-handling options can specify an empty
        string (<code class="literal">''</code>). If not empty, the
        <code class="literal">FIELDS [OPTIONALLY] ENCLOSED BY</code> and
        <code class="literal">FIELDS ESCAPED BY</code> values must be a single
        character. The <code class="literal">FIELDS TERMINATED BY</code>,
        <code class="literal">LINES STARTING BY</code>, and <code class="literal">LINES
        TERMINATED BY</code> values can be more than one character.
        For example, to write lines that are terminated by carriage
        return/linefeed pairs, or to read a file containing such lines,
        specify a <code class="literal">LINES TERMINATED BY '\r\n'</code> clause.
      </p><p>
        To read a file containing jokes that are separated by lines
        consisting of <code class="literal">%%</code>, you can do this
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE jokes
  (a INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  joke TEXT NOT NULL);
LOAD DATA INFILE '/tmp/jokes.txt' INTO TABLE jokes
  FIELDS TERMINATED BY ''
  LINES TERMINATED BY '\n%%\n' (joke);
</pre><p>
        <code class="literal">FIELDS [OPTIONALLY] ENCLOSED BY</code> controls
        quoting of fields. For output
        (<a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE</code></a>), if you omit the word
        <code class="literal">OPTIONALLY</code>, all fields are enclosed by the
        <code class="literal">ENCLOSED BY</code> character. An example of such
        output (using a comma as the field delimiter) is shown here:
      </p><pre data-lang="none" class="programlisting">
"1","a string","100.20"
"2","a string containing a , comma","102.20"
"3","a string containing a \" quote","102.20"
"4","a string containing a \", quote and comma","102.20"
</pre><p>
        If you specify <code class="literal">OPTIONALLY</code>, the
        <code class="literal">ENCLOSED BY</code> character is used only to enclose
        values from columns that have a string data type (such as
        <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
        <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
        <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>, or
        <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a>):
      </p><pre data-lang="none" class="programlisting">
1,"a string",100.20
2,"a string containing a , comma",102.20
3,"a string containing a \" quote",102.20
4,"a string containing a \", quote and comma",102.20
</pre><p>
        Occurrences of the <code class="literal">ENCLOSED BY</code> character
        within a field value are escaped by prefixing them with the
        <code class="literal">ESCAPED BY</code> character. Also, if you specify an
        empty <code class="literal">ESCAPED BY</code> value, it is possible to
        inadvertently generate output that cannot be read properly by
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>. For example, the
        preceding output just shown would appear as follows if the
        escape character is empty. Observe that the second field in the
        fourth line contains a comma following the quote, which
        (erroneously) appears to terminate the field:
      </p><pre data-lang="none" class="programlisting">
1,"a string",100.20
2,"a string containing a , comma",102.20
3,"a string containing a " quote",102.20
4,"a string containing a ", quote and comma",102.20
</pre><p>
        For input, the <code class="literal">ENCLOSED BY</code> character, if
        present, is stripped from the ends of field values. (This is
        true regardless of whether <code class="literal">OPTIONALLY</code> is
        specified; <code class="literal">OPTIONALLY</code> has no effect on input
        interpretation.) Occurrences of the <code class="literal">ENCLOSED
        BY</code> character preceded by the <code class="literal">ESCAPED
        BY</code> character are interpreted as part of the current
        field value.
      </p><p>
        If the field begins with the <code class="literal">ENCLOSED BY</code>
        character, instances of that character are recognized as
        terminating a field value only if followed by the field or line
        <code class="literal">TERMINATED BY</code> sequence. To avoid ambiguity,
        occurrences of the <code class="literal">ENCLOSED BY</code> character
        within a field value can be doubled and are interpreted as a
        single instance of the character. For example, if
        <code class="literal">ENCLOSED BY '"'</code> is specified, quotation marks
        are handled as shown here:
      </p><pre data-lang="none" class="programlisting">
"The ""BIG"" boss"  -&gt; The "BIG" boss
The "BIG" boss      -&gt; The "BIG" boss
The ""BIG"" boss    -&gt; The ""BIG"" boss
</pre><p>
        <code class="literal">FIELDS ESCAPED BY</code> controls how to read or
        write special characters:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For input, if the <code class="literal">FIELDS ESCAPED BY</code>
            character is not empty, occurrences of that character are
            stripped and the following character is taken literally as
            part of a field value. Some two-character sequences that are
            exceptions, where the first character is the escape
            character. These sequences are shown in the following table
            (using <code class="literal">\</code> for the escape character). The
            rules for <code class="literal">NULL</code> handling are described
            later in this section.
</p>
<div class="informaltable">
<table summary="Two-character sequences for which the first character (a \) is the escape character."><col width="15%"><col width="85%"><thead><tr>
                <th scope="col">Character</th>
                <th scope="col">Escape Sequence</th>
              </tr></thead><tbody><tr>
                <td scope="row"><code class="literal">\0</code><a class="indexterm" name="idm140091665668752"></a><a class="indexterm" name="idm140091665667808"></a></td>
                <td>An ASCII NUL (<code class="literal">X'00'</code>) character</td>
              </tr><tr>
                <td scope="row"><code class="literal">\b</code><a class="indexterm" name="idm140091665663392"></a><a class="indexterm" name="idm140091665662448"></a></td>
                <td>A backspace character</td>
              </tr><tr>
                <td scope="row"><code class="literal">\n</code><a class="indexterm" name="idm140091665658720"></a><a class="indexterm" name="idm140091665657776"></a><a class="indexterm" name="idm140091665656832"></a><a class="indexterm" name="idm140091665655888"></a></td>
                <td>A newline (linefeed) character</td>
              </tr><tr>
                <td scope="row"><code class="literal">\r</code><a class="indexterm" name="idm140091665652144"></a><a class="indexterm" name="idm140091665651200"></a><a class="indexterm" name="idm140091665650256"></a></td>
                <td>A carriage return character</td>
              </tr><tr>
                <td scope="row"><code class="literal">\t</code><a class="indexterm" name="idm140091665646512"></a><a class="indexterm" name="idm140091665645568"></a></td>
                <td>A tab character.</td>
              </tr><tr>
                <td scope="row"><code class="literal">\Z</code><a class="indexterm" name="idm140091665641840"></a><a class="indexterm" name="idm140091665640896"></a></td>
                <td>ASCII 26 (Control+Z)</td>
              </tr><tr>
                <td scope="row"><code class="literal">\N</code><a class="indexterm" name="idm140091665637168"></a></td>
                <td>NULL</td>
</tr></tbody></table>
</div>
<p>
            For more information about <code class="literal">\</code>-escape
            syntax, see <a class="xref" href="language-structure.html#string-literals" title="9.1.1 String Literals">Section 9.1.1, “String Literals”</a>.
          </p><p>
            If the <code class="literal">FIELDS ESCAPED BY</code> character is
            empty, escape-sequence interpretation does not occur.
          </p></li><li class="listitem"><p>
            For output, if the <code class="literal">FIELDS ESCAPED BY</code>
            character is not empty, it is used to prefix the following
            characters on output:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                The <code class="literal">FIELDS ESCAPED BY</code> character.
              </p></li><li class="listitem"><p>
                The <code class="literal">FIELDS [OPTIONALLY] ENCLOSED BY</code>
                character.
              </p></li><li class="listitem"><p>
                The first character of the <code class="literal">FIELDS TERMINATED
                BY</code> and <code class="literal">LINES TERMINATED BY</code>
                values, if the <code class="literal">ENCLOSED BY</code> character
                is empty or unspecified.
              </p></li><li class="listitem"><p>
                ASCII <code class="literal">0</code> (what is actually written
                following the escape character is ASCII
                <code class="literal">0</code>, not a zero-valued byte).
</p></li></ul>
</div>
<p>
            If the <code class="literal">FIELDS ESCAPED BY</code> character is
            empty, no characters are escaped and <code class="literal">NULL</code>
            is output as <code class="literal">NULL</code>, not
            <code class="literal">\N</code>. It is probably not a good idea to
            specify an empty escape character, particularly if field
            values in your data contain any of the characters in the
            list just given.
</p></li></ul>
</div>
<p>
        In certain cases, field- and line-handling options interact:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If <code class="literal">LINES TERMINATED BY</code> is an empty string
            and <code class="literal">FIELDS TERMINATED BY</code> is nonempty,
            lines are also terminated with <code class="literal">FIELDS TERMINATED
            BY</code>.
          </p></li><li class="listitem"><p>
            If the <code class="literal">FIELDS TERMINATED BY</code> and
            <code class="literal">FIELDS ENCLOSED BY</code> values are both empty
            (<code class="literal">''</code>), a fixed-row (nondelimited) format
            is used. With fixed-row format, no delimiters are used
            between fields (but you can still have a line terminator).
            Instead, column values are read and written using a field
            width wide enough to hold all values in the field. For
            <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">TINYINT</code></a>,
            <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">SMALLINT</code></a>,
            <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">MEDIUMINT</code></a>,
            <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INT</code></a>, and
            <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">BIGINT</code></a>, the field widths are
            4, 6, 8, 11, and 20, respectively, no matter what the
            declared display width is.
          </p><p>
            <code class="literal">LINES TERMINATED BY</code> is still used to
            separate lines. If a line does not contain all fields, the
            rest of the columns are set to their default values. If you
            do not have a line terminator, you should set this to
            <code class="literal">''</code>. In this case, the text file must
            contain all fields for each row.
          </p><p>
            Fixed-row format also affects handling of
            <code class="literal">NULL</code> values, as described later.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Fixed-size format does not work if you are using a
              multibyte character set.
</p>
</div>
</li></ul>
</div>
<p>
        Handling of <code class="literal">NULL</code> values varies according to
        the <code class="literal">FIELDS</code> and <code class="literal">LINES</code>
        options in use:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For the default <code class="literal">FIELDS</code> and
            <code class="literal">LINES</code> values, <code class="literal">NULL</code> is
            written as a field value of <code class="literal">\N</code> for
            output, and a field value of <code class="literal">\N</code> is read
            as <code class="literal">NULL</code> for input (assuming that the
            <code class="literal">ESCAPED BY</code> character is
            <code class="literal">\</code>).
          </p></li><li class="listitem"><p>
            If <code class="literal">FIELDS ENCLOSED BY</code> is not empty, a
            field containing the literal word <code class="literal">NULL</code> as
            its value is read as a <code class="literal">NULL</code> value. This
            differs from the word <code class="literal">NULL</code> enclosed
            within <code class="literal">FIELDS ENCLOSED BY</code> characters,
            which is read as the string <code class="literal">'NULL'</code>.
          </p></li><li class="listitem"><p>
            If <code class="literal">FIELDS ESCAPED BY</code> is empty,
            <code class="literal">NULL</code> is written as the word
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            With fixed-row format (which is used when <code class="literal">FIELDS
            TERMINATED BY</code> and <code class="literal">FIELDS ENCLOSED
            BY</code> are both empty), <code class="literal">NULL</code> is
            written as an empty string. This causes both
            <code class="literal">NULL</code> values and empty strings in the
            table to be indistinguishable when written to the file
            because both are written as empty strings. If you need to be
            able to tell the two apart when reading the file back in,
            you should not use fixed-row format.
</p></li></ul>
</div>
<p>
        An attempt to load <code class="literal">NULL</code> into a <code class="literal">NOT
        NULL</code> column causes assignment of the implicit default
        value for the column's data type and a warning, or an error in
        strict SQL mode. Implicit default values are discussed in
        <a class="xref" href="data-types.html#data-type-defaults" title="11.7 Data Type Default Values">Section 11.7, “Data Type Default Values”</a>.
      </p><p>
        Some cases are not supported by <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
        DATA</code></a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Fixed-size rows (<code class="literal">FIELDS TERMINATED BY</code> and
            <code class="literal">FIELDS ENCLOSED BY</code> both empty) and
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> or
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns.
          </p></li><li class="listitem"><p>
            If you specify one separator that is the same as or a prefix
            of another, <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> cannot
            interpret the input properly. For example, the following
            <code class="literal">FIELDS</code> clause would cause problems:
          </p><pre data-lang="sql" class="programlisting">
FIELDS TERMINATED BY '"' ENCLOSED BY '"'
</pre></li><li class="listitem"><p>
            If <code class="literal">FIELDS ESCAPED BY</code> is empty, a field
            value that contains an occurrence of <code class="literal">FIELDS
            ENCLOSED BY</code> or <code class="literal">LINES TERMINATED
            BY</code> followed by the <code class="literal">FIELDS TERMINATED
            BY</code> value causes <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
            DATA</code></a> to stop reading a field or line too early.
            This happens because <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
            DATA</code></a> cannot properly determine where the field or
            line value ends.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="load-data-column-list"></a>Column List Specification</h4>

</div>

</div>

</div>
<p>
        The following example loads all columns of the
        <code class="literal">persondata</code> table:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE 'persondata.txt' INTO TABLE persondata;
</pre><p>
        By default, when no column list is provided at the end of the
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> statement, input lines
        are expected to contain a field for each table column. If you
        want to load only some of a table's columns, specify a column
        list:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE 'persondata.txt' INTO TABLE persondata
(<em class="replaceable"><code>col_name_or_user_var</code></em> [, <em class="replaceable"><code>col_name_or_user_var</code></em>] ...);
</pre><p>
        You must also specify a column list if the order of the fields
        in the input file differs from the order of the columns in the
        table. Otherwise, MySQL cannot tell how to match input fields
        with table columns.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="load-data-input-preprocessing"></a>Input Preprocessing</h4>

</div>

</div>

</div>
<p>
        Each <em class="replaceable"><code>col_name_or_user_var</code></em> value is
        either a column name or a user variable. With user variables,
        the <code class="literal">SET</code> clause enables you to perform
        preprocessing transformations on their values before assigning
        the result to columns.
      </p><p>
        User variables in the <code class="literal">SET</code> clause can be used
        in several ways. The following example uses the first input
        column directly for the value of <code class="literal">t1.column1</code>,
        and assigns the second input column to a user variable that is
        subjected to a division operation before being used for the
        value of <code class="literal">t1.column2</code>:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE 'file.txt'
  INTO TABLE t1
  (column1, @var1)
  SET column2 = @var1/100;
</pre><p>
        The <code class="literal">SET</code> clause can be used to supply values
        not derived from the input file. The following statement sets
        <code class="literal">column3</code> to the current date and time:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE 'file.txt'
  INTO TABLE t1
  (column1, column2)
  SET column3 = CURRENT_TIMESTAMP;
</pre><p>
        You can also discard an input value by assigning it to a user
        variable and not assigning the variable to a table column:
      </p><pre data-lang="sql" class="programlisting">
LOAD DATA INFILE 'file.txt'
  INTO TABLE t1
  (column1, @dummy, column2, @dummy, column3);
</pre><p>
        Use of the column/variable list and <code class="literal">SET</code>
        clause is subject to the following restrictions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Assignments in the <code class="literal">SET</code> clause should have
            only column names on the left hand side of assignment
            operators.
          </p></li><li class="listitem"><p>
            You can use subqueries in the right hand side of
            <code class="literal">SET</code> assignments. A subquery that returns
            a value to be assigned to a column may be a scalar subquery
            only. Also, you cannot use a subquery to select from the
            table that is being loaded.
          </p></li><li class="listitem"><p>
            Lines ignored by an <code class="literal">IGNORE</code> clause are not
            processed for the column/variable list or
            <code class="literal">SET</code> clause.
          </p></li><li class="listitem"><p>
            User variables cannot be used when loading data with
            fixed-row format because user variables do not have a
            display width.
</p></li></ul>
</div>
<p>
        When processing an input line, <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
        DATA</code></a> splits it into fields and uses the values
        according to the column/variable list and the
        <code class="literal">SET</code> clause, if they are present. Then the
        resulting row is inserted into the table. If there are
        <code class="literal">BEFORE INSERT</code> or <code class="literal">AFTER
        INSERT</code> triggers for the table, they are activated
        before or after inserting the row, respectively.
      </p><p>
        If an input line has too many fields, the extra fields are
        ignored and the number of warnings is incremented.
      </p><p>
        If an input line has too few fields, the table columns for which
        input fields are missing are set to their default values.
        Default value assignment is described in
        <a class="xref" href="data-types.html#data-type-defaults" title="11.7 Data Type Default Values">Section 11.7, “Data Type Default Values”</a>.
      </p><p>
        An empty field value is interpreted different from a missing
        field:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For string types, the column is set to the empty string.
          </p></li><li class="listitem"><p>
            For numeric types, the column is set to
            <code class="literal">0</code>.
          </p></li><li class="listitem"><p>
            For date and time types, the column is set to the
            appropriate <span class="quote">“<span class="quote">zero</span>”</span> value for the type. See
            <a class="xref" href="data-types.html#date-and-time-types" title="11.3 Date and Time Types">Section 11.3, “Date and Time Types”</a>.
</p></li></ul>
</div>
<p>
        These are the same values that result if you assign an empty
        string explicitly to a string, numeric, or date or time type
        explicitly in an <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> or
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement.
      </p><p>
        Treatment of empty or incorrect field values differs from that
        just described if the SQL mode is set to a restrictive value.
        For example, if <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> is set
        to <a class="link" href="server-administration.html#sqlmode_traditional"><code class="literal">TRADITIONAL</code></a>, conversion of
        an empty value or a value such as <code class="literal">'x'</code> for a
        numeric column results in an error, not conversion to 0. (With
        <code class="literal">LOCAL</code> or <code class="literal">IGNORE</code>, warnings
        occur rather than errors, even with a restrictive
        <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> value, and the row is
        inserted using the same closest-value behavior used for
        nonrestrictive SQL modes. This occurs because the server has no
        way to stop transmission of the file in the middle of the
        operation.)
      </p><p>
        <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> columns are set to the
        current date and time only if there is a <code class="literal">NULL</code>
        value for the column (that is, <code class="literal">\N</code>) and the
        column is not declared to permit <code class="literal">NULL</code> values,
        or if the <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> column's
        default value is the current timestamp and it is omitted from
        the field list when a field list is specified.
      </p><p>
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> regards all input as
        strings, so you cannot use numeric values for
        <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> or
        <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> columns the way you can with
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statements. All
        <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> and
        <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> values must be specified as
        strings.
      </p><p>
        <a class="link" href="data-types.html#bit-type" title="11.2.4 Bit-Value Type - BIT"><code class="literal">BIT</code></a> values cannot be loaded
        directly using binary notation (for example,
        <code class="literal">b'011010'</code>). To work around this, use the
        <code class="literal">SET</code> clause to strip off the leading
        <code class="literal">b'</code> and trailing <code class="literal">'</code> and
        perform a base-2 to base-10 conversion so that MySQL loads the
        values into the <a class="link" href="data-types.html#bit-type" title="11.2.4 Bit-Value Type - BIT"><code class="literal">BIT</code></a> column
        properly:
      </p><pre data-lang="terminal" class="programlisting">
shell&gt; <strong class="userinput"><code>cat /tmp/bit_test.txt</code></strong>
b'10'
b'1111111'
shell&gt; <strong class="userinput"><code>mysql test</code></strong>
mysql&gt; <strong class="userinput"><code>LOAD DATA INFILE '/tmp/bit_test.txt'</code></strong>
       <strong class="userinput"><code>INTO TABLE bit_test (@var1)</code></strong>
       <strong class="userinput"><code>SET b = CAST(CONV(MID(@var1, 3, LENGTH(@var1)-3), 2, 10) AS UNSIGNED);</code></strong>
Query OK, 2 rows affected (0.00 sec)
Records: 2  Deleted: 0  Skipped: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT BIN(b+0) FROM bit_test;</code></strong>
+----------+
| BIN(b+0) |
+----------+
| 10       |
| 1111111  |
+----------+
2 rows in set (0.00 sec)
</pre><p>
        For <a class="link" href="data-types.html#bit-type" title="11.2.4 Bit-Value Type - BIT"><code class="literal">BIT</code></a> values in
        <code class="literal">0b</code> binary notation (for example,
        <code class="literal">0b011010</code>), use this <code class="literal">SET</code>
        clause instead to strip off the leading <code class="literal">0b</code>:
      </p><pre data-lang="sql" class="programlisting">
SET b = CAST(CONV(MID(@var1, 3, LENGTH(@var1)-2), 2, 10) AS UNSIGNED)
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="load-data-statement-result-information"></a>Statement Result Information</h4>

</div>

</div>

</div>
<p>
        When the <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> statement
        finishes, it returns an information string in the following
        format:
      </p><pre data-lang="none" class="programlisting">
Records: 1  Deleted: 0  Skipped: 0  Warnings: 0
</pre><p>
        Warnings occur under the same circumstances as when values are
        inserted using the <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>
        statement (see <a class="xref" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax">Section 13.2.6, “INSERT Syntax”</a>), except that
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> also generates warnings
        when there are too few or too many fields in the input row.
      </p><p>
        You can use <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> to get
        a list of the first
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> warnings as
        information about what went wrong. See
        <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax">Section 13.7.6.40, “SHOW WARNINGS Syntax”</a>.
      </p><a class="indexterm" name="idm140091665468304"></a><p>
        If you are using the C API, you can get information about the
        statement by calling the
        <a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info()"><code class="literal">mysql_info()</code></a> function. See
        <a class="xref" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info()">Section 28.7.7.36, “mysql_info()”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="load-data-miscellaneous"></a>Miscellaneous Topics</h4>

</div>

</div>

</div>
<p>
        On Unix, if you need <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> to
        read from a pipe, you can use the following technique (the
        example loads a listing of the <code class="filename">/</code> directory
        into the table <code class="literal">db1.t1</code>):
      </p><pre data-lang="terminal" class="programlisting">
mkfifo /mysql/data/db1/ls.dat
chmod 666 /mysql/data/db1/ls.dat
find / -ls &gt; /mysql/data/db1/ls.dat &amp;
mysql -e "LOAD DATA INFILE 'ls.dat' INTO TABLE t1" db1
</pre><p>
        Here you must run the command that generates the data to be
        loaded and the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> commands either on
        separate terminals, or run the data generation process in the
        background (as shown in the preceding example). If you do not do
        this, the pipe will block until data is read by the
        <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> process.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="load-xml"></a>13.2.8 LOAD XML Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091665454512"></a><pre data-lang="sql" class="programlisting">
LOAD XML
    [LOW_PRIORITY | CONCURRENT] [LOCAL]
    INFILE '<em class="replaceable"><code>file_name</code></em>'
    [REPLACE | IGNORE]
    INTO TABLE [<em class="replaceable"><code>db_name</code></em>.]<em class="replaceable"><code>tbl_name</code></em>
    [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>]
    [ROWS IDENTIFIED BY '&lt;<em class="replaceable"><code>tagname</code></em>&gt;']
    [IGNORE <em class="replaceable"><code>number</code></em> {LINES | ROWS}]
    [(<em class="replaceable"><code>field_name_or_user_var</code></em>
        [, <em class="replaceable"><code>field_name_or_user_var</code></em>] ...)]
    [SET <em class="replaceable"><code>col_name</code></em>={<em class="replaceable"><code>expr</code></em> | DEFAULT},
        [, <em class="replaceable"><code>col_name</code></em>={<em class="replaceable"><code>expr</code></em> | DEFAULT}] ...]
</pre><p>
      The <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> statement reads data
      from an XML file into a table. The
      <em class="replaceable"><code>file_name</code></em> must be given as a literal
      string. The <em class="replaceable"><code>tagname</code></em> in the optional
      <code class="literal">ROWS IDENTIFIED BY</code> clause must also be given as
      a literal string, and must be surrounded by angle brackets
      (<code class="literal">&lt;</code> and <code class="literal">&gt;</code>).
    </p><p>
      <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> acts as the complement of
      running the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client in XML output mode
      (that is, starting the client with the
      <a class="link" href="programs.html#option_mysql_xml"><code class="option">--xml</code></a> option). To write data from a
      table to an XML file, you can invoke the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a>
      client with the <a class="link" href="programs.html#option_mysql_xml"><code class="option">--xml</code></a> and
      <a class="link" href="programs.html#option_mysql_execute"><code class="option">-e</code></a> options from
      the system shell, as shown here:
    </p><pre data-lang="terminal" class="programlisting">
shell&gt; <strong class="userinput"><code>mysql --xml -e 'SELECT * FROM mydb.mytable' &gt; file.xml</code></strong>
</pre><p>
      To read the file back into a table, use <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD
      XML</code></a>. By default, the <code class="literal">&lt;row&gt;</code>
      element is considered to be the equivalent of a database table
      row; this can be changed using the <code class="literal">ROWS IDENTIFIED
      BY</code> clause.
    </p><p>
      This statement supports three different XML formats:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Column names as attributes and column values as attribute
          values:
        </p><pre data-lang="xml" class="programlisting">
&lt;<em class="replaceable"><code>row</code></em> <em class="replaceable"><code>column1</code></em>="<em class="replaceable"><code>value1</code></em>" <em class="replaceable"><code>column2</code></em>="<em class="replaceable"><code>value2</code></em>" .../&gt;
</pre></li><li class="listitem"><p>
          Column names as tags and column values as the content of these
          tags:
        </p><pre data-lang="xml" class="programlisting">
&lt;<em class="replaceable"><code>row</code></em>&gt;
  &lt;<em class="replaceable"><code>column1</code></em>&gt;<em class="replaceable"><code>value1</code></em>&lt;/<em class="replaceable"><code>column1</code></em>&gt;
  &lt;<em class="replaceable"><code>column2</code></em>&gt;<em class="replaceable"><code>value2</code></em>&lt;/<em class="replaceable"><code>column2</code></em>&gt;
&lt;/<em class="replaceable"><code>row</code></em>&gt;
</pre></li><li class="listitem"><p>
          Column names are the <code class="literal">name</code> attributes of
          <code class="literal">&lt;field&gt;</code> tags, and values are the
          contents of these tags:
        </p><pre data-lang="xml" class="programlisting">
&lt;row&gt;
  &lt;field name='<em class="replaceable"><code>column1</code></em>'&gt;<em class="replaceable"><code>value1</code></em>&lt;/field&gt;
  &lt;field name='<em class="replaceable"><code>column2</code></em>'&gt;<em class="replaceable"><code>value2</code></em>&lt;/field&gt;
&lt;/row&gt;
</pre><p>
          This is the format used by other MySQL tools, such as
          <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a>.
</p></li></ul>
</div>
<p>
      All three formats can be used in the same XML file; the import
      routine automatically detects the format for each row and
      interprets it correctly. Tags are matched based on the tag or
      attribute name and the column name.
    </p><p>
      The following clauses work essentially the same way for
      <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> as they do for
      <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">LOW_PRIORITY</code> or
          <code class="literal">CONCURRENT</code>
        </p></li><li class="listitem"><p>
          <code class="literal">LOCAL</code>
        </p></li><li class="listitem"><p>
          <code class="literal">REPLACE</code> or <code class="literal">IGNORE</code>
        </p></li><li class="listitem"><p>
          <code class="literal">CHARACTER SET</code>
        </p></li><li class="listitem"><p>
          <code class="literal">SET</code>
</p></li></ul>
</div>
<p>
      See <a class="xref" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax">Section 13.2.7, “LOAD DATA Syntax”</a>, for more information about these
      clauses.
    </p><p>
      <code class="literal">(<em class="replaceable"><code>field_name_or_user_var</code></em>,
      ...)</code> is a list of one or more comma-separated XML fields
      or user variables. The name of a user variable used for this
      purpose must match the name of a field from the XML file, prefixed
      with <code class="literal">@</code>. You can use field names to select only
      desired fields. User variables can be employed to store the
      corresponding field values for subsequent re-use.
    </p><p>
      The <code class="literal">IGNORE <em class="replaceable"><code>number</code></em>
      LINES</code> or <code class="literal">IGNORE
      <em class="replaceable"><code>number</code></em> ROWS</code> clause causes the
      first <em class="replaceable"><code>number</code></em> rows in the XML file to be
      skipped. It is analogous to the <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
      DATA</code></a> statement's <code class="literal">IGNORE ... LINES</code>
      clause.
    </p><p>
      Suppose that we have a table named <code class="literal">person</code>,
      created as shown here:
    </p><pre data-lang="sql" class="programlisting">
USE test;

CREATE TABLE person (
    person_id INT NOT NULL PRIMARY KEY,
    fname VARCHAR(40) NULL,
    lname VARCHAR(40) NULL,
    created TIMESTAMP
);
</pre><p>
      Suppose further that this table is initially empty.
    </p><p>
      Now suppose that we have a simple XML file
      <code class="filename">person.xml</code>, whose contents are as shown here:
    </p><pre data-lang="xml" class="programlisting">
&lt;list&gt;
  &lt;person person_id="1" fname="Kapek" lname="Sainnouine"/&gt;
  &lt;person person_id="2" fname="Sajon" lname="Rondela"/&gt;
  &lt;person person_id="3"&gt;&lt;fname&gt;Likame&lt;/fname&gt;&lt;lname&gt;Örrtmons&lt;/lname&gt;&lt;/person&gt;
  &lt;person person_id="4"&gt;&lt;fname&gt;Slar&lt;/fname&gt;&lt;lname&gt;Manlanth&lt;/lname&gt;&lt;/person&gt;
  &lt;person&gt;&lt;field name="person_id"&gt;5&lt;/field&gt;&lt;field name="fname"&gt;Stoma&lt;/field&gt;
    &lt;field name="lname"&gt;Milu&lt;/field&gt;&lt;/person&gt;
  &lt;person&gt;&lt;field name="person_id"&gt;6&lt;/field&gt;&lt;field name="fname"&gt;Nirtam&lt;/field&gt;
    &lt;field name="lname"&gt;Sklöd&lt;/field&gt;&lt;/person&gt;
  &lt;person person_id="7"&gt;&lt;fname&gt;Sungam&lt;/fname&gt;&lt;lname&gt;Dulbåd&lt;/lname&gt;&lt;/person&gt;
  &lt;person person_id="8" fname="Sraref" lname="Encmelt"/&gt;
&lt;/list&gt;
</pre><p>
      Each of the permissible XML formats discussed previously is
      represented in this example file.
    </p><p>
      To import the data in <code class="filename">person.xml</code> into the
      <code class="literal">person</code> table, you can use this statement:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>LOAD XML LOCAL INFILE 'person.xml'</code></strong>
    -&gt;   <strong class="userinput"><code>INTO TABLE person</code></strong>
    -&gt;   <strong class="userinput"><code>ROWS IDENTIFIED BY '&lt;person&gt;';</code></strong>

Query OK, 8 rows affected (0.00 sec)
Records: 8  Deleted: 0  Skipped: 0  Warnings: 0
</pre><p>
      Here, we assume that <code class="filename">person.xml</code> is located in
      the MySQL data directory. If the file cannot be found, the
      following error results:
    </p><pre data-lang="none" class="programlisting">
<span class="errortext">ERROR 2 (HY000): File '/person.xml' not found (Errcode: 2)</span>
</pre><p>
      The <code class="literal">ROWS IDENTIFIED BY '&lt;person&gt;'</code> clause
      means that each <code class="literal">&lt;person&gt;</code> element in the
      XML file is considered equivalent to a row in the table into which
      the data is to be imported. In this case, this is the
      <code class="literal">person</code> table in the <code class="literal">test</code>
      database.
    </p><p>
      As can be seen by the response from the server, 8 rows were
      imported into the <code class="literal">test.person</code> table. This can
      be verified by a simple <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
      statement:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM person;</code></strong>
+-----------+--------+------------+---------------------+
| person_id | fname  | lname      | created             |
+-----------+--------+------------+---------------------+
|         1 | Kapek  | Sainnouine | 2007-07-13 16:18:47 |
|         2 | Sajon  | Rondela    | 2007-07-13 16:18:47 |
|         3 | Likame | Örrtmons   | 2007-07-13 16:18:47 |
|         4 | Slar   | Manlanth   | 2007-07-13 16:18:47 |
|         5 | Stoma  | Nilu       | 2007-07-13 16:18:47 |
|         6 | Nirtam | Sklöd      | 2007-07-13 16:18:47 |
|         7 | Sungam | Dulbåd     | 2007-07-13 16:18:47 |
|         8 | Sreraf | Encmelt    | 2007-07-13 16:18:47 |
+-----------+--------+------------+---------------------+
8 rows in set (0.00 sec)
</pre><p>
      This shows, as stated earlier in this section, that any or all of
      the 3 permitted XML formats may appear in a single file and be
      read using <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a>.
    </p><p>
      The inverse of the import operation just shown—that is,
      dumping MySQL table data into an XML file—can be
      accomplished using the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client from the
      system shell, as shown here:
    </p><pre data-lang="terminal" class="programlisting">
shell&gt; <strong class="userinput"><code>mysql --xml -e "SELECT * FROM test.person" &gt; person-dump.xml</code></strong>
shell&gt; <strong class="userinput"><code>cat person-dump.xml</code></strong>
&lt;?xml version="1.0"?&gt;

&lt;resultset statement="SELECT * FROM test.person" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
  &lt;row&gt;
	&lt;field name="person_id"&gt;1&lt;/field&gt;
	&lt;field name="fname"&gt;Kapek&lt;/field&gt;
	&lt;field name="lname"&gt;Sainnouine&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
	&lt;field name="person_id"&gt;2&lt;/field&gt;
	&lt;field name="fname"&gt;Sajon&lt;/field&gt;
	&lt;field name="lname"&gt;Rondela&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
	&lt;field name="person_id"&gt;3&lt;/field&gt;
	&lt;field name="fname"&gt;Likema&lt;/field&gt;
	&lt;field name="lname"&gt;Örrtmons&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
	&lt;field name="person_id"&gt;4&lt;/field&gt;
	&lt;field name="fname"&gt;Slar&lt;/field&gt;
	&lt;field name="lname"&gt;Manlanth&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
	&lt;field name="person_id"&gt;5&lt;/field&gt;
	&lt;field name="fname"&gt;Stoma&lt;/field&gt;
	&lt;field name="lname"&gt;Nilu&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
	&lt;field name="person_id"&gt;6&lt;/field&gt;
	&lt;field name="fname"&gt;Nirtam&lt;/field&gt;
	&lt;field name="lname"&gt;Sklöd&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
	&lt;field name="person_id"&gt;7&lt;/field&gt;
	&lt;field name="fname"&gt;Sungam&lt;/field&gt;
	&lt;field name="lname"&gt;Dulbåd&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
	&lt;field name="person_id"&gt;8&lt;/field&gt;
	&lt;field name="fname"&gt;Sreraf&lt;/field&gt;
	&lt;field name="lname"&gt;Encmelt&lt;/field&gt;
  &lt;/row&gt;
&lt;/resultset&gt;
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        The <a class="link" href="programs.html#option_mysql_xml"><code class="option">--xml</code></a> option causes the
        <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client to use XML formatting for its
        output; the <a class="link" href="programs.html#option_mysql_execute"><code class="option">-e</code></a>
        option causes the client to execute the SQL statement
        immediately following the option. See <a class="xref" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client">Section 4.5.1, “<span class="command"><strong>mysql</strong></span> — The MySQL Command-Line Client”</a>.
</p>
</div>
<p>
      You can verify that the dump is valid by creating a copy of the
      <code class="literal">person</code> table and importing the dump file into
      the new table, like this:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>USE test;</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE TABLE person2 LIKE person;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>LOAD XML LOCAL INFILE 'person-dump.xml'</code></strong>
    -&gt;   <strong class="userinput"><code>INTO TABLE person2;</code></strong>
Query OK, 8 rows affected (0.01 sec)
Records: 8  Deleted: 0  Skipped: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM person2;</code></strong>
+-----------+--------+------------+---------------------+
| person_id | fname  | lname      | created             |
+-----------+--------+------------+---------------------+
|         1 | Kapek  | Sainnouine | 2007-07-13 16:18:47 |
|         2 | Sajon  | Rondela    | 2007-07-13 16:18:47 |
|         3 | Likema | Örrtmons   | 2007-07-13 16:18:47 |
|         4 | Slar   | Manlanth   | 2007-07-13 16:18:47 |
|         5 | Stoma  | Nilu       | 2007-07-13 16:18:47 |
|         6 | Nirtam | Sklöd      | 2007-07-13 16:18:47 |
|         7 | Sungam | Dulbåd     | 2007-07-13 16:18:47 |
|         8 | Sreraf | Encmelt    | 2007-07-13 16:18:47 |
+-----------+--------+------------+---------------------+
8 rows in set (0.00 sec)
</pre><p>
      There is no requirement that every field in the XML file be
      matched with a column in the corresponding table. Fields which
      have no corresponding columns are skipped. You can see this by
      first emptying the <code class="literal">person2</code> table and dropping
      the <code class="literal">created</code> column, then using the same
      <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> statement we just employed
      previously, like this:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>TRUNCATE person2;</code></strong>
Query OK, 8 rows affected (0.26 sec)

mysql&gt; <strong class="userinput"><code>ALTER TABLE person2 DROP COLUMN created;</code></strong>
Query OK, 0 rows affected (0.52 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE person2\G</code></strong>
*************************** 1. row ***************************
       Table: person2
Create Table: CREATE TABLE `person2` (
  `person_id` int(11) NOT NULL,
  `fname` varchar(40) DEFAULT NULL,
  `lname` varchar(40) DEFAULT NULL,
  PRIMARY KEY (`person_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>LOAD XML LOCAL INFILE 'person-dump.xml'</code></strong>
    -&gt;   <strong class="userinput"><code>INTO TABLE person2;</code></strong>
Query OK, 8 rows affected (0.01 sec)
Records: 8  Deleted: 0  Skipped: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM person2;</code></strong>
+-----------+--------+------------+
| person_id | fname  | lname      |
+-----------+--------+------------+
|         1 | Kapek  | Sainnouine |
|         2 | Sajon  | Rondela    |
|         3 | Likema | Örrtmons   |
|         4 | Slar   | Manlanth   |
|         5 | Stoma  | Nilu       |
|         6 | Nirtam | Sklöd      |
|         7 | Sungam | Dulbåd     |
|         8 | Sreraf | Encmelt    |
+-----------+--------+------------+
8 rows in set (0.00 sec)
</pre><p>
      The order in which the fields are given within each row of the XML
      file does not affect the operation of <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD
      XML</code></a>; the field order can vary from row to row, and is
      not required to be in the same order as the corresponding columns
      in the table.
    </p><p>
      As mentioned previously, you can use a
      <code class="literal">(<em class="replaceable"><code>field_name_or_user_var</code></em>,
      ...)</code> list of one or more XML fields (to select desired
      fields only) or user variables (to store the corresponding field
      values for later use). User variables can be especially useful
      when you want to insert data from an XML file into table columns
      whose names do not match those of the XML fields. To see how this
      works, we first create a table named <code class="literal">individual</code>
      whose structure matches that of the <code class="literal">person</code>
      table, but whose columns are named differently:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE individual (</code></strong>
    -&gt;     <strong class="userinput"><code>individual_id INT NOT NULL PRIMARY KEY,</code></strong>
    -&gt;     <strong class="userinput"><code>name1 VARCHAR(40) NULL,</code></strong>
    -&gt;     <strong class="userinput"><code>name2 VARCHAR(40) NULL,</code></strong>
    -&gt;     <strong class="userinput"><code>made TIMESTAMP</code></strong>
    -&gt; );
Query OK, 0 rows affected (0.42 sec)
</pre><p>
      In this case, you cannot simply load the XML file directly into
      the table, because the field and column names do not match:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>LOAD XML INFILE '../bin/person-dump.xml' INTO TABLE test.individual;</code></strong>
ERROR 1263 (22004): Column set to default value; NULL supplied to NOT NULL column 'individual_id' at row 1
</pre><p>
      This happens because the MySQL server looks for field names
      matching the column names of the target table. You can work around
      this problem by selecting the field values into user variables,
      then setting the target table's columns equal to the values
      of those variables using <code class="literal">SET</code>. You can perform
      both of these operations in a single statement, as shown here:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>LOAD XML INFILE '../bin/person-dump.xml'</code></strong>
    -&gt;     <strong class="userinput"><code>INTO TABLE test.individual (@person_id, @fname, @lname, @created)</code></strong>
    -&gt;     <strong class="userinput"><code>SET individual_id=@person_id, name1=@fname, name2=@lname, made=@created;</code></strong>
Query OK, 8 rows affected (0.05 sec)
Records: 8  Deleted: 0  Skipped: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM individual;</code></strong>
+---------------+--------+------------+---------------------+
| individual_id | name1  | name2      | made                |
+---------------+--------+------------+---------------------+
|             1 | Kapek  | Sainnouine | 2007-07-13 16:18:47 |
|             2 | Sajon  | Rondela    | 2007-07-13 16:18:47 |
|             3 | Likema | Örrtmons   | 2007-07-13 16:18:47 |
|             4 | Slar   | Manlanth   | 2007-07-13 16:18:47 |
|             5 | Stoma  | Nilu       | 2007-07-13 16:18:47 |
|             6 | Nirtam | Sklöd      | 2007-07-13 16:18:47 |
|             7 | Sungam | Dulbåd     | 2007-07-13 16:18:47 |
|             8 | Srraf  | Encmelt    | 2007-07-13 16:18:47 |
+---------------+--------+------------+---------------------+
8 rows in set (0.00 sec)
</pre><p>
      The names of the user variables <span class="emphasis"><em>must</em></span> match
      those of the corresponding fields from the XML file, with the
      addition of the required <code class="literal">@</code> prefix to indicate
      that they are variables. The user variables need not be listed or
      assigned in the same order as the corresponding fields.
    </p><p>
      Using a <code class="literal">ROWS IDENTIFIED BY
      '&lt;<em class="replaceable"><code>tagname</code></em>&gt;'</code> clause, it
      is possible to import data from the same XML file into database
      tables with different definitions. For this example, suppose that
      you have a file named <code class="filename">address.xml</code> which
      contains the following XML:
    </p><pre data-lang="xml" class="programlisting">
&lt;?xml version="1.0"?&gt;

&lt;list&gt;
  &lt;person person_id="1"&gt;
    &lt;fname&gt;Robert&lt;/fname&gt;
    &lt;lname&gt;Jones&lt;/lname&gt;
    &lt;address address_id="1" street="Mill Creek Road" zip="45365" city="Sidney"/&gt;
    &lt;address address_id="2" street="Main Street" zip="28681" city="Taylorsville"/&gt;
  &lt;/person&gt;

  &lt;person person_id="2"&gt;
    &lt;fname&gt;Mary&lt;/fname&gt;
    &lt;lname&gt;Smith&lt;/lname&gt;
    &lt;address address_id="3" street="River Road" zip="80239" city="Denver"/&gt;
    &lt;!-- &lt;address address_id="4" street="North Street" zip="37920" city="Knoxville"/&gt; --&gt;
  &lt;/person&gt;

&lt;/list&gt;
</pre><p>
      You can again use the <code class="literal">test.person</code> table as
      defined previously in this section, after clearing all the
      existing records from the table and then showing its structure as
      shown here:
    </p><pre data-lang="sql" class="programlisting">
mysql&lt; <strong class="userinput"><code>TRUNCATE person;</code></strong>
Query OK, 0 rows affected (0.04 sec)

mysql&lt; <strong class="userinput"><code>SHOW CREATE TABLE person\G</code></strong>
*************************** 1. row ***************************
       Table: person
Create Table: CREATE TABLE `person` (
  `person_id` int(11) NOT NULL,
  `fname` varchar(40) DEFAULT NULL,
  `lname` varchar(40) DEFAULT NULL,
  `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`person_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4
1 row in set (0.00 sec)
</pre><p>
      Now create an <code class="literal">address</code> table in the
      <code class="literal">test</code> database using the following
      <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement:
    </p><pre data-lang="sql" class="programlisting">
CREATE TABLE address (
    address_id INT NOT NULL PRIMARY KEY,
    person_id INT NULL,
    street VARCHAR(40) NULL,
    zip INT NULL,
    city VARCHAR(40) NULL,
    created TIMESTAMP
);
</pre><p>
      To import the data from the XML file into the
      <code class="literal">person</code> table, execute the following
      <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> statement, which specifies
      that rows are to be specified by the
      <code class="literal">&lt;person&gt;</code> element, as shown here;
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>LOAD XML LOCAL INFILE 'address.xml'</code></strong>
    -&gt;   <strong class="userinput"><code>INTO TABLE person</code></strong>
    -&gt;   <strong class="userinput"><code>ROWS IDENTIFIED BY '&lt;person&gt;';</code></strong>
Query OK, 2 rows affected (0.00 sec)
Records: 2  Deleted: 0  Skipped: 0  Warnings: 0
</pre><p>
      You can verify that the records were imported using a
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM person;</code></strong>
+-----------+--------+-------+---------------------+
| person_id | fname  | lname | created             |
+-----------+--------+-------+---------------------+
|         1 | Robert | Jones | 2007-07-24 17:37:06 |
|         2 | Mary   | Smith | 2007-07-24 17:37:06 |
+-----------+--------+-------+---------------------+
2 rows in set (0.00 sec)
</pre><p>
      Since the <code class="literal">&lt;address&gt;</code> elements in the XML
      file have no corresponding columns in the
      <code class="literal">person</code> table, they are skipped.
    </p><p>
      To import the data from the <code class="literal">&lt;address&gt;</code>
      elements into the <code class="literal">address</code> table, use the
      <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> statement shown here:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>LOAD XML LOCAL INFILE 'address.xml'</code></strong>
    -&gt;   <strong class="userinput"><code>INTO TABLE address</code></strong>
    -&gt;   <strong class="userinput"><code>ROWS IDENTIFIED BY '&lt;address&gt;';</code></strong>
Query OK, 3 rows affected (0.00 sec)
Records: 3  Deleted: 0  Skipped: 0  Warnings: 0
</pre><p>
      You can see that the data was imported using a
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement such as this one:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM address;</code></strong>
+------------+-----------+-----------------+-------+--------------+---------------------+
| address_id | person_id | street          | zip   | city         | created             |
+------------+-----------+-----------------+-------+--------------+---------------------+
|          1 |         1 | Mill Creek Road | 45365 | Sidney       | 2007-07-24 17:37:37 |
|          2 |         1 | Main Street     | 28681 | Taylorsville | 2007-07-24 17:37:37 |
|          3 |         2 | River Road      | 80239 | Denver       | 2007-07-24 17:37:37 |
+------------+-----------+-----------------+-------+--------------+---------------------+
3 rows in set (0.00 sec)
</pre><p>
      The data from the <code class="literal">&lt;address&gt;</code> element that
      is enclosed in XML comments is not imported. However, since there
      is a <code class="literal">person_id</code> column in the
      <code class="literal">address</code> table, the value of the
      <code class="literal">person_id</code> attribute from the parent
      <code class="literal">&lt;person&gt;</code> element for each
      <code class="literal">&lt;address&gt;</code> <span class="emphasis"><em>is</em></span>
      imported into the <code class="literal">address</code> table.
    </p><p><b>Security Considerations. </b>
        As with the <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> statement,
        the transfer of the XML file from the client host to the server
        host is initiated by the MySQL server. In theory, a patched
        server could be built that would tell the client program to
        transfer a file of the server's choosing rather than the file
        named by the client in the <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD
        XML</code></a> statement. Such a server could access any file on
        the client host to which the client user has read access.
      </p><p>
      In a Web environment, clients usually connect to MySQL from a Web
      server. A user that can run any command against the MySQL server
      can use <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML
      LOCAL</code></a> to read any files to which the Web server process
      has read access. In this environment, the client with respect to
      the MySQL server is actually the Web server, not the remote
      program being run by the user who connects to the Web server.
    </p><p>
      You can disable loading of XML files from clients by starting the
      server with <a class="link" href="server-administration.html#sysvar_local_infile"><code class="literal">--local-infile=0</code></a> or
      <a class="link" href="server-administration.html#sysvar_local_infile"><code class="literal">--local-infile=OFF</code></a>. This option
      can also be used when starting the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client
      to disable <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> for the
      duration of the client session.
    </p><p>
      To prevent a client from loading XML files from the server, do not
      grant the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege to the
      corresponding MySQL user account, or revoke this privilege if the
      client user account already has it.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        Revoking the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege (or
        not granting it in the first place) keeps the user only from
        executing the <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> statement
        (as well as the <a class="link" href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a>
        function; it does <span class="emphasis"><em>not</em></span> prevent the user from
        executing <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML
        LOCAL</code></a>. To disallow this statement, you must start the
        server or the client with <code class="option">--local-infile=OFF</code>.
      </p><p>
        In other words, the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a>
        privilege affects only whether the client can read files on the
        server; it has no bearing on whether the client can read files
        on the local file system.
</p>
</div>
<p>
      For partitioned tables using storage engines that employ table
      locks, such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>, any locks
      caused by <a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> perform locks on
      all partitions of the table. This does not apply to tables using
      storage engines which employ row-level locking, such as
      <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>. For more information, see
      <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/partitioning-limitations-locking.html" target="_top">Partitioning and Locking</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="replace"></a>13.2.9 REPLACE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091665243696"></a><pre data-lang="sql" class="programlisting">
REPLACE [LOW_PRIORITY | DELAYED]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em> [, <em class="replaceable"><code>partition_name</code></em>] ...)]
    [(<em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...)]
    {VALUES | VALUE} (<em class="replaceable"><code>value_list</code></em>) [, (<em class="replaceable"><code>value_list</code></em>)] ...

REPLACE [LOW_PRIORITY | DELAYED]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em> [, <em class="replaceable"><code>partition_name</code></em>] ...)]
    SET <em class="replaceable"><code>assignment_list</code></em>

REPLACE [LOW_PRIORITY | DELAYED]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em> [, <em class="replaceable"><code>partition_name</code></em>] ...)]
    [(<em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...)]
    SELECT ...

<em class="replaceable"><code>value</code></em>:
    {<em class="replaceable"><code>expr</code></em> | DEFAULT}

<em class="replaceable"><code>value_list</code></em>:
    <em class="replaceable"><code>value</code></em> [, <em class="replaceable"><code>value</code></em>] ...

<em class="replaceable"><code>assignment</code></em>:
    <em class="replaceable"><code>col_name</code></em> = <em class="replaceable"><code>value</code></em>

<em class="replaceable"><code>assignment_list</code></em>:
    <em class="replaceable"><code>assignment</code></em> [, <em class="replaceable"><code>assignment</code></em>] ...
</pre><p>
      <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> works exactly like
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>, except that if an old row
      in the table has the same value as a new row for a
      <code class="literal">PRIMARY KEY</code> or a <code class="literal">UNIQUE</code>
      index, the old row is deleted before the new row is inserted. See
      <a class="xref" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax">Section 13.2.6, “INSERT Syntax”</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> is a MySQL extension to the
      SQL standard. It either inserts, or <span class="emphasis"><em>deletes</em></span>
      and inserts. For another MySQL extension to standard
      SQL—that either inserts or
      <span class="emphasis"><em>updates</em></span>—see
      <a class="xref" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE Syntax">Section 13.2.6.2, “INSERT ... ON DUPLICATE KEY UPDATE Syntax”</a>.
    </p><p>
      <code class="literal">DELAYED</code> inserts and replaces were deprecated in
      MySQL 5.6. In MySQL 8.0, <code class="literal">DELAYED</code>
      is not supported. The server recognizes but ignores the
      <code class="literal">DELAYED</code> keyword, handles the replace as a
      nondelayed replace, and generates an
      <code class="literal">ER_WARN_LEGACY_SYNTAX_CONVERTED</code> warning.
      (<span class="quote">“<span class="quote">REPLACE DELAYED is no longer supported. The statement was
      converted to REPLACE.</span>”</span>) The <code class="literal">DELAYED</code>
      keyword will be removed in a future release.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> makes sense only if a
        table has a <code class="literal">PRIMARY KEY</code> or
        <code class="literal">UNIQUE</code> index. Otherwise, it becomes
        equivalent to <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>, because
        there is no index to be used to determine whether a new row
        duplicates another.
</p>
</div>
<p>
      Values for all columns are taken from the values specified in the
      <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> statement. Any missing
      columns are set to their default values, just as happens for
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>. You cannot refer to values
      from the current row and use them in the new row. If you use an
      assignment such as <code class="literal">SET
      <em class="replaceable"><code>col_name</code></em> =
      <em class="replaceable"><code>col_name</code></em> + 1</code>, the reference
      to the column name on the right hand side is treated as
      <a class="link" href="functions.html#function_default"><code class="literal">DEFAULT(<em class="replaceable"><code>col_name</code></em>)</code></a>,
      so the assignment is equivalent to <code class="literal">SET
      <em class="replaceable"><code>col_name</code></em> =
      DEFAULT(<em class="replaceable"><code>col_name</code></em>) + 1</code>.
    </p><p>
      To use <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a>, you must have both
      the <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> and
      <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privileges for the table.
    </p><a class="indexterm" name="idm140091665196016"></a><p>
      If a generated column is replaced explicitly, the only permitted
      value is <code class="literal">DEFAULT</code>. For information about
      generated columns, see
      <a class="xref" href="sql-syntax.html#create-table-generated-columns" title="13.1.20.9 CREATE TABLE and Generated Columns">Section 13.1.20.9, “CREATE TABLE and Generated Columns”</a>.
    </p><p>
      <code class="literal">REPLACE</code> supports explicit partition selection
      using the <code class="literal">PARTITION</code> keyword with a list of
      comma-separated names of partitions, subpartitions, or both. As
      with <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>, if it is not possible
      to insert the new row into any of these partitions or
      subpartitions, the <code class="literal">REPLACE</code> statement fails with
      the error <span class="errortext">Found a row not matching the given partition
      set</span>. For more information and examples, see
      <a class="xref" href="partitioning.html#partitioning-selection" title="23.5 Partition Selection">Section 23.5, “Partition Selection”</a>.
    </p><p>
      The <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> statement returns a
      count to indicate the number of rows affected. This is the sum of
      the rows deleted and inserted. If the count is 1 for a single-row
      <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a>, a row was inserted and no
      rows were deleted. If the count is greater than 1, one or more old
      rows were deleted before the new row was inserted. It is possible
      for a single row to replace more than one old row if the table
      contains multiple unique indexes and the new row duplicates values
      for different old rows in different unique indexes.
    </p><p>
      The affected-rows count makes it easy to determine whether
      <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> only added a row or whether
      it also replaced any rows: Check whether the count is 1 (added) or
      greater (replaced).
    </p><p>
      If you are using the C API, the affected-rows count can be
      obtained using the
      <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1 mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> function.
    </p><p>
      You cannot replace into a table and select from the same table in
      a subquery.
    </p><p>
      MySQL uses the following algorithm for
      <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> (and
      <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA ...
      REPLACE</code></a>):
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Try to insert the new row into the table
        </p></li><li class="listitem"><p>
          While the insertion fails because a duplicate-key error occurs
          for a primary key or unique index:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="a"><li class="listitem"><p>
              Delete from the table the conflicting row that has the
              duplicate key value
            </p></li><li class="listitem"><p>
              Try again to insert the new row into the table
</p></li></ol>
</div>
</li></ol>
</div>
<p>
      It is possible that in the case of a duplicate-key error, a
      storage engine may perform the <code class="literal">REPLACE</code> as an
      update rather than a delete plus insert, but the semantics are the
      same. There are no user-visible effects other than a possible
      difference in how the storage engine increments
      <code class="literal">Handler_<em class="replaceable"><code>xxx</code></em></code> status
      variables.
    </p><p>
      Because the results of <code class="literal">REPLACE ... SELECT</code>
      statements depend on the ordering of rows from the
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> and this order cannot always
      be guaranteed, it is possible when logging these statements for
      the master and the slave to diverge. For this reason,
      <code class="literal">REPLACE ... SELECT</code> statements are flagged as
      unsafe for statement-based replication. such statements produce a
      warning in the error log when using statement-based mode and are
      written to the binary log using the row-based format when using
      <code class="literal">MIXED</code> mode. See also
      <a class="xref" href="replication.html#replication-sbr-rbr" title="17.2.1.1 Advantages and Disadvantages of Statement-Based and Row-Based Replication">Section 17.2.1.1, “Advantages and Disadvantages of Statement-Based and Row-Based
        Replication”</a>.
    </p><p>
      When modifying an existing table that is not partitioned to
      accommodate partitioning, or, when modifying the partitioning of
      an already partitioned table, you may consider altering the
      table's primary key (see
      <a class="xref" href="partitioning.html#partitioning-limitations-partitioning-keys-unique-keys" title="23.6.1 Partitioning Keys, Primary Keys, and Unique Keys">Section 23.6.1, “Partitioning Keys, Primary Keys, and Unique Keys”</a>).
      You should be aware that, if you do this, the results of
      <code class="literal">REPLACE</code> statements may be affected, just as
      they would be if you modified the primary key of a nonpartitioned
      table. Consider the table created by the following
      <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement:
    </p><pre data-lang="sql" class="programlisting">
CREATE TABLE test (
  id INT UNSIGNED NOT NULL AUTO_INCREMENT,
  data VARCHAR(64) DEFAULT NULL,
  ts TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (id)
);
</pre><p>
      When we create this table and run the statements shown in the
      mysql client, the result is as follows:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>REPLACE INTO test VALUES (1, 'Old', '2014-08-20 18:47:00');</code></strong>
Query OK, 1 row affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>REPLACE INTO test VALUES (1, 'New', '2014-08-20 18:47:42');</code></strong>
Query OK, 2 rows affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM test;</code></strong>
+----+------+---------------------+
| id | data | ts                  |
+----+------+---------------------+
|  1 | New  | 2014-08-20 18:47:42 |
+----+------+---------------------+
1 row in set (0.00 sec)
</pre><p>
      Now we create a second table almost identical to the first, except
      that the primary key now covers 2 columns, as shown here
      (emphasized text):
    </p><pre data-lang="sql" class="programlisting">
CREATE TABLE test2 (
  id INT UNSIGNED NOT NULL AUTO_INCREMENT,
  data VARCHAR(64) DEFAULT NULL,
  ts TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  <span class="emphasis"><em>PRIMARY KEY (id, ts)</em></span>
);
</pre><p>
      When we run on <code class="literal">test2</code> the same two
      <code class="literal">REPLACE</code> statements as we did on the original
      <code class="literal">test</code> table, we obtain a different result:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>REPLACE INTO test2 VALUES (1, 'Old', '2014-08-20 18:47:00');</code></strong>
Query OK, 1 row affected (0.05 sec)

mysql&gt; <strong class="userinput"><code>REPLACE INTO test2 VALUES (1, 'New', '2014-08-20 18:47:42');</code></strong>
Query OK, 1 row affected (0.06 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM test2;</code></strong>
+----+------+---------------------+
| id | data | ts                  |
+----+------+---------------------+
|  1 | Old  | 2014-08-20 18:47:00 |
|  1 | New  | 2014-08-20 18:47:42 |
+----+------+---------------------+
2 rows in set (0.00 sec)
</pre><p>
      This is due to the fact that, when run on
      <code class="literal">test2</code>, both the <code class="literal">id</code> and
      <code class="literal">ts</code> column values must match those of an
      existing row for the row to be replaced; otherwise, a row is
      inserted.
    </p><p>
      A <code class="literal">REPLACE</code> statement affecting a partitioned
      table using a storage engine such as
      <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that employs table-level locks
      locks only those partitions containing rows that match the
      <code class="literal">REPLACE</code> statement <code class="literal">WHERE</code>
      clause, as long as none of the table partitioning columns are
      updated; otherwise the entire table is locked. (For storage
      engines such as <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that employ
      row-level locking, no locking of partitions takes place.) For more
      information, see
      <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/partitioning-limitations-locking.html" target="_top">Partitioning and Locking</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="select"></a>13.2.10 SELECT Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#select-into">13.2.10.1 SELECT ... INTO Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#join">13.2.10.2 JOIN Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#union">13.2.10.3 UNION Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091665136640"></a><pre data-lang="sql" class="programlisting">
SELECT
    [ALL | DISTINCT | DISTINCTROW ]
      [HIGH_PRIORITY]
      [STRAIGHT_JOIN]
      [SQL_SMALL_RESULT] [SQL_BIG_RESULT] [SQL_BUFFER_RESULT]
      [SQL_NO_CACHE] [SQL_CALC_FOUND_ROWS]
    <em class="replaceable"><code>select_expr</code></em> [, <em class="replaceable"><code>select_expr</code></em> ...]
    [FROM <em class="replaceable"><code>table_references</code></em>
      [PARTITION <em class="replaceable"><code>partition_list</code></em>]
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
    [GROUP BY {<em class="replaceable"><code>col_name</code></em> | <em class="replaceable"><code>expr</code></em> | <em class="replaceable"><code>position</code></em>}, ... [WITH ROLLUP]]
    [HAVING <em class="replaceable"><code>where_condition</code></em>]
    [WINDOW <em class="replaceable"><code>window_name</code></em> AS (<em class="replaceable"><code>window_spec</code></em>)
        [, <em class="replaceable"><code>window_name</code></em> AS (<em class="replaceable"><code>window_spec</code></em>)] ...]
    [ORDER BY {<em class="replaceable"><code>col_name</code></em> | <em class="replaceable"><code>expr</code></em> | <em class="replaceable"><code>position</code></em>}
      [ASC | DESC], ... [WITH ROLLUP]]
    [LIMIT {[<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em> | <em class="replaceable"><code>row_count</code></em> OFFSET <em class="replaceable"><code>offset</code></em>}]
    [INTO OUTFILE '<em class="replaceable"><code>file_name</code></em>'
        [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>]
        <em class="replaceable"><code>export_options</code></em>
      | INTO DUMPFILE '<em class="replaceable"><code>file_name</code></em>'
      | INTO <em class="replaceable"><code>var_name</code></em> [, <em class="replaceable"><code>var_name</code></em>]]
    [FOR {UPDATE | SHARE} [OF <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ...] [NOWAIT | SKIP LOCKED] 
      | LOCK IN SHARE MODE]]
</pre><p>
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> is used to retrieve rows
      selected from one or more tables, and can include
      <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> statements and subqueries.
      See <a class="xref" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax">Section 13.2.10.3, “UNION Syntax”</a>, and <a class="xref" href="sql-syntax.html#subqueries" title="13.2.11 Subquery Syntax">Section 13.2.11, “Subquery Syntax”</a>. A
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement can start with a
      <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause to define common table
      expressions accessible within the
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>. See <a class="xref" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)">Section 13.2.13, “WITH Syntax (Common Table Expressions)”</a>.
    </p><p>
      The most commonly used clauses of
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements are these:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Each <em class="replaceable"><code>select_expr</code></em> indicates a column
          that you want to retrieve. There must be at least one
          <em class="replaceable"><code>select_expr</code></em>.
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>table_references</code></em> indicates the
          table or tables from which to retrieve rows. Its syntax is
          described in <a class="xref" href="sql-syntax.html#join" title="13.2.10.2 JOIN Syntax">Section 13.2.10.2, “JOIN Syntax”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">SELECT</code> supports explicit partition
          selection using the <code class="literal">PARTITION</code> with a list
          of partitions or subpartitions (or both) following the name of
          the table in a <em class="replaceable"><code>table_reference</code></em> (see
          <a class="xref" href="sql-syntax.html#join" title="13.2.10.2 JOIN Syntax">Section 13.2.10.2, “JOIN Syntax”</a>). In this case, rows are selected only
          from the partitions listed, and any other partitions of the
          table are ignored. For more information and examples, see
          <a class="xref" href="partitioning.html#partitioning-selection" title="23.5 Partition Selection">Section 23.5, “Partition Selection”</a>.
        </p><p>
          <code class="literal">SELECT ... PARTITION</code> from tables using
          storage engines such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>
          that perform table-level locks (and thus partition locks) lock
          only the partitions or subpartitions named by the
          <code class="literal">PARTITION</code> option.
        </p><p>
          For more information, see
          <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/partitioning-limitations-locking.html" target="_top">Partitioning and Locking</a>.
        </p></li><li class="listitem"><p>
          The <code class="literal">WHERE</code> clause, if given, indicates the
          condition or conditions that rows must satisfy to be selected.
          <em class="replaceable"><code>where_condition</code></em> is an expression
          that evaluates to true for each row to be selected. The
          statement selects all rows if there is no
          <code class="literal">WHERE</code> clause.
        </p><p>
          In the <code class="literal">WHERE</code> expression, you can use any of
          the functions and operators that MySQL supports, except for
          aggregate (summary) functions. See
          <a class="xref" href="language-structure.html#expressions" title="9.5 Expressions">Section 9.5, “Expressions”</a>, and
          <a class="xref" href="functions.html" title="Chapter 12 Functions and Operators">Chapter 12, <i>Functions and Operators</i></a>.
</p></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> can also be used to retrieve
      rows computed without reference to any table.
    </p><p>
      For example:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 + 1;</code></strong>
        -&gt; 2
</pre><p>
      <a class="indexterm" name="idm140091665082944"></a>

      You are permitted to specify <code class="literal">DUAL</code> as a dummy
      table name in situations where no tables are referenced:
    </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 + 1 FROM DUAL;</code></strong>
        -&gt; 2
</pre><p>
      <code class="literal">DUAL</code> is purely for the convenience of people
      who require that all <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
      statements should have <code class="literal">FROM</code> and possibly other
      clauses. MySQL may ignore the clauses. MySQL does not require
      <code class="literal">FROM DUAL</code> if no tables are referenced.
    </p><p>
      In general, clauses used must be given in exactly the order shown
      in the syntax description. For example, a
      <code class="literal">HAVING</code> clause must come after any
      <code class="literal">GROUP BY</code> clause and before any <code class="literal">ORDER
      BY</code> clause. The exception is that the
      <code class="literal">INTO</code> clause can appear either as shown in the
      syntax description or immediately following the
      <em class="replaceable"><code>select_expr</code></em> list. For more information
      about <code class="literal">INTO</code>, see <a class="xref" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax">Section 13.2.10.1, “SELECT ... INTO Syntax”</a>.
    </p><p>
      The list of <em class="replaceable"><code>select_expr</code></em> terms comprises
      the select list that indicates which columns to retrieve. Terms
      specify a column or expression or can use
      <code class="literal">*</code>-shorthand:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A select list consisting only of a single unqualified
          <code class="literal">*</code> can be used as shorthand to select all
          columns from all tables:
        </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 INNER JOIN t2 ...
</pre></li><li class="listitem"><p>
          <code class="literal"><em class="replaceable"><code>tbl_name</code></em>.*</code> can
          be used as a qualified shorthand to select all columns from
          the named table:
        </p><pre data-lang="sql" class="programlisting">
SELECT t1.*, t2.* FROM t1 INNER JOIN t2 ...
</pre></li><li class="listitem"><p>
          Use of an unqualified <code class="literal">*</code> with other items in
          the select list may produce a parse error. To avoid this
          problem, use a qualified
          <code class="literal"><em class="replaceable"><code>tbl_name</code></em>.*</code>
          reference
        </p><pre data-lang="sql" class="programlisting">
SELECT AVG(score), t1.* FROM t1 ...
</pre></li></ul>
</div>
<p>
      The following list provides additional information about other
      <code class="literal">SELECT</code> clauses:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="indexterm" name="idm140091665056448"></a>

          <a class="indexterm" name="idm140091665054960"></a>

          A <em class="replaceable"><code>select_expr</code></em> can be given an alias
          using <code class="literal">AS
          <em class="replaceable"><code>alias_name</code></em></code>. The alias is
          used as the expression's column name and can be used in
          <code class="literal">GROUP BY</code>, <code class="literal">ORDER BY</code>, or
          <code class="literal">HAVING</code> clauses. For example:
        </p><pre data-lang="sql" class="programlisting">
SELECT CONCAT(last_name,', ',first_name) AS full_name
  FROM mytable ORDER BY full_name;
</pre><p>
          The <code class="literal">AS</code> keyword is optional when aliasing a
          <em class="replaceable"><code>select_expr</code></em> with an identifier. The
          preceding example could have been written like this:
        </p><pre data-lang="sql" class="programlisting">
SELECT CONCAT(last_name,', ',first_name) full_name
  FROM mytable ORDER BY full_name;
</pre><p>
          However, because the <code class="literal">AS</code> is optional, a
          subtle problem can occur if you forget the comma between two
          <em class="replaceable"><code>select_expr</code></em> expressions: MySQL
          interprets the second as an alias name. For example, in the
          following statement, <code class="literal">columnb</code> is treated as
          an alias name:
        </p><pre data-lang="sql" class="programlisting">
SELECT columna columnb FROM mytable;
</pre><p>
          For this reason, it is good practice to be in the habit of
          using <code class="literal">AS</code> explicitly when specifying column
          aliases.
        </p><p>
          It is not permissible to refer to a column alias in a
          <code class="literal">WHERE</code> clause, because the column value
          might not yet be determined when the <code class="literal">WHERE</code>
          clause is executed. See <a class="xref" href="error-handling.html#problems-with-alias" title="B.4.4.4 Problems with Column Aliases">Section B.4.4.4, “Problems with Column Aliases”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091665038208"></a>

          <a class="indexterm" name="idm140091665037136"></a>

          The <code class="literal">FROM
          <em class="replaceable"><code>table_references</code></em></code> clause
          indicates the table or tables from which to retrieve rows. If
          you name more than one table, you are performing a join. For
          information on join syntax, see <a class="xref" href="sql-syntax.html#join" title="13.2.10.2 JOIN Syntax">Section 13.2.10.2, “JOIN Syntax”</a>. For
          each table specified, you can optionally specify an alias.
        </p><pre data-lang="sql" class="programlisting">
<em class="replaceable"><code>tbl_name</code></em> [[AS] <em class="replaceable"><code>alias</code></em>] [<em class="replaceable"><code>index_hint</code></em>]
</pre><a class="indexterm" name="idm140091665031840"></a><a class="indexterm" name="idm140091665030768"></a><p>
          The use of index hints provides the optimizer with information
          about how to choose indexes during query processing. For a
          description of the syntax for specifying these hints, see
          <a class="xref" href="optimization.html#index-hints" title="8.9.4 Index Hints">Section 8.9.4, “Index Hints”</a>.
        </p><p>
          You can use <code class="literal">SET
          max_seeks_for_key=<em class="replaceable"><code>value</code></em></code>
          as an alternative way to force MySQL to prefer key scans
          instead of table scans. See
          <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>.
        </p></li><li class="listitem"><p>
          You can refer to a table within the default database as
          <em class="replaceable"><code>tbl_name</code></em>, or as
          <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em>
          to specify a database explicitly. You can refer to a column as
          <em class="replaceable"><code>col_name</code></em>,
          <em class="replaceable"><code>tbl_name</code></em>.<em class="replaceable"><code>col_name</code></em>,
          or
          <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em>.<em class="replaceable"><code>col_name</code></em>.
          You need not specify a <em class="replaceable"><code>tbl_name</code></em> or
          <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em>
          prefix for a column reference unless the reference would be
          ambiguous. See <a class="xref" href="language-structure.html#identifier-qualifiers" title="9.2.1 Identifier Qualifiers">Section 9.2.1, “Identifier Qualifiers”</a>, for
          examples of ambiguity that require the more explicit column
          reference forms.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091665017952"></a>

          <a class="indexterm" name="idm140091665016496"></a>

          A table reference can be aliased using
          <code class="literal"><em class="replaceable"><code>tbl_name</code></em> AS
          <em class="replaceable"><code>alias_name</code></em></code> or
          <em class="replaceable"><code>tbl_name alias_name</code></em>. These
          statements are equivalent:
        </p><pre data-lang="sql" class="programlisting">
SELECT t1.name, t2.salary FROM employee AS t1, info AS t2
  WHERE t1.name = t2.name;

SELECT t1.name, t2.salary FROM employee t1, info t2
  WHERE t1.name = t2.name;
</pre></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091665011728"></a>

          Columns selected for output can be referred to in
          <code class="literal">ORDER BY</code> and <code class="literal">GROUP BY</code>
          clauses using column names, column aliases, or column
          positions. Column positions are integers and begin with 1:
        </p><pre data-lang="sql" class="programlisting">
SELECT college, region, seed FROM tournament
  ORDER BY region, seed;

SELECT college, region AS r, seed AS s FROM tournament
  ORDER BY r, s;

SELECT college, region, seed FROM tournament
  ORDER BY 2, 3;
</pre><p>
          To sort in reverse order, add the <code class="literal">DESC</code>
          (descending) keyword to the name of the column in the
          <code class="literal">ORDER BY</code> clause that you are sorting by.
          The default is ascending order; this can be specified
          explicitly using the <code class="literal">ASC</code> keyword.
        </p><p>
          If <code class="literal">ORDER BY</code> occurs within a subquery and
          also is applied in the outer query, the outermost
          <code class="literal">ORDER BY</code> takes precedence. For example,
          results for the following statement are sorted in descending
          order, not ascending order:
        </p><pre data-lang="sql" class="programlisting">
(SELECT ... ORDER BY a) ORDER BY a DESC;
</pre><p>
          Use of column positions is deprecated because the syntax has
          been removed from the SQL standard.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091665000800"></a>

          Prior to MySQL 8.0.13, MySQL supported a nonstandard syntax
          extension that permitted explicit <code class="literal">ASC</code> or
          <code class="literal">DESC</code> designators for <code class="literal">GROUP
          BY</code> columns. MySQL 8.0.12 and later supports
          <code class="literal">ORDER BY</code> with grouping functions so that
          use of this extension is no longer necessary. (Bug #86312, Bug
          #26073525) This also means you can sort on an arbitrary column
          or columns when using <code class="literal">GROUP BY</code>, like this:
        </p><pre data-lang="sql" class="programlisting">
SELECT a, b, COUNT(c) AS t FROM test_table GROUP BY a,b ORDER BY a,t DESC;
</pre><p>
          As of MySQL 8.0.13, the <code class="literal">GROUP BY</code> extension
          is no longer supported: <code class="literal">ASC</code> or
          <code class="literal">DESC</code> designators for <code class="literal">GROUP
          BY</code> columns are not permitted.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091664990288"></a>

          <a class="indexterm" name="idm140091664988800"></a>

          When you use <code class="literal">ORDER BY</code> or <code class="literal">GROUP
          BY</code> to sort a column in a
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>, the server sorts values
          using only the initial number of bytes indicated by the
          <a class="link" href="server-administration.html#sysvar_max_sort_length"><code class="literal">max_sort_length</code></a> system
          variable.
        </p></li><li class="listitem"><p>
          MySQL extends the use of <code class="literal">GROUP BY</code> to permit
          selecting fields that are not mentioned in the <code class="literal">GROUP
          BY</code> clause. If you are not getting the results that
          you expect from your query, please read the description of
          <code class="literal">GROUP BY</code> found in
          <a class="xref" href="functions.html#group-by-functions-and-modifiers" title="12.20 Aggregate (GROUP BY) Functions">Section 12.20, “Aggregate (GROUP BY) Functions”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">GROUP BY</code> permits a <code class="literal">WITH
          ROLLUP</code> modifier. See
          <a class="xref" href="functions.html#group-by-modifiers" title="12.20.2 GROUP BY Modifiers">Section 12.20.2, “GROUP BY Modifiers”</a>.
        </p><p>
          <a class="indexterm" name="idm140091664976128"></a>

          Previously, it was not permitted to use <code class="literal">ORDER
          BY</code> in a query having a <code class="literal">WITH
          ROLLUP</code> modifier. This restriction is lifted as of
          MySQL 8.0.12. See <a class="xref" href="functions.html#group-by-modifiers" title="12.20.2 GROUP BY Modifiers">Section 12.20.2, “GROUP BY Modifiers”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091664971632"></a>

          The <code class="literal">HAVING</code> clause is applied nearly last,
          just before items are sent to the client, with no
          optimization. (<code class="literal">LIMIT</code> is applied after
          <code class="literal">HAVING</code>.)
        </p><p>
          The SQL standard requires that <code class="literal">HAVING</code> must
          reference only columns in the <code class="literal">GROUP BY</code>
          clause or columns used in aggregate functions. However, MySQL
          supports an extension to this behavior, and permits
          <code class="literal">HAVING</code> to refer to columns in the
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> list and columns in
          outer subqueries as well.
        </p><p>
          If the <code class="literal">HAVING</code> clause refers to a column
          that is ambiguous, a warning occurs. In the following
          statement, <code class="literal">col2</code> is ambiguous because it is
          used as both an alias and a column name:
        </p><pre data-lang="sql" class="programlisting">
SELECT COUNT(col1) AS col2 FROM t GROUP BY col2 HAVING col2 = 2;
</pre><p>
          Preference is given to standard SQL behavior, so if a
          <code class="literal">HAVING</code> column name is used both in
          <code class="literal">GROUP BY</code> and as an aliased column in the
          output column list, preference is given to the column in the
          <code class="literal">GROUP BY</code> column.
        </p></li><li class="listitem"><p>
          Do not use <code class="literal">HAVING</code> for items that should be
          in the <code class="literal">WHERE</code> clause. For example, do not
          write the following:
        </p><pre data-lang="sql" class="programlisting">
SELECT <em class="replaceable"><code>col_name</code></em> FROM <em class="replaceable"><code>tbl_name</code></em> HAVING <em class="replaceable"><code>col_name</code></em> &gt; 0;
</pre><p>
          Write this instead:
        </p><pre data-lang="sql" class="programlisting">
SELECT <em class="replaceable"><code>col_name</code></em> FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>col_name</code></em> &gt; 0;
</pre></li><li class="listitem"><p>
          The <code class="literal">HAVING</code> clause can refer to aggregate
          functions, which the <code class="literal">WHERE</code> clause cannot:
        </p><pre data-lang="sql" class="programlisting">
SELECT user, MAX(salary) FROM users
  GROUP BY user HAVING MAX(salary) &gt; 10;
</pre><p>
          (This did not work in some older versions of MySQL.)
        </p></li><li class="listitem"><p>
          MySQL permits duplicate column names. That is, there can be
          more than one <em class="replaceable"><code>select_expr</code></em> with the
          same name. This is an extension to standard SQL. Because MySQL
          also permits <code class="literal">GROUP BY</code> and
          <code class="literal">HAVING</code> to refer to
          <em class="replaceable"><code>select_expr</code></em> values, this can result
          in an ambiguity:
        </p><pre data-lang="sql" class="programlisting">
SELECT 12 AS a, a FROM t GROUP BY a;
</pre><p>
          In that statement, both columns have the name
          <code class="literal">a</code>. To ensure that the correct column is
          used for grouping, use different names for each
          <em class="replaceable"><code>select_expr</code></em>.
        </p></li><li class="listitem"><p>
          The <code class="literal">WINDOW</code> clause, if present, defines
          named windows that can be referred to by window functions. For
          details, see <a class="xref" href="functions.html#window-functions-named-windows" title="12.21.4 Named Windows">Section 12.21.4, “Named Windows”</a>.
        </p></li><li class="listitem"><p>
          MySQL resolves unqualified column or alias references in
          <code class="literal">ORDER BY</code> clauses by searching in the
          <em class="replaceable"><code>select_expr</code></em> values, then in the
          columns of the tables in the <code class="literal">FROM</code> clause.
          For <code class="literal">GROUP BY</code> or <code class="literal">HAVING</code>
          clauses, it searches the <code class="literal">FROM</code> clause before
          searching in the <em class="replaceable"><code>select_expr</code></em>
          values. (For <code class="literal">GROUP BY</code> and
          <code class="literal">HAVING</code>, this differs from the pre-MySQL 5.0
          behavior that used the same rules as for <code class="literal">ORDER
          BY</code>.)
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091664930480"></a>

          The <code class="literal">LIMIT</code> clause can be used to constrain
          the number of rows returned by the
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
          <code class="literal">LIMIT</code> takes one or two numeric arguments,
          which must both be nonnegative integer constants, with these
          exceptions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Within prepared statements, <code class="literal">LIMIT</code>
              parameters can be specified using <code class="literal">?</code>
              placeholder markers.
            </p></li><li class="listitem"><p>
              Within stored programs, <code class="literal">LIMIT</code>
              parameters can be specified using integer-valued routine
              parameters or local variables.
</p></li></ul>
</div>
<p>
          With two arguments, the first argument specifies the offset of
          the first row to return, and the second specifies the maximum
          number of rows to return. The offset of the initial row is 0
          (not 1):
        </p><pre data-lang="sql" class="programlisting">
SELECT * FROM tbl LIMIT 5,10;  # Retrieve rows 6-15
</pre><p>
          To retrieve all rows from a certain offset up to the end of
          the result set, you can use some large number for the second
          parameter. This statement retrieves all rows from the 96th row
          to the last:
        </p><pre data-lang="sql" class="programlisting">
SELECT * FROM tbl LIMIT 95,18446744073709551615;
</pre><p>
          With one argument, the value specifies the number of rows to
          return from the beginning of the result set:
        </p><pre data-lang="sql" class="programlisting">
SELECT * FROM tbl LIMIT 5;     # Retrieve first 5 rows
</pre><p>
          In other words, <code class="literal">LIMIT
          <em class="replaceable"><code>row_count</code></em></code> is equivalent
          to <code class="literal">LIMIT 0,
          <em class="replaceable"><code>row_count</code></em></code>.
        </p><p>
          For prepared statements, you can use placeholders. The
          following statements will return one row from the
          <code class="literal">tbl</code> table:
        </p><pre data-lang="sql" class="programlisting">
SET @a=1;
PREPARE STMT FROM 'SELECT * FROM tbl LIMIT ?';
EXECUTE STMT USING @a;
</pre><p>
          The following statements will return the second to sixth row
          from the <code class="literal">tbl</code> table:
        </p><pre data-lang="sql" class="programlisting">
SET @skip=1; SET @numrows=5;
PREPARE STMT FROM 'SELECT * FROM tbl LIMIT ?, ?';
EXECUTE STMT USING @skip, @numrows;
</pre><p>
          For compatibility with PostgreSQL, MySQL also supports the
          <code class="literal">LIMIT <em class="replaceable"><code>row_count</code></em> OFFSET
          <em class="replaceable"><code>offset</code></em></code> syntax.
        </p><p>
          If <code class="literal">LIMIT</code> occurs within a subquery and also
          is applied in the outer query, the outermost
          <code class="literal">LIMIT</code> takes precedence. For example, the
          following statement produces two rows, not one:
        </p><pre data-lang="sql" class="programlisting">
(SELECT ... LIMIT 1) LIMIT 2;
</pre></li><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ...
          INTO</code></a> form of <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
          enables the query result to be written to a file or stored in
          variables. For more information, see
          <a class="xref" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax">Section 13.2.10.1, “SELECT ... INTO Syntax”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091664900784"></a>

          <a class="indexterm" name="idm140091664899712"></a>

          <a class="indexterm" name="idm140091664898640"></a>

          <a class="indexterm" name="idm140091664897568"></a>

          <a class="indexterm" name="idm140091664896496"></a>

          If you use <code class="literal">FOR UPDATE</code> with a storage engine
          that uses page or row locks, rows examined by the query are
          write-locked until the end of the current transaction.
        </p><p>
          You cannot use <code class="literal">FOR UPDATE</code> as part of the
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> in a statement such as
          <a class="link" href="sql-syntax.html#create-table-select" title="13.1.20.5 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
          TABLE <em class="replaceable"><code>new_table</code></em> SELECT ... FROM
          <em class="replaceable"><code>old_table</code></em> ...</code></a>. (If you
          attempt to do so, the statement is rejected with the error
          <span class="errortext">Can't update table
          '<em class="replaceable"><code>old_table</code></em>' while
          '<em class="replaceable"><code>new_table</code></em>' is being
          created</span>.)
        </p><p>
          <code class="literal">FOR SHARE</code> and <code class="literal">LOCK IN SHARE
          MODE</code> set shared locks that permit other transactions
          to read the examined rows but not to update or delete them.
          <code class="literal">FOR SHARE</code> and <code class="literal">LOCK IN SHARE
          MODE</code> are equivalent. However, <code class="literal">FOR
          SHARE</code>, like <code class="literal">FOR UPDATE</code>, supports
          <code class="literal">NOWAIT</code>, <code class="literal">SKIP LOCKED</code>, and
          <code class="literal">OF <em class="replaceable"><code>tbl_name</code></em></code>
          options. <code class="literal">FOR SHARE</code> is a replacement for
          <code class="literal">LOCK IN SHARE MODE</code>, but <code class="literal">LOCK IN
          SHARE MODE</code> remains available for backward
          compatibility.
        </p><p>
          <code class="literal">NOWAIT</code> causes a <code class="literal">FOR
          UPDATE</code> or <code class="literal">FOR SHARE</code> query to
          execute immediately, returning an error if a row lock cannot
          be obtained due to a lock held by another transaction.
        </p><p>
          <code class="literal">SKIP LOCKED</code> causes a <code class="literal">FOR
          UPDATE</code> or <code class="literal">FOR SHARE</code> query to
          execute immediately, excluding rows from the result set that
          are locked by another transaction.
        </p><p>
          <code class="literal">NOWAIT</code> and <code class="literal">SKIP LOCKED</code>
          options are unsafe for statement-based replication.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Queries that skip locked rows return an inconsistent view of
            the data. <code class="literal">SKIP LOCKED</code> is therefore not
            suitable for general transactional work. However, it may be
            used to avoid lock contention when multiple sessions access
            the same queue-like table.
</p>
</div>
<p>
          <code class="literal">OF <em class="replaceable"><code>tbl_name</code></em></code>
          applies <code class="literal">FOR UPDATE</code> and <code class="literal">FOR
          SHARE</code> queries to named tables. For example:
        </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1, t2 FOR SHARE OF t1 FOR UPDATE OF t2;              
</pre><p>
          All tables referenced by the query block are locked when
          <code class="literal">OF <em class="replaceable"><code>tbl_name</code></em></code> is
          omitted. Consequently, using a locking clause without
          <code class="literal">OF <em class="replaceable"><code>tbl_name</code></em></code> in
          combination with another locking clause returns an error.
          Specifying the same table in multiple locking clauses returns
          an error. If an alias is specified as the table name in the
          <code class="literal">SELECT</code> statement, a locking clause may only
          use the alias. If the <code class="literal">SELECT</code> statement does
          not specify an alias explicitly, the locking clause may only
          specify the actual table name.
        </p><p>
          For more information about <code class="literal">FOR UPDATE</code> and
          <code class="literal">FOR SHARE</code>, see
          <a class="xref" href="innodb-storage-engine.html#innodb-locking-reads" title="15.7.2.4 Locking Reads">Section 15.7.2.4, “Locking Reads”</a>. For additional
          information about <code class="literal">NOWAIT</code> and <code class="literal">SKIP
          LOCKED</code> options, see
          <a class="xref" href="innodb-storage-engine.html#innodb-locking-reads-nowait-skip-locked" title="Locking Read Concurrency with NOWAIT and SKIP LOCKED">Locking Read Concurrency with NOWAIT and SKIP LOCKED</a>.
</p></li></ul>
</div>
<p>
      Following the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> keyword, you
      can use a number of modifiers that affect the operation of the
      statement. <code class="literal">HIGH_PRIORITY</code>,
      <code class="literal">STRAIGHT_JOIN</code>, and modifiers beginning with
      <code class="literal">SQL_</code> are MySQL extensions to standard SQL.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The <code class="literal">ALL</code> and <code class="literal">DISTINCT</code>
          modifiers specify whether duplicate rows should be returned.
          <code class="literal">ALL</code> (the default) specifies that all
          matching rows should be returned, including duplicates.
          <code class="literal">DISTINCT</code> specifies removal of duplicate
          rows from the result set. It is an error to specify both
          modifiers. <code class="literal">DISTINCTROW</code> is a synonym for
          <code class="literal">DISTINCT</code>.
        </p><p>
          In MySQL 8.0.12 and later, <code class="literal">DISTINCT</code> can be
          used with a query that also uses <code class="literal">WITH
          ROLLUP</code>. (Bug #87450, Bug #26640100)
        </p><a class="indexterm" name="idm140091664845216"></a><a class="indexterm" name="idm140091664843760"></a><a class="indexterm" name="idm140091664842272"></a></li><li class="listitem"><p>
          <code class="literal">HIGH_PRIORITY</code> gives the
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> higher priority than a
          statement that updates a table. You should use this only for
          queries that are very fast and must be done at once. A
          <code class="literal">SELECT HIGH_PRIORITY</code> query that is issued
          while the table is locked for reading runs even if there is an
          update statement waiting for the table to be free. This
          affects only storage engines that use only table-level locking
          (such as <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>,
          and <code class="literal">MERGE</code>).
        </p><a class="indexterm" name="idm140091664834816"></a><p>
          <code class="literal">HIGH_PRIORITY</code> cannot be used with
          <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements that are part
          of a <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a>.
        </p></li><li class="listitem"><p>
          <code class="literal">STRAIGHT_JOIN</code> forces the optimizer to join
          the tables in the order in which they are listed in the
          <code class="literal">FROM</code> clause. You can use this to speed up a
          query if the optimizer joins the tables in nonoptimal order.
          <code class="literal">STRAIGHT_JOIN</code> also can be used in the
          <em class="replaceable"><code>table_references</code></em> list. See
          <a class="xref" href="sql-syntax.html#join" title="13.2.10.2 JOIN Syntax">Section 13.2.10.2, “JOIN Syntax”</a>.
        </p><a class="indexterm" name="idm140091664825440"></a><a class="indexterm" name="idm140091664823952"></a><a class="indexterm" name="idm140091664822464"></a><p>
          <code class="literal">STRAIGHT_JOIN</code> does not apply to any table
          that the optimizer treats as a
          <a class="link" href="optimization.html#jointype_const"><code class="literal">const</code></a> or
          <a class="link" href="optimization.html#jointype_system"><code class="literal">system</code></a> table. Such a table
          produces a single row, is read during the optimization phase
          of query execution, and references to its columns are replaced
          with the appropriate column values before query execution
          proceeds. These tables will appear first in the query plan
          displayed by <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>. See
          <a class="xref" href="optimization.html#using-explain" title="8.8.1 Optimizing Queries with EXPLAIN">Section 8.8.1, “Optimizing Queries with EXPLAIN”</a>. This exception may not apply
          to <a class="link" href="optimization.html#jointype_const"><code class="literal">const</code></a> or
          <a class="link" href="optimization.html#jointype_system"><code class="literal">system</code></a> tables that are used
          on the <code class="literal">NULL</code>-complemented side of an outer
          join (that is, the right-side table of a <code class="literal">LEFT
          JOIN</code> or the left-side table of a <code class="literal">RIGHT
          JOIN</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">SQL_BIG_RESULT</code> or
          <code class="literal">SQL_SMALL_RESULT</code> can be used with
          <code class="literal">GROUP BY</code> or <code class="literal">DISTINCT</code> to
          tell the optimizer that the result set has many rows or is
          small, respectively. For <code class="literal">SQL_BIG_RESULT</code>,
          MySQL directly uses disk-based temporary tables if they are
          created, and prefers sorting to using a temporary table with a
          key on the <code class="literal">GROUP BY</code> elements. For
          <code class="literal">SQL_SMALL_RESULT</code>, MySQL uses in-memory
          temporary tables to store the resulting table instead of using
          sorting. This should not normally be needed.
        </p><a class="indexterm" name="idm140091664804160"></a><a class="indexterm" name="idm140091664802672"></a></li><li class="listitem"><p>
          <code class="literal">SQL_BUFFER_RESULT</code> forces the result to be
          put into a temporary table. This helps MySQL free the table
          locks early and helps in cases where it takes a long time to
          send the result set to the client. This modifier can be used
          only for top-level <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
          statements, not for subqueries or following
          <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a>.
        </p><a class="indexterm" name="idm140091664796928"></a></li><li class="listitem"><p>
          <code class="literal">SQL_CALC_FOUND_ROWS</code> tells MySQL to
          calculate how many rows there would be in the result set,
          disregarding any <code class="literal">LIMIT</code> clause. The number
          of rows can then be retrieved with <code class="literal">SELECT
          FOUND_ROWS()</code>. See
          <a class="xref" href="functions.html#information-functions" title="12.15 Information Functions">Section 12.15, “Information Functions”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The <code class="literal">SQL_CALC_FOUND_ROWS</code> query modifier
            and accompanying <a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a>
            function are deprecated as of MySQL 8.0.17 and will be
            removed in a future MySQL version. See the
            <a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a> description for
            information about an alternative strategy.
</p>
</div>
<a class="indexterm" name="idm140091664787488"></a></li><li class="listitem"><p>
          The <code class="literal">SQL_CACHE</code> and
          <code class="literal">SQL_NO_CACHE</code> modifiers were used with the
          query cache prior to MySQL 8.0. The query cache
          was removed in MySQL 8.0. The
          <code class="literal">SQL_CACHE</code> modifier was removed as well.
          <code class="literal">SQL_NO_CACHE</code> is deprecated, has no effect,
          and will be removed in a future MySQL release.
</p><a class="indexterm" name="idm140091664782080"></a><a class="indexterm" name="idm140091664780592"></a></li></ul>
</div>
<p>
      A <code class="literal">SELECT</code> from a partitioned table using a
      storage engine such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that
      employs table-level locks locks only those partitions containing
      rows that match the <code class="literal">SELECT</code> statement
      <code class="literal">WHERE</code> clause. (This does not occur with storage
      engines such as <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that employ
      row-level locking.) For more information, see
      <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/partitioning-limitations-locking.html" target="_top">Partitioning and Locking</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="select-into"></a>13.2.10.1 SELECT ... INTO Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091664771680"></a><a class="indexterm" name="idm140091664770192"></a><p>
        The <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ...
        INTO</code></a> form of <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        enables a query result to be stored in variables or written to a
        file:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">SELECT ... INTO
            <em class="replaceable"><code>var_list</code></em></code> selects column
            values and stores them into variables.
          </p></li><li class="listitem"><p>
            <code class="literal">SELECT ... INTO OUTFILE</code> writes the
            selected rows to a file. Column and line terminators can be
            specified to produce a specific output format.
          </p></li><li class="listitem"><p>
            <code class="literal">SELECT ... INTO DUMPFILE</code> writes a single
            row to a file without any formatting.
</p></li></ul>
</div>
<p>
        The <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> syntax description
        (see <a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax">Section 13.2.10, “SELECT Syntax”</a>) shows the <code class="literal">INTO</code>
        clause near the end of the statement. It is also possible to use
        <code class="literal">INTO</code> immediately following the
        <em class="replaceable"><code>select_expr</code></em> list.
      </p><p>
        An <code class="literal">INTO</code> clause should not be used in a nested
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> because such a
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> must return its result to
        the outer context.
      </p><p>
        The <code class="literal">INTO</code> clause can name a list of one or
        more variables, which can be user-defined variables, stored
        procedure or function parameters, or stored program local
        variables. (Within a prepared <code class="literal">SELECT ... INTO
        OUTFILE</code> statement, only user-defined variables are
        permitted;see <a class="xref" href="sql-syntax.html#local-variable-scope" title="13.6.4.2 Local Variable Scope and Resolution">Section 13.6.4.2, “Local Variable Scope and Resolution”</a>.)
      </p><p>
        The selected values are assigned to the variables. The number of
        variables must match the number of columns. The query should
        return a single row. If the query returns no rows, a warning
        with error code 1329 occurs (<code class="literal">No data</code>), and
        the variable values remain unchanged. If the query returns
        multiple rows, error 1172 occurs (<code class="literal">Result consisted of
        more than one row</code>). If it is possible that the
        statement may retrieve multiple rows, you can use <code class="literal">LIMIT
        1</code> to limit the result set to a single row.
      </p><pre data-lang="sql" class="programlisting">
SELECT id, data INTO @x, @y FROM test.t1 LIMIT 1;
</pre><p>
        User variable names are not case-sensitive. See
        <a class="xref" href="language-structure.html#user-variables" title="9.4 User-Defined Variables">Section 9.4, “User-Defined Variables”</a>.
      </p><a class="indexterm" name="idm140091664744192"></a><a class="indexterm" name="idm140091664743120"></a><p>
        The <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE '<em class="replaceable"><code>file_name</code></em>'</code></a> form of
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> writes the selected rows
        to a file. The file is created on the server host, so you must
        have the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege to use
        this syntax. <em class="replaceable"><code>file_name</code></em> cannot be an
        existing file, which among other things prevents files such as
        <code class="filename">/etc/passwd</code> and database tables from being
        destroyed. The
        <a class="link" href="server-administration.html#sysvar_character_set_filesystem"><code class="literal">character_set_filesystem</code></a> system
        variable controls the interpretation of the file name.
      </p><p>
        The <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE</code></a> statement is intended primarily to let you
        very quickly dump a table to a text file on the server machine.
        If you want to create the resulting file on some other host than
        the server host, you normally cannot use
        <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE</code></a> since there is no way to write a path to the
        file relative to the server host's file system.
      </p><p>
        However, if the MySQL client software is installed on the remote
        machine, you can instead use a client command such as
        <code class="literal">mysql -e "SELECT ..." &gt;
        <em class="replaceable"><code>file_name</code></em></code> to generate the
        file on the client host.
      </p><p>
        It is also possible to create the resulting file on a different
        host other than the server host, if the location of the file on
        the remote host can be accessed using a network-mapped path on
        the server's file system. In this case, the presence of
        <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> (or some other MySQL client program) is
        not required on the target host.
      </p><p>
        <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE</code></a> is the complement of <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
        DATA</code></a>. Column values are written converted to the
        character set specified in the <code class="literal">CHARACTER SET</code>
        clause. If no such clause is present, values are dumped using
        the <code class="literal">binary</code> character set. In effect, there is
        no character set conversion. If a result set contains columns in
        several character sets, the output data file will as well and
        you may not be able to reload the file correctly.
      </p><p>
        The syntax for the <em class="replaceable"><code>export_options</code></em>
        part of the statement consists of the same
        <code class="literal">FIELDS</code> and <code class="literal">LINES</code> clauses
        that are used with the <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>
        statement. See <a class="xref" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax">Section 13.2.7, “LOAD DATA Syntax”</a>, for information
        about the <code class="literal">FIELDS</code> and <code class="literal">LINES</code>
        clauses, including their default values and permissible values.
      </p><p>
        <code class="literal">FIELDS ESCAPED BY</code> controls how to write
        special characters. If the <code class="literal">FIELDS ESCAPED BY</code>
        character is not empty, it is used when necessary to avoid
        ambiguity as a prefix that precedes following characters on
        output:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The <code class="literal">FIELDS ESCAPED BY</code> character
          </p></li><li class="listitem"><p>
            The <code class="literal">FIELDS [OPTIONALLY] ENCLOSED BY</code>
            character
          </p></li><li class="listitem"><p>
            The first character of the <code class="literal">FIELDS TERMINATED
            BY</code> and <code class="literal">LINES TERMINATED BY</code>
            values
          </p></li><li class="listitem"><p>
            ASCII <code class="literal">NUL</code> (the zero-valued byte; what is
            actually written following the escape character is ASCII
            <code class="literal">0</code>, not a zero-valued byte)
</p></li></ul>
</div>
<p>
        The <code class="literal">FIELDS TERMINATED BY</code>, <code class="literal">ENCLOSED
        BY</code>, <code class="literal">ESCAPED BY</code>, or <code class="literal">LINES
        TERMINATED BY</code> characters <span class="emphasis"><em>must</em></span> be
        escaped so that you can read the file back in reliably. ASCII
        <code class="literal">NUL</code> is escaped to make it easier to view with
        some pagers.
      </p><p>
        The resulting file does not have to conform to SQL syntax, so
        nothing else need be escaped.
      </p><p>
        If the <code class="literal">FIELDS ESCAPED BY</code> character is empty,
        no characters are escaped and <code class="literal">NULL</code> is output
        as <code class="literal">NULL</code>, not <code class="literal">\N</code>. It is
        probably not a good idea to specify an empty escape character,
        particularly if field values in your data contain any of the
        characters in the list just given.
      </p><a class="indexterm" name="idm140091664698832"></a><a class="indexterm" name="idm140091664697760"></a><p>
        Here is an example that produces a file in the comma-separated
        values (CSV) format used by many programs:
      </p><pre data-lang="sql" class="programlisting">
SELECT a,b,a+b INTO OUTFILE '/tmp/result.txt'
  FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
  LINES TERMINATED BY '\n'
  FROM test_table;
</pre><a class="indexterm" name="idm140091664695088"></a><p>
        If you use <code class="literal">INTO DUMPFILE</code> instead of
        <code class="literal">INTO OUTFILE</code>, MySQL writes only one row into
        the file, without any column or line termination and without
        performing any escape processing. This is useful if you want to
        store a <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> value in a file.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Any file created by <code class="literal">INTO OUTFILE</code> or
          <code class="literal">INTO DUMPFILE</code> is owned by the operating
          system user under whose account <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> run.
          (You should <span class="emphasis"><em>never</em></span> run
          <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> as <code class="literal">root</code> for this
          and other reasons.) As of MySQL 8.0.17, the umask for file
          creation is 0640; you must have sufficient access privileges
          to manipulate the file contents. Prior to MySQL 8.0.17, the
          umask is 0666 and the file is writable by all users on the
          server host.
        </p><p>
          If the <a class="link" href="server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a>
          system variable is set to a nonempty directory name, the file
          to be written must be located in that directory.
</p>
</div>
<p>
        In the context of
        <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ...
        INTO</code></a> statements that occur as part of events executed
        by the Event Scheduler, diagnostics messages (not only errors,
        but also warnings) are written to the error log, and, on
        Windows, to the application event log. For additional
        information, see <a class="xref" href="stored-objects.html#events-status-info" title="24.4.5 Event Scheduler Status">Section 24.4.5, “Event Scheduler Status”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="join"></a>13.2.10.2 JOIN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091664678880"></a><a class="indexterm" name="idm140091664677808"></a><a class="indexterm" name="idm140091664676736"></a><a class="indexterm" name="idm140091664675664"></a><a class="indexterm" name="idm140091664674592"></a><a class="indexterm" name="idm140091664673520"></a><a class="indexterm" name="idm140091664672448"></a><a class="indexterm" name="idm140091664671376"></a><a class="indexterm" name="idm140091664670304"></a><a class="indexterm" name="idm140091664669232"></a><a class="indexterm" name="idm140091664668160"></a><a class="indexterm" name="idm140091664667088"></a><a class="indexterm" name="idm140091664666016"></a><a class="indexterm" name="idm140091664664928"></a><a class="indexterm" name="idm140091664663856"></a><p>
        MySQL supports the following <code class="literal">JOIN</code> syntax for
        the <em class="replaceable"><code>table_references</code></em> part of
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements and
        multiple-table <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> and
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements:
      </p><pre data-lang="sql" class="programlisting">
<em class="replaceable"><code>table_references:</code></em>
    <em class="replaceable"><code>escaped_table_reference</code></em> [, <em class="replaceable"><code>escaped_table_reference</code></em>] ...

<em class="replaceable"><code>escaped_table_reference</code></em>:
    <em class="replaceable"><code>table_reference</code></em>
  | { OJ <em class="replaceable"><code>table_reference</code></em> }

<em class="replaceable"><code>table_reference</code></em>:
    <em class="replaceable"><code>table_factor</code></em>
  | <em class="replaceable"><code>joined_table</code></em>

<em class="replaceable"><code>table_factor</code></em>:
    <em class="replaceable"><code>tbl_name</code></em> [PARTITION (<em class="replaceable"><code>partition_names</code></em>)]
        [[AS] <em class="replaceable"><code>alias</code></em>] [<em class="replaceable"><code>index_hint_list</code></em>]
  | <em class="replaceable"><code>table_subquery</code></em> [AS] <em class="replaceable"><code>alias</code></em> [(<em class="replaceable"><code>col_list</code></em>)]
  | ( <em class="replaceable"><code>table_references</code></em> )

<em class="replaceable"><code>joined_table</code></em>:
    <em class="replaceable"><code>table_reference</code></em> {[INNER | CROSS] JOIN | STRAIGHT_JOIN} <em class="replaceable"><code>table_factor</code></em> [<em class="replaceable"><code>join_specification</code></em>]
  | <em class="replaceable"><code>table_reference</code></em> {LEFT|RIGHT} [OUTER] JOIN <em class="replaceable"><code>table_reference</code></em> <em class="replaceable"><code>join_specification</code></em>
  | <em class="replaceable"><code>table_reference</code></em> NATURAL [INNER | {LEFT|RIGHT} [OUTER]] JOIN <em class="replaceable"><code>table_factor</code></em>

<em class="replaceable"><code>join_specification</code></em>:
    ON <em class="replaceable"><code>search_condition</code></em>
  | USING (<em class="replaceable"><code>join_column_list</code></em>)

<em class="replaceable"><code>join_column_list</code></em>:
    <em class="replaceable"><code>column_name</code></em> [, <em class="replaceable"><code>column_name</code></em>] ...

<em class="replaceable"><code>index_hint_list</code></em>:
    <em class="replaceable"><code>index_hint</code></em> [, <em class="replaceable"><code>index_hint</code></em>] ...

<em class="replaceable"><code>index_hint</code></em>:
    USE {INDEX|KEY}
      [FOR {JOIN|ORDER BY|GROUP BY}] ([<em class="replaceable"><code>index_list</code></em>])
  | {IGNORE|FORCE} {INDEX|KEY}
      [FOR {JOIN|ORDER BY|GROUP BY}] (<em class="replaceable"><code>index_list</code></em>)

<em class="replaceable"><code>index_list</code></em>:
    <em class="replaceable"><code>index_name</code></em> [, <em class="replaceable"><code>index_name</code></em>] ...
</pre><p>
        A table reference is also known as a join expression.
      </p><p>
        A table reference (when it refers to a partitioned table) may
        contain a <code class="literal">PARTITION</code> option, including a list
        of comma-separated partitions, subpartitions, or both. This
        option follows the name of the table and precedes any alias
        declaration. The effect of this option is that rows are selected
        only from the listed partitions or subpartitions. Any partitions
        or subpartitions not named in the list are ignored. For more
        information and examples, see
        <a class="xref" href="partitioning.html#partitioning-selection" title="23.5 Partition Selection">Section 23.5, “Partition Selection”</a>.
      </p><p>
        The syntax of <em class="replaceable"><code>table_factor</code></em> is
        extended in MySQL in comparison with standard SQL. The standard
        accepts only <em class="replaceable"><code>table_reference</code></em>, not a
        list of them inside a pair of parentheses.
      </p><p>
        This is a conservative extension if each comma in a list of
        <em class="replaceable"><code>table_reference</code></em> items is considered
        as equivalent to an inner join. For example:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 LEFT JOIN (t2, t3, t4)
                 ON (t2.a = t1.a AND t3.b = t1.b AND t4.c = t1.c)
</pre><p>
        is equivalent to:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 LEFT JOIN (t2 CROSS JOIN t3 CROSS JOIN t4)
                 ON (t2.a = t1.a AND t3.b = t1.b AND t4.c = t1.c)
</pre><p>
        In MySQL, <code class="literal">JOIN</code>, <code class="literal">CROSS
        JOIN</code>, and <code class="literal">INNER JOIN</code> are syntactic
        equivalents (they can replace each other). In standard SQL, they
        are not equivalent. <code class="literal">INNER JOIN</code> is used with
        an <code class="literal">ON</code> clause, <code class="literal">CROSS JOIN</code>
        is used otherwise.
      </p><p>
        In general, parentheses can be ignored in join expressions
        containing only inner join operations. MySQL also supports
        nested joins. See <a class="xref" href="optimization.html#nested-join-optimization" title="8.2.1.7 Nested Join Optimization">Section 8.2.1.7, “Nested Join Optimization”</a>.
      </p><p>
        Index hints can be specified to affect how the MySQL optimizer
        makes use of indexes. For more information, see
        <a class="xref" href="optimization.html#index-hints" title="8.9.4 Index Hints">Section 8.9.4, “Index Hints”</a>. Optimizer hints and the
        <code class="literal">optimizer_switch</code> system variable are other
        ways to influence optimizer use of indexes. See
        <a class="xref" href="optimization.html#optimizer-hints" title="8.9.3 Optimizer Hints">Section 8.9.3, “Optimizer Hints”</a>, and
        <a class="xref" href="optimization.html#switchable-optimizations" title="8.9.2 Switchable Optimizations">Section 8.9.2, “Switchable Optimizations”</a>.
      </p><p>
        The following list describes general factors to take into
        account when writing joins:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A table reference can be aliased using
            <code class="literal"><em class="replaceable"><code>tbl_name</code></em> AS
            <em class="replaceable"><code>alias_name</code></em></code> or
            <em class="replaceable"><code>tbl_name alias_name</code></em>:
          </p><pre data-lang="sql" class="programlisting">
SELECT t1.name, t2.salary
  FROM employee AS t1 INNER JOIN info AS t2 ON t1.name = t2.name;

SELECT t1.name, t2.salary
  FROM employee t1 INNER JOIN info t2 ON t1.name = t2.name;
</pre></li><li class="listitem"><p>
            A <em class="replaceable"><code>table_subquery</code></em> is also known as
            a derived table or subquery in the <code class="literal">FROM</code>
            clause. See <a class="xref" href="sql-syntax.html#derived-tables" title="13.2.11.8 Derived Tables">Section 13.2.11.8, “Derived Tables”</a>. Such
            subqueries <span class="emphasis"><em>must</em></span> include an alias to
            give the subquery result a table name, and may optionally
            include a list of table column names in parentheses. A
            trivial example follows:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM (SELECT 1, 2, 3) AS t1;
</pre></li><li class="listitem"><p>
            <code class="literal">INNER JOIN</code> and <code class="literal">,</code>
            (comma) are semantically equivalent in the absence of a join
            condition: both produce a Cartesian product between the
            specified tables (that is, each and every row in the first
            table is joined to each and every row in the second table).
          </p><p>
            However, the precedence of the comma operator is less than
            that of <code class="literal">INNER JOIN</code>, <code class="literal">CROSS
            JOIN</code>, <code class="literal">LEFT JOIN</code>, and so on. If
            you mix comma joins with the other join types when there is
            a join condition, an error of the form <code class="literal">Unknown
            column '<em class="replaceable"><code>col_name</code></em>' in 'on
            clause'</code> may occur. Information about dealing with
            this problem is given later in this section.
          </p></li><li class="listitem"><p>
            The <em class="replaceable"><code>search_condition</code></em> used with
            <code class="literal">ON</code> is any conditional expression of the
            form that can be used in a <code class="literal">WHERE</code> clause.
            Generally, the <code class="literal">ON</code> clause serves for
            conditions that specify how to join tables, and the
            <code class="literal">WHERE</code> clause restricts which rows to
            include in the result set.
          </p></li><li class="listitem"><p>
            If there is no matching row for the right table in the
            <code class="literal">ON</code> or <code class="literal">USING</code> part in a
            <code class="literal">LEFT JOIN</code>, a row with all columns set to
            <code class="literal">NULL</code> is used for the right table. You can
            use this fact to find rows in a table that have no
            counterpart in another table:
          </p><pre data-lang="sql" class="programlisting">
SELECT left_tbl.*
  FROM left_tbl LEFT JOIN right_tbl ON left_tbl.id = right_tbl.id
  WHERE right_tbl.id IS NULL;
</pre><p>
            This example finds all rows in <code class="literal">left_tbl</code>
            with an <code class="literal">id</code> value that is not present in
            <code class="literal">right_tbl</code> (that is, all rows in
            <code class="literal">left_tbl</code> with no corresponding row in
            <code class="literal">right_tbl</code>). See
            <a class="xref" href="optimization.html#outer-join-optimization" title="8.2.1.8 Outer Join Optimization">Section 8.2.1.8, “Outer Join Optimization”</a>.
          </p></li><li class="listitem"><p>
            The
            <code class="literal">USING(<em class="replaceable"><code>join_column_list</code></em>)</code>
            clause names a list of columns that must exist in both
            tables. If tables <code class="literal">a</code> and
            <code class="literal">b</code> both contain columns
            <code class="literal">c1</code>, <code class="literal">c2</code>, and
            <code class="literal">c3</code>, the following join compares
            corresponding columns from the two tables:
          </p><pre data-lang="sql" class="programlisting">
a LEFT JOIN b USING (c1, c2, c3)
</pre></li><li class="listitem"><p>
            The <code class="literal">NATURAL [LEFT] JOIN</code> of two tables is
            defined to be semantically equivalent to an <code class="literal">INNER
            JOIN</code> or a <code class="literal">LEFT JOIN</code> with a
            <code class="literal">USING</code> clause that names all columns that
            exist in both tables.
          </p></li><li class="listitem"><p>
            <code class="literal">RIGHT JOIN</code> works analogously to
            <code class="literal">LEFT JOIN</code>. To keep code portable across
            databases, it is recommended that you use <code class="literal">LEFT
            JOIN</code> instead of <code class="literal">RIGHT JOIN</code>.
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm140091664573760"></a>

            <a class="indexterm" name="idm140091664572688"></a>

            The <code class="literal">{ OJ ... }</code> syntax shown in the join
            syntax description exists only for compatibility with ODBC.
            The curly braces in the syntax should be written literally;
            they are not metasyntax as used elsewhere in syntax
            descriptions.
          </p><pre data-lang="sql" class="programlisting">
SELECT left_tbl.*
    FROM { OJ left_tbl LEFT OUTER JOIN right_tbl
           ON left_tbl.id = right_tbl.id }
    WHERE right_tbl.id IS NULL;
</pre><p>
            You can use other types of joins within <code class="literal">{ OJ ...
            }</code>, such as <code class="literal">INNER JOIN</code> or
            <code class="literal">RIGHT OUTER JOIN</code>. This helps with
            compatibility with some third-party applications, but is not
            official ODBC syntax.
          </p></li><li class="listitem"><p>
            <code class="literal">STRAIGHT_JOIN</code> is similar to
            <code class="literal">JOIN</code>, except that the left table is
            always read before the right table. This can be used for
            those (few) cases for which the join optimizer processes the
            tables in a suboptimal order.
</p></li></ul>
</div>
<p>
        Some join examples:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM table1, table2;

SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.id;

SELECT * FROM table1 LEFT JOIN table2 ON table1.id = table2.id;

SELECT * FROM table1 LEFT JOIN table2 USING (id);

SELECT * FROM table1 LEFT JOIN table2 ON table1.id = table2.id
  LEFT JOIN table3 ON table2.id = table3.id;
</pre><p>
        Natural joins and joins with <code class="literal">USING</code>, including
        outer join variants, are processed according to the SQL:2003
        standard:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Redundant columns of a <code class="literal">NATURAL</code> join do
            not appear. Consider this set of statements:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (i INT, j INT);
CREATE TABLE t2 (k INT, j INT);
INSERT INTO t1 VALUES(1, 1);
INSERT INTO t2 VALUES(1, 1);
SELECT * FROM t1 NATURAL JOIN t2;
SELECT * FROM t1 JOIN t2 USING (j);
</pre><p>
            In the first <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
            statement, column <code class="literal">j</code> appears in both
            tables and thus becomes a join column, so, according to
            standard SQL, it should appear only once in the output, not
            twice. Similarly, in the second SELECT statement, column
            <code class="literal">j</code> is named in the
            <code class="literal">USING</code> clause and should appear only once
            in the output, not twice.
          </p><p>
            Thus, the statements produce this output:
          </p><pre data-lang="none" class="programlisting">
+------+------+------+
| j    | i    | k    |
+------+------+------+
|    1 |    1 |    1 |
+------+------+------+
+------+------+------+
| j    | i    | k    |
+------+------+------+
|    1 |    1 |    1 |
+------+------+------+
</pre><p>
            Redundant column elimination and column ordering occurs
            according to standard SQL, producing this display order:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                First, coalesced common columns of the two joined
                tables, in the order in which they occur in the first
                table
              </p></li><li class="listitem"><p>
                Second, columns unique to the first table, in order in
                which they occur in that table
              </p></li><li class="listitem"><p>
                Third, columns unique to the second table, in order in
                which they occur in that table
</p></li></ul>
</div>
<p>
            The single result column that replaces two common columns is
            defined using the coalesce operation. That is, for two
            <code class="literal">t1.a</code> and <code class="literal">t2.a</code> the
            resulting single join column <code class="literal">a</code> is defined
            as <code class="literal">a = COALESCE(t1.a, t2.a)</code>, where:
          </p><pre data-lang="sql" class="programlisting">
COALESCE(x, y) = (CASE WHEN x IS NOT NULL THEN x ELSE y END)
</pre><p>
            If the join operation is any other join, the result columns
            of the join consist of the concatenation of all columns of
            the joined tables.
          </p><p>
            A consequence of the definition of coalesced columns is
            that, for outer joins, the coalesced column contains the
            value of the non-<code class="literal">NULL</code> column if one of
            the two columns is always <code class="literal">NULL</code>. If
            neither or both columns are <code class="literal">NULL</code>, both
            common columns have the same value, so it doesn't matter
            which one is chosen as the value of the coalesced column. A
            simple way to interpret this is to consider that a coalesced
            column of an outer join is represented by the common column
            of the inner table of a <code class="literal">JOIN</code>. Suppose
            that the tables <code class="literal">t1(a, b)</code> and
            <code class="literal">t2(a, c)</code> have the following contents:
          </p><pre data-lang="none" class="programlisting">
t1    t2
----  ----
1 x   2 z
2 y   3 w
</pre><p>
            Then, for this join, column <code class="literal">a</code> contains
            the values of <code class="literal">t1.a</code>:
          </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1 NATURAL LEFT JOIN t2;</code></strong>
+------+------+------+
| a    | b    | c    |
+------+------+------+
|    1 | x    | NULL |
|    2 | y    | z    |
+------+------+------+
</pre><p>
            By contrast, for this join, column <code class="literal">a</code>
            contains the values of <code class="literal">t2.a</code>.
          </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1 NATURAL RIGHT JOIN t2;</code></strong>
+------+------+------+
| a    | c    | b    |
+------+------+------+
|    2 | z    | y    |
|    3 | w    | NULL |
+------+------+------+
</pre><p>
            Compare those results to the otherwise equivalent queries
            with <code class="literal">JOIN ... ON</code>:
          </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1 LEFT JOIN t2 ON (t1.a = t2.a);</code></strong>
+------+------+------+------+
| a    | b    | a    | c    |
+------+------+------+------+
|    1 | x    | NULL | NULL |
|    2 | y    |    2 | z    |
+------+------+------+------+
</pre><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1 RIGHT JOIN t2 ON (t1.a = t2.a);</code></strong>
+------+------+------+------+
| a    | b    | a    | c    |
+------+------+------+------+
|    2 | y    |    2 | z    |
| NULL | NULL |    3 | w    |
+------+------+------+------+
</pre></li><li class="listitem"><p>
            A <code class="literal">USING</code> clause can be rewritten as an
            <code class="literal">ON</code> clause that compares corresponding
            columns. However, although <code class="literal">USING</code> and
            <code class="literal">ON</code> are similar, they are not quite the
            same. Consider the following two queries:
          </p><a class="indexterm" name="idm140091664521056"></a><a class="indexterm" name="idm140091664519568"></a><a class="indexterm" name="idm140091664518080"></a><pre data-lang="sql" class="programlisting">
a LEFT JOIN b USING (c1, c2, c3)
a LEFT JOIN b ON a.c1 = b.c1 AND a.c2 = b.c2 AND a.c3 = b.c3
</pre><p>
            With respect to determining which rows satisfy the join
            condition, both joins are semantically identical.
          </p><p>
            With respect to determining which columns to display for
            <code class="literal">SELECT *</code> expansion, the two joins are not
            semantically identical. The <code class="literal">USING</code> join
            selects the coalesced value of corresponding columns,
            whereas the <code class="literal">ON</code> join selects all columns
            from all tables. For the <code class="literal">USING</code> join,
            <code class="literal">SELECT *</code> selects these values:
          </p><pre data-lang="sql" class="programlisting">
COALESCE(a.c1, b.c1), COALESCE(a.c2, b.c2), COALESCE(a.c3, b.c3)
</pre><p>
            For the <code class="literal">ON</code> join, <code class="literal">SELECT
            *</code> selects these values:
          </p><pre data-lang="none" class="programlisting">
a.c1, a.c2, a.c3, b.c1, b.c2, b.c3
</pre><p>
            With an inner join, <a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE(a.c1,
            b.c1)</code></a> is the same as either
            <code class="literal">a.c1</code> or <code class="literal">b.c1</code> because
            both columns will have the same value. With an outer join
            (such as <code class="literal">LEFT JOIN</code>), one of the two
            columns can be <code class="literal">NULL</code>. That column is
            omitted from the result.
          </p></li><li class="listitem"><p>
            An <code class="literal">ON</code> clause can refer only to its
            operands.
          </p><p>
            Example:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (i1 INT);
CREATE TABLE t2 (i2 INT);
CREATE TABLE t3 (i3 INT);
SELECT * FROM t1 JOIN t2 ON (i1 = i3) JOIN t3;
</pre><p>
            The statement fails with an <code class="literal">Unknown column 'i3' in
            'on clause'</code> error because <code class="literal">i3</code> is
            a column in <code class="literal">t3</code>, which is not an operand
            of the <code class="literal">ON</code> clause. To enable the join to
            be processed, rewrite the statement as follows:
          </p><a class="indexterm" name="idm140091664495856"></a><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 JOIN t2 JOIN t3 ON (i1 = i3);
</pre></li><li class="listitem"><p>
            <code class="literal">JOIN</code> has higher precedence than the comma
            operator (<code class="literal">,</code>), so the join expression
            <code class="literal">t1, t2 JOIN t3</code> is interpreted as
            <code class="literal">(t1, (t2 JOIN t3))</code>, not as <code class="literal">((t1,
            t2) JOIN t3)</code>. This affects statements that use an
            <code class="literal">ON</code> clause because that clause can refer
            only to columns in the operands of the join, and the
            precedence affects interpretation of what those operands
            are.
          </p><p>
            Example:
          </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (i1 INT, j1 INT);
CREATE TABLE t2 (i2 INT, j2 INT);
CREATE TABLE t3 (i3 INT, j3 INT);
INSERT INTO t1 VALUES(1, 1);
INSERT INTO t2 VALUES(1, 1);
INSERT INTO t3 VALUES(1, 1);
SELECT * FROM t1, t2 JOIN t3 ON (t1.i1 = t3.i3);
</pre><p>
            The <code class="literal">JOIN</code> takes precedence over the comma
            operator, so the operands for the <code class="literal">ON</code>
            clause are <code class="literal">t2</code> and <code class="literal">t3</code>.
            Because <code class="literal">t1.i1</code> is not a column in either
            of the operands, the result is an <code class="literal">Unknown column
            't1.i1' in 'on clause'</code> error.
          </p><a class="indexterm" name="idm140091664482080"></a><p>
            To enable the join to be processed, use either of these
            strategies:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                Group the first two tables explicitly with parentheses
                so that the operands for the <code class="literal">ON</code>
                clause are <code class="literal">(t1, t2)</code> and
                <code class="literal">t3</code>:
              </p><pre data-lang="sql" class="programlisting">
SELECT * FROM (t1, t2) JOIN t3 ON (t1.i1 = t3.i3);
</pre></li><li class="listitem"><p>
                Avoid the use of the comma operator and use
                <code class="literal">JOIN</code> instead:
              </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 JOIN t2 JOIN t3 ON (t1.i1 = t3.i3);
</pre></li></ul>
</div>
<p>
            The same precedence interpretation also applies to
            statements that mix the comma operator with <code class="literal">INNER
            JOIN</code>, <code class="literal">CROSS JOIN</code>, <code class="literal">LEFT
            JOIN</code>, and <code class="literal">RIGHT JOIN</code>, all of
            which have higher precedence than the comma operator.
          </p></li><li class="listitem"><p>
            A MySQL extension compared to the SQL:2003 standard is that
            MySQL permits you to qualify the common (coalesced) columns
            of <code class="literal">NATURAL</code> or <code class="literal">USING</code>
            joins, whereas the standard disallows that.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="union"></a>13.2.10.3 UNION Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091664466256"></a><pre data-lang="sql" class="programlisting">
SELECT ...
UNION [ALL | DISTINCT] SELECT ...
[UNION [ALL | DISTINCT] SELECT ...]
</pre><p>
        <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> is used to combine the
        result from multiple <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        statements into a single result set.
      </p><p>
        The column names from the first
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement are used as the
        column names for the results returned. Selected columns listed
        in corresponding positions of each
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement should have the
        same data type. (For example, the first column selected by the
        first statement should have the same type as the first column
        selected by the other statements.)
      </p><p>
        If the data types of corresponding
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> columns do not match, the
        types and lengths of the columns in the
        <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> result take into account
        the values retrieved by all of the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements. For example,
        consider the following:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT REPEAT('a',1) UNION SELECT REPEAT('b',10);</code></strong>
+---------------+
| REPEAT('a',1) |
+---------------+
| a             |
| bbbbbbbbbb    |
+---------------+
</pre><p>
        The <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements are normal
        select statements, but with the following restrictions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Only the last <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
            statement can use <code class="literal">INTO OUTFILE</code>. (However,
            the entire <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> result is
            written to the file.)
          </p></li><li class="listitem"><p>
            <code class="literal">HIGH_PRIORITY</code> cannot be used with
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements that are
            part of a <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a>. If you
            specify it for the first
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>, it has no effect. If
            you specify it for any subsequent
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements, a syntax
            error results.
</p></li></ul>
</div>
<p>
        The default behavior for <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> is
        that duplicate rows are removed from the result. The optional
        <code class="literal">DISTINCT</code> keyword has no effect other than the
        default because it also specifies duplicate-row removal. With
        the optional <code class="literal">ALL</code> keyword, duplicate-row
        removal does not occur and the result includes all matching rows
        from all the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements.
      </p><p>
        You can mix <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION
        ALL</code></a> and <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION
        DISTINCT</code></a> in the same query. Mixed
        <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> types are treated such that
        a <code class="literal">DISTINCT</code> union overrides any
        <code class="literal">ALL</code> union to its left. A
        <code class="literal">DISTINCT</code> union can be produced explicitly by
        using <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION
        DISTINCT</code></a> or implicitly by using
        <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> with no following
        <code class="literal">DISTINCT</code> or <code class="literal">ALL</code> keyword.
      </p><p>
        To apply <code class="literal">ORDER BY</code> or <code class="literal">LIMIT</code>
        to an individual <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>, place
        the clause inside the parentheses that enclose the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>:
      </p><pre data-lang="sql" class="programlisting">
(SELECT a FROM t1 WHERE a=10 AND B=1 ORDER BY a LIMIT 10)
UNION
(SELECT a FROM t2 WHERE a=11 AND B=2 ORDER BY a LIMIT 10);
</pre><p>
        However, use of <code class="literal">ORDER BY</code> for individual
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements implies nothing
        about the order in which the rows appear in the final result
        because <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> by default produces
        an unordered set of rows. Therefore, the use of <code class="literal">ORDER
        BY</code> in this context is typically in conjunction with
        <code class="literal">LIMIT</code>, so that it is used to determine the
        subset of the selected rows to retrieve for the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>, even though it does not
        necessarily affect the order of those rows in the final
        <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> result. If <code class="literal">ORDER
        BY</code> appears without <code class="literal">LIMIT</code> in a
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>, it is optimized away
        because it will have no effect anyway.
      </p><p>
        To use an <code class="literal">ORDER BY</code> or
        <code class="literal">LIMIT</code> clause to sort or limit the entire
        <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> result, parenthesize the
        individual <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements and
        place the <code class="literal">ORDER BY</code> or
        <code class="literal">LIMIT</code> after the last one. The following
        example uses both clauses:
      </p><pre data-lang="sql" class="programlisting">
(SELECT a FROM t1 WHERE a=10 AND B=1)
UNION
(SELECT a FROM t2 WHERE a=11 AND B=2)
ORDER BY a LIMIT 10;
</pre><p>
        A statement without parentheses is equivalent to one
        parenthesized as just shown.
      </p><p>
        This kind of <code class="literal">ORDER BY</code> cannot use column
        references that include a table name (that is, names in
        <em class="replaceable"><code>tbl_name</code></em>.<em class="replaceable"><code>col_name</code></em>
        format). Instead, provide a column alias in the first
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement and refer to the
        alias in the <code class="literal">ORDER BY</code>. (Alternatively, refer
        to the column in the <code class="literal">ORDER BY</code> using its
        column position. However, use of column positions is
        deprecated.)
      </p><p>
        Also, if a column to be sorted is aliased, the <code class="literal">ORDER
        BY</code> clause <span class="emphasis"><em>must</em></span> refer to the
        alias, not the column name. The first of the following
        statements will work, but the second will fail with an
        <code class="literal">Unknown column 'a' in 'order clause'</code> error:
      </p><pre data-lang="sql" class="programlisting">
(SELECT a AS b FROM t) UNION (SELECT ...) ORDER BY b;
(SELECT a AS b FROM t) UNION (SELECT ...) ORDER BY a;
</pre><p>
        To cause rows in a <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> result
        to consist of the sets of rows retrieved by each
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> one after the other,
        select an additional column in each
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> to use as a sort column
        and add an <code class="literal">ORDER BY</code> following the last
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>:
      </p><pre data-lang="sql" class="programlisting">
(SELECT 1 AS sort_col, col1a, col1b, ... FROM t1)
UNION
(SELECT 2, col2a, col2b, ... FROM t2) ORDER BY sort_col;
</pre><p>
        To additionally maintain sort order within individual
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> results, add a secondary
        column to the <code class="literal">ORDER BY</code> clause:
      </p><pre data-lang="sql" class="programlisting">
(SELECT 1 AS sort_col, col1a, col1b, ... FROM t1)
UNION
(SELECT 2, col2a, col2b, ... FROM t2) ORDER BY sort_col, col1a;
</pre><p>
        Use of an additional column also enables you to determine which
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> each row comes from. Extra
        columns can provide other identifying information as well, such
        as a string that indicates a table name.
      </p><p>
        <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> queries with an aggregate
        function in an <code class="literal">ORDER BY</code> clause are rejected
        with an
        <a class="link" href="error-handling.html#error_er_aggregate_order_for_union"><code class="literal">ER_AGGREGATE_ORDER_FOR_UNION</code></a>
        error. Example:
      </p><pre data-lang="sql" class="programlisting">
SELECT 1 AS foo UNION SELECT 2 ORDER BY MAX(1);
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="subqueries"></a>13.2.11 Subquery Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#scalar-subqueries">13.2.11.1 The Subquery as Scalar Operand</a></span></dt><dt><span class="section"><a href="sql-syntax.html#comparisons-using-subqueries">13.2.11.2 Comparisons Using Subqueries</a></span></dt><dt><span class="section"><a href="sql-syntax.html#any-in-some-subqueries">13.2.11.3 Subqueries with ANY, IN, or SOME</a></span></dt><dt><span class="section"><a href="sql-syntax.html#all-subqueries">13.2.11.4 Subqueries with ALL</a></span></dt><dt><span class="section"><a href="sql-syntax.html#row-subqueries">13.2.11.5 Row Subqueries</a></span></dt><dt><span class="section"><a href="sql-syntax.html#exists-and-not-exists-subqueries">13.2.11.6 Subqueries with EXISTS or NOT EXISTS</a></span></dt><dt><span class="section"><a href="sql-syntax.html#correlated-subqueries">13.2.11.7 Correlated Subqueries</a></span></dt><dt><span class="section"><a href="sql-syntax.html#derived-tables">13.2.11.8 Derived Tables</a></span></dt><dt><span class="section"><a href="sql-syntax.html#lateral-derived-tables">13.2.11.9 Lateral Derived Tables</a></span></dt><dt><span class="section"><a href="sql-syntax.html#subquery-errors">13.2.11.10 Subquery Errors</a></span></dt><dt><span class="section"><a href="sql-syntax.html#optimizing-subqueries">13.2.11.11 Optimizing Subqueries</a></span></dt><dt><span class="section"><a href="sql-syntax.html#rewriting-subqueries">13.2.11.12 Rewriting Subqueries as Joins</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091664370432"></a><a class="indexterm" name="idm140091664369360"></a><a class="indexterm" name="idm140091664368288"></a><a class="indexterm" name="idm140091664366800"></a><p>
      A subquery is a <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement
      within another statement.
    </p><p>
      All subquery forms and operations that the SQL standard requires
      are supported, as well as a few features that are MySQL-specific.
    </p><p>
      Here is an example of a subquery:
    </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE column1 = (SELECT column1 FROM t2);
</pre><p>
      In this example, <code class="literal">SELECT * FROM t1 ...</code> is the
      <span class="emphasis"><em>outer query</em></span> (or <span class="emphasis"><em>outer
      statement</em></span>), and <code class="literal">(SELECT column1 FROM
      t2)</code> is the <span class="emphasis"><em>subquery</em></span>. We say that
      the subquery is <span class="emphasis"><em>nested</em></span> within the outer
      query, and in fact it is possible to nest subqueries within other
      subqueries, to a considerable depth. A subquery must always appear
      within parentheses.
    </p><p>
      The main advantages of subqueries are:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          They allow queries that are <span class="emphasis"><em>structured</em></span> so
          that it is possible to isolate each part of a statement.
        </p></li><li class="listitem"><p>
          They provide alternative ways to perform operations that would
          otherwise require complex joins and unions.
        </p></li><li class="listitem"><p>
          Many people find subqueries more readable than complex joins
          or unions. Indeed, it was the innovation of subqueries that
          gave people the original idea of calling the early SQL
          <span class="quote">“<span class="quote">Structured Query Language.</span>”</span>
</p></li></ul>
</div>
<p>
      Here is an example statement that shows the major points about
      subquery syntax as specified by the SQL standard and supported in
      MySQL:
    </p><pre data-lang="sql" class="programlisting">
DELETE FROM t1
WHERE s11 &gt; ANY
 (SELECT COUNT(*) /* no hint */ FROM t2
  WHERE NOT EXISTS
   (SELECT * FROM t3
    WHERE ROW(5*t2.s1,77)=
     (SELECT 50,11*s1 FROM t4 UNION SELECT 50,77 FROM
      (SELECT * FROM t5) AS t5)));
</pre><p>
      A subquery can return a scalar (a single value), a single row, a
      single column, or a table (one or more rows of one or more
      columns). These are called scalar, column, row, and table
      subqueries. Subqueries that return a particular kind of result
      often can be used only in certain contexts, as described in the
      following sections.
    </p><p>
      There are few restrictions on the type of statements in which
      subqueries can be used. A subquery can contain many of the
      keywords or clauses that an ordinary
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> can contain:
      <code class="literal">DISTINCT</code>, <code class="literal">GROUP BY</code>,
      <code class="literal">ORDER BY</code>, <code class="literal">LIMIT</code>, joins,
      index hints, <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> constructs,
      comments, functions, and so on.
    </p><p>
      A subquery's outer statement can be any one of:
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>,
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>,
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>,
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>,
      <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>, or
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a>.
    </p><p>
      In MySQL, you cannot modify a table and select from the same table
      in a subquery. This applies to statements such as
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>,
      <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>,
      <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a>,
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>, and (because subqueries can
      be used in the <code class="literal">SET</code> clause)
      <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>.
    </p><p>
      For information about how the optimizer handles subqueries, see
      <a class="xref" href="optimization.html#subquery-optimization" title="8.2.2 Optimizing Subqueries, Derived Tables, View References, and Common Table Expressions">Section 8.2.2, “Optimizing Subqueries, Derived Tables, View References, and Common Table
        Expressions”</a>. For a discussion of
      restrictions on subquery use, including performance issues for
      certain forms of subquery syntax, see
      <a class="xref" href="restrictions.html#subquery-restrictions" title="C.4 Restrictions on Subqueries">Section C.4, “Restrictions on Subqueries”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="scalar-subqueries"></a>13.2.11.1 The Subquery as Scalar Operand</h4>
</div>
</div>
</div>
<p>
        In its simplest form, a subquery is a scalar subquery that
        returns a single value. A scalar subquery is a simple operand,
        and you can use it almost anywhere a single column value or
        literal is legal, and you can expect it to have those
        characteristics that all operands have: a data type, a length,
        an indication that it can be <code class="literal">NULL</code>, and so on.
        For example:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (s1 INT, s2 CHAR(5) NOT NULL);
INSERT INTO t1 VALUES(100, 'abcde');
SELECT (SELECT s2 FROM t1);
</pre><p>
        The subquery in this <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        returns a single value (<code class="literal">'abcde'</code>) that has a
        data type of <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>, a length of 5,
        a character set and collation equal to the defaults in effect at
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> time, and an
        indication that the value in the column can be
        <code class="literal">NULL</code>. Nullability of the value selected by a
        scalar subquery is not copied because if the subquery result is
        empty, the result is <code class="literal">NULL</code>. For the subquery
        just shown, if <code class="literal">t1</code> were empty, the result
        would be <code class="literal">NULL</code> even though
        <code class="literal">s2</code> is <code class="literal">NOT NULL</code>.
      </p><p>
        There are a few contexts in which a scalar subquery cannot be
        used. If a statement permits only a literal value, you cannot
        use a subquery. For example, <code class="literal">LIMIT</code> requires
        literal integer arguments, and <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD
        DATA</code></a> requires a literal string file name. You cannot
        use subqueries to supply these values.
      </p><p>
        When you see examples in the following sections that contain the
        rather spartan construct <code class="literal">(SELECT column1 FROM
        t1)</code>, imagine that your own code contains much more
        diverse and complex constructions.
      </p><p>
        Suppose that we make two tables:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (s1 INT);
INSERT INTO t1 VALUES (1);
CREATE TABLE t2 (s1 INT);
INSERT INTO t2 VALUES (2);
</pre><p>
        Then perform a <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>:
      </p><pre data-lang="sql" class="programlisting">
SELECT (SELECT s1 FROM t2) FROM t1;
</pre><p>
        The result is <code class="literal">2</code> because there is a row in
        <code class="literal">t2</code> containing a column <code class="literal">s1</code>
        that has a value of <code class="literal">2</code>.
      </p><p>
        A scalar subquery can be part of an expression, but remember the
        parentheses, even if the subquery is an operand that provides an
        argument for a function. For example:
      </p><pre data-lang="sql" class="programlisting">
SELECT UPPER((SELECT s1 FROM t1)) FROM t2;
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="comparisons-using-subqueries"></a>13.2.11.2 Comparisons Using Subqueries</h4>

</div>

</div>

</div>
<p>
        The most common use of a subquery is in the form:
      </p><pre data-lang="sql" class="programlisting">
<em class="replaceable"><code>non_subquery_operand</code></em> <em class="replaceable"><code>comparison_operator</code></em> (<em class="replaceable"><code>subquery</code></em>)
</pre><p>
        Where <em class="replaceable"><code>comparison_operator</code></em> is one of
        these operators:
      </p><pre data-lang="sql" class="programlisting">
=  &gt;  &lt;  &gt;=  &lt;=  &lt;&gt;  !=  &lt;=&gt;
</pre><p>
        For example:
      </p><pre data-lang="sql" class="programlisting">
... WHERE 'a' = (SELECT column1 FROM t1)
</pre><p>
        MySQL also permits this construct:
      </p><pre data-lang="sql" class="programlisting">
<em class="replaceable"><code>non_subquery_operand</code></em> LIKE (<em class="replaceable"><code>subquery</code></em>)
</pre><p>
        At one time the only legal place for a subquery was on the right
        side of a comparison, and you might still find some old DBMSs
        that insist on this.
      </p><p>
        Here is an example of a common-form subquery comparison that you
        cannot do with a join. It finds all the rows in table
        <code class="literal">t1</code> for which the <code class="literal">column1</code>
        value is equal to a maximum value in table
        <code class="literal">t2</code>:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1
  WHERE column1 = (SELECT MAX(column2) FROM t2);
</pre><p>
        Here is another example, which again is impossible with a join
        because it involves aggregating for one of the tables. It finds
        all rows in table <code class="literal">t1</code> containing a value that
        occurs twice in a given column:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 AS t
  WHERE 2 = (SELECT COUNT(*) FROM t1 WHERE t1.id = t.id);
</pre><p>
        For a comparison of the subquery to a scalar, the subquery must
        return a scalar. For a comparison of the subquery to a row
        constructor, the subquery must be a row subquery that returns a
        row with the same number of values as the row constructor. See
        <a class="xref" href="sql-syntax.html#row-subqueries" title="13.2.11.5 Row Subqueries">Section 13.2.11.5, “Row Subqueries”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="any-in-some-subqueries"></a>13.2.11.3 Subqueries with ANY, IN, or SOME</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091664283120"></a><a class="indexterm" name="idm140091664281664"></a><a class="indexterm" name="idm140091664280624"></a><a class="indexterm" name="idm140091664279584"></a><p>
        Syntax:
      </p><pre data-lang="sql" class="programlisting">
<em class="replaceable"><code>operand</code></em> <em class="replaceable"><code>comparison_operator</code></em> ANY (<em class="replaceable"><code>subquery</code></em>)
<em class="replaceable"><code>operand</code></em> IN (<em class="replaceable"><code>subquery</code></em>)
<em class="replaceable"><code>operand</code></em> <em class="replaceable"><code>comparison_operator</code></em> SOME (<em class="replaceable"><code>subquery</code></em>)
</pre><p>
        Where <em class="replaceable"><code>comparison_operator</code></em> is one of
        these operators:
      </p><pre data-lang="sql" class="programlisting">
=  &gt;  &lt;  &gt;=  &lt;=  &lt;&gt;  !=
</pre><p>
        The <code class="literal">ANY</code> keyword, which must follow a
        comparison operator, means <span class="quote">“<span class="quote">return <code class="literal">TRUE</code>
        if the comparison is <code class="literal">TRUE</code> for
        <code class="literal">ANY</code> of the values in the column that the
        subquery returns.</span>”</span> For example:
      </p><pre data-lang="sql" class="programlisting">
SELECT s1 FROM t1 WHERE s1 &gt; ANY (SELECT s1 FROM t2);
</pre><p>
        Suppose that there is a row in table <code class="literal">t1</code>
        containing <code class="literal">(10)</code>. The expression is
        <code class="literal">TRUE</code> if table <code class="literal">t2</code> contains
        <code class="literal">(21,14,7)</code> because there is a value
        <code class="literal">7</code> in <code class="literal">t2</code> that is less than
        <code class="literal">10</code>. The expression is
        <code class="literal">FALSE</code> if table <code class="literal">t2</code> contains
        <code class="literal">(20,10)</code>, or if table <code class="literal">t2</code> is
        empty. The expression is <span class="emphasis"><em>unknown</em></span> (that is,
        <code class="literal">NULL</code>) if table <code class="literal">t2</code> contains
        <code class="literal">(NULL,NULL,NULL)</code>.
      </p><p>
        When used with a subquery, the word <code class="literal">IN</code> is an
        alias for <code class="literal">= ANY</code>. Thus, these two statements
        are the same:
      </p><pre data-lang="sql" class="programlisting">
SELECT s1 FROM t1 WHERE s1 = ANY (SELECT s1 FROM t2);
SELECT s1 FROM t1 WHERE s1 IN    (SELECT s1 FROM t2);
</pre><p>
        <code class="literal">IN</code> and <code class="literal">= ANY</code> are not
        synonyms when used with an expression list.
        <code class="literal">IN</code> can take an expression list, but
        <code class="literal">= ANY</code> cannot. See
        <a class="xref" href="functions.html#comparison-operators" title="12.3.2 Comparison Functions and Operators">Section 12.3.2, “Comparison Functions and Operators”</a>.
      </p><p>
        <code class="literal">NOT IN</code> is not an alias for <code class="literal">&lt;&gt;
        ANY</code>, but for <code class="literal">&lt;&gt; ALL</code>. See
        <a class="xref" href="sql-syntax.html#all-subqueries" title="13.2.11.4 Subqueries with ALL">Section 13.2.11.4, “Subqueries with ALL”</a>.
      </p><p>
        The word <code class="literal">SOME</code> is an alias for
        <code class="literal">ANY</code>. Thus, these two statements are the same:
      </p><pre data-lang="sql" class="programlisting">
SELECT s1 FROM t1 WHERE s1 &lt;&gt; ANY  (SELECT s1 FROM t2);
SELECT s1 FROM t1 WHERE s1 &lt;&gt; SOME (SELECT s1 FROM t2);
</pre><p>
        Use of the word <code class="literal">SOME</code> is rare, but this
        example shows why it might be useful. To most people, the
        English phrase <span class="quote">“<span class="quote">a is not equal to any b</span>”</span> means
        <span class="quote">“<span class="quote">there is no b which is equal to a,</span>”</span> but that is
        not what is meant by the SQL syntax. The syntax means
        <span class="quote">“<span class="quote">there is some b to which a is not equal.</span>”</span> Using
        <code class="literal">&lt;&gt; SOME</code> instead helps ensure that
        everyone understands the true meaning of the query.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="all-subqueries"></a>13.2.11.4 Subqueries with ALL</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091664237472"></a><a class="indexterm" name="idm140091664235984"></a><p>
        Syntax:
      </p><pre data-lang="sql" class="programlisting">
<em class="replaceable"><code>operand</code></em> <em class="replaceable"><code>comparison_operator</code></em> ALL (<em class="replaceable"><code>subquery</code></em>)
</pre><p>
        The word <code class="literal">ALL</code>, which must follow a comparison
        operator, means <span class="quote">“<span class="quote">return <code class="literal">TRUE</code> if the
        comparison is <code class="literal">TRUE</code> for <code class="literal">ALL</code>
        of the values in the column that the subquery returns.</span>”</span>
        For example:
      </p><pre data-lang="sql" class="programlisting">
SELECT s1 FROM t1 WHERE s1 &gt; ALL (SELECT s1 FROM t2);
</pre><p>
        Suppose that there is a row in table <code class="literal">t1</code>
        containing <code class="literal">(10)</code>. The expression is
        <code class="literal">TRUE</code> if table <code class="literal">t2</code> contains
        <code class="literal">(-5,0,+5)</code> because <code class="literal">10</code> is
        greater than all three values in <code class="literal">t2</code>. The
        expression is <code class="literal">FALSE</code> if table
        <code class="literal">t2</code> contains
        <code class="literal">(12,6,NULL,-100)</code> because there is a single
        value <code class="literal">12</code> in table <code class="literal">t2</code> that
        is greater than <code class="literal">10</code>. The expression is
        <span class="emphasis"><em>unknown</em></span> (that is, <code class="literal">NULL</code>)
        if table <code class="literal">t2</code> contains
        <code class="literal">(0,NULL,1)</code>.
      </p><p>
        Finally, the expression is <code class="literal">TRUE</code> if table
        <code class="literal">t2</code> is empty. So, the following expression is
        <code class="literal">TRUE</code> when table <code class="literal">t2</code> is
        empty:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE 1 &gt; ALL (SELECT s1 FROM t2);
</pre><p>
        But this expression is <code class="literal">NULL</code> when table
        <code class="literal">t2</code> is empty:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE 1 &gt; (SELECT s1 FROM t2);
</pre><p>
        In addition, the following expression is <code class="literal">NULL</code>
        when table <code class="literal">t2</code> is empty:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE 1 &gt; ALL (SELECT MAX(s1) FROM t2);
</pre><p>
        In general, <span class="emphasis"><em>tables containing <code class="literal">NULL</code>
        values</em></span> and <span class="emphasis"><em>empty tables</em></span> are
        <span class="quote">“<span class="quote">edge cases.</span>”</span> When writing subqueries, always
        consider whether you have taken those two possibilities into
        account.
      </p><p>
        <code class="literal">NOT IN</code> is an alias for <code class="literal">&lt;&gt;
        ALL</code>. Thus, these two statements are the same:
      </p><pre data-lang="sql" class="programlisting">
SELECT s1 FROM t1 WHERE s1 &lt;&gt; ALL (SELECT s1 FROM t2);
SELECT s1 FROM t1 WHERE s1 NOT IN (SELECT s1 FROM t2);
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="row-subqueries"></a>13.2.11.5 Row Subqueries</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091664198416"></a><a class="indexterm" name="idm140091664197344"></a><a class="indexterm" name="idm140091664196304"></a><a class="indexterm" name="idm140091664195232"></a><p>
        Scalar or column subqueries return a single value or a column of
        values. A <span class="emphasis"><em>row subquery</em></span> is a subquery
        variant that returns a single row and can thus return more than
        one column value. Legal operators for row subquery comparisons
        are:
      </p><pre data-lang="sql" class="programlisting">
=  &gt;  &lt;  &gt;=  &lt;=  &lt;&gt;  !=  &lt;=&gt;
</pre><p>
        Here are two examples:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1
  WHERE (col1,col2) = (SELECT col3, col4 FROM t2 WHERE id = 10);
SELECT * FROM t1
  WHERE ROW(col1,col2) = (SELECT col3, col4 FROM t2 WHERE id = 10);
</pre><p>
        For both queries, if the table <code class="literal">t2</code> contains a
        single row with <code class="literal">id = 10</code>, the subquery returns
        a single row. If this row has <code class="literal">col3</code> and
        <code class="literal">col4</code> values equal to the
        <code class="literal">col1</code> and <code class="literal">col2</code> values of
        any rows in <code class="literal">t1</code>, the <code class="literal">WHERE</code>
        expression is <code class="literal">TRUE</code> and each query returns
        those <code class="literal">t1</code> rows. If the <code class="literal">t2</code>
        row <code class="literal">col3</code> and <code class="literal">col4</code> values
        are not equal the <code class="literal">col1</code> and
        <code class="literal">col2</code> values of any <code class="literal">t1</code> row,
        the expression is <code class="literal">FALSE</code> and the query returns
        an empty result set. The expression is
        <span class="emphasis"><em>unknown</em></span> (that is, <code class="literal">NULL</code>)
        if the subquery produces no rows. An error occurs if the
        subquery produces multiple rows because a row subquery can
        return at most one row.
      </p><p>
        For information about how each operator works for row
        comparisons, see <a class="xref" href="functions.html#comparison-operators" title="12.3.2 Comparison Functions and Operators">Section 12.3.2, “Comparison Functions and Operators”</a>.
      </p><p>
        The expressions <code class="literal">(1,2)</code> and
        <code class="literal">ROW(1,2)</code> are sometimes called
        <span class="firstterm">row constructors</span>. The two
        are equivalent. The row constructor and the row returned by the
        subquery must contain the same number of values.
      </p><p>
        A row constructor is used for comparisons with subqueries that
        return two or more columns. When a subquery returns a single
        column, this is regarded as a scalar value and not as a row, so
        a row constructor cannot be used with a subquery that does not
        return at least two columns. Thus, the following query fails
        with a syntax error:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE ROW(1) = (SELECT column1 FROM t2)
</pre><p>
        Row constructors are legal in other contexts. For example, the
        following two statements are semantically equivalent (and are
        handled in the same way by the optimizer):
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE (column1,column2) = (1,1);
SELECT * FROM t1 WHERE column1 = 1 AND column2 = 1;
</pre><p>
        The following query answers the request, <span class="quote">“<span class="quote">find all rows in
        table <code class="literal">t1</code> that also exist in table
        <code class="literal">t2</code></span>”</span>:
      </p><pre data-lang="sql" class="programlisting">
SELECT column1,column2,column3
  FROM t1
  WHERE (column1,column2,column3) IN
         (SELECT column1,column2,column3 FROM t2);
</pre><p>
        For more information about the optimizer and row constructors,
        see <a class="xref" href="optimization.html#row-constructor-optimization" title="8.2.1.21 Row Constructor Expression Optimization">Section 8.2.1.21, “Row Constructor Expression Optimization”</a>
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="exists-and-not-exists-subqueries"></a>13.2.11.6 Subqueries with EXISTS or NOT EXISTS</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091664163200"></a><a class="indexterm" name="idm140091664161712"></a><a class="indexterm" name="idm140091664160224"></a><a class="indexterm" name="idm140091664158736"></a><p>
        If a subquery returns any rows at all, <code class="literal">EXISTS
        <em class="replaceable"><code>subquery</code></em></code> is
        <code class="literal">TRUE</code>, and <code class="literal">NOT EXISTS
        <em class="replaceable"><code>subquery</code></em></code> is
        <code class="literal">FALSE</code>. For example:
      </p><pre data-lang="sql" class="programlisting">
SELECT column1 FROM t1 WHERE EXISTS (SELECT * FROM t2);
</pre><p>
        Traditionally, an <code class="literal">EXISTS</code> subquery starts with
        <code class="literal">SELECT *</code>, but it could begin with
        <code class="literal">SELECT 5</code> or <code class="literal">SELECT column1</code>
        or anything at all. MySQL ignores the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> list in such a subquery,
        so it makes no difference.
      </p><p>
        For the preceding example, if <code class="literal">t2</code> contains any
        rows, even rows with nothing but <code class="literal">NULL</code> values,
        the <code class="literal">EXISTS</code> condition is
        <code class="literal">TRUE</code>. This is actually an unlikely example
        because a <code class="literal">[NOT] EXISTS</code> subquery almost always
        contains correlations. Here are some more realistic examples:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            What kind of store is present in one or more cities?
          </p><pre data-lang="sql" class="programlisting">
SELECT DISTINCT store_type FROM stores
  WHERE EXISTS (SELECT * FROM cities_stores
                WHERE cities_stores.store_type = stores.store_type);
</pre></li><li class="listitem"><p>
            What kind of store is present in no cities?
          </p><pre data-lang="sql" class="programlisting">
SELECT DISTINCT store_type FROM stores
  WHERE NOT EXISTS (SELECT * FROM cities_stores
                    WHERE cities_stores.store_type = stores.store_type);
</pre></li><li class="listitem"><p>
            What kind of store is present in all cities?
          </p><pre data-lang="sql" class="programlisting">
SELECT DISTINCT store_type FROM stores s1
  WHERE NOT EXISTS (
    SELECT * FROM cities WHERE NOT EXISTS (
      SELECT * FROM cities_stores
       WHERE cities_stores.city = cities.city
       AND cities_stores.store_type = stores.store_type));
</pre></li></ul>
</div>
<p>
        The last example is a double-nested <code class="literal">NOT
        EXISTS</code> query. That is, it has a <code class="literal">NOT
        EXISTS</code> clause within a <code class="literal">NOT EXISTS</code>
        clause. Formally, it answers the question <span class="quote">“<span class="quote">does a city
        exist with a store that is not in
        <code class="literal">Stores</code></span>”</span>? But it is easier to say that
        a nested <code class="literal">NOT EXISTS</code> answers the question
        <span class="quote">“<span class="quote">is <em class="replaceable"><code>x</code></em> <code class="literal">TRUE</code>
        for all <em class="replaceable"><code>y</code></em>?</span>”</span>
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="correlated-subqueries"></a>13.2.11.7 Correlated Subqueries</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091664129680"></a><a class="indexterm" name="idm140091664128608"></a><p>
        A <span class="emphasis"><em>correlated subquery</em></span> is a subquery that
        contains a reference to a table that also appears in the outer
        query. For example:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1
  WHERE column1 = ANY (SELECT column1 FROM t2
                       WHERE t2.column2 = t1.column2);
</pre><p>
        Notice that the subquery contains a reference to a column of
        <code class="literal">t1</code>, even though the subquery's
        <code class="literal">FROM</code> clause does not mention a table
        <code class="literal">t1</code>. So, MySQL looks outside the subquery, and
        finds <code class="literal">t1</code> in the outer query.
      </p><p>
        Suppose that table <code class="literal">t1</code> contains a row where
        <code class="literal">column1 = 5</code> and <code class="literal">column2 =
        6</code>; meanwhile, table <code class="literal">t2</code> contains a
        row where <code class="literal">column1 = 5</code> and <code class="literal">column2 =
        7</code>. The simple expression <code class="literal">... WHERE column1 =
        ANY (SELECT column1 FROM t2)</code> would be
        <code class="literal">TRUE</code>, but in this example, the
        <code class="literal">WHERE</code> clause within the subquery is
        <code class="literal">FALSE</code> (because <code class="literal">(5,6)</code> is
        not equal to <code class="literal">(5,7)</code>), so the expression as a
        whole is <code class="literal">FALSE</code>.
      </p><p>
        <span class="bold"><strong>Scoping rule:</strong></span> MySQL evaluates
        from inside to outside. For example:
      </p><pre data-lang="sql" class="programlisting">
SELECT column1 FROM t1 AS x
  WHERE x.column1 = (SELECT column1 FROM t2 AS x
    WHERE x.column1 = (SELECT column1 FROM t3
      WHERE x.column2 = t3.column1));
</pre><p>
        In this statement, <code class="literal">x.column2</code> must be a column
        in table <code class="literal">t2</code> because <code class="literal">SELECT column1
        FROM t2 AS x ...</code> renames <code class="literal">t2</code>. It is
        not a column in table <code class="literal">t1</code> because
        <code class="literal">SELECT column1 FROM t1 ...</code> is an outer query
        that is <span class="emphasis"><em>farther out</em></span>.
      </p><p>
        For subqueries in <code class="literal">HAVING</code> or <code class="literal">ORDER
        BY</code> clauses, MySQL also looks for column names in the
        outer select list.
      </p><p>
        For certain cases, a correlated subquery is optimized. For
        example:
      </p><pre data-lang="sql" class="programlisting">
<em class="replaceable"><code>val</code></em> IN (SELECT <em class="replaceable"><code>key_val</code></em> FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>correlated_condition</code></em>)
</pre><p>
        Otherwise, they are inefficient and likely to be slow. Rewriting
        the query as a join might improve performance.
      </p><p>
        Aggregate functions in correlated subqueries may contain outer
        references, provided the function contains nothing but outer
        references, and provided the function is not contained in
        another function or expression.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="derived-tables"></a>13.2.11.8 Derived Tables</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091664096960"></a><a class="indexterm" name="idm140091664095888"></a><a class="indexterm" name="idm140091664093984"></a><p>
        This section discusses general characteristics of derived
        tables. For information about lateral derived tables preceded by
        the <code class="literal">LATERAL</code> keyword, see
        <a class="xref" href="sql-syntax.html#lateral-derived-tables" title="13.2.11.9 Lateral Derived Tables">Section 13.2.11.9, “Lateral Derived Tables”</a>.
      </p><p>
        A derived table is an expression that generates a table within
        the scope of a query <code class="literal">FROM</code> clause. For
        example, a subquery in a <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        statement <code class="literal">FROM</code> clause is a derived table:
      </p><pre data-lang="sql" class="programlisting">
SELECT ... FROM (<em class="replaceable"><code>subquery</code></em>) [AS] <em class="replaceable"><code>tbl_name</code></em> ...
</pre><p>
        The <a class="link" href="functions.html#function_json-table"><code class="literal">JSON_TABLE()</code></a> function
        generates a table and provides another way to create a derived
        table:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM JSON_TABLE(<em class="replaceable"><code>arg_list</code></em>) [AS] <em class="replaceable"><code>tbl_name</code></em> ...
</pre><p>
        The <code class="literal">[AS] <em class="replaceable"><code>tbl_name</code></em></code>
        clause is mandatory because every table in a
        <code class="literal">FROM</code> clause must have a name. Any columns in
        the derived table must have unique names. Alternatively,
        <em class="replaceable"><code>tbl_name</code></em> may be followed by a
        parenthesized list of names for the derived table columns:
      </p><pre data-lang="sql" class="programlisting">
SELECT ... FROM (<em class="replaceable"><code>subquery</code></em>) [AS] <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>col_list</code></em>) ...
</pre><p>
        The number of column names must be the same as the number of
        table columns.
      </p><p>
        For the sake of illustration, assume that you have this table:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE t1 (s1 INT, s2 CHAR(5), s3 FLOAT);
</pre><p>
        Here is how to use a subquery in the <code class="literal">FROM</code>
        clause, using the example table:
      </p><pre data-lang="sql" class="programlisting">
INSERT INTO t1 VALUES (1,'1',1.0);
INSERT INTO t1 VALUES (2,'2',2.0);
SELECT sb1,sb2,sb3
  FROM (SELECT s1 AS sb1, s2 AS sb2, s3*2 AS sb3 FROM t1) AS sb
  WHERE sb1 &gt; 1;
</pre><p>
        Result:
      </p><pre data-lang="none" class="programlisting">
+------+------+------+
| sb1  | sb2  | sb3  |
+------+------+------+
|    2 | 2    |    4 |
+------+------+------+
</pre><p>
        Here is another example: Suppose that you want to know the
        average of a set of sums for a grouped table. This does not
        work:
      </p><pre data-lang="sql" class="programlisting">
SELECT AVG(SUM(column1)) FROM t1 GROUP BY column1;
</pre><p>
        However, this query provides the desired information:
      </p><pre data-lang="sql" class="programlisting">
SELECT AVG(sum_column1)
  FROM (SELECT SUM(column1) AS sum_column1
        FROM t1 GROUP BY column1) AS t1;
</pre><p>
        Notice that the column name used within the subquery
        (<code class="literal">sum_column1</code>) is recognized in the outer
        query.
      </p><p>
        The column names for a derived table come from its select list:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM (SELECT 1, 2, 3, 4) AS dt;</code></strong>
+---+---+---+---+
| 1 | 2 | 3 | 4 |
+---+---+---+---+
| 1 | 2 | 3 | 4 |
+---+---+---+---+
</pre><p>
        To provide column names explicitly, follow the derived table
        name with a parenthesized list of column names:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM (SELECT 1, 2, 3, 4) AS dt (a, b, c, d);</code></strong>
+---+---+---+---+
| a | b | c | d |
+---+---+---+---+
| 1 | 2 | 3 | 4 |
+---+---+---+---+
</pre><p>
        A derived table can return a scalar, column, row, or table.
      </p><p>
        Derived tables are subject to these restrictions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A derived table cannot be a correlated subquery.
          </p></li><li class="listitem"><p>
            A derived table cannot contain references to other tables of
            the same <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>.
          </p></li><li class="listitem"><p>
            Prior to MySQL 8.0.14, a derived table cannot contain outer
            references. This is a MySQL restriction that is lifted in
            MySQL 8.0.14, not a restriction of the SQL standard. For
            example, the derived table <code class="literal">dt</code> in the
            following query contains a reference <code class="literal">t1.b</code>
            to the table <code class="literal">t1</code> in the outer query:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1
WHERE t1.d &gt; (SELECT AVG(dt.a)
                FROM (SELECT SUM(t2.a) AS a
                      FROM t2
                      WHERE t2.b = t1.b GROUP BY t2.c) dt
              WHERE dt.a &gt; 10);
</pre><p>
            The query is valid in MySQL 8.0.14 and higher. Before
            8.0.14, it produces an error: <code class="literal">Unknown column 't1.b'
            in 'where clause'</code>
</p></li></ul>
</div>
<p>
        The optimizer determines information about derived tables in
        such a way that <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> does not
        need to materialize them. See
        <a class="xref" href="optimization.html#derived-table-optimization" title="8.2.2.4 Optimizing Derived Tables, View References, and Common Table Expressions with Merging or Materialization">Section 8.2.2.4, “Optimizing Derived Tables, View References, and Common Table Expressions
          with Merging or Materialization”</a>.
      </p><p>
        It is possible under certain circumstances that using
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN
        SELECT</code></a> will modify table data. This can occur if the
        outer query accesses any tables and an inner query invokes a
        stored function that changes one or more rows of a table.
        Suppose that there are two tables <code class="literal">t1</code> and
        <code class="literal">t2</code> in database <code class="literal">d1</code>, and a
        stored function <code class="literal">f1</code> that modifies
        <code class="literal">t2</code>, created as shown here:
      </p><pre data-lang="sql" class="programlisting">
CREATE DATABASE d1;
USE d1;
CREATE TABLE t1 (c1 INT);
CREATE TABLE t2 (c1 INT);
CREATE FUNCTION f1(p1 INT) RETURNS INT
  BEGIN
    INSERT INTO t2 VALUES (p1);
    RETURN p1;
  END;
</pre><p>
        Referencing the function directly in an
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN
        SELECT</code></a> has no effect on <code class="literal">t2</code>, as
        shown here:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM t2;</code></strong>
Empty set (0.02 sec)

mysql&gt; <strong class="userinput"><code>EXPLAIN SELECT f1(5)\G</code></strong>
*************************** 1. row ***************************
           id: 1
  select_type: SIMPLE
        table: NULL
   partitions: NULL
         type: NULL
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: NULL
     filtered: NULL
        Extra: No tables used
1 row in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM t2;</code></strong>
Empty set (0.01 sec)
</pre><p>
        This is because the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        statement did not reference any tables, as can be seen in the
        <code class="literal">table</code> and <code class="literal">Extra</code> columns of
        the output. This is also true of the following nested
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>EXPLAIN SELECT NOW() AS a1, (SELECT f1(5)) AS a2\G</code></strong>
*************************** 1. row ***************************
           id: 1
  select_type: PRIMARY
        table: NULL
         type: NULL
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: NULL
     filtered: NULL
        Extra: No tables used
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------------------+
| Level | Code | Message                                  |
+-------+------+------------------------------------------+
| Note  | 1249 | Select 2 was reduced during optimization |
+-------+------+------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM t2;</code></strong>
Empty set (0.00 sec)
</pre><p>
        However, if the outer <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        references any tables, the optimizer executes the statement in
        the subquery as well, with the result that <code class="literal">t2</code>
        is modified:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>EXPLAIN SELECT * FROM t1 AS a1, (SELECT f1(5)) AS a2\G</code></strong>
*************************** 1. row ***************************
           id: 1
  select_type: PRIMARY
        table: &lt;derived2&gt;
   partitions: NULL
         type: system
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: 1
     filtered: 100.00
        Extra: NULL
*************************** 2. row ***************************
           id: 1
  select_type: PRIMARY
        table: a1
   partitions: NULL
         type: ALL
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: 1
     filtered: 100.00
        Extra: NULL
*************************** 3. row ***************************
           id: 2
  select_type: DERIVED
        table: NULL
   partitions: NULL
         type: NULL
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: NULL
     filtered: NULL
        Extra: No tables used
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM t2;</code></strong>
+------+
| c1   |
+------+
|    5 |
+------+
1 row in set (0.00 sec)
</pre><p>
        This also means that an
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN
        SELECT</code></a> statement such as the one shown here may take a
        long time to execute because the
        <a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a> function is executed
        once for each row in <code class="literal">t1</code>:
      </p><pre data-lang="sql" class="programlisting">
EXPLAIN SELECT * FROM t1 AS a1, (SELECT BENCHMARK(1000000, MD5(NOW())));
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="lateral-derived-tables"></a>13.2.11.9 Lateral Derived Tables</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091664016160"></a><a class="indexterm" name="idm140091664014672"></a><p>
        A derived table cannot normally refer to (depend on) columns of
        preceding tables in the same <code class="literal">FROM</code> clause. As
        of MySQL 8.0.14, a derived table may be defined as a lateral
        derived table to specify that such references are permitted.
      </p><p>
        Nonlateral derived tables are specified using the syntax
        discussed in <a class="xref" href="sql-syntax.html#derived-tables" title="13.2.11.8 Derived Tables">Section 13.2.11.8, “Derived Tables”</a>. The syntax for a
        lateral derived table is the same as for a nonlateral derived
        table except that the keyword <code class="literal">LATERAL</code> is
        specified before the derived table specification. The
        <code class="literal">LATERAL</code> keyword must precede each table to be
        used as a lateral derived table.
      </p><p>
        Lateral derived tables are subject to these restrictions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A lateral derived table can occur only in a
            <code class="literal">FROM</code> clause, either in a list of tables
            separated with commas or in a join specification
            (<code class="literal">JOIN</code>, <code class="literal">INNER JOIN</code>,
            <code class="literal">CROSS JOIN</code>, <code class="literal">LEFT [OUTER]
            JOIN</code>, or <code class="literal">RIGHT [OUTER] JOIN</code>).
          </p></li><li class="listitem"><p>
            If a lateral derived table is in the right operand of a join
            clause and contains a reference to the left operand, the
            join operation must be an <code class="literal">INNER JOIN</code>,
            <code class="literal">CROSS JOIN</code>, or <code class="literal">LEFT [OUTER]
            JOIN</code>.
          </p><p>
            If the table is in the left operand and contains a reference
            to the right operand, the join operation must be an
            <code class="literal">INNER JOIN</code>, <code class="literal">CROSS
            JOIN</code>, or <code class="literal">RIGHT [OUTER] JOIN</code>.
          </p></li><li class="listitem"><p>
            If a lateral derived table references an aggregate function,
            the function's aggregation query cannot be the one that owns
            the <code class="literal">FROM</code> clause in which the lateral
            derived table occurs.
          </p></li><li class="listitem"><p>
            Per the SQL standard, a table function has an implicit
            <code class="literal">LATERAL</code>, so it behaves as in MySQL 8.0
            versions prior to 8.0.14. However, per the standard, the
            <code class="literal">LATERAL</code> word is not allowed before
            <a class="link" href="functions.html#function_json-table"><code class="literal">JSON_TABLE()</code></a>, even though it
            is implicit.
</p></li></ul>
</div>
<p>
        The following discussion shows how lateral derived tables make
        possible certain SQL operations that cannot be done with
        nonlateral derived tables or that require less-efficient
        workarounds.
      </p><p>
        Suppose that we want to solve this problem: Given a table of
        people in a sales force (where each row describes a member of
        the sales force), and a table of all sales (where each row
        describes a sale: salesperson, customer, amount, date),
        determine the size and customer of the largest sale for each
        salesperson. This problem can be approached two ways.
      </p><p>
        First approach to solving the problem: For each salesperson,
        calculate the maximum sale size, and also find the customer who
        provided this maximum. In MySQL, that can be done like this:
      </p><pre data-lang="sql" class="programlisting">
SELECT
  salesperson.name,
  -- find maximum sale size for this salesperson
  (SELECT MAX(amount) AS amount
    FROM all_sales
    WHERE all_sales.salesperson_id = salesperson.id)
  AS amount,
  -- find customer for this maximum size
  (SELECT customer_name
    FROM all_sales
    WHERE all_sales.salesperson_id = salesperson.id
    AND all_sales.amount =
         -- find maximum size, again
         (SELECT MAX(amount) AS amount
           FROM all_sales
           WHERE all_sales.salesperson_id = salesperson.id))
  AS customer_name
FROM
  salesperson;
</pre><p>
        That query is inefficient because it calculates the maximum size
        twice per salesperson (once in the first subquery and once in
        the second).
      </p><p>
        We can try to achieve an efficiency gain by calculating the
        maximum once per salesperson and <span class="quote">“<span class="quote">caching</span>”</span> it in a
        derived table, as shown by this modified query:
      </p><pre data-lang="sql" class="programlisting">
SELECT
  salesperson.name,
  max_sale.amount,
  max_sale_customer.customer_name
FROM
  salesperson,
  -- calculate maximum size, cache it in transient derived table max_sale
  (SELECT MAX(amount) AS amount
    FROM all_sales
    WHERE all_sales.salesperson_id = salesperson.id)
  AS max_sale,
  -- find customer, reusing cached maximum size
  (SELECT customer_name
    FROM all_sales
    WHERE all_sales.salesperson_id = salesperson.id
    AND all_sales.amount =
        -- the cached maximum size
        max_sale.amount)
  AS max_sale_customer;
</pre><p>
        However, the query is illegal in SQL-92 because derived tables
        cannot depend on other tables in the same
        <code class="literal">FROM</code> clause. Derived tables must be constant
        over the query's duration, not contain references to columns of
        other <code class="literal">FROM</code> clause tables. As written, the
        query produces this error:
      </p><pre data-lang="none" class="programlisting">
ERROR 1054 (42S22): Unknown column 'salesperson.id' in 'where clause'
</pre><p>
        In SQL:1999, the query becomes legal if the derived tables are
        preceded by the <code class="literal">LATERAL</code> keyword (which means
        <span class="quote">“<span class="quote">this derived table depends on previous tables on its left
        side</span>”</span>):
      </p><pre data-lang="sql" class="programlisting">
SELECT
  salesperson.name,
  max_sale.amount,
  max_sale_customer.customer_name
FROM
  salesperson,
  -- calculate maximum size, cache it in transient derived table max_sale
  LATERAL
  (SELECT MAX(amount) AS amount
    FROM all_sales
    WHERE all_sales.salesperson_id = salesperson.id)
  AS max_sale,
  -- find customer, reusing cached maximum size
  LATERAL
  (SELECT customer_name
    FROM all_sales
    WHERE all_sales.salesperson_id = salesperson.id
    AND all_sales.amount =
        -- the cached maximum size
        max_sale.amount)
  AS max_sale_customer;
</pre><p>
        A lateral derived table need not be constant and is brought up
        to date each time a new row from a preceding table on which it
        depends is processed by the top query.
      </p><p>
        Second approach to solving the problem: A different solution
        could be used if a subquery in the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> list could return multiple
        columns:
      </p><pre data-lang="sql" class="programlisting">
SELECT
  salesperson.name,
  -- find maximum size and customer at same time
  (SELECT amount, customer_name
    FROM all_sales
    WHERE all_sales.salesperson_id = salesperson.id
    ORDER BY amount DESC LIMIT 1)
FROM
  salesperson;
</pre><p>
        That is efficient but illegal. It does not work because such
        subqueries can return only a single column:
      </p><pre data-lang="none" class="programlisting">
ERROR 1241 (21000): Operand should contain 1 column(s)
</pre><p>
        One attempt at rewriting the query is to select multiple columns
        from a derived table:
      </p><pre data-lang="sql" class="programlisting">
SELECT
  salesperson.name,
  max_sale.amount,
  max_sale.customer_name
FROM
  salesperson,
  -- find maximum size and customer at same time
  (SELECT amount, customer_name
    FROM all_sales
    WHERE all_sales.salesperson_id = salesperson.id
    ORDER BY amount DESC LIMIT 1)
  AS max_sale;
</pre><p>
        However, that also does not work. The derived table is dependent
        on the <code class="literal">salesperson</code> table and thus fails
        without <code class="literal">LATERAL</code>:
      </p><pre data-lang="none" class="programlisting">
ERROR 1054 (42S22): Unknown column 'salesperson.id' in 'where clause'
</pre><p>
        Adding the <code class="literal">LATERAL</code> keyword makes the query
        legal:
      </p><pre data-lang="sql" class="programlisting">
SELECT
  salesperson.name,
  max_sale.amount,
  max_sale.customer_name
FROM
  salesperson,
  -- find maximum size and customer at same time
  LATERAL
  (SELECT amount, customer_name
    FROM all_sales
    WHERE all_sales.salesperson_id = salesperson.id
    ORDER BY amount DESC LIMIT 1)
  AS max_sale;
</pre><p>
        In short, <code class="literal">LATERAL</code> is the efficient solution
        to all drawbacks in the two approaches just discussed.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="subquery-errors"></a>13.2.11.10 Subquery Errors</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091663964512"></a><a class="indexterm" name="idm140091663963024"></a><p>
        There are some errors that apply only to subqueries. This
        section describes them.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Unsupported subquery syntax:
          </p><pre data-lang="none" class="programlisting">
ERROR 1235 (ER_NOT_SUPPORTED_YET)
SQLSTATE = 42000
Message = "This version of MySQL doesn't yet support
'LIMIT &amp; IN/ALL/ANY/SOME subquery'"
</pre><p>
            This means that MySQL does not support statements of the
            following form:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE s1 IN (SELECT s2 FROM t2 ORDER BY s1 LIMIT 1)
</pre></li><li class="listitem"><p>
            Incorrect number of columns from subquery:
          </p><pre data-lang="none" class="programlisting">
ERROR 1241 (ER_OPERAND_COL)
SQLSTATE = 21000
Message = "Operand should contain 1 column(s)"
</pre><p>
            This error occurs in cases like this:
          </p><pre data-lang="sql" class="programlisting">
SELECT (SELECT column1, column2 FROM t2) FROM t1;
</pre><p>
            You may use a subquery that returns multiple columns, if the
            purpose is row comparison. In other contexts, the subquery
            must be a scalar operand. See
            <a class="xref" href="sql-syntax.html#row-subqueries" title="13.2.11.5 Row Subqueries">Section 13.2.11.5, “Row Subqueries”</a>.
          </p></li><li class="listitem"><p>
            Incorrect number of rows from subquery:
          </p><pre data-lang="none" class="programlisting">
ERROR 1242 (ER_SUBSELECT_NO_1_ROW)
SQLSTATE = 21000
Message = "Subquery returns more than 1 row"
</pre><p>
            This error occurs for statements where the subquery must
            return at most one row but returns multiple rows. Consider
            the following example:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE column1 = (SELECT column1 FROM t2);
</pre><p>
            If <code class="literal">SELECT column1 FROM t2</code> returns just
            one row, the previous query will work. If the subquery
            returns more than one row, error 1242 will occur. In that
            case, the query should be rewritten as:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE column1 = ANY (SELECT column1 FROM t2);
</pre></li><li class="listitem"><p>
            Incorrectly used table in subquery:
          </p><pre data-lang="none" class="programlisting">
Error 1093 (ER_UPDATE_TABLE_USED)
SQLSTATE = HY000
Message = "You can't specify target table 'x'
for update in FROM clause"
</pre><p>
            This error occurs in cases such as the following, which
            attempts to modify a table and select from the same table in
            the subquery:
          </p><pre data-lang="sql" class="programlisting">
UPDATE t1 SET column2 = (SELECT MAX(column1) FROM t1);
</pre><p>
            You can use a subquery for assignment within an
            <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement because
            subqueries are legal in
            <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> and
            <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements as well as
            in <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements.
            However, you cannot use the same table (in this case, table
            <code class="literal">t1</code>) for both the subquery
            <code class="literal">FROM</code> clause and the update target.
</p></li></ul>
</div>
<p>
        For transactional storage engines, the failure of a subquery
        causes the entire statement to fail. For nontransactional
        storage engines, data modifications made before the error was
        encountered are preserved.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="optimizing-subqueries"></a>13.2.11.11 Optimizing Subqueries</h4>

</div>

</div>

</div>
<p>
        Development is ongoing, so no optimization tip is reliable for
        the long term. The following list provides some interesting
        tricks that you might want to play with. See also
        <a class="xref" href="optimization.html#subquery-optimization" title="8.2.2 Optimizing Subqueries, Derived Tables, View References, and Common Table Expressions">Section 8.2.2, “Optimizing Subqueries, Derived Tables, View References, and Common Table
        Expressions”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Use subquery clauses that affect the number or order of the
            rows in the subquery. For example:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE t1.column1 IN
  (SELECT column1 FROM t2 ORDER BY column1);
SELECT * FROM t1 WHERE t1.column1 IN
  (SELECT DISTINCT column1 FROM t2);
SELECT * FROM t1 WHERE EXISTS
  (SELECT * FROM t2 LIMIT 1);
</pre></li><li class="listitem"><p>
            Replace a join with a subquery. For example, try this:
          </p><pre data-lang="sql" class="programlisting">
SELECT DISTINCT column1 FROM t1 WHERE t1.column1 IN (
  SELECT column1 FROM t2);
</pre><p>
            Instead of this:
          </p><pre data-lang="sql" class="programlisting">
SELECT DISTINCT t1.column1 FROM t1, t2
  WHERE t1.column1 = t2.column1;
</pre></li><li class="listitem"><p>
            Some subqueries can be transformed to joins for
            compatibility with older versions of MySQL that do not
            support subqueries. However, in some cases, converting a
            subquery to a join may improve performance. See
            <a class="xref" href="sql-syntax.html#rewriting-subqueries" title="13.2.11.12 Rewriting Subqueries as Joins">Section 13.2.11.12, “Rewriting Subqueries as Joins”</a>.
          </p></li><li class="listitem"><p>
            Move clauses from outside to inside the subquery. For
            example, use this query:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1
  WHERE s1 IN (SELECT s1 FROM t1 UNION ALL SELECT s1 FROM t2);
</pre><p>
            Instead of this query:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1
  WHERE s1 IN (SELECT s1 FROM t1) OR s1 IN (SELECT s1 FROM t2);
</pre><p>
            For another example, use this query:
          </p><pre data-lang="sql" class="programlisting">
SELECT (SELECT column1 + 5 FROM t1) FROM t2;
</pre><p>
            Instead of this query:
          </p><pre data-lang="sql" class="programlisting">
SELECT (SELECT column1 FROM t1) + 5 FROM t2;
</pre></li><li class="listitem"><p>
            Use a row subquery instead of a correlated subquery. For
            example, use this query:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1
  WHERE (column1,column2) IN (SELECT column1,column2 FROM t2);
</pre><p>
            Instead of this query:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1
  WHERE EXISTS (SELECT * FROM t2 WHERE t2.column1=t1.column1
                AND t2.column2=t1.column2);
</pre></li><li class="listitem"><p>
            Use <code class="literal">NOT (a = ANY (...))</code> rather than
            <code class="literal">a &lt;&gt; ALL (...)</code>.
          </p></li><li class="listitem"><p>
            Use <code class="literal">x = ANY (<em class="replaceable"><code>table containing
            (1,2)</code></em>)</code> rather than <code class="literal">x=1 OR
            x=2</code>.
          </p></li><li class="listitem"><p>
            Use <code class="literal">= ANY</code> rather than
            <code class="literal">EXISTS</code>.
          </p></li><li class="listitem"><p>
            For uncorrelated subqueries that always return one row,
            <code class="literal">IN</code> is always slower than
            <code class="literal">=</code>. For example, use this query:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1
  WHERE t1.<em class="replaceable"><code>col_name</code></em> = (SELECT a FROM t2 WHERE b = <em class="replaceable"><code>some_const</code></em>);
</pre><p>
            Instead of this query:
          </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1
  WHERE t1.<em class="replaceable"><code>col_name</code></em> IN (SELECT a FROM t2 WHERE b = <em class="replaceable"><code>some_const</code></em>);
</pre></li></ul>
</div>
<p>
        These tricks might cause programs to go faster or slower. Using
        MySQL facilities like the
        <a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a> function, you can get
        an idea about what helps in your own situation. See
        <a class="xref" href="functions.html#information-functions" title="12.15 Information Functions">Section 12.15, “Information Functions”</a>.
      </p><p>
        Some optimizations that MySQL itself makes are:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            MySQL executes uncorrelated subqueries only once. Use
            <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> to make sure that a
            given subquery really is uncorrelated.
          </p></li><li class="listitem"><p>
            MySQL rewrites <code class="literal">IN</code>,
            <code class="literal">ALL</code>, <code class="literal">ANY</code>, and
            <code class="literal">SOME</code> subqueries in an attempt to take
            advantage of the possibility that the select-list columns in
            the subquery are indexed.
          </p></li><li class="listitem"><p>
            MySQL replaces subqueries of the following form with an
            index-lookup function, which
            <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> describes as a
            special join type
            (<a class="link" href="optimization.html#jointype_unique_subquery"><code class="literal">unique_subquery</code></a> or
            <a class="link" href="optimization.html#jointype_index_subquery"><code class="literal">index_subquery</code></a>):
          </p><pre data-lang="sql" class="programlisting">
... IN (SELECT <em class="replaceable"><code>indexed_column</code></em> FROM <em class="replaceable"><code>single_table</code></em> ...)
</pre></li><li class="listitem"><p>
            MySQL enhances expressions of the following form with an
            expression involving <a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a> or
            <a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a>, unless
            <code class="literal">NULL</code> values or empty sets are involved:
          </p><pre data-lang="sql" class="programlisting">
<em class="replaceable"><code>value</code></em> {ALL|ANY|SOME} {&gt; | &lt; | &gt;= | &lt;=} (<em class="replaceable"><code>uncorrelated subquery</code></em>)
</pre><p>
            For example, this <code class="literal">WHERE</code> clause:
          </p><pre data-lang="sql" class="programlisting">
WHERE 5 &gt; ALL (SELECT x FROM t)
</pre><p>
            might be treated by the optimizer like this:
          </p><pre data-lang="sql" class="programlisting">
WHERE 5 &gt; (SELECT MAX(x) FROM t)
</pre></li></ul>
</div>
<p>
        See also
        <a class="ulink" href="https://dev.mysql.com/doc/internals/en/transformations.html" target="_top">MySQL
        Internals: How MySQL Transforms Subqueries</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="rewriting-subqueries"></a>13.2.11.12 Rewriting Subqueries as Joins</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091663874672"></a><p>
        Sometimes there are other ways to test membership in a set of
        values than by using a subquery. Also, on some occasions, it is
        not only possible to rewrite a query without a subquery, but it
        can be more efficient to make use of some of these techniques
        rather than to use subqueries. One of these is the
        <code class="literal">IN()</code> construct:
      </p><p>
        For example, this query:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE id IN (SELECT id FROM t2);
</pre><p>
        Can be rewritten as:
      </p><pre data-lang="sql" class="programlisting">
SELECT DISTINCT t1.* FROM t1, t2 WHERE t1.id=t2.id;
</pre><p>
        The queries:
      </p><pre data-lang="sql" class="programlisting">
SELECT * FROM t1 WHERE id NOT IN (SELECT id FROM t2);
SELECT * FROM t1 WHERE NOT EXISTS (SELECT id FROM t2 WHERE t1.id=t2.id);
</pre><p>
        Can be rewritten as:
      </p><pre data-lang="sql" class="programlisting">
SELECT table1.*
  FROM table1 LEFT JOIN table2 ON table1.id=table2.id
  WHERE table2.id IS NULL;
</pre><p>
        A <code class="literal">LEFT [OUTER] JOIN</code> can be faster than an
        equivalent subquery because the server might be able to optimize
        it better—a fact that is not specific to MySQL Server
        alone. Prior to SQL-92, outer joins did not exist, so subqueries
        were the only way to do certain things. Today, MySQL Server and
        many other modern database systems offer a wide range of outer
        join types.
      </p><p>
        MySQL Server supports multiple-table
        <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements that can be
        used to efficiently delete rows based on information from one
        table or even from many tables at the same time. Multiple-table
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements are also
        supported. See <a class="xref" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax">Section 13.2.2, “DELETE Syntax”</a>, and
        <a class="xref" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax">Section 13.2.12, “UPDATE Syntax”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="update"></a>13.2.12 UPDATE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091663858304"></a><a class="indexterm" name="idm140091663857232"></a><p>
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> is a DML statement that
      modifies rows in a table.
    </p><p>
      An <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement can start with
      a <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause to define common
      table expressions accessible within the
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>. See <a class="xref" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)">Section 13.2.13, “WITH Syntax (Common Table Expressions)”</a>.
    </p><p>
      Single-table syntax:
    </p><pre data-lang="sql" class="programlisting">
UPDATE [LOW_PRIORITY] [IGNORE] <em class="replaceable"><code>table_reference</code></em>
    SET <em class="replaceable"><code>assignment_list</code></em>
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
    [ORDER BY ...]
    [LIMIT <em class="replaceable"><code>row_count</code></em>]

<em class="replaceable"><code>value</code></em>:
    {<em class="replaceable"><code>expr</code></em> | DEFAULT}

<em class="replaceable"><code>assignment</code></em>:
    <em class="replaceable"><code>col_name</code></em> = <em class="replaceable"><code>value</code></em>

<em class="replaceable"><code>assignment_list</code></em>:
    <em class="replaceable"><code>assignment</code></em> [, <em class="replaceable"><code>assignment</code></em>] ...
</pre><p>
      Multiple-table syntax:
    </p><pre data-lang="sql" class="programlisting">
UPDATE [LOW_PRIORITY] [IGNORE] <em class="replaceable"><code>table_references</code></em>
    SET <em class="replaceable"><code>assignment_list</code></em>
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
</pre><p>
      For the single-table syntax, the
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement updates columns of
      existing rows in the named table with new values. The
      <code class="literal">SET</code> clause indicates which columns to modify
      and the values they should be given. Each value can be given as an
      expression, or the keyword <code class="literal">DEFAULT</code> to set a
      column explicitly to its default value. The
      <code class="literal">WHERE</code> clause, if given, specifies the
      conditions that identify which rows to update. With no
      <code class="literal">WHERE</code> clause, all rows are updated. If the
      <code class="literal">ORDER BY</code> clause is specified, the rows are
      updated in the order that is specified. The
      <code class="literal">LIMIT</code> clause places a limit on the number of
      rows that can be updated.
    </p><p>
      For the multiple-table syntax,
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> updates rows in each table
      named in <em class="replaceable"><code>table_references</code></em> that satisfy
      the conditions. Each matching row is updated once, even if it
      matches the conditions multiple times. For multiple-table syntax,
      <code class="literal">ORDER BY</code> and <code class="literal">LIMIT</code> cannot be
      used.
    </p><p>
      For partitioned tables, both the single-single and multiple-table
      forms of this statement support the use of a
      <code class="literal">PARTITION</code> option as part of a table reference.
      This option takes a list of one or more partitions or
      subpartitions (or both). Only the partitions (or subpartitions)
      listed are checked for matches, and a row that is not in any of
      these partitions or subpartitions is not updated, whether it
      satisfies the <em class="replaceable"><code>where_condition</code></em> or not.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Unlike the case when using <code class="literal">PARTITION</code> with an
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> or
        <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a> statement, an otherwise
        valid <code class="literal">UPDATE ... PARTITION</code> statement is
        considered successful even if no rows in the listed partitions
        (or subpartitions) match the
        <em class="replaceable"><code>where_condition</code></em>.
</p>
</div>
<p>
      For more information and examples, see
      <a class="xref" href="partitioning.html#partitioning-selection" title="23.5 Partition Selection">Section 23.5, “Partition Selection”</a>.
    </p><p>
      <em class="replaceable"><code>where_condition</code></em> is an expression that
      evaluates to true for each row to be updated. For expression
      syntax, see <a class="xref" href="language-structure.html#expressions" title="9.5 Expressions">Section 9.5, “Expressions”</a>.
    </p><p>
      <em class="replaceable"><code>table_references</code></em> and
      <em class="replaceable"><code>where_condition</code></em> are specified as
      described in <a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax">Section 13.2.10, “SELECT Syntax”</a>.
    </p><p>
      You need the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege only
      for columns referenced in an <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>
      that are actually updated. You need only the
      <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for any columns
      that are read but not modified.
    </p><p>
      The <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement supports the
      following modifiers:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          With the <code class="literal">LOW_PRIORITY</code> modifier, execution
          of the <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> is delayed until
          no other clients are reading from the table. This affects only
          storage engines that use only table-level locking (such as
          <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>, and
          <code class="literal">MERGE</code>).
        </p><a class="indexterm" name="idm140091663803440"></a></li><li class="listitem"><p>
          With the <code class="literal">IGNORE</code> modifier, the update
          statement does not abort even if errors occur during the
          update. Rows for which duplicate-key conflicts occur on a
          unique key value are not updated. Rows updated to values that
          would cause data conversion errors are updated to the closest
          valid values instead. For more information, see
          <a class="xref" href="server-administration.html#ignore-strict-comparison" title="Comparison of the IGNORE Keyword and Strict SQL Mode">Comparison of the IGNORE Keyword and Strict SQL Mode</a>.
</p><a class="indexterm" name="idm140091663799328"></a></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE IGNORE</code></a>
      statements, including those having an <code class="literal">ORDER BY</code>
      clause, are flagged as unsafe for statement-based replication.
      (This is because the order in which the rows are updated
      determines which rows are ignored.) Such statements produce a
      warning in the error log when using statement-based mode and are
      written to the binary log using the row-based format when using
      <code class="literal">MIXED</code> mode. (Bug #11758262, Bug #50439) See
      <a class="xref" href="replication.html#replication-rbr-safe-unsafe" title="17.2.1.3 Determination of Safe and Unsafe Statements in Binary Logging">Section 17.2.1.3, “Determination of Safe and Unsafe Statements in Binary Logging”</a>, for more
      information.
    </p><p>
      If you access a column from the table to be updated in an
      expression, <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> uses the current
      value of the column. For example, the following statement sets
      <code class="literal">col1</code> to one more than its current value:
    </p><pre data-lang="sql" class="programlisting">
UPDATE t1 SET col1 = col1 + 1;
</pre><p>
      The second assignment in the following statement sets
      <code class="literal">col2</code> to the current (updated)
      <code class="literal">col1</code> value, not the original
      <code class="literal">col1</code> value. The result is that
      <code class="literal">col1</code> and <code class="literal">col2</code> have the same
      value. This behavior differs from standard SQL.
    </p><pre data-lang="sql" class="programlisting">
UPDATE t1 SET col1 = col1 + 1, col2 = col1;
</pre><p>
      Single-table <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> assignments are
      generally evaluated from left to right. For multiple-table
      updates, there is no guarantee that assignments are carried out in
      any particular order.
    </p><p>
      If you set a column to the value it currently has, MySQL notices
      this and does not update it.
    </p><p>
      If you update a column that has been declared <code class="literal">NOT
      NULL</code> by setting to <code class="literal">NULL</code>, an error
      occurs if strict SQL mode is enabled; otherwise, the column is set
      to the implicit default value for the column data type and the
      warning count is incremented. The implicit default value is
      <code class="literal">0</code> for numeric types, the empty string
      (<code class="literal">''</code>) for string types, and the
      <span class="quote">“<span class="quote">zero</span>”</span> value for date and time types. See
      <a class="xref" href="data-types.html#data-type-defaults" title="11.7 Data Type Default Values">Section 11.7, “Data Type Default Values”</a>.
    </p><a class="indexterm" name="idm140091663777120"></a><p>
      If a generated column is updated explicitly, the only permitted
      value is <code class="literal">DEFAULT</code>. For information about
      generated columns, see
      <a class="xref" href="sql-syntax.html#create-table-generated-columns" title="13.1.20.9 CREATE TABLE and Generated Columns">Section 13.1.20.9, “CREATE TABLE and Generated Columns”</a>.
    </p><a class="indexterm" name="idm140091663773632"></a><p>
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> returns the number of rows
      that were actually changed. The
      <a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info()"><code class="literal">mysql_info()</code></a> C API function
      returns the number of rows that were matched and updated and the
      number of warnings that occurred during the
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>.
    </p><p>
      You can use <code class="literal">LIMIT
      <em class="replaceable"><code>row_count</code></em></code> to restrict the
      scope of the <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>. A
      <code class="literal">LIMIT</code> clause is a rows-matched restriction. The
      statement stops as soon as it has found
      <em class="replaceable"><code>row_count</code></em> rows that satisfy the
      <code class="literal">WHERE</code> clause, whether or not they actually were
      changed.
    </p><p>
      If an <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement includes an
      <code class="literal">ORDER BY</code> clause, the rows are updated in the
      order specified by the clause. This can be useful in certain
      situations that might otherwise result in an error. Suppose that a
      table <code class="literal">t</code> contains a column <code class="literal">id</code>
      that has a unique index. The following statement could fail with a
      duplicate-key error, depending on the order in which rows are
      updated:
    </p><pre data-lang="sql" class="programlisting">
UPDATE t SET id = id + 1;
</pre><p>
      For example, if the table contains 1 and 2 in the
      <code class="literal">id</code> column and 1 is updated to 2 before 2 is
      updated to 3, an error occurs. To avoid this problem, add an
      <code class="literal">ORDER BY</code> clause to cause the rows with larger
      <code class="literal">id</code> values to be updated before those with
      smaller values:
    </p><pre data-lang="sql" class="programlisting">
UPDATE t SET id = id + 1 ORDER BY id DESC;
</pre><p>
      You can also perform <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>
      operations covering multiple tables. However, you cannot use
      <code class="literal">ORDER BY</code> or <code class="literal">LIMIT</code> with a
      multiple-table <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>. The
      <em class="replaceable"><code>table_references</code></em> clause lists the
      tables involved in the join. Its syntax is described in
      <a class="xref" href="sql-syntax.html#join" title="13.2.10.2 JOIN Syntax">Section 13.2.10.2, “JOIN Syntax”</a>. Here is an example:
    </p><pre data-lang="sql" class="programlisting">
UPDATE items,month SET items.price=month.price
WHERE items.id=month.id;
</pre><p>
      The preceding example shows an inner join that uses the comma
      operator, but multiple-table <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>
      statements can use any type of join permitted in
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements, such as
      <code class="literal">LEFT JOIN</code>.
    </p><p>
      If you use a multiple-table <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>
      statement involving <code class="literal">InnoDB</code> tables for which
      there are foreign key constraints, the MySQL optimizer might
      process tables in an order that differs from that of their
      parent/child relationship. In this case, the statement fails and
      rolls back. Instead, update a single table and rely on the
      <code class="literal">ON UPDATE</code> capabilities that
      <code class="literal">InnoDB</code> provides to cause the other tables to be
      modified accordingly. See
      <a class="xref" href="innodb-storage-engine.html#innodb-foreign-key-constraints" title="15.6.1.5 InnoDB and FOREIGN KEY Constraints">Section 15.6.1.5, “InnoDB and FOREIGN KEY Constraints”</a>.
    </p><p>
      You cannot update a table and select from the same table in a
      subquery.
    </p><p>
      An <code class="literal">UPDATE</code> on a partitioned table using a
      storage engine such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that
      employs table-level locks locks only those partitions containing
      rows that match the <code class="literal">UPDATE</code> statement
      <code class="literal">WHERE</code> clause, as long as none of the table
      partitioning columns are updated. (For storage engines such as
      <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that employ row-level locking,
      no locking of partitions takes place.) For more information, see
      <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/partitioning-limitations-locking.html" target="_top">Partitioning and Locking</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="with"></a>13.2.13 WITH Syntax (Common Table Expressions)</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091663731712"></a><p>
      A common table expression (CTE) is a named temporary result set
      that exists within the scope of a single statement and that can be
      referred to later within that statement, possibly multiple times.
      The following discussion describes how to write statements that
      use CTEs.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#common-table-expressions-syntax" title="Common Table Expression Syntax">Common Table Expression Syntax</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#common-table-expressions-recursive" title="Recursive Common Table Expressions">Recursive Common Table Expressions</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#common-table-expressions-recursion-limits" title="Limiting Common Table Expression Recursion">Limiting Common Table Expression Recursion</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#common-table-expressions-recursive-examples" title="Recursive Common Table Expression Examples">Recursive Common Table Expression Examples</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#common-table-expressions-similar-constructs" title="Common Table Expressions Compared to Similar Constructs">Common Table Expressions Compared to Similar Constructs</a></p></li></ul>
</div>
<p>
      For information about CTE optimization, see
      <a class="xref" href="optimization.html#derived-table-optimization" title="8.2.2.4 Optimizing Derived Tables, View References, and Common Table Expressions with Merging or Materialization">Section 8.2.2.4, “Optimizing Derived Tables, View References, and Common Table Expressions
          with Merging or Materialization”</a>.
</p>
<h4><a name="idm140091663723024"></a>Additional Resources</h4>
<p>
      These articles contain additional information about using CTEs in
      MySQL, including many examples:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="ulink" href="http://mysqlserverteam.com/mysql-8-0-labs-recursive-common-table-expressions-in-mysql-ctes/" target="_top">MySQL
          8.0 Labs: [Recursive] Common Table Expressions in MySQL
          (CTEs)</a>
        </p></li><li class="listitem"><p>
          <a class="ulink" href="http://mysqlserverteam.com/mysql-8-0-labs-recursive-common-table-expressions-in-mysql-ctes-part-two-how-to-generate-series/" target="_top">MySQL
          8.0 Labs: [Recursive] Common Table Expressions in MySQL
          (CTEs), Part Two – how to generate series</a>
        </p></li><li class="listitem"><p>
          <a class="ulink" href="http://mysqlserverteam.com/mysql-8-0-labs-recursive-common-table-expressions-in-mysql-ctes-part-three-hierarchies/" target="_top">MySQL
          8.0 Labs: [Recursive] Common Table Expressions in MySQL
          (CTEs), Part Three – hierarchies</a>
        </p></li><li class="listitem"><p>
          <a class="ulink" href="http://mysqlserverteam.com/mysql-8-0-1-recursive-common-table-expressions-in-mysql-ctes-part-four-depth-first-or-breadth-first-traversal-transitive-closure-cycle-avoidance/" target="_top">MySQL
          8.0.1: [Recursive] Common Table Expressions in MySQL (CTEs),
          Part Four – depth-first or breadth-first traversal,
          transitive closure, cycle avoidance</a>
</p></li></ul>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="common-table-expressions-syntax"></a>Common Table Expression Syntax</h4>

</div>

</div>

</div>
<p>
        To specify common table expressions, use a
        <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause that has one or more
        comma-separated subclauses. Each subclause provides a subquery
        that produces a result set, and associates a name with the
        subquery. The following example defines CTEs named
        <code class="literal">cte1</code> and <code class="literal">cte2</code> in the
        <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause, and refers to them
        in the top-level <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> that
        follows the <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause:
      </p><pre data-lang="sql" class="programlisting">
WITH
  cte1 AS (SELECT a, b FROM table1),
  cte2 AS (SELECT c, d FROM table2)
SELECT b, d FROM cte1 JOIN cte2
WHERE cte1.a = cte2.c;
</pre><p>
        In the statement containing the
        <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause, each CTE name can be
        referenced to access the corresponding CTE result set.
      </p><p>
        A CTE name can be referenced in other CTEs, enabling CTEs to be
        defined based on other CTEs.
      </p><p>
        A CTE can refer to itself to define a recursive CTE. Common
        applications of recursive CTEs include series generation and
        traversal of hierarchical or tree-structured data.
      </p><p>
        Common table expressions are an optional part of the syntax for
        DML statements. They are defined using a
        <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause:
      </p><pre data-lang="sql" class="programlisting">
<em class="replaceable"><code>with_clause</code></em>:
    WITH [RECURSIVE]
        <em class="replaceable"><code>cte_name</code></em> [(<em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...)] AS (<em class="replaceable"><code>subquery</code></em>)
        [, <em class="replaceable"><code>cte_name</code></em> [(<em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...)] AS (<em class="replaceable"><code>subquery</code></em>)] ...
</pre><p>
        <em class="replaceable"><code>cte_name</code></em> names a single common table
        expression and can be used as a table reference in the statement
        containing the <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause.
      </p><p>
        The <em class="replaceable"><code>subquery</code></em> part of <code class="literal">AS
        (<em class="replaceable"><code>subquery</code></em>)</code> is called the
        <span class="quote">“<span class="quote">subquery of the CTE</span>”</span> and is what produces the CTE
        result set. The parentheses following <code class="literal">AS</code> are
        required.
      </p><p>
        A common table expression is recursive if its subquery refers to
        its own name. The <code class="literal">RECURSIVE</code> keyword must be
        included if any CTE in the <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a>
        clause is recursive. For more information, see
        <a class="xref" href="sql-syntax.html#common-table-expressions-recursive" title="Recursive Common Table Expressions">Recursive Common Table Expressions</a>.
      </p><p>
        Determination of column names for a given CTE occurs as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If a parenthesized list of names follows the CTE name, those
            names are the column names:
          </p><pre data-lang="sql" class="programlisting">
WITH cte (col1, col2) AS
(
  SELECT 1, 2
  UNION ALL
  SELECT 3, 4
)
SELECT col1, col2 FROM cte;
</pre><p>
            The number of names in the list must be the same as the
            number of columns in the result set.
          </p></li><li class="listitem"><p>
            Otherwise, the column names come from the select list of the
            first <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> within the
            <code class="literal">AS (<em class="replaceable"><code>subquery</code></em>)</code>
            part:
          </p><pre data-lang="sql" class="programlisting">
WITH cte AS
(
  SELECT 1 AS col1, 2 AS col2
  UNION ALL
  SELECT 3, 4
)
SELECT col1, col2 FROM cte;
</pre></li></ul>
</div>
<p>
        A <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause is permitted in
        these contexts:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            At the beginning of <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>,
            <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>, and
            <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements.
          </p><pre data-lang="sql" class="programlisting">
WITH ... SELECT ...
WITH ... UPDATE ...
WITH ... DELETE ...
</pre></li><li class="listitem"><p>
            At the beginning of subqueries (including derived table
            subqueries):
          </p><pre data-lang="sql" class="programlisting">
SELECT ... WHERE id IN (WITH ... SELECT ...) ...
SELECT * FROM (WITH ... SELECT ...) AS dt ...
</pre></li><li class="listitem"><p>
            Immediately preceding <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
            for statements that include a
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement:
          </p><pre data-lang="sql" class="programlisting">
INSERT ... WITH ... SELECT ...
REPLACE ... WITH ... SELECT ...
CREATE TABLE ... WITH ... SELECT ...
CREATE VIEW ... WITH ... SELECT ...
DECLARE CURSOR ... WITH ... SELECT ...
EXPLAIN ... WITH ... SELECT ...
</pre></li></ul>
</div>
<p>
        Only one <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause is permitted
        at the same level. <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> followed
        by <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> at the same level is not
        permitted, so this is illegal:
      </p><pre data-lang="sql" class="programlisting">
WITH cte1 AS (...) WITH cte2 AS (...) SELECT ...
</pre><p>
        To make the statement legal, use a single
        <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause that separates the
        subclauses by a comma:
      </p><pre data-lang="sql" class="programlisting">
WITH cte1 AS (...), cte2 AS (...) SELECT ...
</pre><p>
        However, a statement can contain multiple
        <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clauses if they occur at
        different levels:
      </p><pre data-lang="sql" class="programlisting">
WITH cte1 AS (SELECT 1)
SELECT * FROM (WITH cte2 AS (SELECT 2) SELECT * FROM cte2 JOIN cte1) AS dt;
</pre><p>
        A <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause can define one or
        more common table expressions, but each CTE name must be unique
        to the clause. This is illegal:
      </p><pre data-lang="sql" class="programlisting">
WITH cte1 AS (...), cte1 AS (...) SELECT ...
</pre><p>
        To make the statement legal, define the CTEs with unique names:
      </p><pre data-lang="sql" class="programlisting">
WITH cte1 AS (...), cte2 AS (...) SELECT ...
</pre><p>
        A CTE can refer to itself or to other CTEs:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A self-referencing CTE is recursive.
          </p></li><li class="listitem"><p>
            A CTE can refer to CTEs defined earlier in the same
            <a class="link" href="sql-syntax.html#with" title="13.2.13 WITH Syntax (Common Table Expressions)"><code class="literal">WITH</code></a> clause, but not those
            defined later.
          </p><p>
            This constraint rules out mutually-recursive CTEs, where
            <code class="literal">cte1</code> references <code class="literal">cte2</code>
            and <code class="literal">cte2</code> references
            <code class="literal">cte1</code>. One of those references must be to
            a CTE defined later, which is not permitted.
          </p></li><li class="listitem"><p>
            A CTE in a given query block can refer to CTEs defined in
            query blocks at a more outer level, but not CTEs defined in
            query blocks at a more inner level.
</p></li></ul>
</div>
<p>
        For resolving references to objects with the same names, derived
        tables hide CTEs; and CTEs hide base tables,
        <code class="literal">TEMPORARY</code> tables, and views. Name resolution
        occurs by searching for objects in the same query block, then
        proceeding to outer blocks in turn while no object with the name
        is found.
      </p><p>
        Like derived tables, a CTE cannot contain outer references prior
        to MySQL 8.0.14. This is a MySQL restriction that is lifted in
        MySQL 8.0.14, not a restriction of the SQL standard. For
        additional syntax considerations specific to recursive CTEs, see
        <a class="xref" href="sql-syntax.html#common-table-expressions-recursive" title="Recursive Common Table Expressions">Recursive Common Table Expressions</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="common-table-expressions-recursive"></a>Recursive Common Table Expressions</h4>

</div>

</div>

</div>
<p>
        A recursive common table expression is one having a subquery
        that refers to its own name. For example:
      </p><pre data-lang="sql" class="programlisting">
WITH RECURSIVE cte (n) AS
(
  SELECT 1
  UNION ALL
  SELECT n + 1 FROM cte WHERE n &lt; 5
)
SELECT * FROM cte;
</pre><p>
        When executed, the statement produces this result, a single
        column containing a simple linear sequence:
      </p><pre data-lang="none" class="programlisting">
+------+
| n    |
+------+
|    1 |
|    2 |
|    3 |
|    4 |
|    5 |
+------+
</pre><p>
        A recursive CTE has this structure:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The <code class="literal">WITH</code> clause must begin with
            <code class="literal">WITH RECURSIVE</code> if any CTE in the
            <code class="literal">WITH</code> clause refers to itself. (If no CTE
            refers to itself, <code class="literal">RECURSIVE</code> is permitted
            but not required.)
          </p><p>
            If you forget <code class="literal">RECURSIVE</code> for a recursive
            CTE, this error is a likely result:
          </p><pre data-lang="none" class="programlisting">
ERROR 1146 (42S02): Table '<em class="replaceable"><code>cte_name</code></em>' doesn't exist
</pre></li><li class="listitem"><p>
            The recursive CTE subquery has two parts, separated by
            <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION [ALL]</code></a>
            or <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION
            DISTINCT</code></a>:
          </p><pre data-lang="sql" class="programlisting">
SELECT ...      -- return initial row set
UNION ALL
SELECT ...      -- return additional row sets
</pre><p>
            The first <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> produces the
            initial row or rows for the CTE and does not refer to the
            CTE name. The second <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
            produces additional rows and recurses by referring to the
            CTE name in its <code class="literal">FROM</code> clause. Recursion
            ends when this part produces no new rows. Thus, a recursive
            CTE consists of a nonrecursive
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part followed by a
            recursive <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part.
          </p><p>
            Each <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part can itself
            be a union of multiple <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
            statements.
          </p></li><li class="listitem"><p>
            The types of the CTE result columns are inferred from the
            column types of the nonrecursive
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part only, and the
            columns are all nullable. For type determination, the
            recursive <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part is
            ignored.
          </p></li><li class="listitem"><p>
            If the nonrecursive and recursive parts are separated by
            <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION
            DISTINCT</code></a>, duplicate rows are eliminated. This is
            useful for queries that perform transitive closures, to
            avoid infinite loops.
          </p></li><li class="listitem"><p>
            Each iteration of the recursive part operates only on the
            rows produced by the previous iteration. If the recursive
            part has multiple query blocks, iterations of each query
            block are scheduled in unspecified order, and each query
            block operates on rows that have been produced either by its
            previous iteration or by other query blocks since that
            previous iteration's end.
</p></li></ul>
</div>
<p>
        The recursive CTE subquery shown earlier has this nonrecursive
        part that retrieves a single row to produce the initial row set:
      </p><pre data-lang="sql" class="programlisting">
SELECT 1
</pre><p>
        The CTE subquery also has this recursive part:
      </p><pre data-lang="sql" class="programlisting">
SELECT n + 1 FROM cte WHERE n &lt; 5
</pre><p>
        At each iteration, that <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        produces a row with a new value one greater than the value of
        <code class="literal">n</code> from the previous row set. The first
        iteration operates on the initial row set (<code class="literal">1</code>)
        and produces <code class="literal">1+1=2</code>; the second iteration
        operates on the first iteration's row set (<code class="literal">2</code>)
        and produces <code class="literal">2+1=3</code>; and so forth. This
        continues until recursion ends, which occurs when
        <code class="literal">n</code> is no longer less than 5.
      </p><p>
        If the recursive part of a CTE produces wider values for a
        column than the nonrecursive part, it may be necessary to widen
        the column in the nonrecursive part to avoid data truncation.
        Consider this statement:
      </p><pre data-lang="sql" class="programlisting">
WITH RECURSIVE cte AS
(
  SELECT 1 AS n, 'abc' AS str
  UNION ALL
  SELECT n + 1, CONCAT(str, str) FROM cte WHERE n &lt; 3
)
SELECT * FROM cte;
</pre><p>
        In nonstrict SQL mode, the statement produces this output:
      </p><pre data-lang="none" class="programlisting">
+------+------+
| n    | str  |
+------+------+
|    1 | abc  |
|    2 | abc  |
|    3 | abc  |
+------+------+
</pre><p>
        The <code class="literal">str</code> column values are all
        <code class="literal">'abc'</code> because the nonrecursive
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> determines the column
        widths. Consequently, the wider <code class="literal">str</code> values
        produced by the recursive <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        are truncated.
      </p><p>
        In strict SQL mode, the statement produces an error:
      </p><pre data-lang="none" class="programlisting">
ERROR 1406 (22001): Data too long for column 'str' at row 1
</pre><p>
        To address this issue, so that the statement does not produce
        truncation or errors, use <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a>
        in the nonrecursive <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> to
        make the <code class="literal">str</code> column wider:
      </p><pre data-lang="sql" class="programlisting">
WITH RECURSIVE cte AS
(
  SELECT 1 AS n, CAST('abc' AS CHAR(20)) AS str
  UNION ALL
  SELECT n + 1, CONCAT(str, str) FROM cte WHERE n &lt; 3
)
SELECT * FROM cte;
</pre><p>
        Now the statement produces this result, without truncation:
      </p><pre data-lang="none" class="programlisting">
+------+--------------+
| n    | str          |
+------+--------------+
|    1 | abc          |
|    2 | abcabc       |
|    3 | abcabcabcabc |
+------+--------------+
</pre><p>
        Columns are accessed by name, not position, which means that
        columns in the recursive part can access columns in the
        nonrecursive part that have a different position, as this CTE
        illustrates:
      </p><pre data-lang="sql" class="programlisting">
WITH RECURSIVE cte AS
(
  SELECT 1 AS n, 1 AS p, -1 AS q
  UNION ALL
  SELECT n + 1, q * 2, p * 2 FROM cte WHERE n &lt; 5
)
SELECT * FROM cte;
</pre><p>
        Because <code class="literal">p</code> in one row is derived from
        <code class="literal">q</code> in the previous row, and vice versa, the
        positive and negative values swap positions in each successive
        row of the output:
      </p><pre data-lang="none" class="programlisting">
+------+------+------+
| n    | p    | q    |
+------+------+------+
|    1 |    1 |   -1 |
|    2 |   -2 |    2 |
|    3 |    4 |   -4 |
|    4 |   -8 |    8 |
|    5 |   16 |  -16 |
+------+------+------+
</pre><p>
        Some syntax constraints apply within recursive CTE subqueries:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The recursive <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part
            must not contain these constructs:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                Aggregate functions such as <code class="literal">SUM()</code>
              </p></li><li class="listitem"><p>
                Window functions
              </p></li><li class="listitem"><p>
                <code class="literal">GROUP BY</code>
              </p></li><li class="listitem"><p>
                <code class="literal">ORDER BY</code>
              </p></li><li class="listitem"><p>
                <code class="literal">LIMIT</code>
              </p></li><li class="listitem"><p>
                <code class="literal">DISTINCT</code>
</p></li></ul>
</div>
<p>
            This constraint does not apply to the nonrecursive
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part of a recursive
            CTE. The prohibition on <code class="literal">DISTINCT</code> applies
            only to <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION Syntax"><code class="literal">UNION</code></a> members;
            <code class="literal">UNION DISTINCT</code> is permitted.
          </p></li><li class="listitem"><p>
            The recursive <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part
            must reference the CTE only once and only in its
            <code class="literal">FROM</code> clause, not in any subquery. It can
            reference tables other than the CTE and join them with the
            CTE. If used in a join like this, the CTE must not be on the
            right side of a <code class="literal">LEFT JOIN</code>.
</p></li></ul>
</div>
<p>
        These constraints come from the SQL standard, other than the
        MySQL-specific exclusions of <code class="literal">ORDER BY</code>,
        <code class="literal">LIMIT</code>, and <code class="literal">DISTINCT</code>.
      </p><p>
        For recursive CTEs, <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>
        output rows for recursive <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        parts display <code class="literal">Recursive</code> in the
        <code class="literal">Extra</code> column.
      </p><p>
        Cost estimates displayed by
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> represent cost per
        iteration, which might differ considerably from total cost. The
        optimizer cannot predict the number of iterations because it
        cannot predict when the <code class="literal">WHERE</code> clause will
        become false.
      </p><p>
        CTE actual cost may also be affected by result set size. A CTE
        that produces many rows may require an internal temporary table
        large enough to be converted from in-memory to on-disk format
        and may suffer a performance penalty. If so, increasing the
        permitted in-memory temporary table size may improve
        performance; see <a class="xref" href="optimization.html#internal-temporary-tables" title="8.4.4 Internal Temporary Table Use in MySQL">Section 8.4.4, “Internal Temporary Table Use in MySQL”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="common-table-expressions-recursion-limits"></a>Limiting Common Table Expression Recursion</h4>

</div>

</div>

</div>
<p>
        It is important for recursive CTEs that the recursive
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> part include a condition
        to terminate recursion. As a development technique to guard
        against a runaway recursive CTE, you can force termination by
        placing a limit on execution time:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The <a class="link" href="server-administration.html#sysvar_cte_max_recursion_depth"><code class="literal">cte_max_recursion_depth</code></a>
            system variable enforces a limit on the number of recursion
            levels for CTEs. The server terminates execution of any CTE
            that recurses more levels than the value of this variable.
          </p></li><li class="listitem"><p>
            The <a class="link" href="server-administration.html#sysvar_max_execution_time"><code class="literal">max_execution_time</code></a>
            system variable enforces an execution timeout for
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements executed
            within the current session.
          </p></li><li class="listitem"><p>
            The <a class="link" href="optimization.html#optimizer-hints-execution-time" title="Statement Execution Time Optimizer Hints"><code class="literal">MAX_EXECUTION_TIME</code></a>
            optimizer hint enforces a per-query execution timeout for
            the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement in which
            it appears.
</p></li></ul>
</div>
<p>
        Suppose that a recursive CTE is mistakenly written with no
        recursion execution termination condition:
      </p><pre data-lang="sql" class="programlisting">
WITH RECURSIVE cte (n) AS
(
  SELECT 1
  UNION ALL
  SELECT n + 1 FROM cte
)
SELECT * FROM cte;
</pre><p>
        By default,
        <a class="link" href="server-administration.html#sysvar_cte_max_recursion_depth"><code class="literal">cte_max_recursion_depth</code></a> has a
        value of 1000, causing the CTE to terminate when it recurses
        past 1000 levels. Applications can change the session value to
        adjust for their requirements:
      </p><pre data-lang="sql" class="programlisting">
SET SESSION cte_max_recursion_depth = 10;      -- permit only shallow recursion
SET SESSION cte_max_recursion_depth = 1000000; -- permit deeper recursion
</pre><p>
        You can also set the global
        <a class="link" href="server-administration.html#sysvar_cte_max_recursion_depth"><code class="literal">cte_max_recursion_depth</code></a> value
        to affect all sessions that begin subsequently.
      </p><p>
        For queries that execute and thus recurse slowly or in contexts
        for which there is reason to set the
        <a class="link" href="server-administration.html#sysvar_cte_max_recursion_depth"><code class="literal">cte_max_recursion_depth</code></a> value
        very high, another way to guard against deep recursion is to set
        a per-session timeout. To do so, execute a statement like this
        prior to executing the CTE statement:
      </p><pre data-lang="sql" class="programlisting">
SET max_execution_time = 1000; -- impose one second timeout
</pre><p>
        Alternatively, include an optimizer hint within the CTE
        statement itself:
      </p><pre data-lang="sql" class="programlisting">
WITH RECURSIVE cte (n) AS
(
  SELECT 1
  UNION ALL
  SELECT n + 1 FROM cte
)
SELECT /*+ MAX_EXECUTION_TIME(1000) */ * FROM cte;
</pre><p>
        If a recursive query without an execution time limit enters an
        infinite loop, you can terminate it from another session using
        <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL QUERY</code></a>.
        Within the session itself, the client program used to run the
        query might provide a way to kill the query. For example, in
        <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a>, typing <span class="keycap"><strong>Control+C</strong></span>
        interrupts the current statement.
</p><a class="indexterm" name="idm140091663518656"></a><a class="indexterm" name="idm140091663517168"></a>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="common-table-expressions-recursive-examples"></a>Recursive Common Table Expression Examples</h4>

</div>

</div>

</div>
<p>
        As mentioned previously, recursive common table expressions
        (CTEs) are frequently used for series generation and traversing
        hierarchical or tree-structured data. This section shows some
        simple examples of these techniques.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#common-table-expressions-recursive-fibonacci-series" title="Fibonacci Series Generation">Fibonacci Series Generation</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#common-table-expressions-recursive-date-series" title="Date Series Generation">Date Series Generation</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#common-table-expressions-recursive-hierarchy-traversal" title="Hierarchical Data Traversal">Hierarchical Data Traversal</a></p></li></ul>
</div>
<h5><a name="common-table-expressions-recursive-fibonacci-series"></a>Fibonacci Series Generation</h5>
<p>
        A Fibonacci series begins with the two numbers 0 and 1 (or 1 and
        1) and each number after that is the sum of the previous two
        numbers. A recursive common table expression can generate a
        Fibonacci series if each row produced by the recursive
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> has access to the two
        previous numbers from the series. The following CTE generates a
        10-number series using 0 and 1 as the first two numbers:
      </p><pre data-lang="sql" class="programlisting">
WITH RECURSIVE fibonacci (n, fib_n, next_fib_n) AS
(
  SELECT 1, 0, 1
  UNION ALL
  SELECT n + 1, next_fib_n, fib_n + next_fib_n
    FROM fibonacci WHERE n &lt; 10
)
SELECT * FROM fibonacci;
</pre><p>
        The CTE produces this result:
      </p><pre data-lang="none" class="programlisting">
+------+-------+------------+
| n    | fib_n | next_fib_n |
+------+-------+------------+
|    1 |     0 |          1 |
|    2 |     1 |          1 |
|    3 |     1 |          2 |
|    4 |     2 |          3 |
|    5 |     3 |          5 |
|    6 |     5 |          8 |
|    7 |     8 |         13 |
|    8 |    13 |         21 |
|    9 |    21 |         34 |
|   10 |    34 |         55 |
+------+-------+------------+
</pre><p>
        How the CTE works:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">n</code> is a display column to indicate that
            the row contains the <code class="literal">n</code>-th Fibonacci
            number. For example, the 8th Fibonacci number is 13.
          </p></li><li class="listitem"><p>
            The <code class="literal">fib_n</code> column displays Fibonacci
            number <code class="literal">n</code>.
          </p></li><li class="listitem"><p>
            The <code class="literal">next_fib_n</code> column displays the next
            Fibonacci number after number <code class="literal">n</code>. This
            column provides the next series value to the next row, so
            that row can produce the sum of the two previous series
            values in its <code class="literal">fib_n</code> column.
          </p></li><li class="listitem"><p>
            Recursion ends when <code class="literal">n</code> reaches 10. This is
            an arbitrary choice, to limit the output to a small set of
            rows.
</p></li></ul>
</div>
<p>
        The preceding output shows the entire CTE result. To select just
        part of it, add an appropriate <code class="literal">WHERE</code> clause
        to the top-level <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>. For
        example, to select the 8th Fibonacci number, do this:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>WITH RECURSIVE fibonacci ...</code></strong>
       ...
       <strong class="userinput"><code>SELECT fib_n FROM fibonacci WHERE n = 8;</code></strong>
+-------+
| fib_n |
+-------+
|    13 |
+-------+
</pre>
<h5><a name="common-table-expressions-recursive-date-series"></a>Date Series Generation</h5>
<p>
        A common table expression can generate a series of successive
        dates, which is useful for generating summaries that include a
        row for all dates in the series, including dates not represented
        in the summarized data.
      </p><p>
        Suppose that a table of sales numbers contains these rows:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM sales ORDER BY date, price;</code></strong>
+------------+--------+
| date       | price  |
+------------+--------+
| 2017-01-03 | 100.00 |
| 2017-01-03 | 200.00 |
| 2017-01-06 |  50.00 |
| 2017-01-08 |  10.00 |
| 2017-01-08 |  20.00 |
| 2017-01-08 | 150.00 |
| 2017-01-10 |   5.00 |
+------------+--------+
</pre><p>
        This query summarizes the sales per day:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT date, SUM(price) AS sum_price</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY date</code></strong>
       <strong class="userinput"><code>ORDER BY date;</code></strong>
+------------+-----------+
| date       | sum_price |
+------------+-----------+
| 2017-01-03 |    300.00 |
| 2017-01-06 |     50.00 |
| 2017-01-08 |    180.00 |
| 2017-01-10 |      5.00 |
+------------+-----------+
</pre><p>
        However, that result contains <span class="quote">“<span class="quote">holes</span>”</span> for dates not
        represented in the range of dates spanned by the table. A result
        that represents all dates in the range can be produced using a
        recursive CTE to generate that set of dates, joined with a
        <code class="literal">LEFT JOIN</code> to the sales data.
      </p><p>
        Here is the CTE to generate the date range series:
      </p><pre data-lang="sql" class="programlisting">
WITH RECURSIVE dates (date) AS
(
  SELECT MIN(date) FROM sales
  UNION ALL
  SELECT date + INTERVAL 1 DAY FROM dates
  WHERE date + INTERVAL 1 DAY &lt;= (SELECT MAX(date) FROM sales)
)
SELECT * FROM dates;
</pre><p>
        The CTE produces this result:
      </p><pre data-lang="none" class="programlisting">
+------------+
| date       |
+------------+
| 2017-01-03 |
| 2017-01-04 |
| 2017-01-05 |
| 2017-01-06 |
| 2017-01-07 |
| 2017-01-08 |
| 2017-01-09 |
| 2017-01-10 |
+------------+
</pre><p>
        How the CTE works:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The nonrecursive <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
            produces the lowest date in the date range spanned by the
            <code class="literal">sales</code> table.
          </p></li><li class="listitem"><p>
            Each row produced by the recursive
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> adds one day to the
            date produced by the previous row.
          </p></li><li class="listitem"><p>
            Recursion ends after the dates reach the highest date in the
            date range spanned by the <code class="literal">sales</code> table.
</p></li></ul>
</div>
<p>
        Joining the CTE with a <code class="literal">LEFT JOIN</code> against the
        <code class="literal">sales</code> table produces the sales summary with a
        row for each date in the range:
      </p><pre data-lang="sql" class="programlisting">
WITH RECURSIVE dates (date) AS
(
  SELECT MIN(date) FROM sales
  UNION ALL
  SELECT date + INTERVAL 1 DAY FROM dates
  WHERE date + INTERVAL 1 DAY &lt;= (SELECT MAX(date) FROM sales)
)
SELECT dates.date, COALESCE(SUM(price), 0) AS sum_price
FROM dates LEFT JOIN sales ON dates.date = sales.date
GROUP BY dates.date
ORDER BY dates.date;
</pre><p>
        The output looks like this:
      </p><pre data-lang="none" class="programlisting">
+------------+-----------+
| date       | sum_price |
+------------+-----------+
| 2017-01-03 |    300.00 |
| 2017-01-04 |      0.00 |
| 2017-01-05 |      0.00 |
| 2017-01-06 |     50.00 |
| 2017-01-07 |      0.00 |
| 2017-01-08 |    180.00 |
| 2017-01-09 |      0.00 |
| 2017-01-10 |      5.00 |
+------------+-----------+
</pre><p>
        Some points to note:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Are the queries inefficient, particularly the one with the
            <a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a> subquery executed for
            each row in the recursive
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>? Checking with
            <code class="literal">EXPLAIN</code> shows that the subqueries are
            optimized away for efficiency.
          </p></li><li class="listitem"><p>
            The use of <a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE()</code></a> avoids
            displaying <code class="literal">NULL</code> in the
            <code class="literal">sum_price</code> column on days for which no
            sales data occur in the <code class="literal">sales</code> table.
</p></li></ul>
</div>
<h5><a name="common-table-expressions-recursive-hierarchy-traversal"></a>Hierarchical Data Traversal</h5>
<p>
        Recursive common table expressions are useful for traversing
        data that forms a hierarchy. Consider these statements that
        create a small data set that shows, for each employee in a
        company, the employee name and ID number, and the ID of the
        employee's manager. The top-level employee (the CEO), has a
        manager ID of <code class="literal">NULL</code> (no manager).
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE employees (
  id         INT PRIMARY KEY NOT NULL,
  name       VARCHAR(100) NOT NULL,
  manager_id INT NULL,
  INDEX (manager_id),
FOREIGN KEY (manager_id) REFERENCES EMPLOYEES (id)
);
INSERT INTO employees VALUES
(333, "Yasmina", NULL),  # Yasmina is the CEO (manager_id is NULL)
(198, "John", 333),      # John has ID 198 and reports to 333 (Yasmina)
(692, "Tarek", 333),
(29, "Pedro", 198),
(4610, "Sarah", 29),
(72, "Pierre", 29),
(123, "Adil", 692);
</pre><p>
        The resulting data set looks like this:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM employees ORDER BY id;</code></strong>
+------+---------+------------+
| id   | name    | manager_id |
+------+---------+------------+
|   29 | Pedro   |        198 |
|   72 | Pierre  |         29 |
|  123 | Adil    |        692 |
|  198 | John    |        333 |
|  333 | Yasmina |       NULL |
|  692 | Tarek   |        333 |
| 4610 | Sarah   |         29 |
+------+---------+------------+
</pre><p>
        To produce the organizational chart with the management chain
        for each employee (that is, the path from CEO to employee), use
        a recursive CTE:
      </p><pre data-lang="sql" class="programlisting">
WITH RECURSIVE employee_paths (id, name, path) AS
(
  SELECT id, name, CAST(id AS CHAR(200))
    FROM employees
    WHERE manager_id IS NULL
  UNION ALL
  SELECT e.id, e.name, CONCAT(ep.path, ',', e.id)
    FROM employee_paths AS ep JOIN employees AS e
      ON ep.id = e.manager_id
)
SELECT * FROM employee_paths ORDER BY path;
</pre><p>
        The CTE produces this output:
      </p><pre data-lang="none" class="programlisting">
+------+---------+-----------------+
| id   | name    | path            |
+------+---------+-----------------+
|  333 | Yasmina | 333             |
|  198 | John    | 333,198         |
|   29 | Pedro   | 333,198,29      |
| 4610 | Sarah   | 333,198,29,4610 |
|   72 | Pierre  | 333,198,29,72   |
|  692 | Tarek   | 333,692         |
|  123 | Adil    | 333,692,123     |
+------+---------+-----------------+
</pre><p>
        How the CTE works:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The nonrecursive <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
            produces the row for the CEO (the row with a
            <code class="literal">NULL</code> manager ID).
          </p><p>
            The <code class="literal">path</code> column is widened to
            <code class="literal">CHAR(200)</code> to ensure that there is room
            for the longer <code class="literal">path</code> values produced by
            the recursive <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>.
          </p></li><li class="listitem"><p>
            Each row produced by the recursive
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> finds all employees
            who report directly to an employee produced by a previous
            row. For each such employee, the row includes the employee
            ID and name, and the employee management chain. The chain is
            the manager's chain, with the employee ID added to the end.
          </p></li><li class="listitem"><p>
            Recursion ends when employees have no others who report to
            them.
</p></li></ul>
</div>
<p>
        To find the path for a specific employee or employees, add a
        <code class="literal">WHERE</code> clause to the top-level
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>. For example, to display
        the results for Tarek and Sarah, modify that
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> like this:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>WITH RECURSIVE ...</code></strong>
       ...
       <strong class="userinput"><code>SELECT * FROM employees_extended</code></strong>
       <strong class="userinput"><code>WHERE id IN (692, 4610)</code></strong>
       <strong class="userinput"><code>ORDER BY path;</code></strong>
+------+-------+-----------------+
| id   | name  | path            |
+------+-------+-----------------+
| 4610 | Sarah | 333,198,29,4610 |
|  692 | Tarek | 333,692         |
+------+-------+-----------------+
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="common-table-expressions-similar-constructs"></a>Common Table Expressions Compared to Similar Constructs</h4>

</div>

</div>

</div>
<p>
        Common table expressions (CTEs) are similar to derived tables in
        some ways:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Both constructs are named.
          </p></li><li class="listitem"><p>
            Both constructs exist for the scope of a single statement.
</p></li></ul>
</div>
<p>
        Because of these similarities, CTEs and derived tables often can
        be used interchangeably. As a trivial example, these statements
        are equivalent:
      </p><pre data-lang="sql" class="programlisting">
WITH cte AS (SELECT 1) SELECT * FROM cte;
SELECT * FROM (SELECT 1) AS dt;
</pre><p>
        However, CTEs have some advantages over derived tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A derived table can be referenced only a single time within
            a query. A CTE can be referenced multiple times. To use
            multiple instances of a derived table result, you must
            derive the result multiple times.
          </p></li><li class="listitem"><p>
            A CTE can be self-referencing (recursive).
          </p></li><li class="listitem"><p>
            One CTE can refer to another.
          </p></li><li class="listitem"><p>
            A CTE may be easier to read when its definition appears at
            the beginning of the statement rather than embedded within
            it.
</p></li></ul>
</div>
<p>
        CTEs are similar to tables created with
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE [TEMPORARY]
        TABLE</code></a> but need not be defined or dropped explicitly.
        For a CTE, you need no privileges to create tables.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-transactions"></a>13.3 Transactional and Locking Statements</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#commit">13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#cannot-roll-back">13.3.2 Statements That Cannot Be Rolled Back</a></span></dt><dt><span class="section"><a href="sql-syntax.html#implicit-commit">13.3.3 Statements That Cause an Implicit Commit</a></span></dt><dt><span class="section"><a href="sql-syntax.html#savepoint">13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#lock-instance-for-backup">13.3.5 LOCK INSTANCE FOR BACKUP and UNLOCK INSTANCE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#lock-tables">13.3.6 LOCK TABLES and UNLOCK TABLES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-transaction">13.3.7 SET TRANSACTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#xa">13.3.8 XA Transactions</a></span></dt></dl>
</div>
<p>
    MySQL supports local transactions (within a given client session)
    through statements such as
    <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">SET autocommit</code></a>,
    <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START TRANSACTION</code></a>,
    <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a>, and
    <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>. See
    <a class="xref" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax">Section 13.3.1, “START TRANSACTION, COMMIT, and ROLLBACK Syntax”</a>. XA transaction support enables MySQL to
    participate in distributed transactions as well. See
    <a class="xref" href="sql-syntax.html#xa" title="13.3.8 XA Transactions">Section 13.3.8, “XA Transactions”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="commit"></a>13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax</h3>
</div>
</div>
</div>
<a class="indexterm" name="idm140091663401728"></a><a class="indexterm" name="idm140091663400688"></a><a class="indexterm" name="idm140091663399616"></a><a class="indexterm" name="idm140091663398544"></a><pre data-lang="sql" class="programlisting">
START TRANSACTION
    [<em class="replaceable"><code>transaction_characteristic</code></em> [, <em class="replaceable"><code>transaction_characteristic</code></em>] ...]

<em class="replaceable"><code>transaction_characteristic</code></em>: {
    WITH CONSISTENT SNAPSHOT
  | READ WRITE
  | READ ONLY
}

BEGIN [WORK]
COMMIT [WORK] [AND [NO] CHAIN] [[NO] RELEASE]
ROLLBACK [WORK] [AND [NO] CHAIN] [[NO] RELEASE]
SET autocommit = {0 | 1}
</pre><p>
      These statements provide control over use of
      <a class="link" href="glossary.html#glos_transaction" title="transaction">transactions</a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">START TRANSACTION</code> or
          <code class="literal">BEGIN</code> start a new transaction.
        </p></li><li class="listitem"><p>
          <code class="literal">COMMIT</code> commits the current transaction,
          making its changes permanent.
        </p></li><li class="listitem"><p>
          <code class="literal">ROLLBACK</code> rolls back the current
          transaction, canceling its changes.
        </p></li><li class="listitem"><p>
          <code class="literal">SET autocommit</code> disables or enables the
          default autocommit mode for the current session.
</p></li></ul>
</div>
<p>
      By default, MySQL runs with
      <a class="link" href="glossary.html#glos_autocommit" title="autocommit">autocommit</a> mode enabled.
      This means that as soon as you execute a statement that updates
      (modifies) a table, MySQL stores the update on disk to make it
      permanent. The change cannot be rolled back.
    </p><p>
      To disable autocommit mode implicitly for a single series of
      statements, use the <code class="literal">START TRANSACTION</code>
      statement:
    </p><pre data-lang="sql" class="programlisting">
START TRANSACTION;
SELECT @A:=SUM(salary) FROM table1 WHERE type=1;
UPDATE table2 SET summary=@A WHERE type=1;
COMMIT;
</pre><p>
      With <code class="literal">START TRANSACTION</code>, autocommit remains
      disabled until you end the transaction with
      <code class="literal">COMMIT</code> or <code class="literal">ROLLBACK</code>. The
      autocommit mode then reverts to its previous state.
    </p><p>
      <code class="literal">START TRANSACTION</code> permits several modifiers
      that control transaction characteristics. To specify multiple
      modifiers, separate them by commas.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The <code class="literal">WITH CONSISTENT SNAPSHOT</code> modifier
          starts a <a class="link" href="glossary.html#glos_consistent_read" title="consistent read">consistent
          read</a> for storage engines that are capable of it. This
          applies only to <code class="literal">InnoDB</code>. The effect is the
          same as issuing a <code class="literal">START TRANSACTION</code>
          followed by a <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> from any
          <code class="literal">InnoDB</code> table. See
          <a class="xref" href="innodb-storage-engine.html#innodb-consistent-read" title="15.7.2.3 Consistent Nonlocking Reads">Section 15.7.2.3, “Consistent Nonlocking Reads”</a>. The <code class="literal">WITH
          CONSISTENT SNAPSHOT</code> modifier does not change the
          current transaction
          <a class="link" href="glossary.html#glos_isolation_level" title="isolation level">isolation level</a>,
          so it provides a consistent snapshot only if the current
          isolation level is one that permits a consistent read. The
          only isolation level that permits a consistent read is
          <a class="link" href="innodb-storage-engine.html#isolevel_repeatable-read"><code class="literal">REPEATABLE READ</code></a>. For all
          other isolation levels, the <code class="literal">WITH CONSISTENT
          SNAPSHOT</code> clause is ignored. A warning is generated
          when the <code class="literal">WITH CONSISTENT SNAPSHOT</code> clause is
          ignored.
        </p></li><li class="listitem"><p>
          The <code class="literal">READ WRITE</code> and <code class="literal">READ
          ONLY</code> modifiers set the transaction access mode. They
          permit or prohibit changes to tables used in the transaction.
          The <code class="literal">READ ONLY</code> restriction prevents the
          transaction from modifying or locking both transactional and
          nontransactional tables that are visible to other
          transactions; the transaction can still modify or lock
          temporary tables.
        </p><p>
          MySQL enables extra optimizations for queries on
          <code class="literal">InnoDB</code> tables when the transaction is known
          to be read-only. Specifying <code class="literal">READ ONLY</code>
          ensures these optimizations are applied in cases where the
          read-only status cannot be determined automatically. See
          <a class="xref" href="optimization.html#innodb-performance-ro-txn" title="8.5.3 Optimizing InnoDB Read-Only Transactions">Section 8.5.3, “Optimizing InnoDB Read-Only Transactions”</a> for more
          information.
        </p><p>
          If no access mode is specified, the default mode applies.
          Unless the default has been changed, it is read/write. It is
          not permitted to specify both <code class="literal">READ WRITE</code>
          and <code class="literal">READ ONLY</code> in the same statement.
        </p><p>
          In read-only mode, it remains possible to change tables
          created with the <code class="literal">TEMPORARY</code> keyword using
          DML statements. Changes made with DDL statements are not
          permitted, just as with permanent tables.
        </p><p>
          For additional information about transaction access mode,
          including ways to change the default mode, see
          <a class="xref" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax">Section 13.3.7, “SET TRANSACTION Syntax”</a>.
        </p><p>
          If the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system
          variable is enabled, explicitly starting a transaction with
          <code class="literal">START TRANSACTION READ WRITE</code> requires the
          <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
          <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
</p></li></ul>
</div>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Important
</div>
<p>
        Many APIs used for writing MySQL client applications (such as
        JDBC) provide their own methods for starting transactions that
        can (and sometimes should) be used instead of sending a
        <code class="literal">START TRANSACTION</code> statement from the client.
        See <a class="xref" href="connectors-apis.html" title="Chapter 28 Connectors and APIs">Chapter 28, <i>Connectors and APIs</i></a>, or the documentation for
        your API, for more information.
</p>
</div>
<p>
      To disable autocommit mode explicitly, use the following
      statement:
    </p><pre data-lang="sql" class="programlisting">
SET autocommit=0;
</pre><p>
      After disabling autocommit mode by setting the
      <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> variable to zero,
      changes to transaction-safe tables (such as those for
      <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> or
      <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a>) are not made permanent
      immediately. You must use <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a> to
      store your changes to disk or <code class="literal">ROLLBACK</code> to
      ignore the changes.
    </p><p>
      <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> is a session variable
      and must be set for each session. To disable autocommit mode for
      each new connection, see the description of the
      <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> system variable at
      <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>.
    </p><p>
      <code class="literal">BEGIN</code> and <code class="literal">BEGIN WORK</code> are
      supported as aliases of <code class="literal">START TRANSACTION</code> for
      initiating a transaction. <code class="literal">START TRANSACTION</code> is
      standard SQL syntax, is the recommended way to start an ad-hoc
      transaction, and permits modifiers that <code class="literal">BEGIN</code>
      does not.
    </p><p>
      The <code class="literal">BEGIN</code> statement differs from the use of the
      <code class="literal">BEGIN</code> keyword that starts a
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      compound statement. The latter does not begin a transaction. See
      <a class="xref" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax">Section 13.6.1, “BEGIN ... END Compound-Statement Syntax”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Within all stored programs (stored procedures and functions,
        triggers, and events), the parser treats <code class="literal">BEGIN
        [WORK]</code> as the beginning of a
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block. Begin a transaction in this context with
        <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
        TRANSACTION</code></a> instead.
</p>
</div>
<p>
      The optional <code class="literal">WORK</code> keyword is supported for
      <code class="literal">COMMIT</code> and <code class="literal">ROLLBACK</code>, as are
      the <code class="literal">CHAIN</code> and <code class="literal">RELEASE</code>
      clauses. <code class="literal">CHAIN</code> and <code class="literal">RELEASE</code>
      can be used for additional control over transaction completion.
      The value of the <a class="link" href="server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a>
      system variable determines the default completion behavior. See
      <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>.
    </p><p>
      The <code class="literal">AND CHAIN</code> clause causes a new transaction
      to begin as soon as the current one ends, and the new transaction
      has the same isolation level as the just-terminated transaction.
      The new transaction also uses the same access mode (<code class="literal">READ
      WRITE</code> or <code class="literal">READ ONLY</code>) as the
      just-terminated transaction. The <code class="literal">RELEASE</code> clause
      causes the server to disconnect the current client session after
      terminating the current transaction. Including the
      <code class="literal">NO</code> keyword suppresses <code class="literal">CHAIN</code>
      or <code class="literal">RELEASE</code> completion, which can be useful if
      the <a class="link" href="server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a> system
      variable is set to cause chaining or release completion by
      default.
    </p><p>
      Beginning a transaction causes any pending transaction to be
      committed. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>, for more
      information.
    </p><p>
      Beginning a transaction also causes table locks acquired with
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to be released, as
      though you had executed
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
      TABLES</code></a>. Beginning a transaction does not release a
      global read lock acquired with <a class="link" href="sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH TABLES
      WITH READ LOCK</code></a>.
    </p><p>
      For best results, transactions should be performed using only
      tables managed by a single transaction-safe storage engine.
      Otherwise, the following problems can occur:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you use tables from more than one transaction-safe storage
          engine (such as <code class="literal">InnoDB</code>), and the
          transaction isolation level is not
          <a class="link" href="innodb-storage-engine.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a>, it is
          possible that when one transaction commits, another ongoing
          transaction that uses the same tables will see only some of
          the changes made by the first transaction. That is, the
          atomicity of transactions is not guaranteed with mixed engines
          and inconsistencies can result. (If mixed-engine transactions
          are infrequent, you can use
          <a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax"><code class="literal">SET
          TRANSACTION ISOLATION LEVEL</code></a> to set the isolation
          level to <a class="link" href="innodb-storage-engine.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a> on a
          per-transaction basis as necessary.)
        </p></li><li class="listitem"><p>
          If you use tables that are not transaction-safe within a
          transaction, changes to those tables are stored at once,
          regardless of the status of autocommit mode.
        </p></li><li class="listitem"><p>
          If you issue a
          <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
          statement after updating a nontransactional table within a
          transaction, an
          <a class="link" href="error-handling.html#error_er_warning_not_complete_rollback"><code class="literal">ER_WARNING_NOT_COMPLETE_ROLLBACK</code></a>
          warning occurs. Changes to transaction-safe tables are rolled
          back, but not changes to nontransaction-safe tables.
</p></li></ul>
</div>
<p>
      Each transaction is stored in the binary log in one chunk, upon
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a>. Transactions that are
      rolled back are not logged.
      (<span class="bold"><strong>Exception</strong></span>: Modifications to
      nontransactional tables cannot be rolled back. If a transaction
      that is rolled back includes modifications to nontransactional
      tables, the entire transaction is logged with a
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
      statement at the end to ensure that modifications to the
      nontransactional tables are replicated.) See
      <a class="xref" href="server-administration.html#binary-log" title="5.4.4 The Binary Log">Section 5.4.4, “The Binary Log”</a>.
    </p><p>
      You can change the isolation level or access mode for transactions
      with the <a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a> statement.
      See <a class="xref" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax">Section 13.3.7, “SET TRANSACTION Syntax”</a>.
    </p><p>
      Rolling back can be a slow operation that may occur implicitly
      without the user having explicitly asked for it (for example, when
      an error occurs). Because of this, <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
      PROCESSLIST</code></a> displays <code class="literal">Rolling back</code> in
      the <code class="literal">State</code> column for the session, not only for
      explicit rollbacks performed with the
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
      statement but also for implicit rollbacks.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        In MySQL 8.0, <code class="literal">BEGIN</code>,
        <code class="literal">COMMIT</code>, and <code class="literal">ROLLBACK</code> are
        not affected by <a class="link" href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a>
        or <a class="link" href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a> rules.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="cannot-roll-back"></a>13.3.2 Statements That Cannot Be Rolled Back</h3>

</div>

</div>

</div>
<p>
      Some statements cannot be rolled back. In general, these include
      data definition language (DDL) statements, such as those that
      create or drop databases, those that create, drop, or alter tables
      or stored routines.
    </p><p>
      You should design your transactions not to include such
      statements. If you issue a statement early in a transaction that
      cannot be rolled back, and then another statement later fails, the
      full effect of the transaction cannot be rolled back in such cases
      by issuing a
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
      statement.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="implicit-commit"></a>13.3.3 Statements That Cause an Implicit Commit</h3>

</div>

</div>

</div>
<p>
      The statements listed in this section (and any synonyms for them)
      implicitly end any transaction active in the current session, as
      if you had done a <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a> before
      executing the statement.
    </p><p>
      Most of these statements also cause an implicit commit after
      executing. The intent is to handle each such statement in its own
      special transaction. Transaction-control and locking statements
      are exceptions: If an implicit commit occurs before execution,
      another does not occur after.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <span class="bold"><strong>Data definition language (DDL)
          statements that define or modify database objects.</strong></span>
          <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a>,
          <a class="link" href="sql-syntax.html#alter-function" title="13.1.4 ALTER FUNCTION Syntax"><code class="literal">ALTER FUNCTION</code></a>,
          <a class="link" href="sql-syntax.html#alter-procedure" title="13.1.7 ALTER PROCEDURE Syntax"><code class="literal">ALTER PROCEDURE</code></a>,
          <a class="link" href="sql-syntax.html#alter-server" title="13.1.8 ALTER SERVER Syntax"><code class="literal">ALTER SERVER</code></a>,
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>,
          <a class="link" href="sql-syntax.html#alter-view" title="13.1.11 ALTER VIEW Syntax"><code class="literal">ALTER VIEW</code></a>,
          <a class="link" href="sql-syntax.html#create-database" title="13.1.12 CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a>,
          <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a>,
          <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a>,
          <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a>,
          <a class="link" href="sql-syntax.html#create-procedure" title="13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax"><code class="literal">CREATE PROCEDURE</code></a>,
          <a class="link" href="sql-syntax.html#create-role" title="13.7.1.2 CREATE ROLE Syntax"><code class="literal">CREATE ROLE</code></a>,
          <a class="link" href="sql-syntax.html#create-server" title="13.1.18 CREATE SERVER Syntax"><code class="literal">CREATE SERVER</code></a>,
          <a class="link" href="sql-syntax.html#create-spatial-reference-system" title="13.1.19 CREATE SPATIAL REFERENCE SYSTEM Syntax"><code class="literal">CREATE SPATIAL REFERENCE
          SYSTEM</code></a>, <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>,
          <a class="link" href="sql-syntax.html#create-trigger" title="13.1.22 CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a>,
          <a class="link" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax"><code class="literal">CREATE VIEW</code></a>,
          <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a>,
          <a class="link" href="sql-syntax.html#drop-event" title="13.1.25 DROP EVENT Syntax"><code class="literal">DROP EVENT</code></a>,
          <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a>,
          <a class="link" href="sql-syntax.html#drop-index" title="13.1.27 DROP INDEX Syntax"><code class="literal">DROP INDEX</code></a>,
          <a class="link" href="sql-syntax.html#drop-procedure" title="13.1.29 DROP PROCEDURE and DROP FUNCTION Syntax"><code class="literal">DROP PROCEDURE</code></a>,
          <a class="link" href="sql-syntax.html#drop-role" title="13.7.1.4 DROP ROLE Syntax"><code class="literal">DROP ROLE</code></a>,
          <a class="link" href="sql-syntax.html#drop-server" title="13.1.30 DROP SERVER Syntax"><code class="literal">DROP SERVER</code></a>,
          <a class="link" href="sql-syntax.html#drop-spatial-reference-system" title="13.1.31 DROP SPATIAL REFERENCE SYSTEM Syntax"><code class="literal">DROP SPATIAL REFERENCE SYSTEM</code></a>,
          <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>,
          <a class="link" href="sql-syntax.html#drop-trigger" title="13.1.34 DROP TRIGGER Syntax"><code class="literal">DROP TRIGGER</code></a>,
          <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a>,
          <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a>,
          <a class="link" href="sql-syntax.html#rename-table" title="13.1.36 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a>,
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>,
          <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a>.
        </p><p>
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> and
          <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statements do not
          commit a transaction if the <code class="literal">TEMPORARY</code>
          keyword is used. (This does not apply to other operations on
          temporary tables such as <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
          TABLE</code></a> and <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE
          INDEX</code></a>, which do cause a commit.) However, although
          no implicit commit occurs, neither can the statement be rolled
          back, which means that the use of such statements causes
          transactional atomicity to be violated. For example, if you
          use <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
          TEMPORARY TABLE</code></a> and then roll back the transaction,
          the table remains in existence.
        </p><p>
          The <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement in
          <code class="literal">InnoDB</code> is processed as a single
          transaction. This means that a
          <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
          from the user does not undo <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
          TABLE</code></a> statements the user made during that
          transaction.
        </p><p>
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
          SELECT</code></a> causes an implicit commit before and after
          the statement is executed when you are creating nontemporary
          tables. (No commit occurs for <code class="literal">CREATE TEMPORARY TABLE
          ... SELECT</code>.)
        </p></li><li class="listitem"><p>
          <span class="bold"><strong>Statements that implicitly use or modify
          tables in the <code class="literal">mysql</code> database.</strong></span>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a>,
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>,
          <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a>,
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a>,
          <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.7 RENAME USER Syntax"><code class="literal">RENAME USER</code></a>,
          <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a>,
          <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a>.
        </p></li><li class="listitem"><p>
          <span class="bold"><strong>Transaction-control and locking
          statements.</strong></span>
          <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">BEGIN</code></a>,
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>, <code class="literal">SET
          autocommit = 1</code> (if the value is not already 1),
          <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
          TRANSACTION</code></a>,
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
          TABLES</code></a>.
        </p><p>
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
          TABLES</code></a> commits a transaction only if any tables
          currently have been locked with <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
          TABLES</code></a> to acquire nontransactional table locks. A
          commit does not occur for
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
          TABLES</code></a> following <a class="link" href="sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH TABLES
          WITH READ LOCK</code></a> because the latter statement does not
          acquire table-level locks.
        </p><p>
          Transactions cannot be nested. This is a consequence of the
          implicit commit performed for any current transaction when you
          issue a <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
          TRANSACTION</code></a> statement or one of its synonyms.
        </p><p>
          Statements that cause an implicit commit cannot be used in an
          XA transaction while the transaction is in an
          <code class="literal">ACTIVE</code> state.
        </p><p>
          The <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">BEGIN</code></a>
          statement differs from the use of the <code class="literal">BEGIN</code>
          keyword that starts a
          <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
          END</code></a> compound statement. The latter does not cause an
          implicit commit. See <a class="xref" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax">Section 13.6.1, “BEGIN ... END Compound-Statement Syntax”</a>.
        </p></li><li class="listitem"><p>
          <span class="bold"><strong>Data loading statements.</strong></span>
          <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>.
          <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> causes an implicit
          commit only for tables using the
          <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> storage engine.
        </p></li><li class="listitem"><p>
          <span class="bold"><strong>Administrative statements.</strong></span>
          <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a>,
          <a class="link" href="sql-syntax.html#cache-index" title="13.7.7.2 CACHE INDEX Syntax"><code class="literal">CACHE INDEX</code></a>,
          <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a>,
          <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a>,
          <a class="link" href="sql-syntax.html#load-index" title="13.7.7.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD INDEX INTO
          CACHE</code></a>, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
          TABLE</code></a>, <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>,
          <a class="link" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax"><code class="literal">RESET</code></a> (but not
          <a class="link" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax"><code class="literal">RESET PERSIST</code></a>).
        </p></li><li class="listitem"><p>
          <span class="bold"><strong>Replication control
          statements</strong></span>. <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START
          SLAVE</code></a>, <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.7 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a>,
          <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a>,
          <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="savepoint"></a>13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091663149760"></a><a class="indexterm" name="idm140091663148720"></a><a class="indexterm" name="idm140091663147648"></a><pre data-lang="sql" class="programlisting">
SAVEPOINT <em class="replaceable"><code>identifier</code></em>
ROLLBACK [WORK] TO [SAVEPOINT] <em class="replaceable"><code>identifier</code></em>
RELEASE SAVEPOINT <em class="replaceable"><code>identifier</code></em>
</pre><p>
      <code class="literal">InnoDB</code> supports the SQL statements
      <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">SAVEPOINT</code></a>,
      <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">ROLLBACK TO
      SAVEPOINT</code></a>,
      <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">RELEASE
      SAVEPOINT</code></a> and the optional <code class="literal">WORK</code>
      keyword for
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>.
    </p><p>
      The <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">SAVEPOINT</code></a> statement sets a
      named transaction savepoint with a name of
      <em class="replaceable"><code>identifier</code></em>. If the current transaction
      has a savepoint with the same name, the old savepoint is deleted
      and a new one is set.
    </p><p>
      The <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">ROLLBACK TO
      SAVEPOINT</code></a> statement rolls back a transaction to the
      named savepoint without terminating the transaction. Modifications
      that the current transaction made to rows after the savepoint was
      set are undone in the rollback, but <code class="literal">InnoDB</code> does
      <span class="emphasis"><em>not</em></span> release the row locks that were stored in
      memory after the savepoint. (For a new inserted row, the lock
      information is carried by the transaction ID stored in the row;
      the lock is not separately stored in memory. In this case, the row
      lock is released in the undo.) Savepoints that were set at a later
      time than the named savepoint are deleted.
    </p><p>
      If the <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">ROLLBACK TO
      SAVEPOINT</code></a> statement returns the following error, it
      means that no savepoint with the specified name exists:
    </p><pre data-lang="none" class="programlisting">
ERROR 1305 (42000): SAVEPOINT <em class="replaceable"><code>identifier</code></em> does not exist
</pre><p>
      The <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">RELEASE
      SAVEPOINT</code></a> statement removes the named savepoint from the
      set of savepoints of the current transaction. No commit or
      rollback occurs. It is an error if the savepoint does not exist.
    </p><p>
      All savepoints of the current transaction are deleted if you
      execute a <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a>, or a
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a> that
      does not name a savepoint.
    </p><p>
      A new savepoint level is created when a stored function is invoked
      or a trigger is activated. The savepoints on previous levels
      become unavailable and thus do not conflict with savepoints on the
      new level. When the function or trigger terminates, any savepoints
      it created are released and the previous savepoint level is
      restored.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="lock-instance-for-backup"></a>13.3.5 LOCK INSTANCE FOR BACKUP and UNLOCK INSTANCE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091663116144"></a><a class="indexterm" name="idm140091663115104"></a><pre data-lang="sql" class="programlisting">
LOCK INSTANCE FOR BACKUP

UNLOCK INSTANCE
</pre><p>
      <code class="literal">LOCK INSTANCE FOR BACKUP</code> acquires an
      instance-level <span class="emphasis"><em>backup lock</em></span> that permits DML
      during an online backup while preventing operations that could
      result in an inconsistent snapshot.
    </p><p>
      Executing the <code class="literal">LOCK INSTANCE FOR BACKUP</code>
      statement requires the <a class="link" href="security.html#priv_backup-admin"><code class="literal">BACKUP_ADMIN</code></a>
      privilege. The <a class="link" href="security.html#priv_backup-admin"><code class="literal">BACKUP_ADMIN</code></a>
      privilege is automatically granted to users with the
      <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege when performing an
      in-place upgrade to MySQL 8.0 from an earlier
      version.
    </p><p>
      Multiple sessions can hold a backup lock simultaneously.
    </p><p>
      <code class="literal">UNLOCK INSTANCE</code> releases a backup lock held by
      the current session. A backup lock held by a session is also
      released if the session is terminated.
    </p><p>
      <code class="literal">LOCK INSTANCE FOR BACKUP</code> prevents files from
      being created, renamed, or removed. <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
      TABLE</code></a> <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>,
      <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a>, and account
      management statements are blocked. See
      <a class="xref" href="sql-syntax.html#account-management-sql" title="13.7.1 Account Management Statements">Section 13.7.1, “Account Management Statements”</a>. Operations that modify
      <code class="literal">InnoDB</code> files that are not recorded in the
      <code class="literal">InnoDB</code> redo log are also blocked.
    </p><p>
      <code class="literal">LOCK INSTANCE FOR BACKUP</code> permits DDL operations
      that only affect user-created temporary tables. In effect, files
      that belong to user-created temporary tables can be created,
      renamed, or removed while a backup lock is held. Creation of
      binary log files is also permitted.
    </p><p>
      A backup lock acquired by <code class="literal">LOCK INSTANCE FOR
      BACKUP</code> is independent of transactional locks and locks
      taken by
      <a class="link" href="sql-syntax.html#flush-tables-with-read-lock-with-list"><code class="literal">FLUSH
      TABLES <em class="replaceable"><code>tbl_name</code></em> [,
      <em class="replaceable"><code>tbl_name</code></em>] ... WITH READ LOCK</code></a>,
      and the following sequences of statements are permitted:
    </p><pre data-lang="sql" class="programlisting">
LOCK INSTANCE FOR BACKUP;
FLUSH TABLES <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ... WITH READ LOCK;
UNLOCK TABLES;
UNLOCK INSTANCE;
</pre><pre data-lang="sql" class="programlisting">
FLUSH TABLES <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ... WITH READ LOCK;
LOCK INSTANCE FOR BACKUP;
UNLOCK INSTANCE;
UNLOCK TABLES;
</pre><p>
      The <a class="link" href="server-administration.html#sysvar_lock_wait_timeout"><code class="literal">lock_wait_timeout</code></a> setting
      defines the amount of time that a <code class="literal">LOCK INSTANCE FOR
      BACKUP</code> statement waits to acquire a lock before giving
      up.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="lock-tables"></a>13.3.6 LOCK TABLES and UNLOCK TABLES Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091663081904"></a><a class="indexterm" name="idm140091663080864"></a><pre data-lang="sql" class="programlisting">
LOCK TABLES
    <em class="replaceable"><code>tbl_name</code></em> [[AS] <em class="replaceable"><code>alias</code></em>] <em class="replaceable"><code>lock_type</code></em>
    [, <em class="replaceable"><code>tbl_name</code></em> [[AS] <em class="replaceable"><code>alias</code></em>] <em class="replaceable"><code>lock_type</code></em>] ...

<em class="replaceable"><code>lock_type</code></em>: {
    READ [LOCAL]
  | [LOW_PRIORITY] WRITE
}

UNLOCK TABLES
</pre><p>
      MySQL enables client sessions to acquire table locks explicitly
      for the purpose of cooperating with other sessions for access to
      tables, or to prevent other sessions from modifying tables during
      periods when a session requires exclusive access to them. A
      session can acquire or release locks only for itself. One session
      cannot acquire locks for another session or release locks held by
      another session.
    </p><p>
      Locks may be used to emulate transactions or to get more speed
      when updating tables. This is explained in more detail in
      <a class="xref" href="sql-syntax.html#lock-tables-restrictions" title="Table-Locking Restrictions and Conditions">Table-Locking Restrictions and Conditions</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> explicitly acquires
      table locks for the current client session. Table locks can be
      acquired for base tables or views. You must have the
      <a class="link" href="security.html#priv_lock-tables"><code class="literal">LOCK TABLES</code></a> privilege, and the
      <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for each object to
      be locked.
    </p><p>
      For view locking, <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> adds
      all base tables used in the view to the set of tables to be locked
      and locks them automatically. If you lock a table explicitly with
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>, any tables used in
      triggers are also locked implicitly, as described in
      <a class="xref" href="sql-syntax.html#lock-tables-and-triggers" title="LOCK TABLES and Triggers">LOCK TABLES and Triggers</a>.
    </p><p>
      If you lock a table explicitly with <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
      TABLES</code></a>, any tables related by a foreign key constraint
      are opened and locked implicitly. For foreign key checks, a shared
      read-only lock (<a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
      TABLES READ</code></a>) is taken on related tables. For cascading
      updates, a shared-nothing write lock
      (<a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES
      WRITE</code></a>) is taken on related tables that are involved in
      the operation.
    </p><p>
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
      TABLES</code></a> explicitly releases any table locks held by the
      current session. <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>
      implicitly releases any table locks held by the current session
      before acquiring new locks.
    </p><p>
      Another use for
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
      TABLES</code></a> is to release the global read lock acquired with
      the <a class="link" href="sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH TABLES WITH READ LOCK</code></a>
      statement, which enables you to lock all tables in all databases.
      See <a class="xref" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax">Section 13.7.7.3, “FLUSH Syntax”</a>. (This is a very convenient way to get
      backups if you have a file system such as Veritas that can take
      snapshots in time.)
    </p><p>
      A table lock protects only against inappropriate reads or writes
      by other sessions. A session holding a <code class="literal">WRITE</code>
      lock can perform table-level operations such as
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> or
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>. For sessions
      holding a <code class="literal">READ</code> lock, <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP
      TABLE</code></a> and <a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>
      operations are not permitted.
    </p><p>
      The following discussion applies only to
      non-<code class="literal">TEMPORARY</code> tables. <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
      TABLES</code></a> is permitted (but ignored) for a
      <code class="literal">TEMPORARY</code> table. The table can be accessed
      freely by the session within which it was created, regardless of
      what other locking may be in effect. No lock is necessary because
      no other session can see the table.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#table-lock-acquisition" title="Table Lock Acquisition">Table Lock Acquisition</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#table-lock-release" title="Table Lock Release">Table Lock Release</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#lock-tables-and-transactions" title="Interaction of Table Locking and Transactions">Interaction of Table Locking and Transactions</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#lock-tables-and-triggers" title="LOCK TABLES and Triggers">LOCK TABLES and Triggers</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#lock-tables-restrictions" title="Table-Locking Restrictions and Conditions">Table-Locking Restrictions and Conditions</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="table-lock-acquisition"></a>Table Lock Acquisition</h4>

</div>

</div>

</div>
<p>
        To acquire table locks within the current session, use the
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement, which
        acquires metadata locks (see
        <a class="xref" href="optimization.html#metadata-locking" title="8.11.4 Metadata Locking">Section 8.11.4, “Metadata Locking”</a>).
      </p><p>
        The following lock types are available:
      </p><p>
        <code class="literal">READ [LOCAL]</code> lock:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The session that holds the lock can read the table (but not
            write it).
          </p></li><li class="listitem"><p>
            Multiple sessions can acquire a <code class="literal">READ</code> lock
            for the table at the same time.
          </p></li><li class="listitem"><p>
            Other sessions can read the table without explicitly
            acquiring a <code class="literal">READ</code> lock.
          </p></li><li class="listitem"><p>
            The <code class="literal">LOCAL</code> modifier enables nonconflicting
            <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> statements (concurrent
            inserts) by other sessions to execute while the lock is
            held. (See <a class="xref" href="optimization.html#concurrent-inserts" title="8.11.3 Concurrent Inserts">Section 8.11.3, “Concurrent Inserts”</a>.) However,
            <code class="literal">READ LOCAL</code> cannot be used if you are
            going to manipulate the database using processes external to
            the server while you hold the lock. For
            <code class="literal">InnoDB</code> tables, <code class="literal">READ
            LOCAL</code> is the same as <code class="literal">READ</code>.
</p></li></ul>
</div>
<p>
        <code class="literal">[LOW_PRIORITY] WRITE</code> lock:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The session that holds the lock can read and write the
            table.
          </p></li><li class="listitem"><p>
            Only the session that holds the lock can access the table.
            No other session can access it until the lock is released.
          </p></li><li class="listitem"><p>
            Lock requests for the table by other sessions block while
            the <code class="literal">WRITE</code> lock is held.
          </p></li><li class="listitem"><p>
            The <code class="literal">LOW_PRIORITY</code> modifier has no effect.
            In previous versions of MySQL, it affected locking behavior,
            but this is no longer true. It is now deprecated and its use
            produces a warning. Use <code class="literal">WRITE</code> without
            <code class="literal">LOW_PRIORITY</code> instead.
</p></li></ul>
</div>
<p>
        <code class="literal">WRITE</code> locks normally have higher priority
        than <code class="literal">READ</code> locks to ensure that updates are
        processed as soon as possible. This means that if one session
        obtains a <code class="literal">READ</code> lock and then another session
        requests a <code class="literal">WRITE</code> lock, subsequent
        <code class="literal">READ</code> lock requests wait until the session
        that requested the <code class="literal">WRITE</code> lock has obtained
        the lock and released it. (An exception to this policy can occur
        for small values of the
        <a class="link" href="server-administration.html#sysvar_max_write_lock_count"><code class="literal">max_write_lock_count</code></a> system
        variable; see <a class="xref" href="optimization.html#metadata-locking" title="8.11.4 Metadata Locking">Section 8.11.4, “Metadata Locking”</a>.)
      </p><p>
        If the <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement must
        wait due to locks held by other sessions on any of the tables,
        it blocks until all locks can be acquired.
      </p><p>
        A session that requires locks must acquire all the locks that it
        needs in a single <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>
        statement. While the locks thus obtained are held, the session
        can access only the locked tables. For example, in the following
        sequence of statements, an error occurs for the attempt to
        access <code class="literal">t2</code> because it was not locked in the
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>LOCK TABLES t1 READ;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT COUNT(*) FROM t1;</code></strong>
+----------+
| COUNT(*) |
+----------+
|        3 |
+----------+
mysql&gt; <strong class="userinput"><code>SELECT COUNT(*) FROM t2;</code></strong>
ERROR 1100 (HY000): Table 't2' was not locked with LOCK TABLES
</pre><p>
        Tables in the <code class="literal">INFORMATION_SCHEMA</code> database are
        an exception. They can be accessed without being locked
        explicitly even while a session holds table locks obtained with
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>.
      </p><p>
        You cannot refer to a locked table multiple times in a single
        query using the same name. Use aliases instead, and obtain a
        separate lock for the table and each alias:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>LOCK TABLE t WRITE, t AS t1 READ;</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t SELECT * FROM t;</code></strong>
ERROR 1100: Table 't' was not locked with LOCK TABLES
mysql&gt; <strong class="userinput"><code>INSERT INTO t SELECT * FROM t AS t1;</code></strong>
</pre><p>
        The error occurs for the first
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> because there are two
        references to the same name for a locked table. The second
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> succeeds because the
        references to the table use different names.
      </p><p>
        If your statements refer to a table by means of an alias, you
        must lock the table using that same alias. It does not work to
        lock the table without specifying the alias:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>LOCK TABLE t READ;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT * FROM t AS myalias;</code></strong>
ERROR 1100: Table 'myalias' was not locked with LOCK TABLES
</pre><p>
        Conversely, if you lock a table using an alias, you must refer
        to it in your statements using that alias:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>LOCK TABLE t AS myalias READ;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT * FROM t;</code></strong>
ERROR 1100: Table 't' was not locked with LOCK TABLES
mysql&gt; <strong class="userinput"><code>SELECT * FROM t AS myalias;</code></strong>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          <code class="literal">LOCK TABLES</code> or <code class="literal">UNLOCK
          TABLES</code>, when applied to a partitioned table, always
          locks or unlocks the entire table; these statements do not
          support partition lock pruning. See
          <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/partitioning-limitations-locking.html" target="_top">Partitioning and Locking</a>.
</p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="table-lock-release"></a>Table Lock Release</h4>

</div>

</div>

</div>
<p>
        When the table locks held by a session are released, they are
        all released at the same time. A session can release its locks
        explicitly, or locks may be released implicitly under certain
        conditions.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A session can release its locks explicitly with
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a>.
          </p></li><li class="listitem"><p>
            If a session issues a <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a> statement to acquire a lock while already
            holding locks, its existing locks are released implicitly
            before the new locks are granted.
          </p></li><li class="listitem"><p>
            If a session begins a transaction (for example, with
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a>), an implicit
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> is performed, which causes existing locks
            to be released. (For additional information about the
            interaction between table locking and transactions, see
            <a class="xref" href="sql-syntax.html#lock-tables-and-transactions" title="Interaction of Table Locking and Transactions">Interaction of Table Locking and Transactions</a>.)
</p></li></ul>
</div>
<p>
        If the connection for a client session terminates, whether
        normally or abnormally, the server implicitly releases all table
        locks held by the session (transactional and nontransactional).
        If the client reconnects, the locks will no longer be in effect.
        In addition, if the client had an active transaction, the server
        rolls back the transaction upon disconnect, and if reconnect
        occurs, the new session begins with autocommit enabled. For this
        reason, clients may wish to disable auto-reconnect. With
        auto-reconnect in effect, the client is not notified if
        reconnect occurs but any table locks or current transaction will
        have been lost. With auto-reconnect disabled, if the connection
        drops, an error occurs for the next statement issued. The client
        can detect the error and take appropriate action such as
        reacquiring the locks or redoing the transaction. See
        <a class="xref" href="connectors-apis.html#c-api-auto-reconnect" title="28.7.28 C API Automatic Reconnection Control">Section 28.7.28, “C API Automatic Reconnection Control”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          If you use <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> on a
          locked table, it may become unlocked. For example, if you
          attempt a second <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
          operation, the result may be an error <code class="literal">Table
          '<em class="replaceable"><code>tbl_name</code></em>' was not locked with LOCK
          TABLES</code>. To handle this, lock the table again prior
          to the second alteration. See also
          <a class="xref" href="error-handling.html#alter-table-problems" title="B.4.6.1 Problems with ALTER TABLE">Section B.4.6.1, “Problems with ALTER TABLE”</a>.
</p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="lock-tables-and-transactions"></a>Interaction of Table Locking and Transactions</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091662955520"></a><p>
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> and
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
        TABLES</code></a> interact with the use of transactions as
        follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> is not
            transaction-safe and implicitly commits any active
            transaction before attempting to lock the tables.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> implicitly commits any active transaction,
            but only if <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> has
            been used to acquire table locks. For example, in the
            following set of statements,
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> releases the global read lock but does not
            commit the transaction because no table locks are in effect:
          </p><pre data-lang="sql" class="programlisting">
FLUSH TABLES WITH READ LOCK;
START TRANSACTION;
SELECT ... ;
UNLOCK TABLES;
</pre></li><li class="listitem"><p>
            Beginning a transaction (for example, with
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a>) implicitly commits any current
            transaction and releases existing table locks.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH TABLES WITH READ LOCK</code></a>
            acquires a global read lock and not table locks, so it is
            not subject to the same behavior as
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> and
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> with respect to table locking and implicit
            commits. For example,
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a> does not release the global read lock.
            See <a class="xref" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax">Section 13.7.7.3, “FLUSH Syntax”</a>.
          </p></li><li class="listitem"><p>
            Other statements that implicitly cause transactions to be
            committed do not release existing table locks. For a list of
            such statements, see <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
          </p></li><li class="listitem"><p>
            The correct way to use <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a> and
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> with transactional tables, such as
            <code class="literal">InnoDB</code> tables, is to begin a transaction
            with <code class="literal">SET autocommit = 0</code> (not
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a>) followed by <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a>, and to not call
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> until you commit the transaction
            explicitly. For example, if you need to write to table
            <code class="literal">t1</code> and read from table
            <code class="literal">t2</code>, you can do this:
          </p><pre data-lang="sql" class="programlisting">
SET autocommit=0;
LOCK TABLES t1 WRITE, t2 READ, ...;
<em class="replaceable"><code>... do something with tables t1 and t2 here ...</code></em>
COMMIT;
UNLOCK TABLES;
</pre><p>
            When you call <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>,
            <code class="literal">InnoDB</code> internally takes its own table
            lock, and MySQL takes its own table lock.
            <code class="literal">InnoDB</code> releases its internal table lock
            at the next commit, but for MySQL to release its table lock,
            you have to call
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a>. You should not have
            <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit = 1</code></a>, because
            then <code class="literal">InnoDB</code> releases its internal table
            lock immediately after the call of <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a>, and deadlocks can very easily happen.
            <code class="literal">InnoDB</code> does not acquire the internal
            table lock at all if <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit =
            1</code></a>, to help old applications avoid unnecessary
            deadlocks.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
            does not release table locks.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="lock-tables-and-triggers"></a>LOCK TABLES and Triggers</h4>

</div>

</div>

</div>
<p>
        If you lock a table explicitly with <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
        TABLES</code></a>, any tables used in triggers are also locked
        implicitly:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The locks are taken as the same time as those acquired
            explicitly with the <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a> statement.
          </p></li><li class="listitem"><p>
            The lock on a table used in a trigger depends on whether the
            table is used only for reading. If so, a read lock suffices.
            Otherwise, a write lock is used.
          </p></li><li class="listitem"><p>
            If a table is locked explicitly for reading with
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>, but needs to be
            locked for writing because it might be modified within a
            trigger, a write lock is taken rather than a read lock.
            (That is, an implicit write lock needed due to the table's
            appearance within a trigger causes an explicit read lock
            request for the table to be converted to a write lock
            request.)
</p></li></ul>
</div>
<p>
        Suppose that you lock two tables, <code class="literal">t1</code> and
        <code class="literal">t2</code>, using this statement:
      </p><pre data-lang="sql" class="programlisting">
LOCK TABLES t1 WRITE, t2 READ;
</pre><p>
        If <code class="literal">t1</code> or <code class="literal">t2</code> have any
        triggers, tables used within the triggers will also be locked.
        Suppose that <code class="literal">t1</code> has a trigger defined like
        this:
      </p><pre data-lang="sql" class="programlisting">
CREATE TRIGGER t1_a_ins AFTER INSERT ON t1 FOR EACH ROW
BEGIN
  UPDATE t4 SET count = count+1
      WHERE id = NEW.id AND EXISTS (SELECT a FROM t3);
  INSERT INTO t2 VALUES(1, 2);
END;
</pre><p>
        The result of the <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>
        statement is that <code class="literal">t1</code> and
        <code class="literal">t2</code> are locked because they appear in the
        statement, and <code class="literal">t3</code> and <code class="literal">t4</code>
        are locked because they are used within the trigger:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">t1</code> is locked for writing per the
            <code class="literal">WRITE</code> lock request.
          </p></li><li class="listitem"><p>
            <code class="literal">t2</code> is locked for writing, even though the
            request is for a <code class="literal">READ</code> lock. This occurs
            because <code class="literal">t2</code> is inserted into within the
            trigger, so the <code class="literal">READ</code> request is converted
            to a <code class="literal">WRITE</code> request.
          </p></li><li class="listitem"><p>
            <code class="literal">t3</code> is locked for reading because it is
            only read from within the trigger.
          </p></li><li class="listitem"><p>
            <code class="literal">t4</code> is locked for writing because it might
            be updated within the trigger.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="lock-tables-restrictions"></a>Table-Locking Restrictions and Conditions</h4>

</div>

</div>

</div>
<p>
        You can safely use <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL</code></a> to
        terminate a session that is waiting for a table lock. See
        <a class="xref" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax">Section 13.7.7.4, “KILL Syntax”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> and
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
        TABLES</code></a> cannot be used within stored programs.
      </p><p>
        Tables in the <code class="literal">performance_schema</code> database
        cannot be locked with <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
        TABLES</code></a>, except the
        <code class="literal">setup_<em class="replaceable"><code>xxx</code></em></code> tables.
      </p><p>
        The following statements are prohibited while a
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement is in
        effect: <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>,
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
        LIKE</code></a>, <a class="link" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax"><code class="literal">CREATE VIEW</code></a>,
        <a class="link" href="sql-syntax.html#drop-view" title="13.1.35 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a>, and DDL statements on
        stored functions and procedures and events.
      </p><p>
        For some operations, system tables in the
        <code class="literal">mysql</code> database must be accessed. For example,
        the <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a> statement requires the
        contents of the server-side help tables, and
        <a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ()</code></a> might need to read
        the time zone tables. The server implicitly locks the system
        tables for reading as necessary so that you need not lock them
        explicitly. These tables are treated as just described:
      </p><pre data-lang="none" class="programlisting">
mysql.help_category
mysql.help_keyword
mysql.help_relation
mysql.help_topic
mysql.time_zone
mysql.time_zone_leap_second
mysql.time_zone_name
mysql.time_zone_transition
mysql.time_zone_transition_type
</pre><p>
        If you want to explicitly place a <code class="literal">WRITE</code> lock
        on any of those tables with a <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
        TABLES</code></a> statement, the table must be the only one
        locked; no other table can be locked with the same statement.
      </p><p>
        Normally, you do not need to lock tables, because all single
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements are atomic; no
        other session can interfere with any other currently executing
        SQL statement. However, there are a few cases when locking
        tables may provide an advantage:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If you are going to run many operations on a set of
            <code class="literal">MyISAM</code> tables, it is much faster to lock
            the tables you are going to use. Locking
            <code class="literal">MyISAM</code> tables speeds up inserting,
            updating, or deleting on them because MySQL does not flush
            the key cache for the locked tables until
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> is called. Normally, the key cache is
            flushed after each SQL statement.
          </p><p>
            The downside to locking the tables is that no session can
            update a <code class="literal">READ</code>-locked table (including the
            one holding the lock) and no session can access a
            <code class="literal">WRITE</code>-locked table other than the one
            holding the lock.
          </p></li><li class="listitem"><p>
            If you are using tables for a nontransactional storage
            engine, you must use <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a> if you want to ensure that no other session
            modifies the tables between a
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> and an
            <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>. The example shown
            here requires <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to
            execute safely:
          </p><pre data-lang="sql" class="programlisting">
LOCK TABLES trans READ, customer WRITE;
SELECT SUM(value) FROM trans WHERE customer_id=<em class="replaceable"><code>some_id</code></em>;
UPDATE customer
  SET total_value=<em class="replaceable"><code>sum_from_previous_statement</code></em>
  WHERE customer_id=<em class="replaceable"><code>some_id</code></em>;
UNLOCK TABLES;
</pre><p>
            Without <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>, it is
            possible that another session might insert a new row in the
            <code class="literal">trans</code> table between execution of the
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> and
            <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements.
</p></li></ul>
</div>
<p>
        You can avoid using <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>
        in many cases by using relative updates (<code class="literal">UPDATE
        customer SET
        <em class="replaceable"><code>value</code></em>=<em class="replaceable"><code>value</code></em>+<em class="replaceable"><code>new_value</code></em></code>)
        or the <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> function.
      </p><p>
        You can also avoid locking tables in some cases by using the
        user-level advisory lock functions
        <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a> and
        <a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a>. These locks are
        saved in a hash table in the server and implemented with
        <code class="literal">pthread_mutex_lock()</code> and
        <code class="literal">pthread_mutex_unlock()</code> for high speed. See
        <a class="xref" href="functions.html#locking-functions" title="12.14 Locking Functions">Section 12.14, “Locking Functions”</a>.
      </p><p>
        See <a class="xref" href="optimization.html#internal-locking" title="8.11.1 Internal Locking Methods">Section 8.11.1, “Internal Locking Methods”</a>, for more information on
        locking policy.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="set-transaction"></a>13.3.7 SET TRANSACTION Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091662820928"></a><a class="indexterm" name="idm140091662819840"></a><a class="indexterm" name="idm140091662818768"></a><a class="indexterm" name="idm140091662817696"></a><pre data-lang="sql" class="programlisting">
SET [GLOBAL | SESSION] TRANSACTION
    <em class="replaceable"><code>transaction_characteristic</code></em> [, <em class="replaceable"><code>transaction_characteristic</code></em>] ...

<em class="replaceable"><code>transaction_characteristic</code></em>: {
    ISOLATION LEVEL <em class="replaceable"><code>level</code></em>
  | <em class="replaceable"><code>access_mode</code></em>
}

<em class="replaceable"><code>level</code></em>: {
     REPEATABLE READ
   | READ COMMITTED
   | READ UNCOMMITTED
   | SERIALIZABLE
}

<em class="replaceable"><code>access_mode</code></em>: {
     READ WRITE
   | READ ONLY
}
</pre><p>
      This statement specifies
      <a class="link" href="glossary.html#glos_transaction" title="transaction">transaction</a>
      characteristics. It takes a list of one or more characteristic
      values separated by commas. Each characteristic value sets the
      transaction <a class="link" href="glossary.html#glos_isolation_level" title="isolation level">isolation
      level</a> or access mode. The isolation level is used for
      operations on <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables. The
      access mode specifies whether transactions operate in read/write
      or read-only mode.
    </p><p>
      In addition, <a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a> can
      include an optional <code class="literal">GLOBAL</code> or
      <code class="literal">SESSION</code> keyword to indicate the scope of the
      statement.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#set-transaction-isolation-level" title="Transaction Isolation Levels">Transaction Isolation Levels</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#set-transaction-access-mode" title="Transaction Access Mode">Transaction Access Mode</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#set-transaction-scope" title="Transaction Characteristic Scope">Transaction Characteristic Scope</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="set-transaction-isolation-level"></a>Transaction Isolation Levels</h4>

</div>

</div>

</div>
<p>
        To set the transaction isolation level, use an
        <code class="literal">ISOLATION LEVEL
        <em class="replaceable"><code>level</code></em></code> clause. It is not
        permitted to specify multiple <code class="literal">ISOLATION LEVEL</code>
        clauses in the same <a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax"><code class="literal">SET
        TRANSACTION</code></a> statement.
      </p><p>
        The default isolation level is
        <a class="link" href="innodb-storage-engine.html#isolevel_repeatable-read"><code class="literal">REPEATABLE READ</code></a>. Other
        permitted values are <a class="link" href="innodb-storage-engine.html#isolevel_read-committed"><code class="literal">READ
        COMMITTED</code></a>, <a class="link" href="innodb-storage-engine.html#isolevel_read-uncommitted"><code class="literal">READ
        UNCOMMITTED</code></a>, and
        <a class="link" href="innodb-storage-engine.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a>. For information
        about these isolation levels, see
        <a class="xref" href="innodb-storage-engine.html#innodb-transaction-isolation-levels" title="15.7.2.1 Transaction Isolation Levels">Section 15.7.2.1, “Transaction Isolation Levels”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="set-transaction-access-mode"></a>Transaction Access Mode</h4>

</div>

</div>

</div>
<p>
        To set the transaction access mode, use a <code class="literal">READ
        WRITE</code> or <code class="literal">READ ONLY</code> clause. It is
        not permitted to specify multiple access-mode clauses in the
        same <a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a> statement.
      </p><p>
        By default, a transaction takes place in read/write mode, with
        both reads and writes permitted to tables used in the
        transaction. This mode may be specified explicitly using
        <a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a> with an access
        mode of <code class="literal">READ WRITE</code>.
      </p><p>
        If the transaction access mode is set to <code class="literal">READ
        ONLY</code>, changes to tables are prohibited. This may
        enable storage engines to make performance improvements that are
        possible when writes are not permitted.
      </p><p>
        In read-only mode, it remains possible to change tables created
        with the <code class="literal">TEMPORARY</code> keyword using DML
        statements. Changes made with DDL statements are not permitted,
        just as with permanent tables.
      </p><p>
        The <code class="literal">READ WRITE</code> and <code class="literal">READ
        ONLY</code> access modes also may be specified for an
        individual transaction using the
        <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
        TRANSACTION</code></a> statement.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="set-transaction-scope"></a>Transaction Characteristic Scope</h4>

</div>

</div>

</div>
<p>
        You can set transaction characteristics globally, for the
        current session, or for the next transaction only:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            With the <code class="literal">GLOBAL</code> keyword:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                The statement applies globally for all subsequent
                sessions.
              </p></li><li class="listitem"><p>
                Existing sessions are unaffected.
</p></li></ul>
</div>
</li><li class="listitem"><p>
            With the <code class="literal">SESSION</code> keyword:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                The statement applies to all subsequent transactions
                performed within the current session.
              </p></li><li class="listitem"><p>
                The statement is permitted within transactions, but does
                not affect the current ongoing transaction.
              </p></li><li class="listitem"><p>
                If executed between transactions, the statement
                overrides any preceding statement that sets the
                next-transaction value of the named characteristics.
</p></li></ul>
</div>
</li><li class="listitem"><p>
            Without any <code class="literal">SESSION</code> or
            <code class="literal">GLOBAL</code> keyword:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                The statement applies only to the next single
                transaction performed within the session.
              </p></li><li class="listitem"><p>
                Subsequent transactions revert to using the session
                value of the named characteristics.
              </p></li><li class="listitem"><p>
                The statement is not permitted within transactions:
              </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>START TRANSACTION;</code></strong>
Query OK, 0 rows affected (0.02 sec)

mysql&gt; <strong class="userinput"><code>SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;</code></strong>
ERROR 1568 (25001): Transaction characteristics can't be changed
while a transaction is in progress
</pre></li></ul>
</div>
</li></ul>
</div>
<p>
        A change to global transaction characteristics requires the
        <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege. Any session is
        free to change its session characteristics (even in the middle
        of a transaction), or the characteristics for its next
        transaction (prior to the start of that transaction).
      </p><p>
        To set the global isolation level at server startup, use the
        <a class="link" href="server-administration.html#option_mysqld_transaction-isolation"><code class="option">--transaction-isolation=<em class="replaceable"><code>level</code></em></code></a>
        option on the command line or in an option file. Values of
        <em class="replaceable"><code>level</code></em> for this option use dashes
        rather than spaces, so the permissible values are
        <a class="link" href="innodb-storage-engine.html#isolevel_read-uncommitted"><code class="literal">READ-UNCOMMITTED</code></a>,
        <a class="link" href="innodb-storage-engine.html#isolevel_read-committed"><code class="literal">READ-COMMITTED</code></a>,
        <a class="link" href="innodb-storage-engine.html#isolevel_repeatable-read"><code class="literal">REPEATABLE-READ</code></a>, or
        <a class="link" href="innodb-storage-engine.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a>.
      </p><p>
        Similarly, to set the global transaction access mode at server
        startup, use the
        <a class="link" href="server-administration.html#option_mysqld_transaction-read-only"><code class="option">--transaction-read-only</code></a> option.
        The default is <code class="literal">OFF</code> (read/write mode) but the
        value can be set to <code class="literal">ON</code> for a mode of read
        only.
      </p><p>
        For example, to set the isolation level to
        <a class="link" href="innodb-storage-engine.html#isolevel_repeatable-read"><code class="literal">REPEATABLE READ</code></a> and the
        access mode to <code class="literal">READ WRITE</code>, use these lines in
        the <code class="literal">[mysqld]</code> section of an option file:
      </p><pre data-lang="ini" class="programlisting">
[mysqld]
transaction-isolation = REPEATABLE-READ
transaction-read-only = OFF
</pre><p>
        At runtime, characteristics at the global, session, and
        next-transaction scope levels can be set indirectly using the
        <a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a> statement, as
        described previously. They can also be set directly using the
        <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
        statement to assign values to the
        <a class="link" href="server-administration.html#sysvar_transaction_isolation"><code class="literal">transaction_isolation</code></a> and
        <a class="link" href="server-administration.html#sysvar_transaction_read_only"><code class="literal">transaction_read_only</code></a> system
        variables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a> permits
            optional <code class="literal">GLOBAL</code> and
            <code class="literal">SESSION</code> keywords for setting transaction
            characteristics at different scope levels.
          </p></li><li class="listitem"><p>
            The
            <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
            statement for assigning values to the
            <a class="link" href="server-administration.html#sysvar_transaction_isolation"><code class="literal">transaction_isolation</code></a> and
            <a class="link" href="server-administration.html#sysvar_transaction_read_only"><code class="literal">transaction_read_only</code></a>
            system variables has syntaxes for setting these variables at
            different scope levels.
</p></li></ul>
</div>
<p>
        The following tables show the characteristic scope level set by
        each <a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a> and
        variable-assignment syntax.
</p>
<div class="table">
<a name="set-transaction-characteristic-syntax"></a><p class="title"><b>Table 13.9 SET TRANSACTION Syntax for Transaction Characteristics</b></p>
<div class="table-contents">
<table summary="Syntax for setting transaction characteristics using SET TRANSACTION and affected scope."><col width="60*"><col width="40*"><thead><tr>
            <th scope="col">Syntax</th>
            <th scope="col">Affected Characteristic Scope</th>
          </tr></thead><tbody><tr>
            <td scope="row"><code class="literal">SET GLOBAL TRANSACTION
              <em class="replaceable"><code>transaction_characteristic</code></em></code></td>
            <td>Global</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET SESSION TRANSACTION
              <em class="replaceable"><code>transaction_characteristic</code></em></code></td>
            <td>Session</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET TRANSACTION
              <em class="replaceable"><code>transaction_characteristic</code></em></code></td>
            <td>Next transaction only</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="table">
<a name="set-variable-characteristic-syntax"></a><p class="title"><b>Table 13.10 SET Syntax for Transaction Characteristics</b></p>
<div class="table-contents">
<table summary="Syntax for setting transaction characteristics using SET and affected scope."><col width="60*"><col width="40*"><thead><tr>
            <th scope="col">Syntax</th>
            <th scope="col">Affected Characteristic Scope</th>
          </tr></thead><tbody><tr>
            <td scope="row"><code class="literal">SET GLOBAL <em class="replaceable"><code>var_name</code></em> =
              <em class="replaceable"><code>value</code></em></code></td>
            <td>Global</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET @@GLOBAL.<em class="replaceable"><code>var_name</code></em> =
              <em class="replaceable"><code>value</code></em></code></td>
            <td>Global</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET PERSIST <em class="replaceable"><code>var_name</code></em> =
              <em class="replaceable"><code>value</code></em></code></td>
            <td>Global</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET @@PERSIST.<em class="replaceable"><code>var_name</code></em> =
              <em class="replaceable"><code>value</code></em></code></td>
            <td>Global</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET PERSIST_ONLY <em class="replaceable"><code>var_name</code></em> =
              <em class="replaceable"><code>value</code></em></code></td>
            <td>No runtime effect</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET @@PERSIST_ONLY.<em class="replaceable"><code>var_name</code></em> =
              <em class="replaceable"><code>value</code></em></code></td>
            <td>No runtime effect</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET SESSION <em class="replaceable"><code>var_name</code></em> =
              <em class="replaceable"><code>value</code></em></code></td>
            <td>Session</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET @@SESSION.<em class="replaceable"><code>var_name</code></em> =
              <em class="replaceable"><code>value</code></em></code></td>
            <td>Session</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET <em class="replaceable"><code>var_name</code></em> =
              <em class="replaceable"><code>value</code></em></code></td>
            <td>Session</td>
          </tr><tr>
            <td scope="row"><code class="literal">SET @@<em class="replaceable"><code>var_name</code></em> =
              <em class="replaceable"><code>value</code></em></code></td>
            <td>Next transaction only</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
        It is possible to check the global and session values of
        transaction characteristics at runtime:
      </p><pre data-lang="sql" class="programlisting">
SELECT @@GLOBAL.transaction_isolation, @@GLOBAL.transaction_read_only;
SELECT @@SESSION.transaction_isolation, @@SESSION.transaction_read_only;
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="xa"></a>13.3.8 XA Transactions</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#xa-statements">13.3.8.1 XA Transaction SQL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#xa-states">13.3.8.2 XA Transaction States</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091662661968"></a><p>
      Support for <a class="link" href="glossary.html#glos_xa" title="XA">XA</a> transactions is
      available for the <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> storage
      engine. The MySQL XA implementation is based on the X/Open CAE
      document <em class="citetitle">Distributed Transaction Processing: The XA
      Specification</em>. This document is published by The Open
      Group and available at
      <a class="ulink" href="http://www.opengroup.org/public/pubs/catalog/c193.htm" target="_top">http://www.opengroup.org/public/pubs/catalog/c193.htm</a>.
      Limitations of the current XA implementation are described in
      <a class="xref" href="restrictions.html#xa-restrictions" title="C.6 Restrictions on XA Transactions">Section C.6, “Restrictions on XA Transactions”</a>.
    </p><p>
      On the client side, there are no special requirements. The XA
      interface to a MySQL server consists of SQL statements that begin
      with the <code class="literal">XA</code> keyword. MySQL client programs must
      be able to send SQL statements and to understand the semantics of
      the XA statement interface. They do not need be linked against a
      recent client library. Older client libraries also will work.
    </p><p>
      Among the MySQL Connectors, MySQL Connector/J 5.0.0 and higher
      supports XA directly, by means of a class interface that handles
      the XA SQL statement interface for you.
    </p><p>
      XA supports distributed transactions, that is, the ability to
      permit multiple separate transactional resources to participate in
      a global transaction. Transactional resources often are RDBMSs but
      may be other kinds of resources.
    </p><p>
      A global transaction involves several actions that are
      transactional in themselves, but that all must either complete
      successfully as a group, or all be rolled back as a group. In
      essence, this extends ACID properties <span class="quote">“<span class="quote">up a level</span>”</span> so
      that multiple ACID transactions can be executed in concert as
      components of a global operation that also has ACID properties.
      (As with nondistributed transactions,
      <a class="link" href="innodb-storage-engine.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a> may be preferred
      if your applications are sensitive to read phenomena.
      <a class="link" href="innodb-storage-engine.html#isolevel_repeatable-read"><code class="literal">REPEATABLE READ</code></a> may not be
      sufficient for distributed transactions.)
    </p><p>
      Some examples of distributed transactions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          An application may act as an integration tool that combines a
          messaging service with an RDBMS. The application makes sure
          that transactions dealing with message sending, retrieval, and
          processing that also involve a transactional database all
          happen in a global transaction. You can think of this as
          <span class="quote">“<span class="quote">transactional email.</span>”</span>
        </p></li><li class="listitem"><p>
          An application performs actions that involve different
          database servers, such as a MySQL server and an Oracle server
          (or multiple MySQL servers), where actions that involve
          multiple servers must happen as part of a global transaction,
          rather than as separate transactions local to each server.
        </p></li><li class="listitem"><p>
          A bank keeps account information in an RDBMS and distributes
          and receives money through automated teller machines (ATMs).
          It is necessary to ensure that ATM actions are correctly
          reflected in the accounts, but this cannot be done with the
          RDBMS alone. A global transaction manager integrates the ATM
          and database resources to ensure overall consistency of
          financial transactions.
</p></li></ul>
</div>
<p>
      Applications that use global transactions involve one or more
      Resource Managers and a Transaction Manager:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A Resource Manager (RM) provides access to transactional
          resources. A database server is one kind of resource manager.
          It must be possible to either commit or roll back transactions
          managed by the RM.
        </p></li><li class="listitem"><p>
          A Transaction Manager (TM) coordinates the transactions that
          are part of a global transaction. It communicates with the RMs
          that handle each of these transactions. The individual
          transactions within a global transaction are
          <span class="quote">“<span class="quote">branches</span>”</span> of the global transaction. Global
          transactions and their branches are identified by a naming
          scheme described later.
</p></li></ul>
</div>
<p>
      The MySQL implementation of XA enables a MySQL server to act as a
      Resource Manager that handles XA transactions within a global
      transaction. A client program that connects to the MySQL server
      acts as the Transaction Manager.
    </p><p>
      To carry out a global transaction, it is necessary to know which
      components are involved, and bring each component to a point when
      it can be committed or rolled back. Depending on what each
      component reports about its ability to succeed, they must all
      commit or roll back as an atomic group. That is, either all
      components must commit, or all components must roll back. To
      manage a global transaction, it is necessary to take into account
      that any component or the connecting network might fail.
    </p><p>
      The process for executing a global transaction uses two-phase
      commit (2PC). This takes place after the actions performed by the
      branches of the global transaction have been executed.
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          In the first phase, all branches are prepared. That is, they
          are told by the TM to get ready to commit. Typically, this
          means each RM that manages a branch records the actions for
          the branch in stable storage. The branches indicate whether
          they are able to do this, and these results are used for the
          second phase.
        </p></li><li class="listitem"><p>
          In the second phase, the TM tells the RMs whether to commit or
          roll back. If all branches indicated when they were prepared
          that they will be able to commit, all branches are told to
          commit. If any branch indicated when it was prepared that it
          will not be able to commit, all branches are told to roll
          back.
</p></li></ol>
</div>
<p>
      In some cases, a global transaction might use one-phase commit
      (1PC). For example, when a Transaction Manager finds that a global
      transaction consists of only one transactional resource (that is,
      a single branch), that resource can be told to prepare and commit
      at the same time.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="xa-statements"></a>13.3.8.1 XA Transaction SQL Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091662633040"></a><a class="indexterm" name="idm140091662632000"></a><a class="indexterm" name="idm140091662630512"></a><a class="indexterm" name="idm140091662629440"></a><a class="indexterm" name="idm140091662627952"></a><a class="indexterm" name="idm140091662626880"></a><a class="indexterm" name="idm140091662625392"></a><a class="indexterm" name="idm140091662624320"></a><a class="indexterm" name="idm140091662622832"></a><a class="indexterm" name="idm140091662621760"></a><a class="indexterm" name="idm140091662620272"></a><a class="indexterm" name="idm140091662619200"></a><a class="indexterm" name="idm140091662617712"></a><a class="indexterm" name="idm140091662616240"></a><p>
        To perform XA transactions in MySQL, use the following
        statements:
      </p><pre data-lang="sql" class="programlisting">
XA {START|BEGIN} <em class="replaceable"><code>xid</code></em> [JOIN|RESUME]

XA END <em class="replaceable"><code>xid</code></em> [SUSPEND [FOR MIGRATE]]

XA PREPARE <em class="replaceable"><code>xid</code></em>

XA COMMIT <em class="replaceable"><code>xid</code></em> [ONE PHASE]

XA ROLLBACK <em class="replaceable"><code>xid</code></em>

XA RECOVER [CONVERT XID]
</pre><p>
        For <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
        START</code></a>, the <code class="literal">JOIN</code> and
        <code class="literal">RESUME</code> clauses are not supported.
      </p><p>
        For <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
        END</code></a> the <code class="literal">SUSPEND [FOR MIGRATE]</code>
        clause is not supported.
      </p><p>
        Each XA statement begins with the <code class="literal">XA</code> keyword,
        and most of them require an <em class="replaceable"><code>xid</code></em>
        value. An <em class="replaceable"><code>xid</code></em> is an XA transaction
        identifier. It indicates which transaction the statement applies
        to. <em class="replaceable"><code>xid</code></em> values are supplied by the
        client, or generated by the MySQL server. An
        <em class="replaceable"><code>xid</code></em> value has from one to three
        parts:
      </p><pre data-lang="none" class="programlisting">
<em class="replaceable"><code>xid</code></em>: <em class="replaceable"><code>gtrid</code></em> [, <em class="replaceable"><code>bqual</code></em> [, <em class="replaceable"><code>formatID</code></em> ]]
</pre><p>
        <em class="replaceable"><code>gtrid</code></em> is a global transaction
        identifier, <em class="replaceable"><code>bqual</code></em> is a branch
        qualifier, and <em class="replaceable"><code>formatID</code></em> is a number
        that identifies the format used by the
        <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> values. As indicated by the
        syntax, <em class="replaceable"><code>bqual</code></em> and
        <em class="replaceable"><code>formatID</code></em> are optional. The default
        <em class="replaceable"><code>bqual</code></em> value is <code class="literal">''</code>
        if not given. The default <em class="replaceable"><code>formatID</code></em>
        value is 1 if not given.
      </p><p>
        <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> must be string literals, each
        up to 64 bytes (not characters) long.
        <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> can be specified in several
        ways. You can use a quoted string (<code class="literal">'ab'</code>), hex
        string (<code class="literal">X'6162'</code>, <code class="literal">0x6162</code>),
        or bit value
        (<code class="literal">b'<em class="replaceable"><code>nnnn</code></em>'</code>).
      </p><p>
        <em class="replaceable"><code>formatID</code></em> is an unsigned integer.
      </p><p>
        The <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> values are interpreted in bytes
        by the MySQL server's underlying XA support routines. However,
        while an SQL statement containing an XA statement is being
        parsed, the server works with some specific character set. To be
        safe, write <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> as hex strings.
      </p><p>
        <em class="replaceable"><code>xid</code></em> values typically are generated by
        the Transaction Manager. Values generated by one TM must be
        different from values generated by other TMs. A given TM must be
        able to recognize its own <em class="replaceable"><code>xid</code></em> values
        in a list of values returned by the
        <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
        RECOVER</code></a> statement.
      </p><p>
        <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA START
        <em class="replaceable"><code>xid</code></em></code></a> starts an XA
        transaction with the given <em class="replaceable"><code>xid</code></em> value.
        Each XA transaction must have a unique
        <em class="replaceable"><code>xid</code></em> value, so the value must not
        currently be used by another XA transaction. Uniqueness is
        assessed using the <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> values. All following XA
        statements for the XA transaction must be specified using the
        same <em class="replaceable"><code>xid</code></em> value as that given in the
        <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
        START</code></a> statement. If you use any of those statements
        but specify an <em class="replaceable"><code>xid</code></em> value that does
        not correspond to some existing XA transaction, an error occurs.
      </p><p>
        One or more XA transactions can be part of the same global
        transaction. All XA transactions within a given global
        transaction must use the same <em class="replaceable"><code>gtrid</code></em>
        value in the <em class="replaceable"><code>xid</code></em> value. For this
        reason, <em class="replaceable"><code>gtrid</code></em> values must be globally
        unique so that there is no ambiguity about which global
        transaction a given XA transaction is part of. The
        <em class="replaceable"><code>bqual</code></em> part of the
        <em class="replaceable"><code>xid</code></em> value must be different for each
        XA transaction within a global transaction. (The requirement
        that <em class="replaceable"><code>bqual</code></em> values be different is a
        limitation of the current MySQL XA implementation. It is not
        part of the XA specification.)
      </p><p>
        The <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
        RECOVER</code></a> statement returns information for those XA
        transactions on the MySQL server that are in the
        <code class="literal">PREPARED</code> state. (See
        <a class="xref" href="sql-syntax.html#xa-states" title="13.3.8.2 XA Transaction States">Section 13.3.8.2, “XA Transaction States”</a>.) The output includes a row for each
        such XA transaction on the server, regardless of which client
        started it.
      </p><p>
        <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
        RECOVER</code></a> requires the
        <a class="link" href="security.html#priv_xa-recover-admin"><code class="literal">XA_RECOVER_ADMIN</code></a> privilege. This
        privilege requirement prevents users from discovering the XID
        values for outstanding prepared XA transactions other than their
        own. It does not affect normal commit or rollback of an XA
        transaction because the user who started it knows its XID.
      </p><p>
        <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
        RECOVER</code></a> output rows look like this (for an example
        <em class="replaceable"><code>xid</code></em> value consisting of the parts
        <code class="literal">'abc'</code>, <code class="literal">'def'</code>, and
        <code class="literal">7</code>):
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>XA RECOVER;</code></strong>
+----------+--------------+--------------+--------+
| formatID | gtrid_length | bqual_length | data   |
+----------+--------------+--------------+--------+
|        7 |            3 |            3 | abcdef |
+----------+--------------+--------------+--------+
</pre><p>
        The output columns have the following meanings:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">formatID</code> is the
            <em class="replaceable"><code>formatID</code></em> part of the transaction
            <em class="replaceable"><code>xid</code></em>
          </p></li><li class="listitem"><p>
            <code class="literal">gtrid_length</code> is the length in bytes of
            the <em class="replaceable"><code>gtrid</code></em> part of the
            <em class="replaceable"><code>xid</code></em>
          </p></li><li class="listitem"><p>
            <code class="literal">bqual_length</code> is the length in bytes of
            the <em class="replaceable"><code>bqual</code></em> part of the
            <em class="replaceable"><code>xid</code></em>
          </p></li><li class="listitem"><p>
            <code class="literal">data</code> is the concatenation of the
            <em class="replaceable"><code>gtrid</code></em> and
            <em class="replaceable"><code>bqual</code></em> parts of the
            <em class="replaceable"><code>xid</code></em>
</p></li></ul>
</div>
<p>
        XID values may contain nonprintable characters.
        <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
        RECOVER</code></a> permits an optional <code class="literal">CONVERT
        XID</code> clause so that clients can request XID values in
        hexadecimal.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="xa-states"></a>13.3.8.2 XA Transaction States</h4>

</div>

</div>

</div>
<p>
        An XA transaction progresses through the following states:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            Use <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
            START</code></a> to start an XA transaction and put it in the
            <code class="literal">ACTIVE</code> state.
          </p></li><li class="listitem"><p>
            For an <code class="literal">ACTIVE</code> XA transaction, issue the
            SQL statements that make up the transaction, and then issue
            an <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
            END</code></a> statement.
            <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
            END</code></a> puts the transaction in the
            <code class="literal">IDLE</code> state.
          </p></li><li class="listitem"><p>
            For an <code class="literal">IDLE</code> XA transaction, you can issue
            either an <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
            PREPARE</code></a> statement or an <code class="literal">XA COMMIT ... ONE
            PHASE</code> statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
                PREPARE</code></a> puts the transaction in the
                <code class="literal">PREPARED</code> state. An
                <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
                RECOVER</code></a> statement at this point will include
                the transaction's <em class="replaceable"><code>xid</code></em> value
                in its output, because
                <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
                RECOVER</code></a> lists all XA transactions that are in
                the <code class="literal">PREPARED</code> state.
              </p></li><li class="listitem"><p>
                <code class="literal">XA COMMIT ... ONE PHASE</code> prepares and
                commits the transaction. The
                <em class="replaceable"><code>xid</code></em> value will not be listed
                by <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
                RECOVER</code></a> because the transaction terminates.
</p></li></ul>
</div>
</li><li class="listitem"><p>
            For a <code class="literal">PREPARED</code> XA transaction, you can
            issue an <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
            COMMIT</code></a> statement to commit and terminate the
            transaction, or
            <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
            ROLLBACK</code></a> to roll back and terminate the
            transaction.
</p></li></ol>
</div>
<p>
        Here is a simple XA transaction that inserts a row into a table
        as part of a global transaction:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>XA START 'xatest';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO mytable (i) VALUES(10);</code></strong>
Query OK, 1 row affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>XA END 'xatest';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>XA PREPARE 'xatest';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>XA COMMIT 'xatest';</code></strong>
Query OK, 0 rows affected (0.00 sec)
</pre><p>
        Within the context of a given client connection, XA transactions
        and local (non-XA) transactions are mutually exclusive. For
        example, if <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
        START</code></a> has been issued to begin an XA transaction, a
        local transaction cannot be started until the XA transaction has
        been committed or rolled back. Conversely, if a local
        transaction has been started with
        <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
        TRANSACTION</code></a>, no XA statements can be used until the
        transaction has been committed or rolled back.
      </p><p>
        If an XA transaction is in the <code class="literal">ACTIVE</code> state,
        you cannot issue any statements that cause an implicit commit.
        That would violate the XA contract because you could not roll
        back the XA transaction. You will receive the following error if
        you try to execute such a statement:
      </p><pre data-lang="none" class="programlisting">
ERROR 1399 (XAE07): XAER_RMFAIL: The command cannot be executed
when global transaction is in the ACTIVE state
</pre><p>
        Statements to which the preceding remark applies are listed at
        <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-replication"></a>13.4 Replication Statements</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#replication-master-sql">13.4.1 SQL Statements for Controlling Master Servers</a></span></dt><dt><span class="section"><a href="sql-syntax.html#replication-slave-sql">13.4.2 SQL Statements for Controlling Slave Servers</a></span></dt><dt><span class="section"><a href="sql-syntax.html#replication-group-sql">13.4.3 SQL Statements for Controlling Group Replication</a></span></dt></dl>
</div>
<p>
    Replication can be controlled through the SQL interface using the
    statements described in this section. Statements are split into a
    group which controls master servers, a group which controls slave
    servers, and a group which can be applied to any replication
    servers.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="replication-master-sql"></a>13.4.1 SQL Statements for Controlling Master Servers</h3>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#purge-binary-logs">13.4.1.1 PURGE BINARY LOGS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#reset-master">13.4.1.2 RESET MASTER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-sql-log-bin">13.4.1.3 SET sql_log_bin Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091662499792"></a><a class="indexterm" name="idm140091662498336"></a><a class="indexterm" name="idm140091662496848"></a><p>
      This section discusses statements for managing master replication
      servers. <a class="xref" href="sql-syntax.html#replication-slave-sql" title="13.4.2 SQL Statements for Controlling Slave Servers">Section 13.4.2, “SQL Statements for Controlling Slave Servers”</a>, discusses
      statements for managing slave servers.
    </p><p>
      In addition to the statements described here, the following
      <a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax"><code class="literal">SHOW</code></a> statements are used with
      master servers in replication. For information about these
      statements, see <a class="xref" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax">Section 13.7.6, “SHOW Syntax”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#show-binary-logs" title="13.7.6.1 SHOW BINARY LOGS Syntax"><code class="literal">SHOW BINARY LOGS</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.6.2 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#show-master-status" title="13.7.6.23 SHOW MASTER STATUS Syntax"><code class="literal">SHOW MASTER STATUS</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#show-slave-hosts" title="13.7.6.33 SHOW SLAVE HOSTS Syntax"><code class="literal">SHOW SLAVE HOSTS</code></a>
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="purge-binary-logs"></a>13.4.1.1 PURGE BINARY LOGS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091662482128"></a><a class="indexterm" name="idm140091662481088"></a><pre data-lang="sql" class="programlisting">
PURGE { BINARY | MASTER } LOGS {
    TO '<em class="replaceable"><code>log_name</code></em>'
  | BEFORE <em class="replaceable"><code>datetime_expr</code></em>
}
</pre><p>
        The binary log is a set of files that contain information about
        data modifications made by the MySQL server. The log consists of
        a set of binary log files, plus an index file (see
        <a class="xref" href="server-administration.html#binary-log" title="5.4.4 The Binary Log">Section 5.4.4, “The Binary Log”</a>).
      </p><p>
        The <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY LOGS</code></a> statement
        deletes all the binary log files listed in the log index file
        prior to the specified log file name or date.
        <code class="literal">BINARY</code> and <code class="literal">MASTER</code> are
        synonyms. Deleted log files also are removed from the list
        recorded in the index file, so that the given log file becomes
        the first in the list.
      </p><p>
        <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY LOGS</code></a> requires the
        <a class="link" href="security.html#priv_binlog-admin"><code class="literal">BINLOG_ADMIN</code></a> privilege. This
        statement has no effect if the server was not started with the
        <a class="link" href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a> option to enable binary
        logging.
      </p><p>
        Examples:
      </p><pre data-lang="sql" class="programlisting">
PURGE BINARY LOGS TO 'mysql-bin.010';
PURGE BINARY LOGS BEFORE '2019-04-02 22:46:26';
</pre><p>
        The <code class="literal">BEFORE</code> variant's
        <em class="replaceable"><code>datetime_expr</code></em> argument should
        evaluate to a <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> value (a
        value in <code class="literal">'YYYY-MM-DD hh:mm:ss'</code> format).
      </p><p>
        This statement is safe to run while slaves are replicating. You
        need not stop them. If you have an active slave that currently
        is reading one of the log files you are trying to delete, this
        statement does not delete the log file that is in use or any log
        files later than that one, but it deletes any earlier log files.
        A warning message is issued in this situation. However, if a
        slave is not connected and you happen to purge one of the log
        files it has yet to read, the slave will be unable to replicate
        after it reconnects.
      </p><p>
        To safely purge binary log files, follow this procedure:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            On each slave server, use <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE
            STATUS</code></a> to check which log file it is reading.
          </p></li><li class="listitem"><p>
            Obtain a listing of the binary log files on the master
            server with <a class="link" href="sql-syntax.html#show-binary-logs" title="13.7.6.1 SHOW BINARY LOGS Syntax"><code class="literal">SHOW BINARY LOGS</code></a>.
          </p></li><li class="listitem"><p>
            Determine the earliest log file among all the slaves. This
            is the target file. If all the slaves are up to date, this
            is the last log file on the list.
          </p></li><li class="listitem"><p>
            Make a backup of all the log files you are about to delete.
            (This step is optional, but always advisable.)
          </p></li><li class="listitem"><p>
            Purge all log files up to but not including the target file.
</p></li></ol>
</div>
<p>
        <code class="literal">PURGE BINARY LOGS TO</code> and <code class="literal">PURGE
        BINARY LOGS BEFORE</code> both fail with an error when binary
        log files listed in the <code class="filename">.index</code> file had
        been removed from the system by some other means (such as using
        <span class="command"><strong>rm</strong></span> on Linux). (Bug #18199, Bug #18453) To
        handle such errors, edit the <code class="filename">.index</code> file
        (which is a simple text file) manually to ensure that it lists
        only the binary log files that are actually present, then run
        again the <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY LOGS</code></a>
        statement that failed.
      </p><p>
        Binary log files are automatically removed after the server's
        binary log expiration period. Removal of the files can take
        place at startup and when the binary log is flushed. The default
        binary log expiration period is 30 days. You can specify an
        alternative expiration period using the
        <a class="link" href="replication.html#sysvar_binlog_expire_logs_seconds"><code class="literal">binlog_expire_logs_seconds</code></a>
        system variable. If you are using replication, you should
        specify an expiration period that is no lower than the maximum
        amount of time your slaves might lag behind the master.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="reset-master"></a>13.4.1.2 RESET MASTER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091662441824"></a><pre data-lang="sql" class="programlisting">
RESET MASTER [TO <em class="replaceable"><code>binary_log_file_index_number</code></em>]
</pre><p>
        <code class="literal">RESET MASTER</code> enables you to delete any binary
        log files and their related binary log index file, returning the
        master to its state before binary logging was started.
        <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> requires the
        <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
          Use this statement with caution to ensure you do not lose
          binary log file data.
</p>
</div>
<p>
        Issuing <code class="literal">RESET MASTER</code> without the optional
        <code class="literal">TO</code> clause deletes all binary log files listed
        in the index file, resets the binary log index file to be empty,
        and creates a new binary log file starting at
        <code class="literal">1</code>. Use the optional <code class="literal">TO</code>
        clause to start the binary log file index from a number other
        than <code class="literal">1</code> after the reset. Issuing
        <code class="literal">RESET MASTER</code> also clears the values of the
        <a class="link" href="replication.html#sysvar_gtid_purged"><code class="literal">gtid_purged</code></a> system variable and
        the <a class="link" href="replication.html#sysvar_gtid_executed"><code class="literal">gtid_executed</code></a> system
        variable; that is, issuing this statement sets each of these
        values to an empty string (<code class="literal">''</code>). This
        statement also clears the <code class="literal">mysql.gtid_executed</code>
        table (see
        <a class="xref" href="replication.html#replication-gtids-gtid-executed-table" title="mysql.gtid_executed Table">mysql.gtid_executed Table</a>).
      </p><p>
        Using <code class="literal">RESET MASTER</code> with the
        <code class="literal">TO</code> clause to specify a binary log file index
        number to start from simplifies failover by providing a single
        statement alternative to the <a class="link" href="sql-syntax.html#flush-binary-logs"><code class="literal">FLUSH BINARY
        LOGS</code></a> and
        <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY
        LOGS TO</code></a> statements. Check that you are using a
        reasonable value for the index number. If you enter an incorrect
        value, you can correct this by issuing another
        <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> statement with or
        without the <code class="literal">TO</code> clause. If you do not correct
        a value that is out of range, the server cannot be restarted.
      </p><p>
        The following example demonstrates <code class="literal">TO</code> clause
        usage:
      </p><pre data-lang="sql" class="programlisting">
RESET MASTER TO 1234;

SHOW BINARY LOGS;
+-------------------+-----------+-----------+
| Log_name          | File_size | Encrypted |
+-------------------+-----------+-----------+
| master-bin.001234 |       154 | No        |
+-------------------+-----------+-----------+
</pre><a class="indexterm" name="idm140091662413616"></a><a class="indexterm" name="idm140091662412112"></a>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          The effects of <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a>
          without the <code class="literal">TO</code> clause differ from those of
          <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY LOGS</code></a> in 2 key
          ways:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> removes
              <span class="emphasis"><em>all</em></span> binary log files that are listed
              in the index file, leaving only a single, empty binary log
              file with a numeric suffix of <code class="literal">.000001</code>,
              whereas the numbering is not reset by
              <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY LOGS</code></a>.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> is
              <span class="emphasis"><em>not</em></span> intended to be used while any
              replication slaves are running. The behavior of
              <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> when used
              while slaves are running is undefined (and thus
              unsupported), whereas <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY
              LOGS</code></a> may be safely used while replication slaves
              are running.
</p></li></ol>
</div>
<p>
          See also <a class="xref" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax">Section 13.4.1.1, “PURGE BINARY LOGS Syntax”</a>.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> without the
        <code class="literal">TO</code> clause can prove useful when you first set
        up the master and the slave, so that you can verify the setup as
        follows:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            Start the master and slave, and start replication (see
            <a class="xref" href="replication.html#replication-howto" title="17.1.2 Setting Up Binary Log File Position Based Replication">Section 17.1.2, “Setting Up Binary Log File Position Based Replication”</a>).
          </p></li><li class="listitem"><p>
            Execute a few test queries on the master.
          </p></li><li class="listitem"><p>
            Check that the queries were replicated to the slave.
          </p></li><li class="listitem"><p>
            When replication is running correctly, issue
            <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.7 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> followed by
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> on the slave,
            then verify that no unwanted data from the test queries
            exists on the slave.
          </p></li><li class="listitem"><p>
            Issue <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> on the
            master to clean up the test queries.
</p></li></ol>
</div>
<p>
        After verifying the setup, resetting the master and slave and
        ensuring that no unwanted data or binary log files generated by
        testing remain on the master or slave, you can start the slave
        and begin replicating.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-sql-log-bin"></a>13.4.1.3 SET sql_log_bin Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091662380176"></a><pre data-lang="sql" class="programlisting">
SET sql_log_bin = {OFF|ON}
</pre><p>
        The <a class="link" href="replication.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a> variable
        controls whether logging to the binary log is enabled for the
        current session (assuming that the binary log itself is
        enabled). The default value is <code class="literal">ON</code>. To disable
        or enable binary logging for the current session, set the
        session <a class="link" href="replication.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a> variable to
        <code class="literal">OFF</code> or <code class="literal">ON</code>.
      </p><p>
        Set this variable to <code class="literal">OFF</code> for a session to
        temporarily disable binary logging while making changes to the
        master you do not want replicated to the slave.
      </p><p>
        Setting the session value of this system variable is a
        restricted operation. The session user must have privileges
        sufficient to set restricted session variables. See
        <a class="xref" href="server-administration.html#system-variable-privileges" title="5.1.9.1 System Variable Privileges">Section 5.1.9.1, “System Variable Privileges”</a>.
      </p><p>
        It is not possible to set the session value of
        <a class="link" href="replication.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a> within a
        transaction or subquery.
      </p><p>
        <span class="emphasis"><em>Setting this variable to <code class="literal">OFF</code>
        prevents GTIDs from being assigned to transactions in the binary
        log</em></span>. If you are using GTIDs for replication, this
        means that even when binary logging is later enabled again, the
        GTIDs written into the log from this point do not account for
        any transactions that occurred in the meantime, so in effect
        those transactions are lost.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="replication-slave-sql"></a>13.4.2 SQL Statements for Controlling Slave Servers</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#change-master-to">13.4.2.1 CHANGE MASTER TO Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#change-replication-filter">13.4.2.2 CHANGE REPLICATION FILTER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#master-pos-wait">13.4.2.3 MASTER_POS_WAIT() Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#reset-slave">13.4.2.4 RESET SLAVE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-global-sql-slave-skip-counter">13.4.2.5 SET GLOBAL sql_slave_skip_counter Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#start-slave">13.4.2.6 START SLAVE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#stop-slave">13.4.2.7 STOP SLAVE Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091662362352"></a><a class="indexterm" name="idm140091662360896"></a><a class="indexterm" name="idm140091662359408"></a><p>
      This section discusses statements for managing slave replication
      servers. <a class="xref" href="sql-syntax.html#replication-master-sql" title="13.4.1 SQL Statements for Controlling Master Servers">Section 13.4.1, “SQL Statements for Controlling Master Servers”</a>, discusses
      statements for managing master servers.
    </p><p>
      In addition to the statements described here,
      <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> and
      <a class="link" href="sql-syntax.html#show-relaylog-events" title="13.7.6.32 SHOW RELAYLOG EVENTS Syntax"><code class="literal">SHOW RELAYLOG EVENTS</code></a> are also used
      with replication slaves. For information about these statements,
      see <a class="xref" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax">Section 13.7.6.34, “SHOW SLAVE STATUS Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#show-relaylog-events" title="13.7.6.32 SHOW RELAYLOG EVENTS Syntax">Section 13.7.6.32, “SHOW RELAYLOG EVENTS Syntax”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="change-master-to"></a>13.4.2.1 CHANGE MASTER TO Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091662351136"></a><pre data-lang="sql" class="programlisting">
CHANGE MASTER TO <em class="replaceable"><code>option</code></em> [, <em class="replaceable"><code>option</code></em>] ... [ <em class="replaceable"><code>channel_option</code></em> ]

<em class="replaceable"><code>option</code></em>:
    MASTER_BIND = '<em class="replaceable"><code>interface_name</code></em>'
  | MASTER_HOST = '<em class="replaceable"><code>host_name</code></em>'
  | MASTER_USER = '<em class="replaceable"><code>user_name</code></em>'
  | MASTER_PASSWORD = '<em class="replaceable"><code>password</code></em>'
  | MASTER_PORT = <em class="replaceable"><code>port_num</code></em>
  | MASTER_CONNECT_RETRY = <em class="replaceable"><code>interval</code></em>
  | MASTER_RETRY_COUNT = <em class="replaceable"><code>count</code></em>
  | MASTER_DELAY = <em class="replaceable"><code>interval</code></em>
  | MASTER_HEARTBEAT_PERIOD = <em class="replaceable"><code>interval</code></em>
  | MASTER_LOG_FILE = '<em class="replaceable"><code>master_log_name</code></em>'
  | MASTER_LOG_POS = <em class="replaceable"><code>master_log_pos</code></em>
  | MASTER_AUTO_POSITION = {0|1}
  | RELAY_LOG_FILE = '<em class="replaceable"><code>relay_log_name</code></em>'
  | RELAY_LOG_POS = <em class="replaceable"><code>relay_log_pos</code></em>
  | MASTER_SSL = {0|1}
  | MASTER_SSL_CA = '<em class="replaceable"><code>ca_file_name</code></em>'
  | MASTER_SSL_CAPATH = '<em class="replaceable"><code>ca_directory_name</code></em>'
  | MASTER_SSL_CERT = '<em class="replaceable"><code>cert_file_name</code></em>'
  | MASTER_SSL_CRL = '<em class="replaceable"><code>crl_file_name</code></em>'
  | MASTER_SSL_CRLPATH = '<em class="replaceable"><code>crl_directory_name</code></em>'
  | MASTER_SSL_KEY = '<em class="replaceable"><code>key_file_name</code></em>'
  | MASTER_SSL_CIPHER = '<em class="replaceable"><code>cipher_list</code></em>'
  | MASTER_SSL_VERIFY_SERVER_CERT = {0|1}
  | MASTER_TLS_VERSION = '<em class="replaceable"><code>protocol_list</code></em>'
  | MASTER_PUBLIC_KEY_PATH = '<em class="replaceable"><code>key_file_name</code></em>'
  | GET_MASTER_PUBLIC_KEY = {0|1}
  | IGNORE_SERVER_IDS = (<em class="replaceable"><code>server_id_list</code></em>)

<em class="replaceable"><code>channel_option</code></em>:
    FOR CHANNEL <em class="replaceable"><code>channel</code></em>

<em class="replaceable"><code>server_id_list</code></em>:
    [<em class="replaceable"><code>server_id</code></em> [, <em class="replaceable"><code>server_id</code></em>] ... ]
</pre><p>
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> changes the
        parameters that the slave server uses for connecting to the
        master server, for reading the master binary log, and reading
        the slave relay log. It also updates the contents of the master
        info and relay log info repositories (see
        <a class="xref" href="replication.html#slave-logs" title="17.2.4 Replication Relay and Status Logs">Section 17.2.4, “Replication Relay and Status Logs”</a>). <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE
        MASTER TO</code></a> requires the
        <a class="link" href="security.html#priv_replication-slave-admin"><code class="literal">REPLICATION_SLAVE_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        You can issue <code class="literal">CHANGE MASTER TO</code> statements on
        a running slave without first stopping it, depending on the
        states of the slave SQL thread and slave I/O thread. The rules
        governing such use are provided later in this section.
      </p><p>
        When using a multithreaded slave (in other words
        <a class="link" href="replication.html#sysvar_slave_parallel_workers"><code class="literal">slave_parallel_workers</code></a> is
        greater than 0), stopping the slave can cause
        <span class="quote">“<span class="quote">gaps</span>”</span> in the sequence of transactions that have
        been executed from the relay log, regardless of whether the
        slave was stopped intentionally or otherwise. When such gaps
        exist, issuing <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
        fails. The solution in this situation is to issue
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE UNTIL
        SQL_AFTER_MTS_GAPS</code></a> which ensures that the gaps are
        closed.
      </p><p>
        The optional <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause enables you
        to name which replication channel the statement applies to.
        Providing a <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause applies the
        <code class="literal">CHANGE MASTER TO</code> statement to a specific
        replication channel, and is used to add a new channel or modify
        an existing channel. For example, to add a new channel called
        channel2:
      </p><pre data-lang="sql" class="programlisting">CHANGE MASTER TO MASTER_HOST=host1, MASTER_PORT=3002 FOR CHANNEL 'channel2'</pre><p>
        If no clause is named and no extra channels exist, the statement
        applies to the default channel.
      </p><p>
        When using multiple replication channels, if a <code class="literal">CHANGE
        MASTER TO</code> statement does not name a channel using a
        <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause, an error
        occurs. See <a class="xref" href="replication.html#replication-channels" title="17.2.3 Replication Channels">Section 17.2.3, “Replication Channels”</a> for more
        information.
      </p><p>
        Options not specified retain their value, except as indicated in
        the following discussion. Thus, in most cases, there is no need
        to specify options that do not change.
      </p><p>
        <code class="literal">MASTER_HOST</code>, <code class="literal">MASTER_USER</code>,
        <code class="literal">MASTER_PASSWORD</code>, and
        <code class="literal">MASTER_PORT</code> provide information to the slave
        about how to connect to its master:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">MASTER_HOST</code> and
            <code class="literal">MASTER_PORT</code> are the host name (or IP
            address) of the master host and its TCP/IP port.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Replication cannot use Unix socket files. You must be able
              to connect to the master MySQL server using TCP/IP.
</p>
</div>
<p>
            If you specify the <code class="literal">MASTER_HOST</code> or
            <code class="literal">MASTER_PORT</code> option, the slave assumes
            that the master server is different from before (even if the
            option value is the same as its current value.) In this
            case, the old values for the master binary log file name and
            position are considered no longer applicable, so if you do
            not specify <code class="literal">MASTER_LOG_FILE</code> and
            <code class="literal">MASTER_LOG_POS</code> in the statement,
            <code class="literal">MASTER_LOG_FILE=''</code> and
            <code class="literal">MASTER_LOG_POS=4</code> are silently appended to
            it.
          </p><p>
            Setting <code class="literal">MASTER_HOST=''</code> (that is, setting
            its value explicitly to an empty string) is
            <span class="emphasis"><em>not</em></span> the same as not setting
            <code class="literal">MASTER_HOST</code> at all. Trying to set
            <code class="literal">MASTER_HOST</code> to an empty string fails with
            an error.
          </p><p>
            Values used for <code class="literal">MASTER_HOST</code> and other
            <code class="literal">CHANGE MASTER TO</code> options are checked for
            linefeed (<code class="literal">\n</code> or <code class="literal">0x0A</code>)
            characters; the presence of such characters in these values
            causes the statement to fail with
            <a class="link" href="error-handling.html#error_er_master_info"><code class="literal">ER_MASTER_INFO</code></a>. (Bug
            #11758581, Bug #50801)
          </p></li><li class="listitem"><p>
            <code class="literal">MASTER_USER</code> and
            <code class="literal">MASTER_PASSWORD</code> are the user name and
            password of the account to use for connecting to the master.
          </p><p>
            <code class="literal">MASTER_USER</code> cannot be made empty; setting
            <code class="literal">MASTER_USER = ''</code> or leaving it unset when
            setting a value for <code class="literal">MASTER_PASSWORD</code>
            causes an error (Bug #13427949).
          </p><p>
            The password used for a MySQL Replication slave account in a
            <code class="literal">CHANGE MASTER TO</code> statement is limited to
            32 characters in length; trying to use a password of more
            than 32 characters causes <code class="literal">CHANGE MASTER
            TO</code> to fail.
          </p><p>
            The text of a running <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
            TO</code></a> statement, including values for
            <code class="literal">MASTER_USER</code> and
            <code class="literal">MASTER_PASSWORD</code>, can be seen in the
            output of a concurrent <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
            PROCESSLIST</code></a> statement. (The complete text of a
            <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statement is also
            visible to <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>.)
</p></li></ul>
</div>
<p>
        The <code class="literal">MASTER_SSL_<em class="replaceable"><code>xxx</code></em></code>
        options and the <code class="literal">MASTER_TLS_VERSION</code> option
        specify how the slave uses encryption and ciphers to secure the
        replication connection. These options can be changed even on
        slaves that are compiled without SSL support. They are saved to
        the master info repository, but are ignored if the slave does
        not have SSL support enabled. The
        <code class="literal">MASTER_SSL_<em class="replaceable"><code>xxx</code></em></code> and
        <code class="literal">MASTER_TLS_VERSION</code> options perform the same
        functions as the
        <code class="literal">--ssl-<em class="replaceable"><code>xxx</code></em></code> and
        <code class="literal">--tls-version</code> client options described in
        <a class="xref" href="security.html#encrypted-connection-options" title="6.3.2 Command Options for Encrypted Connections">Section 6.3.2, “Command Options for Encrypted Connections”</a>. The
        correspondence between the two sets of options, and the use of
        the <code class="literal">MASTER_SSL_<em class="replaceable"><code>xxx</code></em></code>
        and <code class="literal">MASTER_TLS_VERSION</code> options to set up a
        secure connection, is explained in
        <a class="xref" href="replication.html#replication-solutions-encrypted-connections" title="17.3.9 Setting Up Replication to Use Encrypted Connections">Section 17.3.9, “Setting Up Replication to Use Encrypted Connections”</a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          To connect to the replication master using a user account that
          authenticates with the
          <code class="literal">caching_sha2_password</code> plugin, you must
          either set up a secure connection as described in
          <a class="xref" href="replication.html#replication-solutions-encrypted-connections" title="17.3.9 Setting Up Replication to Use Encrypted Connections">Section 17.3.9, “Setting Up Replication to Use Encrypted Connections”</a>,
          or enable the unencrypted connection to support password
          exchange using an RSA key pair. The
          <code class="literal">caching_sha2_password</code> authentication plugin
          is the default for new users created from MySQL 8.0 (for
          details, see
          <a class="xref" href="security.html#caching-sha2-pluggable-authentication" title="6.4.1.3 Caching SHA-2 Pluggable Authentication">Section 6.4.1.3, “Caching SHA-2 Pluggable Authentication”</a>).
          If the user account that you create or use for replication (as
          specified by the <code class="literal">MASTER_USER</code> option) uses
          this authentication plugin, and you are not using a secure
          connection, you must enable RSA key pair-based password
          exchange for a successful connection.
</p>
</div>
<p>
        To enable RSA key pair-based password exchange, specify either
        the <code class="literal">MASTER_PUBLIC_KEY_PATH</code> or the
        <code class="literal">GET_MASTER_PUBLIC_KEY=1</code> option. Either of
        these options provides the RSA public key to the slave:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">MASTER_PUBLIC_KEY_PATH</code> indicates the path
            name to a file containing a slave-side copy of the public
            key required by the master for RSA key pair-based password
            exchange. The file must be in PEM format. This option
            applies to slaves that authenticate with the
            <code class="literal">sha256_password</code> or
            <code class="literal">caching_sha2_password</code> authentication
            plugin. (For <code class="literal">sha256_password</code>,
            <code class="literal">MASTER_PUBLIC_KEY_PATH</code> can be used only
            if MySQL was built using OpenSSL.)
          </p></li><li class="listitem"><p>
            <code class="literal">GET_MASTER_PUBLIC_KEY</code> indicates whether
            to request from the master the public key required for RSA
            key pair-based password exchange. This option applies to
            slaves that authenticate with the
            <code class="literal">caching_sha2_password</code> authentication
            plugin. For connections by accounts that authenticate using
            this plugin, the master does not send the public key unless
            requested, so it must be requested or specified in the
            client. If <code class="literal">MASTER_PUBLIC_KEY_PATH</code> is
            given and specifies a valid public key file, it takes
            precedence over <code class="literal">GET_MASTER_PUBLIC_KEY</code>.
</p></li></ul>
</div>
<p>
        The <code class="literal">MASTER_HEARTBEAT_PERIOD</code>,
        <code class="literal">MASTER_CONNECT_RETRY</code>, and
        <code class="literal">MASTER_RETRY_COUNT</code> options control how the
        slave recognizes that the connection to the master has been lost
        and makes attempts to reconnect.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The <a class="link" href="replication.html#sysvar_slave_net_timeout"><code class="literal">slave_net_timeout</code></a>
            system variable specifies the number of seconds that the
            slave waits for either more data or a heartbeat signal from
            the master, before the slave considers the connection
            broken, aborts the read, and tries to reconnect. The default
            value is 60 seconds (one minute).
          </p></li><li class="listitem"><p>
            The heartbeat interval, which stops the connection timeout
            occurring in the absence of data if the connection is still
            good, is controlled by the
            <code class="literal">MASTER_HEARTBEAT_PERIOD</code> option. A
            heartbeat signal is sent to the slave after that number of
            seconds, and the waiting period is reset whenever the
            master's binary log is updated with an event. Heartbeats are
            therefore sent by the master only if there are no unsent
            events in the binary log file for a period longer than this.
            The heartbeat interval <em class="replaceable"><code>interval</code></em>
            is a decimal value having the range 0 to 4294967 seconds and
            a resolution in milliseconds; the smallest nonzero value is
            0.001. Setting <em class="replaceable"><code>interval</code></em> to 0
            disables heartbeats altogether. The heartbeat interval
            defaults to half the value of the
            <a class="link" href="replication.html#sysvar_slave_net_timeout"><code class="literal">slave_net_timeout</code></a> system
            variable. It is recorded in the master info log and shown in
            the
            <a class="link" href="performance-schema.html#replication-connection-configuration-table" title="26.12.11.1 The replication_connection_configuration Table"><code class="literal">replication_connection_configuration</code></a>
            Performance Schema table. Issuing <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET
            SLAVE</code></a> resets the heartbeat interval to the default
            value.
          </p><p>
            Note that a change to the value or default setting of
            <a class="link" href="replication.html#sysvar_slave_net_timeout"><code class="literal">slave_net_timeout</code></a> does not
            automatically change the heartbeat interval, whether that
            has been set explicitly or is using a previously calculated
            default. A warning is issued if you set
            <code class="literal">@@GLOBAL.slave_net_timeout</code> to a value
            less than that of the current heartbeat interval. If
            <a class="link" href="replication.html#sysvar_slave_net_timeout"><code class="literal">slave_net_timeout</code></a> is
            changed, you must also issue <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE
            MASTER TO</code></a> to adjust the heartbeat interval to an
            appropriate value so that the heartbeat signal occurs before
            the connection timeout. If you do not do this, the heartbeat
            signal has no effect, and if no data is received from the
            master, the slave can make repeated reconnection attempts,
            creating zombie dump threads.
          </p></li><li class="listitem"><p>
            If the slave does need to reconnect, the first retry occurs
            immediately after the timeout.
            <code class="literal">MASTER_CONNECT_RETRY</code> specifies the
            interval between reconnection attempts, and
            <code class="literal">MASTER_RETRY_COUNT</code> limits the number of
            reconnection attempts. If both the default settings are
            used, the slave waits 60 seconds between reconnection
            attempts (<code class="literal">MASTER_CONNECT_RETRY=60</code>), and
            keeps attempting to reconnect at this rate for 60 days
            (<code class="literal">MASTER_RETRY_COUNT=86400</code>). These values
            are recorded in the master info log and shown in the
            <a class="link" href="performance-schema.html#replication-connection-configuration-table" title="26.12.11.1 The replication_connection_configuration Table"><code class="literal">replication_connection_configuration</code></a>
            Performance Schema table.
            <code class="literal">MASTER_RETRY_COUNT</code> supersedes the
            <a class="link" href="replication.html#option_mysqld_master-retry-count"><code class="option">--master-retry-count</code></a> server
            startup option.
</p></li></ul>
</div>
<p>
        <code class="literal">MASTER_DELAY</code> specifies how many seconds
        behind the master the slave must lag. An event received from the
        master is not executed until at least
        <em class="replaceable"><code>interval</code></em> seconds later than its
        execution on the master. The default is 0. An error occurs if
        <em class="replaceable"><code>interval</code></em> is not a nonnegative integer
        in the range from 0 to 2<sup>31</sup>−1.
        For more information, see <a class="xref" href="replication.html#replication-delayed" title="17.3.12 Delayed Replication">Section 17.3.12, “Delayed Replication”</a>.
      </p><p>
        A <code class="literal">CHANGE MASTER TO</code> statement employing the
        <code class="literal">MASTER_DELAY</code> option can be executed on a
        running slave when the slave SQL thread is stopped.
      </p><p>
        <code class="literal">MASTER_BIND</code> is for use on replication slaves
        having multiple network interfaces, and determines which of the
        slave's network interfaces is chosen for connecting to the
        master.
      </p><p>
        The address configured with this option, if any, can be seen in
        the <code class="literal">Master_Bind</code> column of the output from
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>. In the master
        info repository table
        <code class="literal">mysql.slave_master_info</code>, the value can be
        seen as the <code class="literal">Master_bind</code> column.
      </p><p>
        The ability to bind a replication slave to a specific network
        interface is also supported by NDB Cluster.
      </p><p>
        <code class="literal">MASTER_LOG_FILE</code> and
        <code class="literal">MASTER_LOG_POS</code> are the coordinates at which
        the slave I/O thread should begin reading from the master the
        next time the thread starts. <code class="literal">RELAY_LOG_FILE</code>
        and <code class="literal">RELAY_LOG_POS</code> are the coordinates at
        which the slave SQL thread should begin reading from the relay
        log the next time the thread starts. If you specify either of
        <code class="literal">MASTER_LOG_FILE</code> or
        <code class="literal">MASTER_LOG_POS</code>, you cannot specify
        <code class="literal">RELAY_LOG_FILE</code> or
        <code class="literal">RELAY_LOG_POS</code>. If you specify either of
        <code class="literal">MASTER_LOG_FILE</code> or
        <code class="literal">MASTER_LOG_POS</code>, you also cannot specify
        <code class="literal">MASTER_AUTO_POSITION = 1</code> (described later in
        this section). If neither of <code class="literal">MASTER_LOG_FILE</code>
        or <code class="literal">MASTER_LOG_POS</code> is specified, the slave
        uses the last coordinates of the <span class="emphasis"><em>slave SQL
        thread</em></span> before <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
        TO</code></a> was issued. This ensures that there is no
        discontinuity in replication, even if the slave SQL thread was
        late compared to the slave I/O thread, when you merely want to
        change, say, the password to use.
      </p><p>
        A <code class="literal">CHANGE MASTER TO</code> statement employing
        <code class="literal">RELAY_LOG_FILE</code>,
        <code class="literal">RELAY_LOG_POS</code>, or both options can be
        executed on a running slave when the slave SQL thread is
        stopped. Relay logs are preserved if at least one of the slave
        SQL thread and the slave I/O thread is running; if both threads
        are stopped, all relay log files are deleted unless at least one
        of <code class="literal">RELAY_LOG_FILE</code> or
        <code class="literal">RELAY_LOG_POS</code> is specified.
      </p><p>
        <code class="literal">RELAY_LOG_FILE</code> can use either an absolute or
        relative path, and uses the same base name as
        <code class="literal">MASTER_LOG_FILE</code>.
      </p><p>
        When <code class="literal">MASTER_AUTO_POSITION = 1</code> is used with
        <code class="literal">CHANGE MASTER TO</code>, the slave attempts to
        connect to the master using the GTID-based replication protocol.
        This option can be used with <code class="literal">CHANGE MASTER TO</code>
        only if both the slave SQL and slave I/O threads are stopped.
        Both the slave and the master must have GTIDs enabled
        (<a class="link" href="replication.html#sysvar_gtid_mode"><code class="literal">GTID_MODE=ON</code></a>,
        <code class="literal">ON_PERMISSIVE,</code> or
        <code class="literal">OFF_PERMISSIVE</code> on the slave, and
        <a class="link" href="replication.html#sysvar_gtid_mode"><code class="literal">GTID_MODE=ON</code></a> on the master).
        Auto-positioning is used for the connection, so the coordinates
        represented by <code class="literal">MASTER_LOG_FILE</code> and
        <code class="literal">MASTER_LOG_POS</code> are not used, and the use of
        either or both of these options together with
        <code class="literal">MASTER_AUTO_POSITION = 1</code> causes an error. If
        multi-source replication is enabled on the slave, you need to
        set the <code class="literal">MASTER_AUTO_POSITION = 1</code> option for
        each applicable replication channel.
      </p><p>
        With <code class="literal">MASTER_AUTO_POSITION = 1</code> set, in the
        initial connection handshake, the slave sends a GTID set
        containing the transactions that it has already received,
        committed, or both. The master responds by sending all
        transactions recorded in its binary log whose GTID is not
        included in the GTID set sent by the slave. This exchange
        ensures that the master only sends the transactions with a GTID
        that the slave has not already recorded or committed. If the
        slave receives transactions from more than one master, as in the
        case of a diamond topology, the auto-skip function ensures that
        the transactions are not applied twice. For details of how the
        GTID set sent by the slave is computed, see
        <a class="xref" href="replication.html#replication-gtids-auto-positioning" title="17.1.3.3 GTID Auto-Positioning">Section 17.1.3.3, “GTID Auto-Positioning”</a>.
      </p><p>
        If any of the transactions that should be sent by the master
        have been purged from the master's binary log, or added to the
        set of GTIDs in the <a class="link" href="replication.html#sysvar_gtid_purged"><code class="literal">gtid_purged</code></a>
        system variable by another method, the master sends the error
        <span class="errorname">ER_MASTER_HAS_PURGED_REQUIRED_GTIDS</span> to
        the slave, and replication does not start. The GTIDs of the
        missing purged transactions are identified and listed in the
        master's error log in the warning message
        <span class="errorname">ER_FOUND_MISSING_GTIDS</span>. Also, if during
        the exchange of transactions it is found that the slave has
        recorded or committed transactions with the master's UUID in the
        GTID, but the master itself has not committed them, the master
        sends the error
        <span class="errorname">ER_SLAVE_HAS_MORE_GTIDS_THAN_MASTER</span> to
        the slave and replication does not start. For information on how
        to handle these situations, see
        <a class="xref" href="replication.html#replication-gtids-auto-positioning" title="17.1.3.3 GTID Auto-Positioning">Section 17.1.3.3, “GTID Auto-Positioning”</a>.
      </p><p>
        You can see whether replication is running with auto-positioning
        enabled by checking the Performance Schema
        <a class="link" href="performance-schema.html#replication-connection-status-table" title="26.12.11.2 The replication_connection_status Table"><code class="literal">replication_connection_status</code></a> table
        or the output of <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE
        STATUS</code></a>. Disabling the
        <code class="literal">MASTER_AUTO_POSITION</code> option again makes the
        slave revert to file-based replication, in which case you must
        also specify one or both of the
        <code class="literal">MASTER_LOG_FILE</code> or
        <code class="literal">MASTER_LOG_POS</code> options.
      </p><p>
        <code class="literal">IGNORE_SERVER_IDS</code> takes a comma-separated
        list of 0 or more server IDs. Events originating from the
        corresponding servers are ignored, with the exception of log
        rotation and deletion events, which are still recorded in the
        relay log.
      </p><p>
        In circular replication, the originating server normally acts as
        the terminator of its own events, so that they are not applied
        more than once. Thus, this option is useful in circular
        replication when one of the servers in the circle is removed.
        Suppose that you have a circular replication setup with 4
        servers, having server IDs 1, 2, 3, and 4, and server 3 fails.
        When bridging the gap by starting replication from server 2 to
        server 4, you can include <code class="literal">IGNORE_SERVER_IDS =
        (3)</code> in the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
        TO</code></a> statement that you issue on server 4 to tell it to
        use server 2 as its master instead of server 3. Doing so causes
        it to ignore and not to propagate any statements that originated
        with the server that is no longer in use.
      </p><p>
        If <code class="literal">IGNORE_SERVER_IDS</code> contains the
        server's own ID and the server was started with the
        <a class="link" href="replication.html#option_mysqld_replicate-same-server-id"><code class="option">--replicate-same-server-id</code></a> option
        enabled, an error results.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          When global transaction identifiers (GTIDs) are used for
          replication, transactions that have already been applied are
          automatically ignored, so the
          <code class="literal">IGNORE_SERVER_IDS</code> function is not required
          and is deprecated. If
          <a class="link" href="replication.html#sysvar_gtid_mode"><code class="literal">gtid_mode=ON</code></a> is set for the
          server, a deprecation warning is issued if you include the
          <code class="literal">IGNORE_SERVER_IDS</code> option in a
          <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement.
</p>
</div>
<p>
        The master info repository and the output of
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> provide the
        list of servers that are currently ignored. For more
        information, see <a class="xref" href="replication.html#slave-logs-status" title="17.2.4.2 Slave Status Logs">Section 17.2.4.2, “Slave Status Logs”</a>, and
        <a class="xref" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax">Section 13.7.6.34, “SHOW SLAVE STATUS Syntax”</a>.
      </p><p>
        If a <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement
        is issued without any <code class="literal">IGNORE_SERVER_IDS</code>
        option, any existing list is preserved. To clear the list of
        ignored servers, it is necessary to use the option with an empty
        list:
      </p><pre data-lang="sql" class="programlisting">
CHANGE MASTER TO IGNORE_SERVER_IDS = ();
</pre><p>
        <code class="literal">RESET SLAVE ALL</code> clears
        <code class="literal">IGNORE_SERVER_IDS</code>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          A deprecation warning is issued if <code class="literal">SET
          GTID_MODE=ON</code> is issued when any channel has existing
          server IDs set with <code class="literal">IGNORE_SERVER_IDS</code>.
          Before starting GTID-based replication, check for and clear
          all ignored server ID lists on the servers involved. The
          <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW_SLAVE_STATUS</code></a> statement
          displays the list of ignored IDs, if there is one. If you do
          receive the deprecation warning, you can still clear a list
          after
          <a class="link" href="replication.html#sysvar_gtid_mode"><code class="literal">gtid_mode=ON</code></a> is
          set by issuing a <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
          TO</code></a> statement containing the
          <code class="literal">IGNORE_SERVER_IDS</code> option with an empty
          list.
</p>
</div>
<p>
        Invoking <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> causes
        the previous values for <code class="literal">MASTER_HOST</code>,
        <code class="literal">MASTER_PORT</code>,
        <code class="literal">MASTER_LOG_FILE</code>, and
        <code class="literal">MASTER_LOG_POS</code> to be written to the error
        log, along with other information about the slave's state
        prior to execution.
      </p><p>
        <code class="literal">CHANGE MASTER TO</code> causes an implicit commit of
        an ongoing transaction. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        From MySQL 5.7, the strict requirement to execute
        <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.7 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> prior to issuing any
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement (and
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> afterward) is
        removed. Instead of depending on whether the slave is stopped,
        the behavior of <code class="literal">CHANGE MASTER TO</code> depends on
        the states of the slave SQL thread and slave I/O threads; which
        of these threads is stopped or running now determines the
        options that can or cannot be used with a <code class="literal">CHANGE MASTER
        TO</code> statement at a given point in time. The rules for
        making this determination are listed here:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If the SQL thread is stopped, you can execute
            <code class="literal">CHANGE MASTER TO</code> using any combination
            that is otherwise allowed of
            <code class="literal">RELAY_LOG_FILE</code>,
            <code class="literal">RELAY_LOG_POS</code>, and
            <code class="literal">MASTER_DELAY</code> options, even if the slave
            I/O thread is running. No other options may be used with
            this statement when the I/O thread is running.
          </p></li><li class="listitem"><p>
            If the I/O thread is stopped, you can execute
            <code class="literal">CHANGE MASTER TO</code> using any of the options
            for this statement (in any allowed combination)
            <span class="emphasis"><em>except</em></span>
            <code class="literal">RELAY_LOG_FILE</code>,
            <code class="literal">RELAY_LOG_POS</code>,
            <code class="literal">MASTER_DELAY</code>, or
            <code class="literal">MASTER_AUTO_POSITION = 1</code> even when the
            SQL thread is running.
          </p></li><li class="listitem"><p>
            Both the SQL thread and the I/O thread must be stopped
            before issuing a <code class="literal">CHANGE MASTER TO</code>
            statement that employs <code class="literal">MASTER_AUTO_POSITION =
            1</code>.
</p></li></ul>
</div>
<p>
        You can check the current state of the slave SQL and I/O threads
        using <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>.
      </p><p>
        For more information, see
        <a class="xref" href="replication.html#replication-solutions-switch" title="17.3.8 Switching Masters During Failover">Section 17.3.8, “Switching Masters During Failover”</a>.
      </p><p>
        If you are using statement-based replication and temporary
        tables, it is possible for a <code class="literal">CHANGE MASTER TO</code>
        statement following a <code class="literal">STOP SLAVE</code> statement to
        leave behind temporary tables on the slave. A warning
        (<a class="link" href="error-handling.html#error_er_warn_open_temp_tables_must_be_zero"><code class="literal">ER_WARN_OPEN_TEMP_TABLES_MUST_BE_ZERO</code></a>)
        is now issued whenever this occurs. You can avoid this in such
        cases by making sure that the value of the
        <a class="link" href="server-administration.html#statvar_Slave_open_temp_tables"><code class="literal">Slave_open_temp_tables</code></a> system
        status variable is equal to 0 prior to executing such a
        <code class="literal">CHANGE MASTER TO</code> statement.
      </p><p>
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> is useful for
        setting up a slave when you have the snapshot of the master and
        have recorded the master binary log coordinates corresponding to
        the time of the snapshot. After loading the snapshot into the
        slave to synchronize it with the master, you can run
        <code class="literal">CHANGE MASTER TO
        MASTER_LOG_FILE='<em class="replaceable"><code>log_name</code></em>',
        MASTER_LOG_POS=<em class="replaceable"><code>log_pos</code></em></code> on
        the slave to specify the coordinates at which the slave should
        begin reading the master binary log.
      </p><p>
        The following example changes the master server the slave uses
        and establishes the master binary log coordinates from which the
        slave begins reading. This is used when you want to set up the
        slave to replicate the master:
      </p><pre data-lang="sql" class="programlisting">
CHANGE MASTER TO
  MASTER_HOST='master2.example.com',
  MASTER_USER='replication',
  MASTER_PASSWORD='<em class="replaceable"><code>password</code></em>',
  MASTER_PORT=3306,
  MASTER_LOG_FILE='master2-bin.001',
  MASTER_LOG_POS=4,
  MASTER_CONNECT_RETRY=10;
</pre><p>
        The next example shows an operation that is less frequently
        employed. It is used when the slave has relay log files that you
        want it to execute again for some reason. To do this, the master
        need not be reachable. You need only use
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> and start the
        SQL thread (<code class="literal">START SLAVE SQL_THREAD</code>):
      </p><pre data-lang="sql" class="programlisting">
CHANGE MASTER TO
  RELAY_LOG_FILE='slave-relay-bin.006',
  RELAY_LOG_POS=4025;
</pre><p>
        The following table shows the maximum permissible length for the
        string-valued options.
</p>
<div class="informaltable">
<table summary="The maximum permissible length for CHANGE MASTER TO string-valued options."><col width="50%"><col width="50%"><thead><tr>
            <th scope="col">Option</th>
            <th scope="col">Maximum Length</th>
          </tr></thead><tbody><tr>
            <td scope="row"><code class="literal">MASTER_HOST</code></td>
            <td>255 (60 prior to MySQL 8.0.17)</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_USER</code></td>
            <td>96</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_PASSWORD</code></td>
            <td>32</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_LOG_FILE</code></td>
            <td>511</td>
          </tr><tr>
            <td scope="row"><code class="literal">RELAY_LOG_FILE</code></td>
            <td>511</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_SSL_CA</code></td>
            <td>511</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_SSL_CAPATH</code></td>
            <td>511</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_SSL_CERT</code></td>
            <td>511</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_SSL_CRL</code></td>
            <td>511</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_SSL_CRLPATH</code></td>
            <td>511</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_SSL_KEY</code></td>
            <td>511</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_SSL_CIPHER</code></td>
            <td>511</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_TLS_VERSION</code></td>
            <td>511</td>
          </tr><tr>
            <td scope="row"><code class="literal">MASTER_PUBLIC_KEY_PATH</code></td>
            <td>511</td>
</tr></tbody></table>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="change-replication-filter"></a>13.4.2.2 CHANGE REPLICATION FILTER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091662055168"></a><pre data-lang="sql" class="programlisting">
CHANGE REPLICATION FILTER <em class="replaceable"><code>filter</code></em>[, <em class="replaceable"><code>filter</code></em>]
	[, ...] [FOR CHANNEL <em class="replaceable"><code>channel</code></em>]

<em class="replaceable"><code>filter</code></em>:
    REPLICATE_DO_DB = (<em class="replaceable"><code>db_list</code></em>)
  | REPLICATE_IGNORE_DB = (<em class="replaceable"><code>db_list</code></em>)
  | REPLICATE_DO_TABLE = (<em class="replaceable"><code>tbl_list</code></em>)
  | REPLICATE_IGNORE_TABLE = (<em class="replaceable"><code>tbl_list</code></em>)
  | REPLICATE_WILD_DO_TABLE = (<em class="replaceable"><code>wild_tbl_list</code></em>)
  | REPLICATE_WILD_IGNORE_TABLE = (<em class="replaceable"><code>wild_tbl_list</code></em>)
  | REPLICATE_REWRITE_DB = (<em class="replaceable"><code>db_pair_list</code></em>)

<em class="replaceable"><code>db_list</code></em>:
    <em class="replaceable"><code>db_name</code></em>[, <em class="replaceable"><code>db_name</code></em>][, ...]

<em class="replaceable"><code>tbl_list</code></em>:
    <em class="replaceable"><code>db_name.table_name</code></em>[, <em class="replaceable"><code>db_name.table_name</code></em>][, ...]
<em class="replaceable"><code>wild_tbl_list</code></em>:
    '<em class="replaceable"><code>db_pattern.table_pattern</code></em>'[, '<em class="replaceable"><code>db_pattern.table_pattern</code></em>'][, ...]

<em class="replaceable"><code>db_pair_list</code></em>:
    (<em class="replaceable"><code>db_pair</code></em>)[, (<em class="replaceable"><code>db_pair</code></em>)][, ...]

<em class="replaceable"><code>db_pair</code></em>:
    <em class="replaceable"><code>from_db</code></em>, <em class="replaceable"><code>to_db</code></em>
</pre><p>
        <code class="literal">CHANGE REPLICATION FILTER</code> sets one or more
        replication filtering rules on the slave in the same way as
        starting the slave <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> with replication
        filtering options such as
        <a class="link" href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> or
        <a class="link" href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table</code></a>.
        Unlike the case with the server options, this statement does not
        require restarting the server to take effect, only that the
        slave SQL thread be stopped using
        <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.7 STOP SLAVE Syntax"><code class="literal">STOP SLAVE
        SQL_THREAD</code></a> first (and restarted with
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE
        SQL_THREAD</code></a> afterwards). <a class="link" href="sql-syntax.html#change-replication-filter" title="13.4.2.2 CHANGE REPLICATION FILTER Syntax"><code class="literal">CHANGE
        REPLICATION FILTER</code></a> requires the
        <a class="link" href="security.html#priv_replication-slave-admin"><code class="literal">REPLICATION_SLAVE_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege. Use the
        <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause to make a
        replication filter specific to a replication channel, for
        example on a multi-source replication slave. Filters applied
        without a specific <code class="literal">FOR CHANNEL</code> clause are
        considered global filters, meaning that they are applied to all
        replication channels.
      </p><p>
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Global replication filters cannot be set on a MySQL server
            instance that is configured for Group Replication, because
            filtering transactions on some servers would make the group
            unable to reach agreement on a consistent state. Channel
            specific replication filters can be set on replication
            channels that are not directly involved with Group
            Replication, such as where a group member also acts as a
            replication slave to a master that is outside the group.
            They cannot be set on the
            <code class="literal">group_replication_applier</code> or
            <code class="literal">group_replication_recovery</code> channels.
</p>
</div>
<p>
      </p><p>
        The following list shows the <code class="literal">CHANGE REPLICATION
        FILTER</code> options and how they relate to
        <code class="option">--replicate-*</code> server options:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">REPLICATE_DO_DB</code>: Include updates based on
            database name. Equivalent to
            <a class="link" href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">REPLICATE_IGNORE_DB</code>: Exclude updates
            based on database name. Equivalent to
            <a class="link" href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">REPLICATE_DO_TABLE</code>: Include updates based
            on table name. Equivalent to
            <a class="link" href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">REPLICATE_IGNORE_TABLE</code>: Exclude updates
            based on table name. Equivalent to
            <a class="link" href="replication.html#option_mysqld_replicate-ignore-table"><code class="option">--replicate-ignore-table</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">REPLICATE_WILD_DO_TABLE</code>: Include updates
            based on wildcard pattern matching table name. Equivalent to
            <a class="link" href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">REPLICATE_WILD_IGNORE_TABLE</code>: Exclude
            updates based on wildcard pattern matching table name.
            Equivalent to
            <a class="link" href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">REPLICATE_REWRITE_DB</code>: Perform updates on
            slave after substituting new name on slave for specified
            database on master. Equivalent to
            <a class="link" href="replication.html#option_mysqld_replicate-rewrite-db"><code class="option">--replicate-rewrite-db</code></a>.
</p></li></ul>
</div>
<p>
        The precise effects of <code class="literal">REPLICATE_DO_DB</code> and
        <code class="literal">REPLICATE_IGNORE_DB</code> filters are dependent on
        whether statement-based or row-based replication is in effect.
        See <a class="xref" href="replication.html#replication-rules" title="17.2.5 How Servers Evaluate Replication Filtering Rules">Section 17.2.5, “How Servers Evaluate Replication Filtering Rules”</a>, for more information.
      </p><p>
        Multiple replication filtering rules can be created in a single
        <code class="literal">CHANGE REPLICATION FILTER</code> statement by
        separating the rules with commas, as shown here:
      </p><pre data-lang="sql" class="programlisting">
CHANGE REPLICATION FILTER
    REPLICATE_DO_DB = (d1), REPLICATE_IGNORE_DB = (d2);
</pre><p>
        Issuing the statement just shown is equivalent to starting the
        slave <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> with the options
        <a class="link" href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db=d1</code></a>
        <a class="link" href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db=d2</code></a>.
      </p><p>
        On a multi-source replication slave, which uses multiple
        replication channels to process transaction from different
        sources, use the <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause to set a
        replication filter on a replication channel:
      </p><pre data-lang="sql" class="programlisting">CHANGE REPLICATION FILTER REPLICATE_DO_DB = (d1) FOR CHANNEL channel_1;</pre><p>
        This enables you to create a channel specific replication filter
        to filter out selected data from a source. When a <code class="literal">FOR
        CHANNEL</code> clause is provided, the replication filter
        statement acts on that slave replication channel removing any
        existing replication filter which has the same filter type as
        the specified replication filters, and replacing them with the
        specified filter. Filter types not explicitly listed in the
        statement are not modified. If issued against a slave
        replication channel which is not configured, the statement fails
        with an <span class="errortext">ER_SLAVE_CONFIGURATION</span> error. If
        issued against Group Replication channels, the statement fails
        with an
        <span class="errortext">ER_SLAVE_CHANNEL_OPERATION_NOT_ALLOWED</span>
        error.
      </p><p>
        On a replication slave with multiple replication channels
        configured, issuing <a class="link" href="sql-syntax.html#change-replication-filter" title="13.4.2.2 CHANGE REPLICATION FILTER Syntax"><code class="literal">CHANGE REPLICATION
        FILTER</code></a> with no <code class="literal">FOR CHANNEL</code> clause
        configures the replication filter for every configured slave
        replication channel, and for the global replication filters. For
        every filter type, if the filter type is listed in the
        statement, then any existing filter rules of that type are
        replaced by the filter rules specified in the most recently
        issued statement, otherwise the old value of the filter type is
        retained. For more information see
        <a class="xref" href="replication.html#replication-rules-channel-based-filters" title="17.2.5.4 Replication Channel Based Filters">Section 17.2.5.4, “Replication Channel Based Filters”</a>.
      </p><p>
        If the same filtering rule is specified multiple times, only the
        <span class="emphasis"><em>last</em></span> such rule is actually used. For
        example, the two statements shown here have exactly the same
        effect, because the first <code class="literal">REPLICATE_DO_DB</code>
        rule in the first statement is ignored:
      </p><pre data-lang="sql" class="programlisting">
CHANGE REPLICATION FILTER
    REPLICATE_DO_DB = (db1, db2), REPLICATE_DO_DB = (db3, db4);

CHANGE REPLICATION FILTER
    REPLICATE_DO_DB = (db3, db4);
</pre>
<div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Caution
</div>
<p>
          This behavior differs from that of the
          <code class="option">--replicate-*</code> filter options where specifying
          the same option multiple times causes the creation of multiple
          filter rules.
</p>
</div>
<p>
        Names of tables and database not containing any special
        characters need not be quoted. Values used with
        <code class="literal">REPLICATION_WILD_TABLE</code> and
        <code class="literal">REPLICATION_WILD_IGNORE_TABLE</code> are string
        expressions, possibly containing (special) wildcard characters,
        and so must be quoted. This is shown in the following example
        statements:
      </p><pre data-lang="sql" class="programlisting">
CHANGE REPLICATION FILTER
    REPLICATE_WILD_DO_TABLE = ('db1.old%');

CHANGE REPLICATION FILTER
    REPLICATE_WILD_IGNORE_TABLE = ('db1.new%', 'db2.new%');
</pre><p>
        Values used with <code class="literal">REPLICATE_REWRITE_DB</code>
        represent <span class="emphasis"><em>pairs</em></span> of database names; each
        such value must be enclosed in parentheses. The following
        statement rewrites statements occurring on database
        <code class="literal">db1</code> on the master to database
        <code class="literal">db2</code> on the slave:
      </p><pre data-lang="sql" class="programlisting">
CHANGE REPLICATION FILTER REPLICATE_REWRITE_DB = ((db1, db2));
</pre><p>
        The statement just shown contains two sets of parentheses, one
        enclosing the pair of database names, and the other enclosing
        the entire list. This is perhaps more easily seen in the
        following example, which creates two
        <code class="literal">rewrite-db</code> rules, one rewriting database
        <code class="literal">dbA</code> to <code class="literal">dbB</code>, and one
        rewriting database <code class="literal">dbC</code> to
        <code class="literal">dbD</code>:
      </p><pre data-lang="sql" class="programlisting">
CHANGE REPLICATION FILTER
  REPLICATE_REWRITE_DB = ((dbA, dbB), (dbC, dbD));
</pre><p>
        The <a class="link" href="sql-syntax.html#change-replication-filter" title="13.4.2.2 CHANGE REPLICATION FILTER Syntax"><code class="literal">CHANGE REPLICATION FILTER</code></a>
        statement replaces replication filtering rules only for the
        filter types and replication channels affected by the statement,
        and leaves other rules and channels unchanged. If you want to
        unset all filters of a given type, set the filter's value
        to an explicitly empty list, as shown in this example, which
        removes all existing <code class="literal">REPLICATE_DO_DB</code> and
        <code class="literal">REPLICATE_IGNORE_DB</code> rules:
      </p><pre data-lang="sql" class="programlisting">
CHANGE REPLICATION FILTER
    REPLICATE_DO_DB = (), REPLICATE_IGNORE_DB = ();
</pre><p>
        Setting a filter to empty in this way removes all existing
        rules, does not create any new ones, and does not restore any
        rules set at mysqld startup using <code class="option">--replicate-*</code>
        options on the command line or in the configuration file.
      </p><p>
        The <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE
        ALL</code></a> statement removes channel specific replication
        filters that were set on channels deleted by the statement. When
        the deleted channel or channels are recreated, any global
        replication filters specified for the slave are copied to them,
        and no channel specific replication filters are applied.
      </p><p>
        For more information, see <a class="xref" href="replication.html#replication-rules" title="17.2.5 How Servers Evaluate Replication Filtering Rules">Section 17.2.5, “How Servers Evaluate Replication Filtering Rules”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="master-pos-wait"></a>13.4.2.3 MASTER_POS_WAIT() Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661955664"></a><pre data-lang="sql" class="programlisting">
SELECT MASTER_POS_WAIT('<em class="replaceable"><code>master_log_file</code></em>', <em class="replaceable"><code>master_log_pos</code></em> [, <em class="replaceable"><code>timeout</code></em>][, <em class="replaceable"><code>channel</code></em>])
</pre><p>
        This is actually a function, not a statement. It is used to
        ensure that the slave has read and executed events up to a given
        position in the master's binary log. See
        <a class="xref" href="functions.html#miscellaneous-functions" title="12.24 Miscellaneous Functions">Section 12.24, “Miscellaneous Functions”</a>, for a full
        description.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="reset-slave"></a>13.4.2.4 RESET SLAVE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661949440"></a><a class="indexterm" name="idm140091661948368"></a><pre data-lang="sql" class="programlisting">
RESET SLAVE [ALL] [<em class="replaceable"><code>channel_option</code></em>]

<em class="replaceable"><code>channel_option</code></em>:
    FOR CHANNEL <em class="replaceable"><code>channel</code></em>
</pre><p>
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> makes the slave
        forget its replication position in the master's binary log. This
        statement is meant to be used for a clean start: It clears the
        master info and relay log info repositories, deletes all the
        relay log files, and starts a new relay log file. It also resets
        to 0 the replication delay specified with the
        <code class="literal">MASTER_DELAY</code> option to <code class="literal">CHANGE MASTER
        TO</code>. <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> does
        not change the values of <code class="literal">gtid_executed</code> or
        <code class="literal">gtid_purged</code>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          All relay log files are deleted, even if they have not been
          completely executed by the slave SQL thread. (This is a
          condition likely to exist on a replication slave if you have
          issued a <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.7 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> statement
          or if the slave is highly loaded.)
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> requires the
        <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege.
      </p><p>
        To use <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a>, the slave
        replication threads must be stopped, so on a running slave use
        <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.7 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> before issuing
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a>. To use
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> on a Group
        Replication group member, the member status must be
        <code class="literal">OFFLINE</code>, meaning that the plugin is loaded
        but the member does not currently belong to any group. A group
        member can be taken offline by using a <a class="link" href="sql-syntax.html#stop-group-replication" title="13.4.3.2 STOP GROUP_REPLICATION Syntax"><code class="literal">STOP
        GROUP REPLICATION</code></a> statement.
      </p><p>
        The optional <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause enables you
        to name which replication channel the statement applies to.
        Providing a <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause applies the
        <code class="literal">RESET SLAVE</code> statement to a specific
        replication channel. Combining a <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause with the
        <code class="literal">ALL</code> option deletes the specified channel. If
        no channel is named and no extra channels exist, the statement
        applies to the default channel. Issuing a
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE
        ALL</code></a> statement without a <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause when
        multiple replication channels exist deletes
        <span class="emphasis"><em>all</em></span> replication channels and recreates only
        the default channel. See <a class="xref" href="replication.html#replication-channels" title="17.2.3 Replication Channels">Section 17.2.3, “Replication Channels”</a>
        for more information.
      </p><p>
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> does not change any
        replication connection parameters such as master host, master
        port, master user, or master password.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            From MySQL 8.0.13, when
            <a class="link" href="replication.html#sysvar_master_info_repository"><code class="literal">master_info_repository=TABLE</code></a>
            is set on the server (which is the default from MySQL 8.0),
            replication connection parameters are preserved in the
            crash-safe <code class="literal">InnoDB</code> table
            <code class="literal">mysql.slave_master_info</code> as part of the
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> operation. They
            are also retained in memory. In the event of a server crash
            or deliberate restart after issuing
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> but before
            issuing <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a>, the
            replication connection parameters are retrieved from the
            table and reused for the new connection.
          </p></li><li class="listitem"><p>
            When
            <a class="link" href="replication.html#sysvar_master_info_repository"><code class="literal">master_info_repository=FILE</code></a>
            is set on the server, replication connection parameters are
            only retained in memory. If the slave
            <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> is restarted immediately after
            issuing <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> due to a
            server crash or deliberate restart, the connection
            parameters are lost. In that case, you must issue a
            <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement
            after the server start to respecify the connection
            parameters before issuing <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START
            SLAVE</code></a>.
</p></li></ul>
</div>
<p>
        If you want to reset the connection parameters intentionally,
        you need to use
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE
        ALL</code></a>, which clears the connection parameters. In that
        case, you must issue a <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
        TO</code></a> statement after the server start to specify the new
        connection parameters.
      </p><p>
        <code class="literal">RESET SLAVE ALL</code> clears the
        <code class="literal">IGNORE_SERVER_IDS</code> list set by
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>.
      </p><p>
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> does not change any
        replication filter settings (such as
        <a class="link" href="replication.html#option_mysqld_replicate-ignore-table"><code class="option">--replicate-ignore-table</code></a>) for
        channels affected by the statement. However, <code class="literal">RESET
        SLAVE ALL</code>removes the replication filters that were set
        on the channels deleted by the statement. When the deleted
        channel or channels are recreated, any global replication
        filters specified for the slave are copied to them, and no
        channel specific replication filters are applied. For more
        information see
        <a class="xref" href="replication.html#replication-rules-channel-based-filters" title="17.2.5.4 Replication Channel Based Filters">Section 17.2.5.4, “Replication Channel Based Filters”</a>.
      </p><p>
        <code class="literal">RESET SLAVE</code> causes an implicit commit of an
        ongoing transaction. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        If the slave SQL thread was in the middle of replicating
        temporary tables when it was stopped, and
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> is issued, these
        replicated temporary tables are deleted on the slave.
      </p><p>
        <code class="literal">RESET SLAVE</code> does not reset the heartbeat
        period
        (<a class="link" href="server-administration.html#statvar_Slave_heartbeat_period"><code class="literal">Slave_heartbeat_period</code></a>) or
        <code class="literal">SSL_VERIFY_SERVER_CERT</code>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          When used on an NDB Cluster replication slave SQL node,
          <code class="literal">RESET SLAVE</code> clears the
          <code class="literal">mysql.ndb_apply_status</code> table. You should
          keep in mind when using this statement that
          <code class="literal">ndb_apply_status</code> uses the
          <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> storage engine and so is
          shared by all SQL nodes attached to the slave cluster.
        </p><p>
          You can override this behavior by issuing
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          <code class="literal">GLOBAL
          @@</code><a class="link" href="mysql-cluster.html#sysvar_ndb_clear_apply_status"><code class="literal">ndb_clear_apply_status=OFF</code></a>
          prior to executing <code class="literal">RESET SLAVE</code>, which keeps
          the slave from purging the <code class="literal">ndb_apply_status</code>
          table in such cases.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-global-sql-slave-skip-counter"></a>13.4.2.5 SET GLOBAL sql_slave_skip_counter Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661869104"></a><a class="indexterm" name="idm140091661868064"></a><a class="indexterm" name="idm140091661866992"></a><a class="indexterm" name="idm140091661865920"></a><pre data-lang="sql" class="programlisting">
SET GLOBAL sql_slave_skip_counter = <em class="replaceable"><code>N</code></em>
</pre><p>
        This statement skips the next <em class="replaceable"><code>N</code></em>
        events from the master. This is useful for recovering from
        replication stops caused by a statement.
      </p><p>
        This statement is valid only when the slave threads are not
        running. Otherwise, it produces an error.
      </p><p>
        When using this statement, it is important to understand that
        the binary log is actually organized as a sequence of groups
        known as <span class="firstterm">event groups</span>.
        Each event group consists of a sequence of events.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For transactional tables, an event group corresponds to a
            transaction.
          </p></li><li class="listitem"><p>
            For nontransactional tables, an event group corresponds to a
            single SQL statement.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          A single transaction can contain changes to both transactional
          and nontransactional tables.
</p>
</div>
<p>
        When you use <a class="link" href="sql-syntax.html#set-global-sql-slave-skip-counter" title="13.4.2.5 SET GLOBAL sql_slave_skip_counter Syntax"><code class="literal">SET GLOBAL
        sql_slave_skip_counter</code></a> to skip events and the result
        is in the middle of a group, the slave continues to skip events
        until it reaches the end of the group. Execution then starts
        with the next event group.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="start-slave"></a>13.4.2.6 START SLAVE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661850768"></a><pre data-lang="sql" class="programlisting">
START SLAVE [<em class="replaceable"><code>thread_types</code></em>] [<em class="replaceable"><code>until_option</code></em>] [<em class="replaceable"><code>connection_options</code></em>] [<em class="replaceable"><code>channel_option</code></em>]

<em class="replaceable"><code>thread_types</code></em>:
    [<em class="replaceable"><code>thread_type</code></em> [, <em class="replaceable"><code>thread_type</code></em>] ... ]

<em class="replaceable"><code>thread_type</code></em>:
    IO_THREAD | SQL_THREAD

<em class="replaceable"><code>until_option</code></em>:
    UNTIL {   {SQL_BEFORE_GTIDS | SQL_AFTER_GTIDS} = <em class="replaceable"><code>gtid_set</code></em>
          |   MASTER_LOG_FILE = '<em class="replaceable"><code>log_name</code></em>', MASTER_LOG_POS = <em class="replaceable"><code>log_pos</code></em>
          |   RELAY_LOG_FILE = '<em class="replaceable"><code>log_name</code></em>', RELAY_LOG_POS = <em class="replaceable"><code>log_pos</code></em>
          |   SQL_AFTER_MTS_GAPS  }

<em class="replaceable"><code>connection_options</code></em>:
    [USER='<em class="replaceable"><code>user_name</code></em>'] [PASSWORD='<em class="replaceable"><code>user_pass</code></em>'] [DEFAULT_AUTH='<em class="replaceable"><code>plugin_name</code></em>'] [PLUGIN_DIR='<em class="replaceable"><code>plugin_dir</code></em>']


<em class="replaceable"><code>channel_option</code></em>:
    FOR CHANNEL <em class="replaceable"><code>channel</code></em>

<em class="replaceable"><code>gtid_set</code></em>:
    <em class="replaceable"><code>uuid_set</code></em> [, <em class="replaceable"><code>uuid_set</code></em>] ...
    | ''

<em class="replaceable"><code>uuid_set</code></em>:
    <em class="replaceable"><code>uuid</code></em>:<em class="replaceable"><code>interval</code></em>[:<em class="replaceable"><code>interval</code></em>]...

<em class="replaceable"><code>uuid</code></em>:
    <em class="replaceable"><code>hhhhhhhh</code></em>-<em class="replaceable"><code>hhhh</code></em>-<em class="replaceable"><code>hhhh</code></em>-<em class="replaceable"><code>hhhh</code></em>-<em class="replaceable"><code>hhhhhhhhhhhh</code></em>

<em class="replaceable"><code>h</code></em>:
    [0-9,A-F]

<em class="replaceable"><code>interval</code></em>:
    <em class="replaceable"><code>n</code></em>[-<em class="replaceable"><code>n</code></em>]

    (<em class="replaceable"><code>n</code></em> &gt;= 1)
</pre><p>
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> with no
        <em class="replaceable"><code>thread_type</code></em> options starts both of
        the slave threads. The I/O thread reads events from the master
        server and stores them in the relay log. The SQL thread reads
        events from the relay log and executes them.
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> requires the
        <a class="link" href="security.html#priv_replication-slave-admin"><code class="literal">REPLICATION_SLAVE_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        If <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> succeeds in
        starting the slave threads, it returns without any error.
        However, even in that case, it might be that the slave threads
        start and then later stop (for example, because they do not
        manage to connect to the master or read its binary log, or some
        other problem). <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> does
        not warn you about this. You must check the slave's error log
        for error messages generated by the slave threads, or check that
        they are running satisfactorily with <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW
        SLAVE STATUS</code></a>.
      </p><p>
        <code class="literal">START SLAVE</code> causes an implicit commit of an
        ongoing transaction. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a> must be set to
        <code class="literal">AUTOMATIC</code> before issuing this statement.
      </p><p>
        The optional <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause enables you
        to name which replication channel the statement applies to.
        Providing a <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause applies the
        <code class="literal">START SLAVE</code> statement to a specific
        replication channel. If no clause is named and no extra channels
        exist, the statement applies to the default channel. If a
        <code class="literal">START SLAVE</code> statement does not have a channel
        defined when using multiple channels, this statement starts the
        specified threads for all channels. This statement is disallowed
        for the <code class="literal">group_replication_recovery</code> channel.
        See <a class="xref" href="replication.html#replication-channels" title="17.2.3 Replication Channels">Section 17.2.3, “Replication Channels”</a> for more information.
      </p><p>
        MySQL supports pluggable user-password authentication with
        <code class="literal">START SLAVE</code> with the <code class="literal">USER</code>,
        <code class="literal">PASSWORD</code>, <code class="literal">DEFAULT_AUTH</code> and
        <code class="literal">PLUGIN_DIR</code> options, as described in the
        following list:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">USER</code>: User name. Cannot be set to an
            empty or null string, or left unset if
            <code class="literal">PASSWORD</code> is used.
          </p></li><li class="listitem"><p>
            <code class="literal">PASSWORD</code>: Password.
          </p></li><li class="listitem"><p>
            <code class="literal">DEFAULT_AUTH</code>: Name of plugin; default is
            MySQL native authentication.
          </p></li><li class="listitem"><p>
            <code class="literal">PLUGIN_DIR</code>: Location of plugin.
</p></li></ul>
</div>
<p>
        You cannot use the <code class="literal">SQL_THREAD</code> option when
        specifying any of <code class="literal">USER</code>,
        <code class="literal">PASSWORD</code>, <code class="literal">DEFAULT_AUTH</code>, or
        <code class="literal">PLUGIN_DIR</code>, unless the
        <code class="literal">IO_THREAD</code> option is also provided.
      </p><p>
        See <a class="xref" href="security.html#pluggable-authentication" title="6.2.17 Pluggable Authentication">Section 6.2.17, “Pluggable Authentication”</a>, for more
        information.
      </p><p>
        If an insecure connection is used with any these options, the
        server issues the warning <span class="errortext">Sending passwords in plain
        text without SSL/TLS is extremely insecure</span>.
      </p><p>
        <code class="literal">START SLAVE ... UNTIL</code> supports two additional
        options for use with global transaction identifiers (GTIDs) (see
        <a class="xref" href="replication.html#replication-gtids" title="17.1.3 Replication with Global Transaction Identifiers">Section 17.1.3, “Replication with Global Transaction Identifiers”</a>). Each of these takes a set
        of one or more global transaction identifiers
        <em class="replaceable"><code>gtid_set</code></em> as an argument (see
        <a class="xref" href="replication.html#replication-gtids-concepts-gtid-sets" title="GTID Sets">GTID Sets</a>, for more
        information).
      </p><p>
        When no <em class="replaceable"><code>thread_type</code></em> is specified,
        <code class="literal">START SLAVE UNTIL SQL_BEFORE_GTIDS</code> causes the
        slave SQL thread to process transactions until it has reached
        the <span class="emphasis"><em>first</em></span> transaction whose GTID is listed
        in the <em class="replaceable"><code>gtid_set</code></em>. <code class="literal">START SLAVE
        UNTIL SQL_AFTER_GTIDS</code> causes the slave threads to
        process all transactions until the
        <em class="replaceable"><code>last</code></em> transaction in the
        <em class="replaceable"><code>gtid_set</code></em> has been processed by both
        threads. In other words, <code class="literal">START SLAVE UNTIL
        SQL_BEFORE_GTIDS</code> causes the slave SQL thread to
        process all transactions occurring before the first GTID in the
        <em class="replaceable"><code>gtid_set</code></em> is reached, and
        <code class="literal">START SLAVE UNTIL SQL_AFTER_GTIDS</code> causes the
        slave threads to handle all transactions, including those whose
        GTIDs are found in <em class="replaceable"><code>gtid_set</code></em>, until
        each has encountered a transaction whose GTID is not part of the
        set. <code class="literal">SQL_BEFORE_GTIDS</code> and
        <code class="literal">SQL_AFTER_GTIDS</code> each support the
        <code class="literal">SQL_THREAD</code> and <code class="literal">IO_THREAD</code>
        options, although using <code class="literal">IO_THREAD</code> with them
        currently has no effect.
      </p><p>
        For example, <code class="literal">START SLAVE SQL_THREAD UNTIL
        SQL_BEFORE_GTIDS =
        3E11FA47-71CA-11E1-9E33-C80AA9429562:11-56</code> causes the
        slave SQL thread to process all transactions originating from
        the master whose <a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a> is
        <code class="literal">3E11FA47-71CA-11E1-9E33-C80AA9429562</code> until it
        encounters the transaction having sequence number 11; it then
        stops without processing this transaction. In other words, all
        transactions up to and including the transaction with sequence
        number 10 are processed. Executing <code class="literal">START SLAVE
        SQL_THREAD UNTIL SQL_AFTER_GTIDS =
        3E11FA47-71CA-11E1-9E33-C80AA9429562:11-56</code>, on the
        other hand, would cause the slave SQL thread to obtain all
        transactions just mentioned from the master, including all of
        the transactions having the sequence numbers 11 through 56, and
        then to stop without processing any additional transactions;
        that is, the transaction having sequence number 56 would be the
        last transaction fetched by the slave SQL thread.
      </p><p>
        When using a multithreaded slave


        with <code class="literal">slave_preserve_commit_order=0</code> set, there
        is a chance of gaps in the sequence of transactions that have
        been executed from the relay log in the following cases:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            killing the coordinator thread
          </p></li><li class="listitem"><p>
            after an error occurs in the applier threads
          </p></li><li class="listitem"><p>
            <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> shuts down unexpectedly
</p></li></ul>
</div>
<p>
        Use the <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE
        UNTIL SQL_AFTER_MTS_GAPS</code></a> statement to cause a
        multithreaded slave's worker threads to only run until no
        more gaps are found in the relay log, and then to stop. This
        statement can take an <code class="literal">SQL_THREAD</code> option, but
        the effects of the statement remain unchanged. It has no effect
        on the slave I/O thread (and cannot be used with the
        <code class="literal">IO_THREAD</code> option).
      </p><p>
        Issuing <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> on a
        multithreaded slave with gaps in the sequence of transactions
        executed from the relay log generates a warning. In such a
        situation, the solution is to use
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE UNTIL
        SQL_AFTER_MTS_GAPS</code></a>, then issue
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> to remove any
        remaining relay logs. See
        <a class="xref" href="replication.html#replication-features-transaction-inconsistencies" title="17.4.1.33 Replication and Transaction Inconsistencies">Section 17.4.1.33, “Replication and Transaction Inconsistencies”</a>
        for more information.
      </p><p>
        To change a failed multithreaded slave to single-threaded mode,
        you can issue the following series of statements, in the order
        shown:
      </p><pre data-lang="sql" class="programlisting">
START SLAVE UNTIL SQL_AFTER_MTS_GAPS;

SET @@GLOBAL.slave_parallel_workers = 0;

START SLAVE SQL_THREAD;
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          It is possible to view the entire text of a running
          <code class="literal">START SLAVE ...</code> statement, including any
          <code class="literal">USER</code> or <code class="literal">PASSWORD</code> values
          used, in the output of <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
          PROCESSLIST</code></a>. This is also true for the text of a
          running <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
          statement, including any values it employs for
          <code class="literal">MASTER_USER</code> or
          <code class="literal">MASTER_PASSWORD</code>.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> sends an
        acknowledgment to the user after both the I/O thread and the SQL
        thread have started. However, the I/O thread may not yet have
        connected. For this reason, a successful
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> causes
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> to show
        <code class="literal">Slave_SQL_Running=Yes</code>, but this does not
        guarantee that <code class="literal">Slave_IO_Running=Yes</code> (because
        <code class="literal">Slave_IO_Running=Yes</code> only if the I/O thread
        is running <span class="emphasis"><em>and connected</em></span>). For more
        information, see <a class="xref" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax">Section 13.7.6.34, “SHOW SLAVE STATUS Syntax”</a>, and
        <a class="xref" href="replication.html#replication-administration-status" title="17.1.7.1 Checking Replication Status">Section 17.1.7.1, “Checking Replication Status”</a>.
      </p><p>
        You can add <code class="literal">IO_THREAD</code> and
        <code class="literal">SQL_THREAD</code> options to the statement to name
        which of the threads to start. The <code class="literal">SQL_THREAD</code>
        option is disallowed when specifying any of
        <code class="literal">USER</code>, <code class="literal">PASSWORD</code>,
        <code class="literal">DEFAULT_AUTH</code>, or
        <code class="literal">PLUGIN_DIR</code>, unless the
        <code class="literal">IO_THREAD</code> option is also provided.
      </p><p>
        An <code class="literal">UNTIL</code> clause
        (<em class="replaceable"><code>until_option</code></em>, in the preceding
        grammar) may be added to specify that the slave should start and
        run until the SQL thread reaches a given point in the master
        binary log, specified by the <code class="literal">MASTER_LOG_POS</code>
        and MASTER_LOG_FILE options, or a given point in the slave relay
        log, indicated with the <code class="literal">RELAY_LOG_POS</code> and
        <code class="literal">RELAY_LOG_FILE</code> options. When the SQL thread
        reaches the point specified, it stops. If the
        <code class="literal">SQL_THREAD</code> option is specified in the
        statement, it starts only the SQL thread. Otherwise, it starts
        both slave threads. If the SQL thread is running, the
        <code class="literal">UNTIL</code> clause is ignored and a warning is
        issued. You cannot use an <code class="literal">UNTIL</code> clause with
        the <code class="literal">IO_THREAD</code> option.
      </p><p>
        It is also possible with <code class="literal">START SLAVE UNTIL</code> to
        specify a stop point relative to a given GTID or set of GTIDs
        using one of the options <code class="literal">SQL_BEFORE_GTIDS</code> or
        <code class="literal">SQL_AFTER_GTIDS</code>, as explained previously in
        this section. When using one of these options, you can specify
        <code class="literal">SQL_THREAD</code>, <code class="literal">IO_THREAD</code>,
        both of these, or neither of them. If you specify only
        <code class="literal">SQL_THREAD</code>, then only the slave SQL thread is
        affected by the statement; if only <code class="literal">IO_THREAD</code>
        is used, then only the slave I/O is affected. If both
        <code class="literal">SQL_THREAD</code> and <code class="literal">IO_THREAD</code>
        are used, or if neither of them is used, then both the SQL and
        I/O threads are affected by the statement.
      </p><p>
        For an <code class="literal">UNTIL</code> clause, you must specify any one
        of the following:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="emphasis"><em>Both</em></span> a log file name and a position in
            that file
          </p></li><li class="listitem"><p>
            <span class="emphasis"><em>Either</em></span> of
            <code class="literal">SQL_BEFORE_GTIDS</code> or
            <code class="literal">SQL_AFTER_GTIDS</code>
          </p></li><li class="listitem"><p>
            <code class="literal">SQL_AFTER_MTS_GAPS</code>
</p></li></ul>
</div>
<p>
        Do not mix master and relay log options. Do not mix log file
        options with GTID options.
      </p><p>
        The <code class="literal">UNTIL</code> clause is not supported for
        multithreaded slaves except when also using
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">SQL_AFTER_MTS_GAPS</code></a>.
        If <code class="literal">UNTIL</code> is used on a multithreaded slave
        without
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">SQL_AFTER_MTS_GAPS</code></a>,
        the slave operates in single-threaded (sequential) mode for
        replication until the point specified by the
        <code class="literal">UNTIL</code> clause is reached.
      </p><p>
        Any <code class="literal">UNTIL</code> condition is reset by a subsequent
        <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.7 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> statement, a
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statement that
        includes no <code class="literal">UNTIL</code> clause, or a server
        restart.
      </p><p>
        When specifying a log file and position, you can use the
        <code class="literal">IO_THREAD</code> option with <code class="literal">START SLAVE
        ... UNTIL</code> even though only the SQL thread is affected
        by this statement. The <code class="literal">IO_THREAD</code> option is
        ignored in such cases. The preceding restriction does not apply
        when using one of the GTID options
        (<code class="literal">SQL_BEFORE_GTIDS</code> and
        <code class="literal">SQL_AFTER_GTIDS</code>); the GTID options support
        both <code class="literal">SQL_THREAD</code> and
        <code class="literal">IO_THREAD</code>, as explained previously in this
        section.
      </p><p>
        The <code class="literal">UNTIL</code> clause can be useful for debugging
        replication, or to cause replication to proceed until just
        before the point where you want to avoid having the slave
        replicate an event. For example, if an unwise
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement was executed
        on the master, you can use <code class="literal">UNTIL</code> to tell the
        slave to execute up to that point but no farther. To find what
        the event is, use <a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files"><span class="command"><strong>mysqlbinlog</strong></span></a> with the master
        binary log or slave relay log, or by using a
        <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.6.2 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a> statement.
      </p><p>
        If you are using <code class="literal">UNTIL</code> to have the slave
        process replicated queries in sections, it is recommended that
        you start the slave with the
        <a class="link" href="replication.html#option_mysqld_skip-slave-start"><code class="option">--skip-slave-start</code></a> option to
        prevent the SQL thread from running when the slave server
        starts. It is probably best to use this option in an option file
        rather than on the command line, so that an unexpected server
        restart does not cause it to be forgotten.
      </p><p>
        The <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> statement
        includes output fields that display the current values of the
        <code class="literal">UNTIL</code> condition.
      </p><p>
        In very old versions of MySQL (before 4.0.5), this statement was
        called <code class="literal">SLAVE START</code>. That syntax now produces
        an error.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="stop-slave"></a>13.4.2.7 STOP SLAVE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661682848"></a><pre data-lang="sql" class="programlisting">
STOP SLAVE [<em class="replaceable"><code>thread_types</code></em>] [<em class="replaceable"><code>channel_option</code></em>]

<em class="replaceable"><code>thread_types</code></em>:
    [<em class="replaceable"><code>thread_type</code></em> [, <em class="replaceable"><code>thread_type</code></em>] ... ]

<em class="replaceable"><code>thread_type</code></em>: IO_THREAD | SQL_THREAD

<em class="replaceable"><code>channel_option</code></em>:
    FOR CHANNEL <em class="replaceable"><code>channel</code></em>

</pre><p>
        Stops the slave threads. <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.7 STOP SLAVE Syntax"><code class="literal">STOP
        SLAVE</code></a> requires the
        <a class="link" href="security.html#priv_replication-slave-admin"><code class="literal">REPLICATION_SLAVE_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege. Recommended best
        practice is to execute <code class="literal">STOP SLAVE</code> on the
        slave before stopping the slave server (see
        <a class="xref" href="server-administration.html#server-shutdown" title="5.1.17 The Server Shutdown Process">Section 5.1.17, “The Server Shutdown Process”</a>, for more information).
      </p><p>
        <span class="emphasis"><em>When using the row-based logging format</em></span>:
        You should execute <code class="literal">STOP SLAVE</code> or
        <code class="literal">STOP SLAVE SQL_THREAD</code> on the slave prior to
        shutting down the slave server if you are replicating any tables
        that use a nontransactional storage engine (see the
        <em class="citetitle">Note</em> later in this section).
      </p><p>
        Like <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a>, this statement
        may be used with the <code class="literal">IO_THREAD</code> and
        <code class="literal">SQL_THREAD</code> options to name the thread or
        threads to be stopped.
      </p><p>
        <code class="literal">STOP SLAVE</code> causes an implicit commit of an
        ongoing transaction. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a> must be set to
        <code class="literal">AUTOMATIC</code> before issuing this statement.
      </p><p>
        You can control how long <code class="literal">STOP SLAVE</code> waits
        before timing out by setting the
        <a class="link" href="replication.html#sysvar_rpl_stop_slave_timeout"><code class="literal">rpl_stop_slave_timeout</code></a> system
        variable. This can be used to avoid deadlocks between
        <code class="literal">STOP SLAVE</code> and other slave SQL statements
        using different client connections to the slave. When the
        timeout value is reached, the issuing client returns an error
        message and stops waiting, but the <code class="literal">STOP SLAVE</code>
        instruction remains in effect. Once the slave threads are no
        longer busy, the <code class="literal">STOP SLAVE</code> statement is
        executed and the slave stops.
      </p><p>
        Some <code class="literal">CHANGE MASTER TO</code> statements are allowed
        while the slave is running, depending on the states of the slave
        SQL and I/O threads. However, using <code class="literal">STOP
        SLAVE</code> prior to executing <code class="literal">CHANGE MASTER
        TO</code> in such cases is still supported. See
        <a class="xref" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax">Section 13.4.2.1, “CHANGE MASTER TO Syntax”</a>, and
        <a class="xref" href="replication.html#replication-solutions-switch" title="17.3.8 Switching Masters During Failover">Section 17.3.8, “Switching Masters During Failover”</a>, for more
        information.
      </p><p>
        The optional <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause enables you
        to name which replication channel the statement applies to.
        Providing a <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause applies the
        <code class="literal">STOP SLAVE</code> statement to a specific
        replication channel. If no channel is named and no extra
        channels exist, the statement applies to the default channel. If
        a <code class="literal">STOP SLAVE</code> statement does not name a
        channel when using multiple channels, this statement stops the
        specified threads for all channels. This statement cannot be
        used with the <code class="literal">group_replication_recovery</code>
        channel. See <a class="xref" href="replication.html#replication-channels" title="17.2.3 Replication Channels">Section 17.2.3, “Replication Channels”</a> for more
        information.
      </p><p>
        <span class="emphasis"><em>When using statement-based replication</em></span>:
        changing the master while it has open temporary tables is
        potentially unsafe. This is one of the reasons why
        statement-based replication of temporary tables is not
        recommended. You can find out whether there are any temporary
        tables on the slave by checking the value of
        <a class="link" href="server-administration.html#statvar_Slave_open_temp_tables"><code class="literal">Slave_open_temp_tables</code></a>; when
        using statement-based replication, this value should be 0 before
        executing <code class="literal">CHANGE MASTER TO</code>. If there are any
        temporary tables open on the slave, issuing a <code class="literal">CHANGE
        MASTER TO</code> statement after issuing a <code class="literal">STOP
        SLAVE</code> causes an
        <a class="link" href="error-handling.html#error_er_warn_open_temp_tables_must_be_zero"><code class="literal">ER_WARN_OPEN_TEMP_TABLES_MUST_BE_ZERO</code></a>
        warning.
      </p><p>
        When using a multithreaded slave
        (<a class="link" href="replication.html#sysvar_slave_parallel_workers"><code class="literal">slave_parallel_workers</code></a> is a
        nonzero value), any gaps in the sequence of transactions
        executed from the relay log are closed as part of stopping the
        worker threads. If the slave is stopped unexpectedly (for
        example due to an error in a worker thread, or another thread
        issuing <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL</code></a>) while a
        <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.7 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> statement is
        executing, the sequence of executed transactions from the relay
        log may become inconsistent. See
        <a class="xref" href="replication.html#replication-features-transaction-inconsistencies" title="17.4.1.33 Replication and Transaction Inconsistencies">Section 17.4.1.33, “Replication and Transaction Inconsistencies”</a>
        for more information.
      </p><p>
        If the current replication event group has modified one or more
        nontransactional tables, STOP SLAVE waits for up to 60 seconds
        for the event group to complete, unless you issue a
        <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL QUERY</code></a> or
        <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL CONNECTION</code></a>
        statement for the slave SQL thread. If the event group remains
        incomplete after the timeout, an error message is logged.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="replication-group-sql"></a>13.4.3 SQL Statements for Controlling Group Replication</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#start-group-replication">13.4.3.1 START GROUP_REPLICATION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#stop-group-replication">13.4.3.2 STOP GROUP_REPLICATION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#group-replication-functions-for-new-primary">13.4.3.3 Function which Configures Group Replication Primary</a></span></dt><dt><span class="section"><a href="sql-syntax.html#group-replication-functions-for-mode">13.4.3.4 Functions which Configure the Group Replication Mode</a></span></dt><dt><span class="section"><a href="sql-syntax.html#group-replication-functions-for-maximum-consensus">13.4.3.5 Functions to Inspect and Configure the Maximum Consensus Instances of a
        Group</a></span></dt><dt><span class="section"><a href="sql-syntax.html#group-replication-functions-for-communication-protocol">13.4.3.6 Functions to Inspect and Set the Group Replication Communication
Protocol Version</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091661627200"></a><a class="indexterm" name="idm140091661625744"></a><a class="indexterm" name="idm140091661624256"></a><p>
      This section provides information about the statements used for
      controlling group replication.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="start-group-replication"></a>13.4.3.1 START GROUP_REPLICATION Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091661621104"></a><pre data-lang="sql" class="programlisting">START GROUP_REPLICATION</pre><p>
        Starts group replication. This statement requires the
        <a class="link" href="security.html#priv_group-replication-admin"><code class="literal">GROUP_REPLICATION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege. If
        <a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a> and the
        member should join as a primary,
        <a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only</code></a> is set to
        <code class="literal">OFF</code> once Group Replication successfully
        starts.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="stop-group-replication"></a>13.4.3.2 STOP GROUP_REPLICATION Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661611648"></a><pre data-lang="sql" class="programlisting">STOP GROUP_REPLICATION</pre><p>
        Stops Group Replication. This statement requires the
        <a class="link" href="security.html#priv_group-replication-admin"><code class="literal">GROUP_REPLICATION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege. As soon as you
        issue <a class="link" href="sql-syntax.html#stop-group-replication" title="13.4.3.2 STOP GROUP_REPLICATION Syntax"><code class="literal">STOP GROUP_REPLICATION</code></a> the
        member is set to
        <a class="link" href="server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a>, which
        ensures that no writes can be made to the member while Group
        Replication stops. Any other replication channels running on the
        member are also stopped.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
          Use this statement with extreme caution because it removes the
          server instance from the group, meaning it is no longer
          protected by Group Replication's consistency guarantee
          mechanisms. To be completely safe, ensure that your
          applications can no longer connect to the instance before
          issuing this statement to avoid any chance of stale reads.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-functions-for-new-primary"></a>13.4.3.3 Function which Configures Group Replication Primary</h4>

</div>

</div>

</div>
<p>
        The following function enables you to configure which member of
        a single-primary replication group is the primary.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="udf_group-replication-set-as-primary"></a>
            <a class="link" href="sql-syntax.html#udf_group-replication-set-as-primary"><code class="literal">group_replication_set_as_primary()</code></a>
          </p><a class="indexterm" name="idm140091661598192"></a><a class="indexterm" name="idm140091661597104"></a><p>
            Appoints a specific member of the group as the new primary,
            overriding any election process. Pass in
            <em class="replaceable"><code>member_uuid</code></em> which is the
            <a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a> of the member
            that you want to become the new primary. Must be issued on a
            member of a replication group running in single-primary
            mode.
          </p><p>
            Syntax:
          </p><pre data-lang="clike" class="programlisting">STRING group_replication_set_as_primary(<em class="replaceable"><code>member_uuid</code></em>)</pre><p>
            Return value:
          </p><p>
            A string containing the result of the operation, for example
            whether it was successful or not.
          </p><p>
            Example:
          </p><pre data-lang="sql" class="programlisting">SELECT group_replication_set_as_primary(<em class="replaceable"><code>member_uuid</code></em>)</pre><p>
            For more information, see
            <a class="xref" href="group-replication.html#group-replication-changing-primary-member" title="18.4.2.1 Changing a Group's Primary Member">Section 18.4.2.1, “Changing a Group's Primary Member”</a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-functions-for-mode"></a>13.4.3.4 Functions which Configure the Group Replication Mode</h4>

</div>

</div>

</div>
<p>
        The following functions enable you to control the mode which a
        replication group is running in, either single-primary or
        multi-primary mode.

        
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="udf_group-replication-switch-to-single-primary-mode"></a>
            <a class="link" href="sql-syntax.html#udf_group-replication-switch-to-single-primary-mode"><code class="literal">group_replication_switch_to_single_primary_mode()</code></a>
          </p><a class="indexterm" name="idm140091661581600"></a><a class="indexterm" name="idm140091661580496"></a><p>
            Changes a group running in multi-primary mode to
            single-primary mode, without the need to stop Group
            Replication. Must be issued on a member of a replication
            group running in multi-primary mode. When you change to
            single-primary mode, strict consistency checks are also
            disabled on all group members, as required in single-primary
            mode
            (<a class="link" href="group-replication.html#sysvar_group_replication_enforce_update_everywhere_checks"><code class="literal">group_replication_enforce_update_everywhere_checks=OFF</code></a>).
          </p><p>
            Syntax:
          </p><pre data-lang="clike" class="programlisting">STRING group_replication_switch_to_single_primary_mode([<em class="replaceable"><code>str</code></em>])</pre><p>
            Arguments:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <em class="replaceable"><code>str</code></em>: A string containing the
                UUID of a member of the group which should become the
                new single primary. Other members of the group become
                secondaries.
</p></li></ul>
</div>
<p>
            Return value:
          </p><p>
            A string containing the result of the operation, for example
            whether it was successful or not.
          </p><p>
            Example:
          </p><pre data-lang="sql" class="programlisting">
<strong class="userinput"><code>SELECT group_replication_switch_to_single_primary_mode(<em class="replaceable"><code>member_uuid</code></em>);</code></strong>
</pre><p>
            For more information, see
            <a class="xref" href="group-replication.html#group-replication-changing-group-mode" title="18.4.2.2 Changing a Group's Mode">Section 18.4.2.2, “Changing a Group's Mode”</a>
          </p></li><li class="listitem"><p><a name="udf_group-replication-switch-to-multi-primary-mode"></a>
            <a class="link" href="sql-syntax.html#udf_group-replication-switch-to-multi-primary-mode"><code class="literal">group_replication_switch_to_multi_primary_mode()</code></a>
          </p><a class="indexterm" name="idm140091661565312"></a><a class="indexterm" name="idm140091661564208"></a><p>
            Changes a group running in single-primary mode to
            multi-primary mode. Must be issued on a member of a
            replication group running in single-primary mode.
          </p><p>
            Syntax:
          </p><pre data-lang="clike" class="programlisting">STRING group_replication_switch_to_multi_primary_mode()</pre><p>
            This function has no parameters.
          </p><p>
            Return value:
          </p><p>
            A string containing the result of the operation, for example
            whether it was successful or not.
          </p><p>
            Example:
          </p><pre data-lang="sql" class="programlisting">SELECT group_replication_switch_to_multi_primary_mode()</pre><p>
            All members which belong to the group become primaries.
          </p><p>
            For more information, see
            <a class="xref" href="group-replication.html#group-replication-changing-group-mode" title="18.4.2.2 Changing a Group's Mode">Section 18.4.2.2, “Changing a Group's Mode”</a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-functions-for-maximum-consensus"></a>13.4.3.5 Functions to Inspect and Configure the Maximum Consensus Instances of a
Group</h4>
</div>
</div>
</div>
<p>
        The following functions enable you to inspect and configure the
        maximum number of consensus instances that a group can execute
        in parallel.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="udf_group-replication-get-write-concurrency"></a>
            <a class="link" href="sql-syntax.html#udf_group-replication-get-write-concurrency"><code class="literal">group_replication_get_write_concurrency()</code></a>
          </p><a class="indexterm" name="idm140091661551216"></a><a class="indexterm" name="idm140091661550112"></a><p>
            Check the maximum number of consensus instances that a group
            can execute in parallel.
          </p><p>
            Syntax:
          </p><pre data-lang="clike" class="programlisting">
STRING group_replication_get_write_concurrency()
</pre><p>
            This function has no parameters.
          </p><p>
            Return value:
          </p><p>
            Any resulting error as a string.
          </p><p>
            Example:
          </p><pre data-lang="sql" class="programlisting">SELECT group_replication_get_write_concurrency()</pre><p>
            For more information, see
            <a class="xref" href="group-replication.html#group-replication-group-write-consensus" title="18.4.2.3 Using Group Replication Group Write Consensus">Section 18.4.2.3, “Using Group Replication Group Write Consensus”</a>.
          </p></li><li class="listitem"><p><a name="udf_group-replication-set-write-concurrency"></a>
            <a class="link" href="sql-syntax.html#udf_group-replication-set-write-concurrency"><code class="literal">group_replication_set_write_concurrency()</code></a>
          </p><a class="indexterm" name="idm140091661540064"></a><a class="indexterm" name="idm140091661538960"></a><p>
            Configures the maximum number of consensus instances that a
            group can execute in parallel. The
            <a class="link" href="security.html#priv_group-replication-admin"><code class="literal">GROUP_REPLICATION_ADMIN</code></a>
            privilege is required to use this UDF.
          </p><p>
            Syntax:
          </p><pre data-lang="clike" class="programlisting">
STRING group_replication_set_write_concurrency(<em class="replaceable"><code>instances</code></em>)
</pre><p>
            Arguments:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <em class="replaceable"><code>members</code></em>: Sets the maximum
                number of consensus instances that a group can execute
                in parallel. Default value is 10, valid values are
                integers in the range of 10 to 200.
</p></li></ul>
</div>
<p>
            Return value:
          </p><p>
            Any resulting error as a string.
          </p><p>
            Example:
          </p><pre data-lang="sql" class="programlisting">
<strong class="userinput"><code>SELECT group_replication_set_write_concurrency(<em class="replaceable"><code>instances</code></em>);</code></strong>
</pre><p>
            For more information, see
            <a class="xref" href="group-replication.html#group-replication-group-write-consensus" title="18.4.2.3 Using Group Replication Group Write Consensus">Section 18.4.2.3, “Using Group Replication Group Write Consensus”</a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-functions-for-communication-protocol"></a>13.4.3.6 Functions to Inspect and Set the Group Replication Communication
Protocol Version</h4>
</div>
</div>
</div>
<p>
        The following functions enable you to inspect and configure the
        Group Replication communication protocol version that is used by
        a replication group.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="udf_group-replication-get-communication-protocol"></a>
            <a class="link" href="sql-syntax.html#udf_group-replication-get-communication-protocol"><code class="literal">group_replication_get_communication_protocol()</code></a>
          </p><a class="indexterm" name="idm140091661521888"></a><a class="indexterm" name="idm140091661520784"></a><p>
            Inspect the Group Replication communication protocol version
            that is currently in use for a group.
          </p><p>
            Syntax:
          </p><pre data-lang="clike" class="programlisting">
STRING group_replication_get_communication_protocol()
</pre><p>
            This function has no parameters.
          </p><p>
            Return value:
          </p><p>
            The oldest MySQL Server version that can join this group and
            use the group's communication protocol. Versions from MySQL
            5.7.14 allow compression of messages, and versions from
            MySQL 8.0.16 also allow fragmentation of messages. Note that
            the
            <a class="link" href="sql-syntax.html#udf_group-replication-get-communication-protocol"><code class="literal">group_replication_get_communication_protocol()</code></a>
            UDF returns the minimum MySQL version that the group
            supports, which might differ from the version number that
            was passed to the
            <a class="link" href="sql-syntax.html#udf_group-replication-set-communication-protocol"><code class="literal">group_replication_set_communication_protocol()</code></a>
            UDF, and from the MySQL Server version that is installed on
            the member where you use the UDF.
          </p><p>
            If the protocol cannot be inspected because this server
            instance does not belong to a replication group, an error is
            returned as a string.
          </p><p>
            Example:
          </p><pre data-lang="sql" class="programlisting">
<strong class="userinput"><code>SELECT group_replication_get_communication_protocol();</code></strong>
+------------------------------------------------+
| group_replication_get_communication_protocol() |
+------------------------------------------------+
| 8.0.16                                         |
+------------------------------------------------+
</pre><p>
            For more information, see
            <a class="xref" href="group-replication.html#group-replication-communication-protocol" title="18.4.2.4 Setting a Group's Communication Protocol Version">Section 18.4.2.4, “Setting a Group's Communication Protocol Version”</a>.
          </p></li><li class="listitem"><p><a name="udf_group-replication-set-communication-protocol"></a>
            <a class="link" href="sql-syntax.html#udf_group-replication-set-communication-protocol"><code class="literal">group_replication_set_communication_protocol()</code></a>
          </p><a class="indexterm" name="idm140091661505936"></a><a class="indexterm" name="idm140091661504832"></a><p>
            Downgrade the Group Replication communication protocol
            version of a group so that members at earlier releases can
            join, or upgrade the Group Replication communication
            protocol version of a group after upgrading MySQL Server on
            all members. The
            <a class="link" href="security.html#priv_group-replication-admin"><code class="literal">GROUP_REPLICATION_ADMIN</code></a>
            privilege is required to use this UDF, and all existing
            group members must be online when you issue the statement,
            with no loss of majority.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              For MySQL InnoDB cluster, the communication protocol
              version is managed automatically whenever the cluster
              topology is changed using AdminAPI operations. You do not
              have to use these UDFs yourself for an InnoDB cluster.
</p>
</div>
<p>
            Syntax:
          </p><pre data-lang="clike" class="programlisting">
STRING group_replication_set_communication_protocol(<em class="replaceable"><code>version</code></em>)
</pre><p>
            Arguments:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <em class="replaceable"><code>version</code></em>: For a downgrade,
                specify the MySQL Server version of the prospective
                group member that has the oldest installed server
                version. In this case, the command makes the group fall
                back to a communication protocol compatible with that
                server version if possible. The minimum server version
                that you can specify is MySQL 5.7.14. For an upgrade,
                specify the new MySQL Server version to which the
                existing group members have been upgraded.
</p></li></ul>
</div>
<p>
            Return value:
          </p><p>
            A string containing the result of the operation, for example
            whether it was successful or not.
          </p><p>
            Example:
          </p><pre data-lang="sql" class="programlisting">
<strong class="userinput"><code>SELECT group_replication_set_communication_protocol("5.7.25");</code></strong>
</pre><p>
            For more information, see
            <a class="xref" href="group-replication.html#group-replication-communication-protocol" title="18.4.2.4 Setting a Group's Communication Protocol Version">Section 18.4.2.4, “Setting a Group's Communication Protocol Version”</a>.
</p></li></ul>
</div>

</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-prepared-statements"></a>13.5 Prepared SQL Statement Syntax</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#prepare">13.5.1 PREPARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#execute">13.5.2 EXECUTE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#deallocate-prepare">13.5.3 DEALLOCATE PREPARE Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091661489648"></a><a class="indexterm" name="idm140091661488576"></a><a class="indexterm" name="idm140091661487504"></a><a class="indexterm" name="idm140091661486432"></a><p>
    MySQL 8.0 provides support for server-side prepared
    statements. This support takes advantage of the efficient
    client/server binary protocol. Using prepared statements with
    placeholders for parameter values has the following benefits:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Less overhead for parsing the statement each time it is
        executed. Typically, database applications process large volumes
        of almost-identical statements, with only changes to literal or
        variable values in clauses such as <code class="literal">WHERE</code> for
        queries and deletes, <code class="literal">SET</code> for updates, and
        <code class="literal">VALUES</code> for inserts.
      </p></li><li class="listitem"><p>
        Protection against SQL injection attacks. The parameter values
        can contain unescaped SQL quote and delimiter characters.
</p></li></ul>
</div>
<h3><a name="idm140091661480192"></a>Prepared Statements in Application Programs</h3>
<p>
    You can use server-side prepared statements through client
    programming interfaces, including the <a class="link" href="connectors-apis.html#c-api" title="28.7 MySQL C API">MySQL C
    API client library</a> or <a class="ulink" href="https://dev.mysql.com/doc/connector-c/en/" target="_top">MySQL
    Connector/C</a> for C programs,
    <a class="ulink" href="https://dev.mysql.com/doc/connector-j/8.0/en/" target="_top">MySQL Connector/J</a> for Java
    programs, and <a class="ulink" href="https://dev.mysql.com/doc/connector-net/en/" target="_top">MySQL Connector/NET</a> for
    programs using .NET technologies. For example, the C API provides a
    set of function calls that make up its prepared statement API. See
    <a class="xref" href="connectors-apis.html#c-api-prepared-statements" title="28.7.8 C API Prepared Statements">Section 28.7.8, “C API Prepared Statements”</a>. Other language
    interfaces can provide support for prepared statements that use the
    binary protocol by linking in the C client library, one example
    being the
    <a class="ulink" href="http://php.net/mysqli" target="_top"><code class="literal">mysqli</code>
    extension</a>, available in PHP 5.0 and later.
</p>
<h3><a name="idm140091661473152"></a>Prepared Statements in SQL Scripts</h3>
<p>
    An alternative SQL interface to prepared statements is available.
    This interface is not as efficient as using the binary protocol
    through a prepared statement API, but requires no programming
    because it is available directly at the SQL level:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        You can use it when no programming interface is available to
        you.
      </p></li><li class="listitem"><p>
        You can use it from any program that can send SQL statements to
        the server to be executed, such as the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a>
        client program.
      </p></li><li class="listitem"><p>
        You can use it even if the client is using an old version of the
        client library, as long as you connect to a server running MySQL
        4.1 or higher.
</p></li></ul>
</div>
<p>
    SQL syntax for prepared statements is intended to be used for
    situations such as these:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        To test how prepared statements work in your application before
        coding it.
      </p></li><li class="listitem"><p>
        To use prepared statements when you do not have access to a
        programming API that supports them.
      </p></li><li class="listitem"><p>
        To interactively troubleshoot application issues with prepared
        statements.
      </p></li><li class="listitem"><p>
        To create a test case that reproduces a problem with prepared
        statements, so that you can file a bug report.
</p></li></ul>
</div>
<h3><a name="idm140091661462944"></a>PREPARE, EXECUTE, and DEALLOCATE PREPARE Statements</h3>
<p>
    SQL syntax for prepared statements is based on three SQL statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> prepares a statement for
        execution (see <a class="xref" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax">Section 13.5.1, “PREPARE Syntax”</a>).
      </p></li><li class="listitem"><p>
        <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a> executes a prepared
        statement (see <a class="xref" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax">Section 13.5.2, “EXECUTE Syntax”</a>).
      </p></li><li class="listitem"><p>
        <a class="link" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax"><code class="literal">DEALLOCATE PREPARE</code></a> releases a
        prepared statement (see <a class="xref" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax">Section 13.5.3, “DEALLOCATE PREPARE Syntax”</a>).
</p></li></ul>
</div>
<p>
    The following examples show two equivalent ways of preparing a
    statement that computes the hypotenuse of a triangle given the
    lengths of the two sides.
  </p><p>
    The first example shows how to create a prepared statement by using
    a string literal to supply the text of the statement:
  </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>PREPARE stmt1 FROM 'SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse';</code></strong>
mysql&gt; <strong class="userinput"><code>SET @a = 3;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @b = 4;</code></strong>
mysql&gt; <strong class="userinput"><code>EXECUTE stmt1 USING @a, @b;</code></strong>
+------------+
| hypotenuse |
+------------+
|          5 |
+------------+
mysql&gt; <strong class="userinput"><code>DEALLOCATE PREPARE stmt1;</code></strong>
</pre><p>
    The second example is similar, but supplies the text of the
    statement as a user variable:
  </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @s = 'SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse';</code></strong>
mysql&gt; <strong class="userinput"><code>PREPARE stmt2 FROM @s;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @a = 6;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @b = 8;</code></strong>
mysql&gt; <strong class="userinput"><code>EXECUTE stmt2 USING @a, @b;</code></strong>
+------------+
| hypotenuse |
+------------+
|         10 |
+------------+
mysql&gt; <strong class="userinput"><code>DEALLOCATE PREPARE stmt2;</code></strong>
</pre><p>
    Here is an additional example that demonstrates how to choose the
    table on which to perform a query at runtime, by storing the name of
    the table as a user variable:
  </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>USE test;</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (a INT NOT NULL);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t1 VALUES (4), (8), (11), (32), (80);</code></strong>

mysql&gt; <strong class="userinput"><code>SET @table = 't1';</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s = CONCAT('SELECT * FROM ', @table);</code></strong>

mysql&gt; <strong class="userinput"><code>PREPARE stmt3 FROM @s;</code></strong>
mysql&gt; <strong class="userinput"><code>EXECUTE stmt3;</code></strong>
+----+
| a  |
+----+
|  4 |
|  8 |
| 11 |
| 32 |
| 80 |
+----+

mysql&gt; <strong class="userinput"><code>DEALLOCATE PREPARE stmt3;</code></strong>
</pre><p>
    A prepared statement is specific to the session in which it was
    created. If you terminate a session without deallocating a
    previously prepared statement, the server deallocates it
    automatically.
  </p><p>
    A prepared statement is also global to the session. If you create a
    prepared statement within a stored routine, it is not deallocated
    when the stored routine ends.
  </p><p>
    To guard against too many prepared statements being created
    simultaneously, set the
    <a class="link" href="server-administration.html#sysvar_max_prepared_stmt_count"><code class="literal">max_prepared_stmt_count</code></a> system
    variable. To prevent the use of prepared statements, set the value
    to 0.
</p>
<h3><a name="idm140091661430944"></a>SQL Syntax Allowed in Prepared Statements</h3>
<p>
    The following SQL statements can be used as prepared statements:
  </p><pre data-lang="sql" class="programlisting">
ALTER TABLE
ALTER USER
ANALYZE TABLE
CACHE INDEX
CALL
CHANGE MASTER
CHECKSUM {TABLE | TABLES}
COMMIT
{CREATE | DROP} INDEX
{CREATE | RENAME | DROP} DATABASE
{CREATE | DROP} TABLE
{CREATE | RENAME | DROP} USER
{CREATE | DROP} VIEW
DELETE
DO
FLUSH {TABLE | TABLES | TABLES WITH READ LOCK | HOSTS | PRIVILEGES
  | LOGS | STATUS | MASTER | SLAVE | USER_RESOURCES}
GRANT
INSERT
INSTALL PLUGIN
KILL
LOAD INDEX INTO CACHE
OPTIMIZE TABLE
RENAME TABLE
REPAIR TABLE
REPLACE
RESET {MASTER | SLAVE}
REVOKE
SELECT
SET
SHOW {WARNINGS | ERRORS}
SHOW BINLOG EVENTS
SHOW CREATE {PROCEDURE | FUNCTION | EVENT | TABLE | VIEW}
SHOW {MASTER | BINARY} LOGS
SHOW {MASTER | SLAVE} STATUS
SLAVE {START | STOP}
TRUNCATE TABLE
UNINSTALL PLUGIN
UPDATE
</pre><p>
    For compliance with the SQL standard, which states that diagnostics
    statements are not preparable, MySQL does not support the following
    as prepared statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <code class="literal">SHOW WARNINGS</code>, <code class="literal">SHOW COUNT(*)
        WARNINGS</code>
      </p></li><li class="listitem"><p>
        <code class="literal">SHOW ERRORS</code>, <code class="literal">SHOW COUNT(*)
        ERRORS</code>
      </p></li><li class="listitem"><p>
        Statements containing any reference to the
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> or
        <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> system variable.
</p></li></ul>
</div>
<p>
    Other statements are not supported in MySQL 8.0.
  </p><p>
    Generally, statements not permitted in SQL prepared statements are
    also not permitted in stored programs. Exceptions are noted in
    <a class="xref" href="restrictions.html#stored-program-restrictions" title="C.1 Restrictions on Stored Programs">Section C.1, “Restrictions on Stored Programs”</a>.
  </p><p>
    Metadata changes to tables or views referred to by prepared
    statements are detected and cause automatic repreparation of the
    statement when it is next executed. For more information, see
    <a class="xref" href="optimization.html#statement-caching" title="8.10.3 Caching of Prepared Statements and Stored Programs">Section 8.10.3, “Caching of Prepared Statements and Stored Programs”</a>.
  </p><p>
    Placeholders can be used for the arguments of the
    <code class="literal">LIMIT</code> clause when using prepared statements. See
    <a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax">Section 13.2.10, “SELECT Syntax”</a>.
  </p><p>
    In prepared <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statements used with
    <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> and
    <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>, placeholder support for
    <code class="literal">OUT</code> and <code class="literal">INOUT</code> parameters is
    available beginning with MySQL 8.0. See
    <a class="xref" href="sql-syntax.html#call" title="13.2.1 CALL Syntax">Section 13.2.1, “CALL Syntax”</a>, for an example and a workaround for earlier
    versions. Placeholders can be used for <code class="literal">IN</code>
    parameters regardless of version.
  </p><p>
    SQL syntax for prepared statements cannot be used in nested fashion.
    That is, a statement passed to
    <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> cannot itself be a
    <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a>,
    <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>, or
    <a class="link" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax"><code class="literal">DEALLOCATE PREPARE</code></a> statement.
  </p><p>
    SQL syntax for prepared statements is distinct from using prepared
    statement API calls. For example, you cannot use the
    <a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare()"><code class="literal">mysql_stmt_prepare()</code></a> C API function
    to prepare a <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a>,
    <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>, or
    <a class="link" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax"><code class="literal">DEALLOCATE PREPARE</code></a> statement.
  </p><p>
    SQL syntax for prepared statements can be used within stored
    procedures, but not in stored functions or triggers. However, a
    cursor cannot be used for a dynamic statement that is prepared and
    executed with <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> and
    <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>. The statement for a cursor
    is checked at cursor creation time, so the statement cannot be
    dynamic.
  </p><p>
    SQL syntax for prepared statements does not support multi-statements
    (that is, multiple statements within a single string separated by
    <code class="literal">;</code> characters).
  </p><p>
    To write C programs that use the <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a>
    SQL statement to execute stored procedures that contain prepared
    statements, the <code class="literal">CLIENT_MULTI_RESULTS</code> flag must be
    enabled. This is because each <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a>
    returns a result to indicate the call status, in addition to any
    result sets that might be returned by statements executed within the
    procedure.
  </p><p>
    <code class="literal">CLIENT_MULTI_RESULTS</code> can be enabled when you call
    <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>, either
    explicitly by passing the <code class="literal">CLIENT_MULTI_RESULTS</code>
    flag itself, or implicitly by passing
    <code class="literal">CLIENT_MULTI_STATEMENTS</code> (which also enables
    <code class="literal">CLIENT_MULTI_RESULTS</code>). For additional
    information, see <a class="xref" href="sql-syntax.html#call" title="13.2.1 CALL Syntax">Section 13.2.1, “CALL Syntax”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="prepare"></a>13.5.1 PREPARE Syntax</h3>
</div>
</div>
</div>
<a class="indexterm" name="idm140091661381984"></a><a class="indexterm" name="idm140091661380912"></a><pre data-lang="sql" class="programlisting">
PREPARE <em class="replaceable"><code>stmt_name</code></em> FROM <em class="replaceable"><code>preparable_stmt</code></em>
</pre><p>
      The <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> statement prepares a
      SQL statement and assigns it a name,
      <em class="replaceable"><code>stmt_name</code></em>, by which to refer to the
      statement later. The prepared statement is executed with
      <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a> and released with
      <a class="link" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax"><code class="literal">DEALLOCATE PREPARE</code></a>. For examples,
      see <a class="xref" href="sql-syntax.html#sql-syntax-prepared-statements" title="13.5 Prepared SQL Statement Syntax">Section 13.5, “Prepared SQL Statement Syntax”</a>.
    </p><p>
      Statement names are not case-sensitive.
      <em class="replaceable"><code>preparable_stmt</code></em> is either a string
      literal or a user variable that contains the text of the SQL
      statement. The text must represent a single statement, not
      multiple statements. Within the statement, <code class="literal">?</code>
      characters can be used as parameter markers to indicate where data
      values are to be bound to the query later when you execute it. The
      <code class="literal">?</code> characters should not be enclosed within
      quotation marks, even if you intend to bind them to string values.
      Parameter markers can be used only where data values should
      appear, not for SQL keywords, identifiers, and so forth.
    </p><p>
      If a prepared statement with the given name already exists, it is
      deallocated implicitly before the new statement is prepared. This
      means that if the new statement contains an error and cannot be
      prepared, an error is returned and no statement with the given
      name exists.
    </p><p>
      The scope of a prepared statement is the session within which it
      is created, which as several implications:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A prepared statement created in one session is not available
          to other sessions.
        </p></li><li class="listitem"><p>
          When a session ends, whether normally or abnormally, its
          prepared statements no longer exist. If auto-reconnect is
          enabled, the client is not notified that the connection was
          lost. For this reason, clients may wish to disable
          auto-reconnect. See <a class="xref" href="connectors-apis.html#c-api-auto-reconnect" title="28.7.28 C API Automatic Reconnection Control">Section 28.7.28, “C API Automatic Reconnection Control”</a>.
        </p></li><li class="listitem"><p>
          A prepared statement created within a stored program continues
          to exist after the program finishes executing and can be
          executed outside the program later.
        </p></li><li class="listitem"><p>
          A statement prepared in stored program context cannot refer to
          stored procedure or function parameters or local variables
          because they go out of scope when the program ends and would
          be unavailable were the statement to be executed later outside
          the program. As a workaround, refer instead to user-defined
          variables, which also have session scope; see
          <a class="xref" href="language-structure.html#user-variables" title="9.4 User-Defined Variables">Section 9.4, “User-Defined Variables”</a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="execute"></a>13.5.2 EXECUTE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661357888"></a><a class="indexterm" name="idm140091661356816"></a><pre data-lang="sql" class="programlisting">
EXECUTE <em class="replaceable"><code>stmt_name</code></em>
    [USING @<em class="replaceable"><code>var_name</code></em> [, @<em class="replaceable"><code>var_name</code></em>] ...]
</pre><p>
      After preparing a statement with
      <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a>, you execute it with an
      <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a> statement that refers to
      the prepared statement name. If the prepared statement contains
      any parameter markers, you must supply a <code class="literal">USING</code>
      clause that lists user variables containing the values to be bound
      to the parameters. Parameter values can be supplied only by user
      variables, and the <code class="literal">USING</code> clause must name
      exactly as many variables as the number of parameter markers in
      the statement.
    </p><p>
      You can execute a given prepared statement multiple times, passing
      different variables to it or setting the variables to different
      values before each execution.
    </p><p>
      For examples, see
      <a class="xref" href="sql-syntax.html#sql-syntax-prepared-statements" title="13.5 Prepared SQL Statement Syntax">Section 13.5, “Prepared SQL Statement Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="deallocate-prepare"></a>13.5.3 DEALLOCATE PREPARE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661342096"></a><a class="indexterm" name="idm140091661341056"></a><a class="indexterm" name="idm140091661339984"></a><pre data-lang="sql" class="programlisting">
{DEALLOCATE | DROP} PREPARE <em class="replaceable"><code>stmt_name</code></em>
</pre><p>
      To deallocate a prepared statement produced with
      <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a>, use a
      <a class="link" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax"><code class="literal">DEALLOCATE PREPARE</code></a> statement that
      refers to the prepared statement name. Attempting to execute a
      prepared statement after deallocating it results in an error. If
      too many prepared statements are created and not deallocated by
      either the <code class="literal">DEALLOCATE PREPARE</code> statement or the
      end of the session, you might encounter the upper limit enforced
      by the <a class="link" href="server-administration.html#sysvar_max_prepared_stmt_count"><code class="literal">max_prepared_stmt_count</code></a>
      system variable.
    </p><p>
      For examples, see
      <a class="xref" href="sql-syntax.html#sql-syntax-prepared-statements" title="13.5 Prepared SQL Statement Syntax">Section 13.5, “Prepared SQL Statement Syntax”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-compound-statements"></a>13.6 Compound-Statement Syntax</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#begin-end">13.6.1 BEGIN ... END Compound-Statement Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#statement-labels">13.6.2 Statement Label Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#declare">13.6.3 DECLARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#stored-program-variables">13.6.4 Variables in Stored Programs</a></span></dt><dt><span class="section"><a href="sql-syntax.html#flow-control-statements">13.6.5 Flow Control Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#cursors">13.6.6 Cursors</a></span></dt><dt><span class="section"><a href="sql-syntax.html#condition-handling">13.6.7 Condition Handling</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091661325360"></a><a class="indexterm" name="idm140091661324288"></a><a class="indexterm" name="idm140091661322800"></a><a class="indexterm" name="idm140091661321728"></a><p>
    This section describes the syntax for the
    <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
    compound statement and other statements that can be used in the body
    of stored programs: Stored procedures and functions, triggers, and
    events. These objects are defined in terms of SQL code that is
    stored on the server for later invocation (see
    <a class="xref" href="stored-objects.html" title="Chapter 24 Stored Objects">Chapter 24, <i>Stored Objects</i></a>).
  </p><p>
    A compound statement is a block that can contain other blocks;
    declarations for variables, condition handlers, and cursors; and
    flow control constructs such as loops and conditional tests.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="begin-end"></a>13.6.1 BEGIN ... END Compound-Statement Syntax</h3>
</div>
</div>
</div>
<a class="indexterm" name="idm140091661314960"></a><a class="indexterm" name="idm140091661313920"></a><pre data-lang="sql" class="programlisting">
[<em class="replaceable"><code>begin_label</code></em>:] BEGIN
    [<em class="replaceable"><code>statement_list</code></em>]
END [<em class="replaceable"><code>end_label</code></em>]
</pre><p>
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      syntax is used for writing compound statements, which can appear
      within stored programs (stored procedures and functions, triggers,
      and events). A compound statement can contain multiple statements,
      enclosed by the <code class="literal">BEGIN</code> and
      <code class="literal">END</code> keywords.
      <em class="replaceable"><code>statement_list</code></em> represents a list of one
      or more statements, each terminated by a semicolon
      (<code class="literal">;</code>) statement delimiter. The
      <em class="replaceable"><code>statement_list</code></em> itself is optional, so
      the empty compound statement (<code class="literal">BEGIN END</code>) is
      legal.
    </p><p>
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      blocks can be nested.
    </p><p>
      Use of multiple statements requires that a client is able to send
      statement strings containing the <code class="literal">;</code> statement
      delimiter. In the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> command-line client,
      this is handled with the <code class="literal">delimiter</code> command.
      Changing the <code class="literal">;</code> end-of-statement delimiter (for
      example, to <code class="literal">//</code>) permit <code class="literal">;</code> to
      be used in a program body. For an example, see
      <a class="xref" href="stored-objects.html#stored-programs-defining" title="24.1 Defining Stored Programs">Section 24.1, “Defining Stored Programs”</a>.
    </p><p>
      A <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
      END</code></a> block can be labeled. See
      <a class="xref" href="sql-syntax.html#statement-labels" title="13.6.2 Statement Label Syntax">Section 13.6.2, “Statement Label Syntax”</a>.
    </p><p>
      The optional <code class="literal">[NOT] ATOMIC</code> clause is not
      supported. This means that no transactional savepoint is set at
      the start of the instruction block and the
      <code class="literal">BEGIN</code> clause used in this context has no effect
      on the current transaction.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Within all stored programs, the parser treats
        <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">BEGIN [WORK]</code></a>
        as the beginning of a
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block. To begin a transaction in this context, use
        <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
        TRANSACTION</code></a> instead.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="statement-labels"></a>13.6.2 Statement Label Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661283792"></a><a class="indexterm" name="idm140091661282304"></a><a class="indexterm" name="idm140091661280816"></a><a class="indexterm" name="idm140091661279328"></a><a class="indexterm" name="idm140091661277840"></a><pre data-lang="sql" class="programlisting">
[<em class="replaceable"><code>begin_label</code></em>:] BEGIN
    [<em class="replaceable"><code>statement_list</code></em>]
END [<em class="replaceable"><code>end_label</code></em>]

[<em class="replaceable"><code>begin_label</code></em>:] LOOP
    <em class="replaceable"><code>statement_list</code></em>
END LOOP [<em class="replaceable"><code>end_label</code></em>]

[<em class="replaceable"><code>begin_label</code></em>:] REPEAT
    <em class="replaceable"><code>statement_list</code></em>
UNTIL <em class="replaceable"><code>search_condition</code></em>
END REPEAT [<em class="replaceable"><code>end_label</code></em>]

[<em class="replaceable"><code>begin_label</code></em>:] WHILE <em class="replaceable"><code>search_condition</code></em> DO
    <em class="replaceable"><code>statement_list</code></em>
END WHILE [<em class="replaceable"><code>end_label</code></em>]
</pre><p>
      Labels are permitted for
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      blocks and for the <a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a>,
      <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a>, and
      <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a> statements. Label use for
      those statements follows these rules:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <em class="replaceable"><code>begin_label</code></em> must be followed by a
          colon.
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>begin_label</code></em> can be given without
          <em class="replaceable"><code>end_label</code></em>. If
          <em class="replaceable"><code>end_label</code></em> is present, it must be
          the same as <em class="replaceable"><code>begin_label</code></em>.
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>end_label</code></em> cannot be given without
          <em class="replaceable"><code>begin_label</code></em>.
        </p></li><li class="listitem"><p>
          Labels at the same nesting level must be distinct.
        </p></li><li class="listitem"><p>
          Labels can be up to 16 characters long.
</p></li></ul>
</div>
<p>
      To refer to a label within the labeled construct, use an
      <a class="link" href="sql-syntax.html#iterate" title="13.6.5.3 ITERATE Syntax"><code class="literal">ITERATE</code></a> or
      <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> statement. The following
      example uses those statements to continue iterating or terminate
      the loop:
    </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE doiterate(p1 INT)
BEGIN
  label1: LOOP
    SET p1 = p1 + 1;
    IF p1 &lt; 10 THEN ITERATE label1; END IF;
    LEAVE label1;
  END LOOP label1;
END;
</pre><p>
      The scope of a block label does not include the code for handlers
      declared within the block. For details, see
      <a class="xref" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax">Section 13.6.7.2, “DECLARE ... HANDLER Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="declare"></a>13.6.3 DECLARE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661246176"></a><p>
      The <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a> statement is used to
      define various items local to a program:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Local variables. See
          <a class="xref" href="sql-syntax.html#stored-program-variables" title="13.6.4 Variables in Stored Programs">Section 13.6.4, “Variables in Stored Programs”</a>.
        </p></li><li class="listitem"><p>
          Conditions and handlers. See
          <a class="xref" href="sql-syntax.html#condition-handling" title="13.6.7 Condition Handling">Section 13.6.7, “Condition Handling”</a>.
        </p></li><li class="listitem"><p>
          Cursors. See <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
</p></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a> is permitted only inside a
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      compound statement and must be at its start, before any other
      statements.
    </p><p>
      Declarations must follow a certain order. Cursor declarations must
      appear before handler declarations. Variable and condition
      declarations must appear before cursor or handler declarations.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="stored-program-variables"></a>13.6.4 Variables in Stored Programs</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#declare-local-variable">13.6.4.1 Local Variable DECLARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#local-variable-scope">13.6.4.2 Local Variable Scope and Resolution</a></span></dt></dl>
</div>
<p>
      System variables and user-defined variables can be used in stored
      programs, just as they can be used outside stored-program context.
      In addition, stored programs can use <code class="literal">DECLARE</code> to
      define local variables, and stored routines (procedures and
      functions) can be declared to take parameters that communicate
      values between the routine and its caller.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          To declare local variables, use the
          <a class="link" href="sql-syntax.html#declare-local-variable" title="13.6.4.1 Local Variable DECLARE Syntax"><code class="literal">DECLARE</code></a>
          statement, as described in
          <a class="xref" href="sql-syntax.html#declare-local-variable" title="13.6.4.1 Local Variable DECLARE Syntax">Section 13.6.4.1, “Local Variable DECLARE Syntax”</a>.
        </p></li><li class="listitem"><p>
          Variables can be set directly with the
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          statement. See <a class="xref" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment">Section 13.7.5.1, “SET Syntax for Variable Assignment”</a>.
        </p></li><li class="listitem"><p>
          Results from queries can be retrieved into local variables
          using <a class="link" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax"><code class="literal">SELECT ...
          INTO <em class="replaceable"><code>var_list</code></em></code></a> or by
          opening a cursor and using
          <a class="link" href="sql-syntax.html#fetch" title="13.6.6.3 Cursor FETCH Syntax"><code class="literal">FETCH ... INTO
          <em class="replaceable"><code>var_list</code></em></code></a>. See
          <a class="xref" href="sql-syntax.html#select-into" title="13.2.10.1 SELECT ... INTO Syntax">Section 13.2.10.1, “SELECT ... INTO Syntax”</a>, and <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
</p></li></ul>
</div>
<p>
      For information about the scope of local variables and how MySQL
      resolves ambiguous names, see
      <a class="xref" href="sql-syntax.html#local-variable-scope" title="13.6.4.2 Local Variable Scope and Resolution">Section 13.6.4.2, “Local Variable Scope and Resolution”</a>.
    </p><p>
      It is not permitted to assign the value <code class="literal">DEFAULT</code>
      to stored procedure or function parameters or stored program local
      variables (for example with a <code class="literal">SET
      <em class="replaceable"><code>var_name</code></em> = DEFAULT</code>
      statement). In MySQL 8.0, this results in a syntax
      error.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="declare-local-variable"></a>13.6.4.1 Local Variable DECLARE Syntax</h4>
</div>
</div>
</div>
<pre data-lang="sql" class="programlisting">
DECLARE <em class="replaceable"><code>var_name</code></em> [, <em class="replaceable"><code>var_name</code></em>] ... <em class="replaceable"><code>type</code></em> [DEFAULT <em class="replaceable"><code>value</code></em>]
</pre><p>
        This statement declares local variables within stored programs.
        To provide a default value for a variable, include a
        <code class="literal">DEFAULT</code> clause. The value can be specified as
        an expression; it need not be a constant. If the
        <code class="literal">DEFAULT</code> clause is missing, the initial value
        is <code class="literal">NULL</code>.
      </p><p>
        Local variables are treated like stored routine parameters with
        respect to data type and overflow checking. See
        <a class="xref" href="sql-syntax.html#create-procedure" title="13.1.17 CREATE PROCEDURE and CREATE FUNCTION Syntax">Section 13.1.17, “CREATE PROCEDURE and CREATE FUNCTION Syntax”</a>.
      </p><p>
        Variable declarations must appear before cursor or handler
        declarations.
      </p><p>
        Local variable names are not case-sensitive. Permissible
        characters and quoting rules are the same as for other
        identifiers, as described in <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>.
      </p><p>
        The scope of a local variable is the
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block within which it is declared. The variable
        can be referred to in blocks nested within the declaring block,
        except those blocks that declare a variable with the same name.
      </p><p>
        For examples of variable declarations, see
        <a class="xref" href="sql-syntax.html#local-variable-scope" title="13.6.4.2 Local Variable Scope and Resolution">Section 13.6.4.2, “Local Variable Scope and Resolution”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="local-variable-scope"></a>13.6.4.2 Local Variable Scope and Resolution</h4>

</div>

</div>

</div>
<p>
        The scope of a local variable is the
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block within which it is declared. The variable
        can be referred to in blocks nested within the declaring block,
        except those blocks that declare a variable with the same name.
      </p><p>
        Because local variables are in scope only during stored program
        execution, references to them are not permitted in prepared
        statements created within a stored program. Prepared statement
        scope is the current session, not the stored program, so the
        statement could be executed after the program ends, at which
        point the variables would no longer be in scope. For example,
        <code class="literal">SELECT ... INTO
        <em class="replaceable"><code>local_var</code></em></code> cannot be used as
        a prepared statement. This restriction also applies to stored
        procedure and function parameters. See
        <a class="xref" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax">Section 13.5.1, “PREPARE Syntax”</a>.
      </p><p>
        A local variable should not have the same name as a table
        column. If an SQL statement, such as a
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT ...
        INTO</code></a> statement, contains a reference to a column and a
        declared local variable with the same name, MySQL currently
        interprets the reference as the name of a variable. Consider the
        following procedure definition:
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE sp1 (x VARCHAR(5))
BEGIN
  DECLARE xname VARCHAR(5) DEFAULT 'bob';
  DECLARE newname VARCHAR(5);
  DECLARE xid INT;

  SELECT xname, id INTO newname, xid
    FROM table1 WHERE xname = xname;
  SELECT newname;
END;
</pre><p>
        MySQL interprets <code class="literal">xname</code> in the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement as a reference
        to the <code class="literal">xname</code> <span class="emphasis"><em>variable</em></span>
        rather than the <code class="literal">xname</code>
        <span class="emphasis"><em>column</em></span>. Consequently, when the procedure
        <code class="literal">sp1()</code>is called, the
        <code class="literal">newname</code> variable returns the value
        <code class="literal">'bob'</code> regardless of the value of the
        <code class="literal">table1.xname</code> column.
      </p><p>
        Similarly, the cursor definition in the following procedure
        contains a <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement that
        refers to <code class="literal">xname</code>. MySQL interprets this as a
        reference to the variable of that name rather than a column
        reference.
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE sp2 (x VARCHAR(5))
BEGIN
  DECLARE xname VARCHAR(5) DEFAULT 'bob';
  DECLARE newname VARCHAR(5);
  DECLARE xid INT;
  DECLARE done TINYINT DEFAULT 0;
  DECLARE cur1 CURSOR FOR SELECT xname, id FROM table1;
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

  OPEN cur1;
  read_loop: LOOP
    FETCH FROM cur1 INTO newname, xid;
    IF done THEN LEAVE read_loop; END IF;
    SELECT newname;
  END LOOP;
  CLOSE cur1;
END;
</pre><p>
        See also <a class="xref" href="restrictions.html#stored-program-restrictions" title="C.1 Restrictions on Stored Programs">Section C.1, “Restrictions on Stored Programs”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="flow-control-statements"></a>13.6.5 Flow Control Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#case">13.6.5.1 CASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#if">13.6.5.2 IF Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#iterate">13.6.5.3 ITERATE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#leave">13.6.5.4 LEAVE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#loop">13.6.5.5 LOOP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#repeat">13.6.5.6 REPEAT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#return">13.6.5.7 RETURN Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#while">13.6.5.8 WHILE Syntax</a></span></dt></dl>
</div>
<p>
      MySQL supports the <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a>,
      <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a>,
      <a class="link" href="sql-syntax.html#iterate" title="13.6.5.3 ITERATE Syntax"><code class="literal">ITERATE</code></a>,
      <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a>
      <a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a>,
      <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a>, and
      <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a> constructs for flow control
      within stored programs. It also supports
      <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> within stored functions.
    </p><p>
      Many of these constructs contain other statements, as indicated by
      the grammar specifications in the following sections. Such
      constructs may be nested. For example, an
      <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> statement might contain a
      <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a> loop, which itself contains a
      <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a> statement.
    </p><p>
      MySQL does not support <code class="literal">FOR</code> loops.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="case"></a>13.6.5.1 CASE Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091661161184"></a><pre data-lang="sql" class="programlisting">
CASE <em class="replaceable"><code>case_value</code></em>
    WHEN <em class="replaceable"><code>when_value</code></em> THEN <em class="replaceable"><code>statement_list</code></em>
    [WHEN <em class="replaceable"><code>when_value</code></em> THEN <em class="replaceable"><code>statement_list</code></em>] ...
    [ELSE <em class="replaceable"><code>statement_list</code></em>]
END CASE
</pre><p>
        Or:
      </p><pre data-lang="sql" class="programlisting">
CASE
    WHEN <em class="replaceable"><code>search_condition</code></em> THEN <em class="replaceable"><code>statement_list</code></em>
    [WHEN <em class="replaceable"><code>search_condition</code></em> THEN <em class="replaceable"><code>statement_list</code></em>] ...
    [ELSE <em class="replaceable"><code>statement_list</code></em>]
END CASE
</pre><p>
        The <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a> statement for stored
        programs implements a complex conditional construct.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          There is also a <a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a>
          <span class="emphasis"><em>expr</em></span>, which differs from the
          <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a>
          <span class="emphasis"><em>statement</em></span> described here. See
          <a class="xref" href="functions.html#control-flow-functions" title="12.4 Control Flow Functions">Section 12.4, “Control Flow Functions”</a>. The
          <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a> statement cannot have an
          <code class="literal">ELSE NULL</code> clause, and it is terminated with
          <code class="literal">END CASE</code> instead of <code class="literal">END</code>.
</p>
</div>
<p>
        For the first syntax, <em class="replaceable"><code>case_value</code></em> is
        an expression. This value is compared to the
        <em class="replaceable"><code>when_value</code></em> expression in each
        <code class="literal">WHEN</code> clause until one of them is equal. When
        an equal <em class="replaceable"><code>when_value</code></em> is found, the
        corresponding <code class="literal">THEN</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes. If no
        <em class="replaceable"><code>when_value</code></em> is equal, the
        <code class="literal">ELSE</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes, if there is
        one.
      </p><p>
        This syntax cannot be used to test for equality with
        <code class="literal">NULL</code> because <code class="literal">NULL = NULL</code>
        is false. See <a class="xref" href="tutorial.html#working-with-null" title="3.3.4.6 Working with NULL Values">Section 3.3.4.6, “Working with NULL Values”</a>.
      </p><p>
        For the second syntax, each <code class="literal">WHEN</code> clause
        <em class="replaceable"><code>search_condition</code></em> expression is
        evaluated until one is true, at which point its corresponding
        <code class="literal">THEN</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes. If no
        <em class="replaceable"><code>search_condition</code></em> is equal, the
        <code class="literal">ELSE</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes, if there is
        one.
      </p><p>
        If no <em class="replaceable"><code>when_value</code></em> or
        <em class="replaceable"><code>search_condition</code></em> matches the value
        tested and the <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a> statement
        contains no <code class="literal">ELSE</code> clause, a <span class="errortext">Case
        not found for CASE statement</span> error results.
      </p><p>
        Each <em class="replaceable"><code>statement_list</code></em> consists of one
        or more SQL statements; an empty
        <em class="replaceable"><code>statement_list</code></em> is not permitted.
      </p><p>
        To handle situations where no value is matched by any
        <code class="literal">WHEN</code> clause, use an <code class="literal">ELSE</code>
        containing an empty
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block, as shown in this example. (The indentation
        used here in the <code class="literal">ELSE</code> clause is for purposes
        of clarity only, and is not otherwise significant.)
      </p><pre data-lang="sql" class="programlisting">
DELIMITER |

CREATE PROCEDURE p()
  BEGIN
    DECLARE v INT DEFAULT 1;

    CASE v
      WHEN 2 THEN SELECT v;
      WHEN 3 THEN SELECT 0;
      ELSE
        BEGIN
        END;
    END CASE;
  END;
  |
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="if"></a>13.6.5.2 IF Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661115360"></a><pre data-lang="sql" class="programlisting">
IF <em class="replaceable"><code>search_condition</code></em> THEN <em class="replaceable"><code>statement_list</code></em>
    [ELSEIF <em class="replaceable"><code>search_condition</code></em> THEN <em class="replaceable"><code>statement_list</code></em>] ...
    [ELSE <em class="replaceable"><code>statement_list</code></em>]
END IF
</pre><p>
        The <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> statement for stored
        programs implements a basic conditional construct.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          There is also an <a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a>
          <span class="emphasis"><em>function</em></span>, which differs from the
          <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a>
          <span class="emphasis"><em>statement</em></span> described here. See
          <a class="xref" href="functions.html#control-flow-functions" title="12.4 Control Flow Functions">Section 12.4, “Control Flow Functions”</a>. The
          <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> statement can have
          <code class="literal">THEN</code>, <code class="literal">ELSE</code>, and
          <code class="literal">ELSEIF</code> clauses, and it is terminated with
          <code class="literal">END IF</code>.
</p>
</div>
<p>
        If a given <em class="replaceable"><code>search_condition</code></em> evaluates
        to true, the corresponding <code class="literal">THEN</code> or
        <code class="literal">ELSEIF</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes. If no
        <em class="replaceable"><code>search_condition</code></em> matches, the
        <code class="literal">ELSE</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes.
      </p><p>
        Each <em class="replaceable"><code>statement_list</code></em> consists of one
        or more SQL statements; an empty
        <em class="replaceable"><code>statement_list</code></em> is not permitted.
      </p><p>
        An <code class="literal">IF ... END IF</code> block, like all other
        flow-control blocks used within stored programs, must be
        terminated with a semicolon, as shown in this example:
      </p><pre data-lang="sql" class="programlisting">
DELIMITER //

CREATE FUNCTION SimpleCompare(n INT, m INT)
  RETURNS VARCHAR(20)

  BEGIN
    DECLARE s VARCHAR(20);

    IF n &gt; m THEN SET s = '&gt;';
    ELSEIF n = m THEN SET s = '=';
    ELSE SET s = '&lt;';
    END IF;

    SET s = CONCAT(n, ' ', s, ' ', m);

    RETURN s;
  END //

DELIMITER ;
</pre><p>
        As with other flow-control constructs, <code class="literal">IF ... END
        IF</code> blocks may be nested within other flow-control
        constructs, including other <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a>
        statements. Each <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> must be
        terminated by its own <code class="literal">END IF</code> followed by a
        semicolon. You can use indentation to make nested flow-control
        blocks more easily readable by humans (although this is not
        required by MySQL), as shown here:
      </p><pre data-lang="sql" class="programlisting">
DELIMITER //

CREATE FUNCTION VerboseCompare (n INT, m INT)
  RETURNS VARCHAR(50)

  BEGIN
    DECLARE s VARCHAR(50);

    IF n = m THEN SET s = 'equals';
    ELSE
      IF n &gt; m THEN SET s = 'greater';
      ELSE SET s = 'less';
      END IF;

      SET s = CONCAT('is ', s, ' than');
    END IF;

    SET s = CONCAT(n, ' ', s, ' ', m, '.');

    RETURN s;
  END //

DELIMITER ;
</pre><p>
        In this example, the inner <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> is
        evaluated only if <code class="literal">n</code> is not equal to
        <code class="literal">m</code>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="iterate"></a>13.6.5.3 ITERATE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661078128"></a><pre data-lang="sql" class="programlisting">
ITERATE <em class="replaceable"><code>label</code></em>
</pre><p>
        <a class="link" href="sql-syntax.html#iterate" title="13.6.5.3 ITERATE Syntax"><code class="literal">ITERATE</code></a> can appear only within
        <a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a>,
        <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a>, and
        <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a> statements.
        <a class="link" href="sql-syntax.html#iterate" title="13.6.5.3 ITERATE Syntax"><code class="literal">ITERATE</code></a> means <span class="quote">“<span class="quote">start the
        loop again.</span>”</span>
      </p><p>
        For an example, see <a class="xref" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax">Section 13.6.5.5, “LOOP Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="leave"></a>13.6.5.4 LEAVE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661063312"></a><pre data-lang="sql" class="programlisting">
LEAVE <em class="replaceable"><code>label</code></em>
</pre><p>
        This statement is used to exit the flow control construct that
        has the given label. If the label is for the outermost stored
        program block, <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> exits the
        program.
      </p><p>
        <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> can be used within
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> or loop constructs
        (<a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a>,
        <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a>,
        <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a>).
      </p><p>
        For an example, see <a class="xref" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax">Section 13.6.5.5, “LOOP Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="loop"></a>13.6.5.5 LOOP Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661047104"></a><pre data-lang="sql" class="programlisting">
[<em class="replaceable"><code>begin_label</code></em>:] LOOP
    <em class="replaceable"><code>statement_list</code></em>
END LOOP [<em class="replaceable"><code>end_label</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a> implements a simple loop
        construct, enabling repeated execution of the statement list,
        which consists of one or more statements, each terminated by a
        semicolon (<code class="literal">;</code>) statement delimiter. The
        statements within the loop are repeated until the loop is
        terminated. Usually, this is accomplished with a
        <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> statement. Within a stored
        function, <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> can also be
        used, which exits the function entirely.
      </p><p>
        Neglecting to include a loop-termination statement results in an
        infinite loop.
      </p><p>
        A <a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a> statement can be labeled.
        For the rules regarding label use, see
        <a class="xref" href="sql-syntax.html#statement-labels" title="13.6.2 Statement Label Syntax">Section 13.6.2, “Statement Label Syntax”</a>.
      </p><p>
        Example:
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE doiterate(p1 INT)
BEGIN
  label1: LOOP
    SET p1 = p1 + 1;
    IF p1 &lt; 10 THEN
      ITERATE label1;
    END IF;
    LEAVE label1;
  END LOOP label1;
  SET @x = p1;
END;
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="repeat"></a>13.6.5.6 REPEAT Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661028496"></a><a class="indexterm" name="idm140091661027424"></a><pre data-lang="sql" class="programlisting">
[<em class="replaceable"><code>begin_label</code></em>:] REPEAT
    <em class="replaceable"><code>statement_list</code></em>
UNTIL <em class="replaceable"><code>search_condition</code></em>
END REPEAT [<em class="replaceable"><code>end_label</code></em>]
</pre><p>
        The statement list within a
        <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a> statement is repeated
        until the <em class="replaceable"><code>search_condition</code></em> expression
        is true. Thus, a <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a> always
        enters the loop at least once.
        <em class="replaceable"><code>statement_list</code></em> consists of one or
        more statements, each terminated by a semicolon
        (<code class="literal">;</code>) statement delimiter.
      </p><p>
        A <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a> statement can be
        labeled. For the rules regarding label use, see
        <a class="xref" href="sql-syntax.html#statement-labels" title="13.6.2 Statement Label Syntax">Section 13.6.2, “Statement Label Syntax”</a>.
      </p><p>
        Example:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>delimiter //</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE dorepeat(p1 INT)</code></strong>
       <strong class="userinput"><code>BEGIN</code></strong>
         <strong class="userinput"><code>SET @x = 0;</code></strong>
         <strong class="userinput"><code>REPEAT</code></strong>
           <strong class="userinput"><code>SET @x = @x + 1;</code></strong>
         <strong class="userinput"><code>UNTIL @x &gt; p1 END REPEAT;</code></strong>
       <strong class="userinput"><code>END</code></strong>
       <strong class="userinput"><code>//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CALL dorepeat(1000)//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @x//</code></strong>
+------+
| @x   |
+------+
| 1001 |
+------+
1 row in set (0.00 sec)
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="return"></a>13.6.5.7 RETURN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091661002000"></a><pre data-lang="sql" class="programlisting">
RETURN <em class="replaceable"><code>expr</code></em>
</pre><p>
        The <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> statement terminates
        execution of a stored function and returns the value
        <em class="replaceable"><code>expr</code></em> to the function caller. There
        must be at least one <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a>
        statement in a stored function. There may be more than one if
        the function has multiple exit points.
      </p><p>
        This statement is not used in stored procedures, triggers, or
        events. The <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> statement can
        be used to exit a stored program of those types.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="while"></a>13.6.5.8 WHILE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091660989920"></a><pre data-lang="sql" class="programlisting">
[<em class="replaceable"><code>begin_label</code></em>:] WHILE <em class="replaceable"><code>search_condition</code></em> DO
    <em class="replaceable"><code>statement_list</code></em>
END WHILE [<em class="replaceable"><code>end_label</code></em>]
</pre><p>
        The statement list within a <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a>
        statement is repeated as long as the
        <em class="replaceable"><code>search_condition</code></em> expression is true.
        <em class="replaceable"><code>statement_list</code></em> consists of one or
        more SQL statements, each terminated by a semicolon
        (<code class="literal">;</code>) statement delimiter.
      </p><p>
        A <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a> statement can be labeled.
        For the rules regarding label use, see
        <a class="xref" href="sql-syntax.html#statement-labels" title="13.6.2 Statement Label Syntax">Section 13.6.2, “Statement Label Syntax”</a>.
      </p><p>
        Example:
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE dowhile()
BEGIN
  DECLARE v1 INT DEFAULT 5;

  WHILE v1 &gt; 0 DO
    ...
    SET v1 = v1 - 1;
  END WHILE;
END;
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="cursors"></a>13.6.6 Cursors</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#close">13.6.6.1 Cursor CLOSE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#declare-cursor">13.6.6.2 Cursor DECLARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#fetch">13.6.6.3 Cursor FETCH Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#open">13.6.6.4 Cursor OPEN Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091660973424"></a><p>
      MySQL supports cursors inside stored programs. The syntax is as in
      embedded SQL. Cursors have these properties:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Asensitive: The server may or may not make a copy of its
          result table
        </p></li><li class="listitem"><p>
          Read only: Not updatable
        </p></li><li class="listitem"><p>
          Nonscrollable: Can be traversed only in one direction and
          cannot skip rows
</p></li></ul>
</div>
<p>
      Cursor declarations must appear before handler declarations and
      after variable and condition declarations.
    </p><p>
      Example:
    </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE curdemo()
BEGIN
  DECLARE done INT DEFAULT FALSE;
  DECLARE a CHAR(16);
  DECLARE b, c INT;
  DECLARE cur1 CURSOR FOR SELECT id,data FROM test.t1;
  DECLARE cur2 CURSOR FOR SELECT i FROM test.t2;
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;

  OPEN cur1;
  OPEN cur2;

  read_loop: LOOP
    FETCH cur1 INTO a, b;
    FETCH cur2 INTO c;
    IF done THEN
      LEAVE read_loop;
    END IF;
    IF b &lt; c THEN
      INSERT INTO test.t3 VALUES (a,b);
    ELSE
      INSERT INTO test.t3 VALUES (a,c);
    END IF;
  END LOOP;

  CLOSE cur1;
  CLOSE cur2;
END;
</pre>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="close"></a>13.6.6.1 Cursor CLOSE Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091660964960"></a><pre data-lang="sql" class="programlisting">
CLOSE <em class="replaceable"><code>cursor_name</code></em>
</pre><p>
        This statement closes a previously opened cursor. For an
        example, see <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
      </p><p>
        An error occurs if the cursor is not open.
      </p><p>
        If not closed explicitly, a cursor is closed at the end of the
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block in which it was declared.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="declare-cursor"></a>13.6.6.2 Cursor DECLARE Syntax</h4>

</div>

</div>

</div>
<pre data-lang="sql" class="programlisting">
DECLARE <em class="replaceable"><code>cursor_name</code></em> CURSOR FOR <em class="replaceable"><code>select_statement</code></em>
</pre><p>
        This statement declares a cursor and associates it with a
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement that retrieves
        the rows to be traversed by the cursor. To fetch the rows later,
        use a <a class="link" href="sql-syntax.html#fetch" title="13.6.6.3 Cursor FETCH Syntax"><code class="literal">FETCH</code></a> statement. The number
        of columns retrieved by the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement must match the
        number of output variables specified in the
        <a class="link" href="sql-syntax.html#fetch" title="13.6.6.3 Cursor FETCH Syntax"><code class="literal">FETCH</code></a> statement.
      </p><p>
        The <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement cannot have
        an <code class="literal">INTO</code> clause.
      </p><p>
        Cursor declarations must appear before handler declarations and
        after variable and condition declarations.
      </p><p>
        A stored program may contain multiple cursor declarations, but
        each cursor declared in a given block must have a unique name.
        For an example, see <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
      </p><p>
        For information available through
        <a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax"><code class="literal">SHOW</code></a> statements, it is possible
        in many cases to obtain equivalent information by using a cursor
        with an <code class="literal">INFORMATION_SCHEMA</code> table.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="fetch"></a>13.6.6.3 Cursor FETCH Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091660936464"></a><pre data-lang="sql" class="programlisting">
FETCH [[NEXT] FROM] <em class="replaceable"><code>cursor_name</code></em> INTO <em class="replaceable"><code>var_name</code></em> [, <em class="replaceable"><code>var_name</code></em>] ...
</pre><p>
        This statement fetches the next row for the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement associated with
        the specified cursor (which must be open), and advances the
        cursor pointer. If a row exists, the fetched columns are stored
        in the named variables. The number of columns retrieved by the
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement must match the
        number of output variables specified in the
        <a class="link" href="sql-syntax.html#fetch" title="13.6.6.3 Cursor FETCH Syntax"><code class="literal">FETCH</code></a> statement.
      </p><p>
        If no more rows are available, a No Data condition occurs with
        SQLSTATE value <code class="literal">'02000'</code>. To detect this
        condition, you can set up a handler for it (or for a
        <code class="literal">NOT FOUND</code> condition). For an example, see
        <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
      </p><p>
        Be aware that another operation, such as a
        <code class="literal">SELECT</code> or another <code class="literal">FETCH</code>,
        may also cause the handler to execute by raising the same
        condition. If it is necessary to distinguish which operation
        raised the condition, place the operation within its own
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block so that it can be associated with its own
        handler.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="open"></a>13.6.6.4 Cursor OPEN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091660918272"></a><pre data-lang="sql" class="programlisting">
OPEN <em class="replaceable"><code>cursor_name</code></em>
</pre><p>
        This statement opens a previously declared cursor. For an
        example, see <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="condition-handling"></a>13.6.7 Condition Handling</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#declare-condition">13.6.7.1 DECLARE ... CONDITION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#declare-handler">13.6.7.2 DECLARE ... HANDLER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#get-diagnostics">13.6.7.3 GET DIAGNOSTICS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#resignal">13.6.7.4 RESIGNAL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#signal">13.6.7.5 SIGNAL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#handler-scope">13.6.7.6 Scope Rules for Handlers</a></span></dt><dt><span class="section"><a href="sql-syntax.html#diagnostics-area">13.6.7.7 The MySQL Diagnostics Area</a></span></dt><dt><span class="section"><a href="sql-syntax.html#conditions-and-parameters">13.6.7.8 Condition Handling and OUT or INOUT Parameters</a></span></dt></dl>
</div>
<p>
      Conditions may arise during stored program execution that require
      special handling, such as exiting the current program block or
      continuing execution. Handlers can be defined for general
      conditions such as warnings or exceptions, or for specific
      conditions such as a particular error code. Specific conditions
      can be assigned names and referred to that way in handlers.
    </p><p>
      To name a condition, use the
      <a class="link" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax"><code class="literal">DECLARE ...
      CONDITION</code></a> statement. To declare a handler, use the
      <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
      HANDLER</code></a> statement. See
      <a class="xref" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax">Section 13.6.7.1, “DECLARE ... CONDITION Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax">Section 13.6.7.2, “DECLARE ... HANDLER Syntax”</a>. For information about how the
      server chooses handlers when a condition occurs, see
      <a class="xref" href="sql-syntax.html#handler-scope" title="13.6.7.6 Scope Rules for Handlers">Section 13.6.7.6, “Scope Rules for Handlers”</a>.
    </p><p>
      To raise a condition, use the
      <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement. To modify
      condition information within a condition handler, use
      <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>. See
      <a class="xref" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax">Section 13.6.7.1, “DECLARE ... CONDITION Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax">Section 13.6.7.2, “DECLARE ... HANDLER Syntax”</a>.
    </p><p>
      To retrieve information from the diagnostics area, use the
      <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement (see
      <a class="xref" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax">Section 13.6.7.3, “GET DIAGNOSTICS Syntax”</a>). For information about the
      diagnostics area, see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="declare-condition"></a>13.6.7.1 DECLARE ... CONDITION Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091660894736"></a><pre data-lang="sql" class="programlisting">
DECLARE <em class="replaceable"><code>condition_name</code></em> CONDITION FOR <em class="replaceable"><code>condition_value</code></em>

<em class="replaceable"><code>condition_value</code></em>: {
    <em class="replaceable"><code>mysql_error_code</code></em>
  | SQLSTATE [VALUE] <em class="replaceable"><code>sqlstate_value</code></em>
}
</pre><p>
        The <a class="link" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax"><code class="literal">DECLARE
        ... CONDITION</code></a> statement declares a named error
        condition, associating a name with a condition that needs
        specific handling. The name can be referred to in a subsequent
        <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
        HANDLER</code></a> statement (see
        <a class="xref" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax">Section 13.6.7.2, “DECLARE ... HANDLER Syntax”</a>).
      </p><p>
        Condition declarations must appear before cursor or handler
        declarations.
      </p><p>
        The <em class="replaceable"><code>condition_value</code></em> for
        <a class="link" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax"><code class="literal">DECLARE ...
        CONDITION</code></a> indicates the specific condition or class of
        conditions to associate with the condition name. It can take the
        following forms:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <em class="replaceable"><code>mysql_error_code</code></em>: An integer
            literal indicating a MySQL error code.
          </p><p>
            Do not use MySQL error code 0 because that indicates success
            rather than an error condition. For a list of MySQL error
            codes, see <a class="xref" href="error-handling.html#server-error-reference" title="B.3.1 Server Error Message Reference">Section B.3.1, “Server Error Message Reference”</a>.
          </p></li><li class="listitem"><p>
            SQLSTATE [VALUE] <em class="replaceable"><code>sqlstate_value</code></em>:
            A 5-character string literal indicating an SQLSTATE value.
          </p><p>
            Do not use SQLSTATE values that begin with
            <code class="literal">'00'</code> because those indicate success
            rather than an error condition. For a list of SQLSTATE
            values, see <a class="xref" href="error-handling.html#server-error-reference" title="B.3.1 Server Error Message Reference">Section B.3.1, “Server Error Message Reference”</a>.
</p></li></ul>
</div>
<p>
        Condition names referred to in
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> or use
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statements must be
        associated with SQLSTATE values, not MySQL error codes.
      </p><p>
        Using names for conditions can help make stored program code
        clearer. For example, this handler applies to attempts to drop a
        nonexistent table, but that is apparent only if you know that
        1051 is the MySQL error code for <span class="quote">“<span class="quote">unknown table</span>”</span>:
      </p><pre data-lang="sql" class="programlisting">
DECLARE CONTINUE HANDLER FOR 1051
  BEGIN
    -- body of handler
  END;
</pre><p>
        By declaring a name for the condition, the purpose of the
        handler is more readily seen:
      </p><pre data-lang="sql" class="programlisting">
DECLARE no_such_table CONDITION FOR 1051;
DECLARE CONTINUE HANDLER FOR no_such_table
  BEGIN
    -- body of handler
  END;
</pre><p>
        Here is a named condition for the same condition, but based on
        the corresponding SQLSTATE value rather than the MySQL error
        code:
      </p><pre data-lang="sql" class="programlisting">
DECLARE no_such_table CONDITION FOR SQLSTATE '42S02';
DECLARE CONTINUE HANDLER FOR no_such_table
  BEGIN
    -- body of handler
  END;
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="declare-handler"></a>13.6.7.2 DECLARE ... HANDLER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091660865280"></a><pre data-lang="sql" class="programlisting">
DECLARE <em class="replaceable"><code>handler_action</code></em> HANDLER
    FOR <em class="replaceable"><code>condition_value</code></em> [, <em class="replaceable"><code>condition_value</code></em>] ...
    <em class="replaceable"><code>statement</code></em>

<em class="replaceable"><code>handler_action</code></em>: {
    CONTINUE
  | EXIT
  | UNDO
}

<em class="replaceable"><code>condition_value</code></em>: {
    <em class="replaceable"><code>mysql_error_code</code></em>
  | SQLSTATE [VALUE] <em class="replaceable"><code>sqlstate_value</code></em>
  | <em class="replaceable"><code>condition_name</code></em>
  | SQLWARNING
  | NOT FOUND
  | SQLEXCEPTION
}
</pre><p>
        The <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
        HANDLER</code></a> statement specifies a handler that deals with
        one or more conditions. If one of these conditions occurs, the
        specified <em class="replaceable"><code>statement</code></em> executes.
        <em class="replaceable"><code>statement</code></em> can be a simple statement
        such as <code class="literal">SET <em class="replaceable"><code>var_name</code></em> =
        <em class="replaceable"><code>value</code></em></code>, or a compound
        statement written using <code class="literal">BEGIN</code> and
        <code class="literal">END</code> (see <a class="xref" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax">Section 13.6.1, “BEGIN ... END Compound-Statement Syntax”</a>).
      </p><p>
        Handler declarations must appear after variable or condition
        declarations.
      </p><p>
        The <em class="replaceable"><code>handler_action</code></em> value indicates
        what action the handler takes after execution of the handler
        statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">CONTINUE</code>: Execution of the current
            program continues.
          </p></li><li class="listitem"><p>
            <code class="literal">EXIT</code>: Execution terminates for the
            <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
            END</code></a> compound statement in which the handler is
            declared. This is true even if the condition occurs in an
            inner block.
          </p></li><li class="listitem"><p>
            <code class="literal">UNDO</code>: Not supported.
</p></li></ul>
</div>
<p>
        The <em class="replaceable"><code>condition_value</code></em> for
        <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
        HANDLER</code></a> indicates the specific condition or class of
        conditions that activates the handler. It can take the following
        forms:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <em class="replaceable"><code>mysql_error_code</code></em>: An integer
            literal indicating a MySQL error code, such as 1051 to
            specify <span class="quote">“<span class="quote">unknown table</span>”</span>:
          </p><pre data-lang="sql" class="programlisting">
DECLARE CONTINUE HANDLER FOR 1051
  BEGIN
    -- body of handler
  END;
</pre><p>
            Do not use MySQL error code 0 because that indicates success
            rather than an error condition. For a list of MySQL error
            codes, see <a class="xref" href="error-handling.html#server-error-reference" title="B.3.1 Server Error Message Reference">Section B.3.1, “Server Error Message Reference”</a>.
          </p></li><li class="listitem"><p>
            SQLSTATE [VALUE] <em class="replaceable"><code>sqlstate_value</code></em>:
            A 5-character string literal indicating an SQLSTATE value,
            such as <code class="literal">'42S01'</code> to specify <span class="quote">“<span class="quote">unknown
            table</span>”</span>:
          </p><pre data-lang="sql" class="programlisting">
DECLARE CONTINUE HANDLER FOR SQLSTATE '42S02'
  BEGIN
    -- body of handler
  END;
</pre><p>
            Do not use SQLSTATE values that begin with
            <code class="literal">'00'</code> because those indicate success
            rather than an error condition. For a list of SQLSTATE
            values, see <a class="xref" href="error-handling.html#server-error-reference" title="B.3.1 Server Error Message Reference">Section B.3.1, “Server Error Message Reference”</a>.
          </p></li><li class="listitem"><p>
            <em class="replaceable"><code>condition_name</code></em>: A condition name
            previously specified with
            <a class="link" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax"><code class="literal">DECLARE
            ... CONDITION</code></a>. A condition name can be associated
            with a MySQL error code or SQLSTATE value. See
            <a class="xref" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax">Section 13.6.7.1, “DECLARE ... CONDITION Syntax”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">SQLWARNING</code>: Shorthand for the class of
            SQLSTATE values that begin with <code class="literal">'01'</code>.
          </p><pre data-lang="sql" class="programlisting">
DECLARE CONTINUE HANDLER FOR SQLWARNING
  BEGIN
    -- body of handler
  END;
</pre></li><li class="listitem"><p>
            <code class="literal">NOT FOUND</code>: Shorthand for the class of
            SQLSTATE values that begin with <code class="literal">'02'</code>.
            This is relevant within the context of cursors and is used
            to control what happens when a cursor reaches the end of a
            data set. If no more rows are available, a No Data condition
            occurs with SQLSTATE value <code class="literal">'02000'</code>. To
            detect this condition, you can set up a handler for it or
            for a <code class="literal">NOT FOUND</code> condition.
          </p><pre data-lang="sql" class="programlisting">
DECLARE CONTINUE HANDLER FOR NOT FOUND
  BEGIN
    -- body of handler
  END;
</pre><p>
            For another example, see <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>. The
            <code class="literal">NOT FOUND</code> condition also occurs for
            <code class="literal">SELECT ... INTO
            <em class="replaceable"><code>var_list</code></em></code> statements
            that retrieve no rows.
          </p></li><li class="listitem"><p>
            <code class="literal">SQLEXCEPTION</code>: Shorthand for the class of
            SQLSTATE values that do not begin with
            <code class="literal">'00'</code>, <code class="literal">'01'</code>, or
            <code class="literal">'02'</code>.
          </p><pre data-lang="sql" class="programlisting">
DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
  BEGIN
    -- body of handler
  END;
</pre></li></ul>
</div>
<p>
        For information about how the server chooses handlers when a
        condition occurs, see <a class="xref" href="sql-syntax.html#handler-scope" title="13.6.7.6 Scope Rules for Handlers">Section 13.6.7.6, “Scope Rules for Handlers”</a>.
      </p><p>
        If a condition occurs for which no handler has been declared,
        the action taken depends on the condition class:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For <code class="literal">SQLEXCEPTION</code> conditions, the stored
            program terminates at the statement that raised the
            condition, as if there were an <code class="literal">EXIT</code>
            handler. If the program was called by another stored
            program, the calling program handles the condition using the
            handler selection rules applied to its own handlers.
          </p></li><li class="listitem"><p>
            For <code class="literal">SQLWARNING</code> conditions, the program
            continues executing, as if there were a
            <code class="literal">CONTINUE</code> handler.
          </p></li><li class="listitem"><p>
            For <code class="literal">NOT FOUND</code> conditions, if the
            condition was raised normally, the action is
            <code class="literal">CONTINUE</code>. If it was raised by
            <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> or
            <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>, the action is
            <code class="literal">EXIT</code>.
</p></li></ul>
</div>
<p>
        The following example uses a handler for <code class="literal">SQLSTATE
        '23000'</code>, which occurs for a duplicate-key error:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE test.t (s1 INT, PRIMARY KEY (s1));</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>delimiter //</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE handlerdemo ()</code></strong>
       <strong class="userinput"><code>BEGIN</code></strong>
         <strong class="userinput"><code>DECLARE CONTINUE HANDLER FOR SQLSTATE '23000' SET @x2 = 1;</code></strong>
         <strong class="userinput"><code>SET @x = 1;</code></strong>
         <strong class="userinput"><code>INSERT INTO test.t VALUES (1);</code></strong>
         <strong class="userinput"><code>SET @x = 2;</code></strong>
         <strong class="userinput"><code>INSERT INTO test.t VALUES (1);</code></strong>
         <strong class="userinput"><code>SET @x = 3;</code></strong>
       <strong class="userinput"><code>END;</code></strong>
       <strong class="userinput"><code>//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CALL handlerdemo()//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @x//</code></strong>
    +------+
    | @x   |
    +------+
    | 3    |
    +------+
    1 row in set (0.00 sec)
</pre><p>
        Notice that <code class="literal">@x</code> is <code class="literal">3</code> after
        the procedure executes, which shows that execution continued to
        the end of the procedure after the error occurred. If the
        <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
        HANDLER</code></a> statement had not been present, MySQL would
        have taken the default action (<code class="literal">EXIT</code>) after
        the second <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> failed due to
        the <code class="literal">PRIMARY KEY</code> constraint, and
        <code class="literal">SELECT @x</code> would have returned
        <code class="literal">2</code>.
      </p><p>
        To ignore a condition, declare a <code class="literal">CONTINUE</code>
        handler for it and associate it with an empty block. For
        example:
      </p><pre data-lang="sql" class="programlisting">
DECLARE CONTINUE HANDLER FOR SQLWARNING BEGIN END;
</pre><p>
        The scope of a block label does not include the code for
        handlers declared within the block. Therefore, the statement
        associated with a handler cannot use
        <a class="link" href="sql-syntax.html#iterate" title="13.6.5.3 ITERATE Syntax"><code class="literal">ITERATE</code></a> or
        <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> to refer to labels for
        blocks that enclose the handler declaration. Consider the
        following example, where the
        <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a> block has a label of
        <code class="literal">retry</code>:
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p ()
BEGIN
  DECLARE i INT DEFAULT 3;
  retry:
    REPEAT
      BEGIN
        DECLARE CONTINUE HANDLER FOR SQLWARNING
          BEGIN
            ITERATE retry;    # illegal
          END;
        IF i &lt; 0 THEN
          LEAVE retry;        # legal
        END IF;
        SET i = i - 1;
      END;
    UNTIL FALSE END REPEAT;
END;
</pre><p>
        The <code class="literal">retry</code> label is in scope for the
        <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> statement within the block. It
        is not in scope for the <code class="literal">CONTINUE</code> handler, so
        the reference there is invalid and results in an error:
      </p><pre data-lang="none" class="programlisting">
ERROR 1308 (42000): LEAVE with no matching label: retry
</pre><p>
        To avoid references to outer labels in handlers, use one of
        these strategies:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            To leave the block, use an <code class="literal">EXIT</code> handler.
            If no block cleanup is required, the
            <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
            END</code></a> handler body can be empty:
          </p><pre data-lang="sql" class="programlisting">
DECLARE EXIT HANDLER FOR SQLWARNING BEGIN END;
</pre><p>
            Otherwise, put the cleanup statements in the handler body:
          </p><pre data-lang="sql" class="programlisting">
DECLARE EXIT HANDLER FOR SQLWARNING
  BEGIN
    <em class="replaceable"><code>block cleanup statements</code></em>
  END;
</pre></li><li class="listitem"><p>
            To continue execution, set a status variable in a
            <code class="literal">CONTINUE</code> handler that can be checked in
            the enclosing block to determine whether the handler was
            invoked. The following example uses the variable
            <code class="literal">done</code> for this purpose:
          </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p ()
BEGIN
  DECLARE i INT DEFAULT 3;
  DECLARE done INT DEFAULT FALSE;
  retry:
    REPEAT
      BEGIN
        DECLARE CONTINUE HANDLER FOR SQLWARNING
          BEGIN
            SET done = TRUE;
          END;
        IF done OR i &lt; 0 THEN
          LEAVE retry;
        END IF;
        SET i = i - 1;
      END;
    UNTIL FALSE END REPEAT;
END;
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="get-diagnostics"></a>13.6.7.3 GET DIAGNOSTICS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091660752976"></a><pre data-lang="sql" class="programlisting">
GET [CURRENT | STACKED] DIAGNOSTICS
{
    <em class="replaceable"><code>statement_information_item</code></em>
    [, <em class="replaceable"><code>statement_information_item</code></em>] ...
  | CONDITION <em class="replaceable"><code>condition_number</code></em>
    <em class="replaceable"><code>condition_information_item</code></em>
    [, <em class="replaceable"><code>condition_information_item</code></em>] ...
}

<em class="replaceable"><code>statement_information_item</code></em>:
    <em class="replaceable"><code>target</code></em> = <em class="replaceable"><code>statement_information_item_name</code></em>

<em class="replaceable"><code>condition_information_item</code></em>:
    <em class="replaceable"><code>target</code></em> = <em class="replaceable"><code>condition_information_item_name</code></em>

<em class="replaceable"><code>statement_information_item_name</code></em>:
    NUMBER
  | ROW_COUNT

<em class="replaceable"><code>condition_information_item_name</code></em>: {
    CLASS_ORIGIN
  | SUBCLASS_ORIGIN
  | RETURNED_SQLSTATE
  | MESSAGE_TEXT
  | MYSQL_ERRNO
  | CONSTRAINT_CATALOG
  | CONSTRAINT_SCHEMA
  | CONSTRAINT_NAME
  | CATALOG_NAME
  | SCHEMA_NAME
  | TABLE_NAME
  | COLUMN_NAME
  | CURSOR_NAME
}

<em class="replaceable"><code>condition_number</code></em>, <em class="replaceable"><code>target</code></em>:
    (see following discussion)
</pre><p>
        SQL statements produce diagnostic information that populates the
        diagnostics area. The <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a> statement enables applications to inspect
        this information. (You can also use <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW
        WARNINGS</code></a> or <a class="link" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a>
        to see conditions or errors.)
      </p><p>
        No special privileges are required to execute
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a>.
      </p><p>
        The keyword <code class="literal">CURRENT</code> means to retrieve
        information from the current diagnostics area. The keyword
        <code class="literal">STACKED</code> means to retrieve information from
        the second diagnostics area, which is available only if the
        current context is a condition handler. If neither keyword is
        given, the default is to use the current diagnostics area.
      </p><p>
        The <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement is
        typically used in a handler within a stored program. It is a
        MySQL extension that
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET [CURRENT]
        DIAGNOSTICS</code></a> is permitted outside handler context to
        check the execution of any SQL statement. For example, if you
        invoke the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client program, you can
        enter these statements at the prompt:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>DROP TABLE test.no_such_table;</code></strong>
ERROR 1051 (42S02): Unknown table 'test.no_such_table'
mysql&gt; <strong class="userinput"><code>GET DIAGNOSTICS CONDITION 1</code></strong>
         <strong class="userinput"><code>@p1 = RETURNED_SQLSTATE, @p2 = MESSAGE_TEXT;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @p1, @p2;</code></strong>
+-------+------------------------------------+
| @p1   | @p2                                |
+-------+------------------------------------+
| 42S02 | Unknown table 'test.no_such_table' |
+-------+------------------------------------+
</pre><p>
        This extension applies only to the current diagnostics area. It
        does not apply to the second diagnostics area because
        <code class="literal">GET STACKED DIAGNOSTICS</code> is permitted only if
        the current context is a condition handler. If that is not the
        case, a <code class="literal">GET STACKED DIAGNOSTICS when handler not
        active</code> error occurs.
      </p><p>
        For a description of the diagnostics area, see
        <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>. Briefly, it contains two
        kinds of information:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Statement information, such as the number of conditions that
            occurred or the affected-rows count.
          </p></li><li class="listitem"><p>
            Condition information, such as the error code and message.
            If a statement raises multiple conditions, this part of the
            diagnostics area has a condition area for each one. If a
            statement raises no conditions, this part of the diagnostics
            area is empty.
</p></li></ul>
</div>
<p>
        For a statement that produces three conditions, the diagnostics
        area contains statement and condition information like this:
      </p><pre data-lang="none" class="programlisting">
Statement information:
  row count
  ... other statement information items ...
Condition area list:
  Condition area 1:
    error code for condition 1
    error message for condition 1
    ... other condition information items ...
  Condition area 2:
    error code for condition 2:
    error message for condition 2
    ... other condition information items ...
  Condition area 3:
    error code for condition 3
    error message for condition 3
    ... other condition information items ...
</pre><p>
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> can obtain either
        statement or condition information, but not both in the same
        statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            To obtain statement information, retrieve the desired
            statement items into target variables. This instance of
            <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> assigns the
            number of available conditions and the rows-affected count
            to the user variables <code class="literal">@p1</code> and
            <code class="literal">@p2</code>:
          </p><pre data-lang="sql" class="programlisting">
GET DIAGNOSTICS @p1 = NUMBER, @p2 = ROW_COUNT;
</pre></li><li class="listitem"><p>
            To obtain condition information, specify the condition
            number and retrieve the desired condition items into target
            variables. This instance of <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
            DIAGNOSTICS</code></a> assigns the SQLSTATE value and error
            message to the user variables <code class="literal">@p3</code> and
            <code class="literal">@p4</code>:
          </p><pre data-lang="sql" class="programlisting">
GET DIAGNOSTICS CONDITION 1
  @p3 = RETURNED_SQLSTATE, @p4 = MESSAGE_TEXT;
</pre></li></ul>
</div>
<p>
        The retrieval list specifies one or more
        <code class="literal"><em class="replaceable"><code>target</code></em> =
        <em class="replaceable"><code>item_name</code></em></code> assignments,
        separated by commas. Each assignment names a target variable and
        either a
        <em class="replaceable"><code>statement_information_item_name</code></em> or
        <em class="replaceable"><code>condition_information_item_name</code></em>
        designator, depending on whether the statement retrieves
        statement or condition information.
      </p><p>
        Valid <em class="replaceable"><code>target</code></em> designators for storing
        item information can be stored procedure or function parameters,
        stored program local variables declared with
        <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a>, or user-defined
        variables.
      </p><p>
        Valid <em class="replaceable"><code>condition_number</code></em> designators
        can be stored procedure or function parameters, stored program
        local variables declared with
        <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a>, user-defined variables,
        system variables, or literals. A character literal may include a
        <em class="replaceable"><code>_charset</code></em> introducer. A warning occurs
        if the condition number is not in the range from 1 to the number
        of condition areas that have information. In this case, the
        warning is added to the diagnostics area without clearing it.
      </p><p>
        When a condition occurs, MySQL does not populate all condition
        items recognized by <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a>. For example:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>GET DIAGNOSTICS CONDITION 1</code></strong>
         <strong class="userinput"><code>@p5 = SCHEMA_NAME, @p6 = TABLE_NAME;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @p5, @p6;</code></strong>
+------+------+
| @p5  | @p6  |
+------+------+
|      |      |
+------+------+
</pre><p>
        In standard SQL, if there are multiple conditions, the first
        condition relates to the <code class="literal">SQLSTATE</code> value
        returned for the previous SQL statement. In MySQL, this is not
        guaranteed. To get the main error, you cannot do this:
      </p><pre data-lang="sql" class="programlisting">
GET DIAGNOSTICS CONDITION 1 @errno = MYSQL_ERRNO;
</pre><p>
        Instead, retrieve the condition count first, then use it to
        specify which condition number to inspect:
      </p><pre data-lang="sql" class="programlisting">
GET DIAGNOSTICS @cno = NUMBER;
GET DIAGNOSTICS CONDITION @cno @errno = MYSQL_ERRNO;
</pre><p>
        For information about permissible statement and condition
        information items, and which ones are populated when a condition
        occurs, see
        <a class="xref" href="sql-syntax.html#diagnostics-area-information-items" title="Diagnostics Area Information Items">Diagnostics Area Information Items</a>.
      </p><p>
        Here is an example that uses <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a> and an exception handler in stored
        procedure context to assess the outcome of an insert operation.
        If the insert was successful, the procedure uses
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> to get the
        rows-affected count. This shows that you can use
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> multiple times to
        retrieve information about a statement as long as the current
        diagnostics area has not been cleared.
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE do_insert(value INT)
BEGIN
  -- Declare variables to hold diagnostics area information
  DECLARE code CHAR(5) DEFAULT '00000';
  DECLARE msg TEXT;
  DECLARE rows INT;
  DECLARE result TEXT;
  -- Declare exception handler for failed insert
  DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
    BEGIN
      GET DIAGNOSTICS CONDITION 1
        code = RETURNED_SQLSTATE, msg = MESSAGE_TEXT;
    END;

  -- Perform the insert
  INSERT INTO t1 (int_col) VALUES(value);
  -- Check whether the insert was successful
  IF code = '00000' THEN
    GET DIAGNOSTICS rows = ROW_COUNT;
    SET result = CONCAT('insert succeeded, row count = ',rows);
  ELSE
    SET result = CONCAT('insert failed, error = ',code,', message = ',msg);
  END IF;
  -- Say what happened
  SELECT result;
END;
</pre><p>
        Suppose that <code class="literal">t1.int_col</code> is an integer column
        that is declared as <code class="literal">NOT NULL</code>. The procedure
        produces these results when invoked to insert
        non-<code class="literal">NULL</code> and <code class="literal">NULL</code> values,
        respectively:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL do_insert(1);</code></strong>
+---------------------------------+
| result                          |
+---------------------------------+
| insert succeeded, row count = 1 |
+---------------------------------+

mysql&gt; <strong class="userinput"><code>CALL do_insert(NULL);</code></strong>
+-------------------------------------------------------------------------+
| result                                                                  |
+-------------------------------------------------------------------------+
| insert failed, error = 23000, message = Column 'int_col' cannot be null |
+-------------------------------------------------------------------------+
</pre><p>
        When a condition handler activates, a push to the diagnostics
        area stack occurs:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The first (current) diagnostics area becomes the second
            (stacked) diagnostics area and a new current diagnostics
            area is created as a copy of it.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
            [CURRENT] DIAGNOSTICS</code></a> and
            <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET STACKED
            DIAGNOSTICS</code></a> can be used within the handler to
            access the contents of the current and stacked diagnostics
            areas.
          </p></li><li class="listitem"><p>
            Initially, both diagnostics areas return the same result, so
            it is possible to get information from the current
            diagnostics area about the condition that activated the
            handler, <span class="emphasis"><em>as long as</em></span> you execute no
            statements within the handler that change its current
            diagnostics area.
          </p></li><li class="listitem"><p>
            However, statements executing within the handler can modify
            the current diagnostics area, clearing and setting its
            contents according to the normal rules (see
            <a class="xref" href="sql-syntax.html#diagnostics-area-populating" title="How the Diagnostics Area is Cleared and Populated">How the Diagnostics Area is Cleared and Populated</a>).
          </p><p>
            A more reliable way to obtain information about the
            handler-activating condition is to use the stacked
            diagnostics area, which cannot be modified by statements
            executing within the handler except
            <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>. For information
            about when the current diagnostics area is set and cleared,
            see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
</p></li></ul>
</div>
<p>
        The next example shows how <code class="literal">GET STACKED
        DIAGNOSTICS</code> can be used within a handler to obtain
        information about the handled exception, even after the current
        diagnostics area has been modified by handler statements.
      </p><p>
        Within a stored procedure <code class="literal">p()</code>, we attempt to
        insert two values into a table that contains a <code class="literal">TEXT NOT
        NULL</code> column. The first value is a
        non-<code class="literal">NULL</code> string and the second is
        <code class="literal">NULL</code>. The column prohibits
        <code class="literal">NULL</code> values, so the first insert succeeds but
        the second causes an exception. The procedure includes an
        exception handler that maps attempts to insert
        <code class="literal">NULL</code> into inserts of the empty string:
      </p><pre data-lang="sql" class="programlisting">
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (c1 TEXT NOT NULL);
DROP PROCEDURE IF EXISTS p;
delimiter //
CREATE PROCEDURE p ()
BEGIN
  -- Declare variables to hold diagnostics area information
  DECLARE errcount INT;
  DECLARE errno INT;
  DECLARE msg TEXT;
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    -- Here the current DA is nonempty because no prior statements
    -- executing within the handler have cleared it
    GET CURRENT DIAGNOSTICS CONDITION 1
      errno = MYSQL_ERRNO, msg = MESSAGE_TEXT;
    SELECT 'current DA before mapped insert' AS op, errno, msg;
    GET STACKED DIAGNOSTICS CONDITION 1
      errno = MYSQL_ERRNO, msg = MESSAGE_TEXT;
    SELECT 'stacked DA before mapped insert' AS op, errno, msg;

    -- Map attempted NULL insert to empty string insert
    INSERT INTO t1 (c1) VALUES('');

    -- Here the current DA should be empty (if the INSERT succeeded),
    -- so check whether there are conditions before attempting to
    -- obtain condition information
    GET CURRENT DIAGNOSTICS errcount = NUMBER;
    IF errcount = 0
    THEN
      SELECT 'mapped insert succeeded, current DA is empty' AS op;
    ELSE
      GET CURRENT DIAGNOSTICS CONDITION 1
        errno = MYSQL_ERRNO, msg = MESSAGE_TEXT;
      SELECT 'current DA after mapped insert' AS op, errno, msg;
    END IF ;
    GET STACKED DIAGNOSTICS CONDITION 1
      errno = MYSQL_ERRNO, msg = MESSAGE_TEXT;
    SELECT 'stacked DA after mapped insert' AS op, errno, msg;
  END;
  INSERT INTO t1 (c1) VALUES('string 1');
  INSERT INTO t1 (c1) VALUES(NULL);
END;
//
delimiter ;
CALL p();
SELECT * FROM t1;
</pre><p>
        When the handler activates, a copy of the current diagnostics
        area is pushed to the diagnostics area stack. The handler first
        displays the contents of the current and stacked diagnostics
        areas, which are both the same initially:
      </p><pre data-lang="none" class="programlisting">
+---------------------------------+-------+----------------------------+
| op                              | errno | msg                        |
+---------------------------------+-------+----------------------------+
| current DA before mapped insert |  1048 | Column 'c1' cannot be null |
+---------------------------------+-------+----------------------------+

+---------------------------------+-------+----------------------------+
| op                              | errno | msg                        |
+---------------------------------+-------+----------------------------+
| stacked DA before mapped insert |  1048 | Column 'c1' cannot be null |
+---------------------------------+-------+----------------------------+
</pre><p>
        Statements executing after the <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a> statements may reset the current
        diagnostics area. statements may reset the current diagnostics
        area. For example, the handler maps the <code class="literal">NULL</code>
        insert to an empty-string insert and displays the result. The
        new insert succeeds and clears the current diagnostics area, but
        the stacked diagnostics area remains unchanged and still
        contains information about the condition that activated the
        handler:
      </p><pre data-lang="none" class="programlisting">
+----------------------------------------------+
| op                                           |
+----------------------------------------------+
| mapped insert succeeded, current DA is empty |
+----------------------------------------------+

+--------------------------------+-------+----------------------------+
| op                             | errno | msg                        |
+--------------------------------+-------+----------------------------+
| stacked DA after mapped insert |  1048 | Column 'c1' cannot be null |
+--------------------------------+-------+----------------------------+
</pre><p>
        When the condition handler ends, its current diagnostics area is
        popped from the stack and the stacked diagnostics area becomes
        the current diagnostics area in the stored procedure.
      </p><p>
        After the procedure returns, the table contains two rows. The
        empty row results from the attempt to insert
        <code class="literal">NULL</code> that was mapped to an empty-string
        insert:
      </p><pre data-lang="none" class="programlisting">
+----------+
| c1       |
+----------+
| string 1 |
|          |
+----------+
</pre><p>
        In the preceding example, the first two <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a> statements within the condition handler
        that retrieve information from the current and stacked
        diagnostics areas return the same values. This will not be the
        case if statements that reset the current diagnostics area
        execute earlier within the handler. Suppose that
        <code class="literal">p()</code> is rewritten to place the
        <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a> statements within the
        handler definition rather than preceding it:
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    -- Declare variables to hold diagnostics area information
    DECLARE errcount INT;
    DECLARE errno INT;
    DECLARE msg TEXT;
    GET CURRENT DIAGNOSTICS CONDITION 1
      errno = MYSQL_ERRNO, msg = MESSAGE_TEXT;
    SELECT 'current DA before mapped insert' AS op, errno, msg;
    GET STACKED DIAGNOSTICS CONDITION 1
      errno = MYSQL_ERRNO, msg = MESSAGE_TEXT;
    SELECT 'stacked DA before mapped insert' AS op, errno, msg;
...
</pre><p>
        In this case, the result is version dependent:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Before MySQL 5.7.2, <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a>
            does not change the current diagnostics area, so the first
            two <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a>
            statements return the same result, just as in the original
            version of <code class="literal">p()</code>.
          </p><p>
            In MySQL 5.7.2, work was done to ensure that all
            nondiagnostic statements populate the diagnostics area, per
            the SQL standard. <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a> is
            one of them, so in 5.7.2 and higher,
            <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a> statements executing
            at the beginning of the handler clear the current
            diagnostics area and the <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
            DIAGNOSTICS</code></a> statements produce different results:
          </p><pre data-lang="none" class="programlisting">
+---------------------------------+-------+------+
| op                              | errno | msg  |
+---------------------------------+-------+------+
| current DA before mapped insert |  NULL | NULL |
+---------------------------------+-------+------+

+---------------------------------+-------+----------------------------+
| op                              | errno | msg                        |
+---------------------------------+-------+----------------------------+
| stacked DA before mapped insert |  1048 | Column 'c1' cannot be null |
+---------------------------------+-------+----------------------------+
</pre></li></ul>
</div>
<p>
        To avoid this issue within a condition handler when seeking to
        obtain information about the condition that activated the
        handler, be sure to access the stacked diagnostics area, not the
        current diagnostics area.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="resignal"></a>13.6.7.4 RESIGNAL Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091660624592"></a><pre data-lang="sql" class="programlisting">
RESIGNAL [<em class="replaceable"><code>condition_value</code></em>]
    [SET <em class="replaceable"><code>signal_information_item</code></em>
    [, <em class="replaceable"><code>signal_information_item</code></em>] ...]

<em class="replaceable"><code>condition_value</code></em>: {
    SQLSTATE [VALUE] <em class="replaceable"><code>sqlstate_value</code></em>
  | <em class="replaceable"><code>condition_name</code></em>
}

<em class="replaceable"><code>signal_information_item</code></em>:
    <em class="replaceable"><code>condition_information_item_name</code></em> = <em class="replaceable"><code>simple_value_specification</code></em>

<em class="replaceable"><code>condition_information_item_name</code></em>: {
    CLASS_ORIGIN
  | SUBCLASS_ORIGIN
  | MESSAGE_TEXT
  | MYSQL_ERRNO
  | CONSTRAINT_CATALOG
  | CONSTRAINT_SCHEMA
  | CONSTRAINT_NAME
  | CATALOG_NAME
  | SCHEMA_NAME
  | TABLE_NAME
  | COLUMN_NAME
  | CURSOR_NAME
}

<em class="replaceable"><code>condition_name</code></em>, <em class="replaceable"><code>simple_value_specification</code></em>:
    (see following discussion)
</pre><p>
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> passes on the error
        condition information that is available during execution of a
        condition handler within a compound statement inside a stored
        procedure or function, trigger, or event.
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> may change some or all
        information before passing it on.
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> is related to
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>, but instead of
        originating a condition as <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>
        does, <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> relays existing
        condition information, possibly after modifying it.
      </p><p>
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> makes it possible to
        both handle an error and return the error information.
        Otherwise, by executing an SQL statement within the handler,
        information that caused the handler's activation is destroyed.
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> also can make some
        procedures shorter if a given handler can handle part of a
        situation, then pass the condition <span class="quote">“<span class="quote">up the line</span>”</span> to
        another handler.
      </p><p>
        No privileges are required to execute the
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement.
      </p><p>
        All forms of <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> require
        that the current context be a condition handler. Otherwise,
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> is illegal and a
        <code class="literal">RESIGNAL when handler not active</code> error
        occurs.
      </p><p>
        To retrieve information from the diagnostics area, use the
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement (see
        <a class="xref" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax">Section 13.6.7.3, “GET DIAGNOSTICS Syntax”</a>). For information about the
        diagnostics area, see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#resignal-overview" title="RESIGNAL Overview">RESIGNAL Overview</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#resignal-alone" title="RESIGNAL Alone">RESIGNAL Alone</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#resignal-with-new-signal" title="RESIGNAL with New Signal Information">RESIGNAL with New Signal Information</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#resignal-with-condition" title="RESIGNAL with a Condition Value and Optional New Signal Information">RESIGNAL with a Condition Value and Optional New Signal Information</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#resignal-handler" title="RESIGNAL Requires Condition Handler Context">RESIGNAL Requires Condition Handler Context</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="resignal-overview"></a>RESIGNAL Overview</h5>

</div>

</div>

</div>
<p>
          For <em class="replaceable"><code>condition_value</code></em> and
          <em class="replaceable"><code>signal_information_item</code></em>, the
          definitions and rules are the same for
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> as for
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>. For example, the
          <em class="replaceable"><code>condition_value</code></em> can be an
          <code class="literal">SQLSTATE</code> value, and the value can indicate
          errors, warnings, or <span class="quote">“<span class="quote">not found.</span>”</span> For additional
          information, see <a class="xref" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax">Section 13.6.7.5, “SIGNAL Syntax”</a>.
        </p><p>
          The <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement takes
          <em class="replaceable"><code>condition_value</code></em> and
          <code class="literal">SET</code> clauses, both of which are optional.
          This leads to several possible uses:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone:
            </p><pre data-lang="sql" class="programlisting">
RESIGNAL;
</pre></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> with new signal
              information:
            </p><pre data-lang="sql" class="programlisting">
RESIGNAL SET <em class="replaceable"><code>signal_information_item</code></em> [, <em class="replaceable"><code>signal_information_item</code></em>] ...;
</pre></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> with a condition
              value and possibly new signal information:
            </p><pre data-lang="sql" class="programlisting">
RESIGNAL <em class="replaceable"><code>condition_value</code></em>
    [SET <em class="replaceable"><code>signal_information_item</code></em> [, <em class="replaceable"><code>signal_information_item</code></em>] ...];
</pre></li></ul>
</div>
<p>
          These use cases all cause changes to the diagnostics and
          condition areas:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              A diagnostics area contains one or more condition areas.
            </p></li><li class="listitem"><p>
              A condition area contains condition information items,
              such as the <code class="literal">SQLSTATE</code> value,
              <code class="literal">MYSQL_ERRNO</code>, or
              <code class="literal">MESSAGE_TEXT</code>.
</p></li></ul>
</div>
<p>
          There is a stack of diagnostics areas. When a handler takes
          control, it pushes a diagnostics area to the top of the stack,
          so there are two diagnostics areas during handler execution:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              The first (current) diagnostics area, which starts as a
              copy of the last diagnostics area, but will be overwritten
              by the first statement in the handler that changes the
              current diagnostics area.
            </p></li><li class="listitem"><p>
              The last (stacked) diagnostics area, which has the
              condition areas that were set up before the handler took
              control.
</p></li></ul>
</div>
<p>
          The maximum number of condition areas in a diagnostics area is
          determined by the value of the
          <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> system
          variable. See
          <a class="xref" href="sql-syntax.html#diagnostics-area-system-variables" title="Diagnostics Area-Related System Variables">Diagnostics Area-Related System Variables</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="resignal-alone"></a>RESIGNAL Alone</h5>

</div>

</div>

</div>
<p>
          A simple <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone means
          <span class="quote">“<span class="quote">pass on the error with no change.</span>”</span> It restores
          the last diagnostics area and makes it the current diagnostics
          area. That is, it <span class="quote">“<span class="quote">pops</span>”</span> the diagnostics area
          stack.
        </p><p>
          Within a condition handler that catches a condition, one use
          for <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone is to
          perform some other actions, and then pass on without change
          the original condition information (the information that
          existed before entry into the handler).
        </p><p>
          Example:
        </p><pre data-lang="sql" class="programlisting">
DROP TABLE IF EXISTS xx;
delimiter //
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    SET @error_count = @error_count + 1;
    IF @a = 0 THEN RESIGNAL; END IF;
  END;
  DROP TABLE xx;
END//
delimiter ;
SET @error_count = 0;
SET @a = 0;
CALL p();
</pre><p>
          Suppose that the <code class="literal">DROP TABLE xx</code> statement
          fails. The diagnostics area stack looks like this:
        </p><pre data-lang="none" class="programlisting">
DA 1. ERROR 1051 (42S02): Unknown table 'xx'
</pre><p>
          Then execution enters the <code class="literal">EXIT</code> handler. It
          starts by pushing a diagnostics area to the top of the stack,
          which now looks like this:
        </p><pre data-lang="none" class="programlisting">
DA 1. ERROR 1051 (42S02): Unknown table 'xx'
DA 2. ERROR 1051 (42S02): Unknown table 'xx'
</pre><p>
          At this point, the contents of the first (current) and second
          (stacked) diagnostics areas are the same. The first
          diagnostics area may be modified by statements executing
          subsequently within the handler.
        </p><p>
          Usually a procedure statement clears the first diagnostics
          area. <code class="literal">BEGIN</code> is an exception, it does not
          clear, it does nothing. <code class="literal">SET</code> is not an
          exception, it clears, performs the operation, and produces a
          result of <span class="quote">“<span class="quote">success.</span>”</span> The diagnostics area stack
          now looks like this:
        </p><pre data-lang="none" class="programlisting">
DA 1. ERROR 0000 (00000): Successful operation
DA 2. ERROR 1051 (42S02): Unknown table 'xx'
</pre><p>
          At this point, if <code class="literal">@a = 0</code>,
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> pops the diagnostics
          area stack, which now looks like this:
        </p><pre data-lang="none" class="programlisting">
DA 1. ERROR 1051 (42S02): Unknown table 'xx'
</pre><p>
          And that is what the caller sees.
        </p><p>
          If <code class="literal">@a</code> is not 0, the handler simply ends,
          which means that there is no more use for the current
          diagnostics area (it has been <span class="quote">“<span class="quote">handled</span>”</span>), so it
          can be thrown away, causing the stacked diagnostics area to
          become the current diagnostics area again. The diagnostics
          area stack looks like this:
        </p><pre data-lang="none" class="programlisting">
DA 1. ERROR 0000 (00000): Successful operation
</pre><p>
          The details make it look complex, but the end result is quite
          useful: Handlers can execute without destroying information
          about the condition that caused activation of the handler.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="resignal-with-new-signal"></a>RESIGNAL with New Signal Information</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> with a
          <code class="literal">SET</code> clause provides new signal information,
          so the statement means <span class="quote">“<span class="quote">pass on the error with
          changes</span>”</span>:
        </p><pre data-lang="sql" class="programlisting">
RESIGNAL SET <em class="replaceable"><code>signal_information_item</code></em> [, <em class="replaceable"><code>signal_information_item</code></em>] ...;
</pre><p>
          As with <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone, the
          idea is to pop the diagnostics area stack so that the original
          information will go out. Unlike
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone, anything
          specified in the <code class="literal">SET</code> clause changes.
        </p><p>
          Example:
        </p><pre data-lang="sql" class="programlisting">
DROP TABLE IF EXISTS xx;
delimiter //
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    SET @error_count = @error_count + 1;
    IF @a = 0 THEN RESIGNAL SET MYSQL_ERRNO = 5; END IF;
  END;
  DROP TABLE xx;
END//
delimiter ;
SET @error_count = 0;
SET @a = 0;
CALL p();
</pre><p>
          Remember from the previous discussion that
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone results in a
          diagnostics area stack like this:
        </p><pre data-lang="none" class="programlisting">
DA 1. ERROR 1051 (42S02): Unknown table 'xx'
</pre><p>
          The <code class="literal">RESIGNAL SET MYSQL_ERRNO = 5</code> statement
          results in this stack instead, which is what the caller sees:
        </p><pre data-lang="none" class="programlisting">
DA 1. ERROR 5 (42S02): Unknown table 'xx'
</pre><p>
          In other words, it changes the error number, and nothing else.
        </p><p>
          The <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement can
          change any or all of the signal information items, making the
          first condition area of the diagnostics area look quite
          different.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="resignal-with-condition"></a>RESIGNAL with a Condition Value and Optional New Signal Information</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> with a condition value
          means <span class="quote">“<span class="quote">push a condition into the current diagnostics
          area.</span>”</span> If the <code class="literal">SET</code> clause is present,
          it also changes the error information.
        </p><pre data-lang="sql" class="programlisting">
RESIGNAL <em class="replaceable"><code>condition_value</code></em>
    [SET <em class="replaceable"><code>signal_information_item</code></em> [, <em class="replaceable"><code>signal_information_item</code></em>] ...];
</pre><p>
          This form of <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> restores
          the last diagnostics area and makes it the current diagnostics
          area. That is, it <span class="quote">“<span class="quote">pops</span>”</span> the diagnostics area
          stack, which is the same as what a simple
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone would do.
          However, it also changes the diagnostics area depending on the
          condition value or signal information.
        </p><p>
          Example:
        </p><pre data-lang="sql" class="programlisting">
DROP TABLE IF EXISTS xx;
delimiter //
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    SET @error_count = @error_count + 1;
    IF @a = 0 THEN RESIGNAL SQLSTATE '45000' SET MYSQL_ERRNO=5; END IF;
  END;
  DROP TABLE xx;
END//
delimiter ;
SET @error_count = 0;
SET @a = 0;
SET @@max_error_count = 2;
CALL p();
SHOW ERRORS;
</pre><p>
          This is similar to the previous example, and the effects are
          the same, except that if
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> happens, the current
          condition area looks different at the end. (The reason the
          condition adds to rather than replaces the existing condition
          is the use of a condition value.)
        </p><p>
          The <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement includes
          a condition value (<code class="literal">SQLSTATE '45000'</code>), so it
          adds a new condition area, resulting in a diagnostics area
          stack that looks like this:
        </p><pre data-lang="none" class="programlisting">
DA 1. (condition 2) ERROR 1051 (42S02): Unknown table 'xx'
      (condition 1) ERROR 5 (45000) Unknown table 'xx'
</pre><p>
          The result of <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL
          p()</code></a> and <a class="link" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a>
          for this example is:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL p();</code></strong>
ERROR 5 (45000): Unknown table 'xx'
mysql&gt; <strong class="userinput"><code>SHOW ERRORS;</code></strong>
+-------+------+----------------------------------+
| Level | Code | Message                          |
+-------+------+----------------------------------+
| Error | 1051 | Unknown table 'xx'               |
| Error |    5 | Unknown table 'xx'               |
+-------+------+----------------------------------+
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="resignal-handler"></a>RESIGNAL Requires Condition Handler Context</h5>

</div>

</div>

</div>
<p>
          All forms of <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> require
          that the current context be a condition handler. Otherwise,
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> is illegal and a
          <code class="literal">RESIGNAL when handler not active</code> error
          occurs. For example:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE p () RESIGNAL;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CALL p();</code></strong>
ERROR 1645 (0K000): RESIGNAL when handler not active
</pre><p>
          Here is a more difficult example:
        </p><pre data-lang="sql" class="programlisting">
delimiter //
CREATE FUNCTION f () RETURNS INT
BEGIN
  RESIGNAL;
  RETURN 5;
END//
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION SET @a=f();
  SIGNAL SQLSTATE '55555';
END//
delimiter ;
CALL p();
</pre><p>
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> occurs within the
          stored function <code class="literal">f()</code>. Although
          <code class="literal">f()</code> itself is invoked within the context of
          the <code class="literal">EXIT</code> handler, execution within
          <code class="literal">f()</code> has its own context, which is not
          handler context. Thus, <code class="literal">RESIGNAL</code> within
          <code class="literal">f()</code> results in a <span class="quote">“<span class="quote">handler not
          active</span>”</span> error.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="signal"></a>13.6.7.5 SIGNAL Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091660473680"></a><pre data-lang="sql" class="programlisting">
SIGNAL <em class="replaceable"><code>condition_value</code></em>
    [SET <em class="replaceable"><code>signal_information_item</code></em>
    [, <em class="replaceable"><code>signal_information_item</code></em>] ...]

<em class="replaceable"><code>condition_value</code></em>: {
    SQLSTATE [VALUE] <em class="replaceable"><code>sqlstate_value</code></em>
  | <em class="replaceable"><code>condition_name</code></em>
}

<em class="replaceable"><code>signal_information_item</code></em>:
    <em class="replaceable"><code>condition_information_item_name</code></em> = <em class="replaceable"><code>simple_value_specification</code></em>

<em class="replaceable"><code>condition_information_item_name</code></em>: {
    CLASS_ORIGIN
  | SUBCLASS_ORIGIN
  | MESSAGE_TEXT
  | MYSQL_ERRNO
  | CONSTRAINT_CATALOG
  | CONSTRAINT_SCHEMA
  | CONSTRAINT_NAME
  | CATALOG_NAME
  | SCHEMA_NAME
  | TABLE_NAME
  | COLUMN_NAME
  | CURSOR_NAME
}

<em class="replaceable"><code>condition_name</code></em>, <em class="replaceable"><code>simple_value_specification</code></em>:
    (see following discussion)
</pre><p>
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> is the way to
        <span class="quote">“<span class="quote">return</span>”</span> an error.
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> provides error information
        to a handler, to an outer portion of the application, or to the
        client. Also, it provides control over the error's
        characteristics (error number, <code class="literal">SQLSTATE</code>
        value, message). Without <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>,
        it is necessary to resort to workarounds such as deliberately
        referring to a nonexistent table to cause a routine to return an
        error.
      </p><p>
        No privileges are required to execute the
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement.
      </p><p>
        To retrieve information from the diagnostics area, use the
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement (see
        <a class="xref" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax">Section 13.6.7.3, “GET DIAGNOSTICS Syntax”</a>). For information about the
        diagnostics area, see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#signal-overview" title="SIGNAL Overview">SIGNAL Overview</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#signal-condition-information-items" title="Signal Condition Information Items">Signal Condition Information Items</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#signal-effects" title="Effect of Signals on Handlers, Cursors, and Statements">Effect of Signals on Handlers, Cursors, and Statements</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="signal-overview"></a>SIGNAL Overview</h5>

</div>

</div>

</div>
<p>
          The <em class="replaceable"><code>condition_value</code></em> in a
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement indicates the
          error value to be returned. It can be an
          <code class="literal">SQLSTATE</code> value (a 5-character string
          literal) or a <em class="replaceable"><code>condition_name</code></em> that
          refers to a named condition previously defined with
          <a class="link" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax"><code class="literal">DECLARE ...
          CONDITION</code></a> (see <a class="xref" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax">Section 13.6.7.1, “DECLARE ... CONDITION Syntax”</a>).
        </p><p>
          An <code class="literal">SQLSTATE</code> value can indicate errors,
          warnings, or <span class="quote">“<span class="quote">not found.</span>”</span> The first two
          characters of the value indicate its error class, as discussed
          in <a class="xref" href="sql-syntax.html#signal-condition-information-items" title="Signal Condition Information Items">Signal Condition Information Items</a>. Some
          signal values cause statement termination; see
          <a class="xref" href="sql-syntax.html#signal-effects" title="Effect of Signals on Handlers, Cursors, and Statements">Effect of Signals on Handlers, Cursors, and Statements</a>.
        </p><p>
          The <code class="literal">SQLSTATE</code> value for a
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement should not
          start with <code class="literal">'00'</code> because such values
          indicate success and are not valid for signaling an error.
          This is true whether the <code class="literal">SQLSTATE</code> value is
          specified directly in the
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement or in a named
          condition referred to in the statement. If the value is
          invalid, a <code class="literal">Bad SQLSTATE</code> error occurs.
        </p><p>
          To signal a generic <code class="literal">SQLSTATE</code> value, use
          <code class="literal">'45000'</code>, which means <span class="quote">“<span class="quote">unhandled
          user-defined exception.</span>”</span>
        </p><p>
          The <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement optionally
          includes a <code class="literal">SET</code> clause that contains
          multiple signal items, in a list of
          <em class="replaceable"><code>condition_information_item_name</code></em> =
          <em class="replaceable"><code>simple_value_specification</code></em>
          assignments, separated by commas.
        </p><p>
          Each
          <em class="replaceable"><code>condition_information_item_name</code></em> may
          be specified only once in the <code class="literal">SET</code> clause.
          Otherwise, a <code class="literal">Duplicate condition information
          item</code> error occurs.
        </p><p>
          Valid <em class="replaceable"><code>simple_value_specification</code></em>
          designators can be specified using stored procedure or
          function parameters, stored program local variables declared
          with <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a>, user-defined
          variables, system variables, or literals. A character literal
          may include a <em class="replaceable"><code>_charset</code></em> introducer.
        </p><p>
          For information about permissible
          <em class="replaceable"><code>condition_information_item_name</code></em>
          values, see
          <a class="xref" href="sql-syntax.html#signal-condition-information-items" title="Signal Condition Information Items">Signal Condition Information Items</a>.
        </p><p>
          The following procedure signals an error or warning depending
          on the value of <code class="literal">pval</code>, its input parameter:
        </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p (pval INT)
BEGIN
  DECLARE specialty CONDITION FOR SQLSTATE '45000';
  IF pval = 0 THEN
    SIGNAL SQLSTATE '01000';
  ELSEIF pval = 1 THEN
    SIGNAL SQLSTATE '45000'
      SET MESSAGE_TEXT = 'An error occurred';
  ELSEIF pval = 2 THEN
    SIGNAL specialty
      SET MESSAGE_TEXT = 'An error occurred';
  ELSE
    SIGNAL SQLSTATE '01000'
      SET MESSAGE_TEXT = 'A warning occurred', MYSQL_ERRNO = 1000;
    SIGNAL SQLSTATE '45000'
      SET MESSAGE_TEXT = 'An error occurred', MYSQL_ERRNO = 1001;
  END IF;
END;
</pre><p>
          If <code class="literal">pval</code> is 0, <code class="literal">p()</code>
          signals a warning because <code class="literal">SQLSTATE</code> values
          that begin with <code class="literal">'01'</code> are signals in the
          warning class. The warning does not terminate the procedure,
          and can be seen with <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW
          WARNINGS</code></a> after the procedure returns.
        </p><p>
          If <code class="literal">pval</code> is 1, <code class="literal">p()</code>
          signals an error and sets the <code class="literal">MESSAGE_TEXT</code>
          condition information item. The error terminates the
          procedure, and the text is returned with the error
          information.
        </p><p>
          If <code class="literal">pval</code> is 2, the same error is signaled,
          although the <code class="literal">SQLSTATE</code> value is specified
          using a named condition in this case.
        </p><p>
          If <code class="literal">pval</code> is anything else,
          <code class="literal">p()</code> first signals a warning and sets the
          message text and error number condition information items.
          This warning does not terminate the procedure, so execution
          continues and <code class="literal">p()</code> then signals an error.
          The error does terminate the procedure. The message text and
          error number set by the warning are replaced by the values set
          by the error, which are returned with the error information.
        </p><p>
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> is typically used within
          stored programs, but it is a MySQL extension that it is
          permitted outside handler context. For example, if you invoke
          the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client program, you can enter any
          of these statements at the prompt:
        </p><pre data-lang="sql" class="programlisting">
SIGNAL SQLSTATE '77777';

CREATE TRIGGER t_bi BEFORE INSERT ON t
  FOR EACH ROW SIGNAL SQLSTATE '77777';

CREATE EVENT e ON SCHEDULE EVERY 1 SECOND
  DO SIGNAL SQLSTATE '77777';
</pre><p>
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> executes according to
          the following rules:
        </p><p>
          If the <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement
          indicates a particular <code class="literal">SQLSTATE</code> value, that
          value is used to signal the condition specified. Example:
        </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p (divisor INT)
BEGIN
  IF divisor = 0 THEN
    SIGNAL SQLSTATE '22012';
  END IF;
END;
</pre><p>
          If the <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement uses a
          named condition, the condition must be declared in some scope
          that applies to the <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>
          statement, and must be defined using an
          <code class="literal">SQLSTATE</code> value, not a MySQL error number.
          Example:
        </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p (divisor INT)
BEGIN
  DECLARE divide_by_zero CONDITION FOR SQLSTATE '22012';
  IF divisor = 0 THEN
    SIGNAL divide_by_zero;
  END IF;
END;
</pre><p>
          If the named condition does not exist in the scope of the
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement, an
          <code class="literal">Undefined CONDITION</code> error occurs.
        </p><p>
          If <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> refers to a named
          condition that is defined with a MySQL error number rather
          than an <code class="literal">SQLSTATE</code> value, a
          <code class="literal">SIGNAL/RESIGNAL can only use a CONDITION defined with
          SQLSTATE</code> error occurs. The following statements
          cause that error because the named condition is associated
          with a MySQL error number:
        </p><pre data-lang="sql" class="programlisting">
DECLARE no_such_table CONDITION FOR 1051;
SIGNAL no_such_table;
</pre><p>
          If a condition with a given name is declared multiple times in
          different scopes, the declaration with the most local scope
          applies. Consider the following procedure:
        </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p (divisor INT)
BEGIN
  DECLARE my_error CONDITION FOR SQLSTATE '45000';
  IF divisor = 0 THEN
    BEGIN
      DECLARE my_error CONDITION FOR SQLSTATE '22012';
      SIGNAL my_error;
    END;
  END IF;
  SIGNAL my_error;
END;
</pre><p>
          If <code class="literal">divisor</code> is 0, the first
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement executes. The
          innermost <code class="literal">my_error</code> condition declaration
          applies, raising <code class="literal">SQLSTATE</code>
          <code class="literal">'22012'</code>.
        </p><p>
          If <code class="literal">divisor</code> is not 0, the second
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement executes. The
          outermost <code class="literal">my_error</code> condition declaration
          applies, raising <code class="literal">SQLSTATE</code>
          <code class="literal">'45000'</code>.
        </p><p>
          For information about how the server chooses handlers when a
          condition occurs, see <a class="xref" href="sql-syntax.html#handler-scope" title="13.6.7.6 Scope Rules for Handlers">Section 13.6.7.6, “Scope Rules for Handlers”</a>.
        </p><p>
          Signals can be raised within exception handlers:
        </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    SIGNAL SQLSTATE VALUE '99999'
      SET MESSAGE_TEXT = 'An error occurred';
  END;
  DROP TABLE no_such_table;
END;
</pre><p>
          <code class="literal">CALL p()</code> reaches the
          <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement. There is
          no table named <code class="literal">no_such_table</code>, so the error
          handler is activated. The error handler destroys the original
          error (<span class="quote">“<span class="quote">no such table</span>”</span>) and makes a new error
          with <code class="literal">SQLSTATE</code> <code class="literal">'99999'</code>
          and message <code class="literal">An error occurred</code>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="signal-condition-information-items"></a>Signal Condition Information Items</h5>

</div>

</div>

</div>
<p>
          The following table lists the names of diagnostics area
          condition information items that can be set in a
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> (or
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>) statement. All items
          are standard SQL except <code class="literal">MYSQL_ERRNO</code>, which
          is a MySQL extension. For more information about these items
          see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
        </p><pre data-lang="none" class="programlisting">
Item Name             Definition
---------             ----------
CLASS_ORIGIN          VARCHAR(64)
SUBCLASS_ORIGIN       VARCHAR(64)
CONSTRAINT_CATALOG    VARCHAR(64)
CONSTRAINT_SCHEMA     VARCHAR(64)
CONSTRAINT_NAME       VARCHAR(64)
CATALOG_NAME          VARCHAR(64)
SCHEMA_NAME           VARCHAR(64)
TABLE_NAME            VARCHAR(64)
COLUMN_NAME           VARCHAR(64)
CURSOR_NAME           VARCHAR(64)
MESSAGE_TEXT          VARCHAR(128)
MYSQL_ERRNO           SMALLINT UNSIGNED
</pre><p>
          The character set for character items is UTF-8.
        </p><p>
          It is illegal to assign <code class="literal">NULL</code> to a condition
          information item in a <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>
          statement.
        </p><p>
          A <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement always
          specifies an <code class="literal">SQLSTATE</code> value, either
          directly, or indirectly by referring to a named condition
          defined with an <code class="literal">SQLSTATE</code> value. The first
          two characters of an <code class="literal">SQLSTATE</code> value are its
          class, and the class determines the default value for the
          condition information items:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Class = <code class="literal">'00'</code> (success)
            </p><p>
              Illegal. <code class="literal">SQLSTATE</code> values that begin
              with <code class="literal">'00'</code> indicate success and are not
              valid for <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>.
            </p></li><li class="listitem"><p>
              Class = <code class="literal">'01'</code> (warning)
            </p><pre data-lang="sql" class="programlisting">
MESSAGE_TEXT = 'Unhandled user-defined warning condition';
MYSQL_ERRNO = <a class="link" href="error-handling.html#error_er_signal_warn"><code class="literal">ER_SIGNAL_WARN</code></a>
</pre></li><li class="listitem"><p>
              Class = <code class="literal">'02'</code> (not found)
            </p><pre data-lang="sql" class="programlisting">
MESSAGE_TEXT = 'Unhandled user-defined not found condition';
MYSQL_ERRNO = <a class="link" href="error-handling.html#error_er_signal_not_found"><code class="literal">ER_SIGNAL_NOT_FOUND</code></a>
</pre></li><li class="listitem"><p>
              Class &gt; <code class="literal">'02'</code> (exception)
            </p><pre data-lang="sql" class="programlisting">
MESSAGE_TEXT = 'Unhandled user-defined exception condition';
MYSQL_ERRNO = <a class="link" href="error-handling.html#error_er_signal_exception"><code class="literal">ER_SIGNAL_EXCEPTION</code></a>
</pre></li></ul>
</div>
<p>
          For legal classes, the other condition information items are
          set as follows:
        </p><pre data-lang="sql" class="programlisting">
CLASS_ORIGIN = SUBCLASS_ORIGIN = '';
CONSTRAINT_CATALOG = CONSTRAINT_SCHEMA = CONSTRAINT_NAME = '';
CATALOG_NAME = SCHEMA_NAME = TABLE_NAME = COLUMN_NAME = '';
CURSOR_NAME = '';
</pre><p>
          The error values that are accessible after
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> executes are the
          <code class="literal">SQLSTATE</code> value raised by the
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement and the
          <code class="literal">MESSAGE_TEXT</code> and
          <code class="literal">MYSQL_ERRNO</code> items. These values are
          available from the C API:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-sqlstate" title="28.7.7.76 mysql_sqlstate()"><code class="literal">mysql_sqlstate()</code></a> returns
              the <code class="literal">SQLSTATE</code> value.
            </p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno()"><code class="literal">mysql_errno()</code></a> returns the
              <code class="literal">MYSQL_ERRNO</code> value.
            </p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error()"><code class="literal">mysql_error()</code></a> returns the
              <code class="literal">MESSAGE_TEXT</code> value.
</p></li></ul>
</div>
<p>
          At the SQL level, the output from <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW
          WARNINGS</code></a> and <a class="link" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax"><code class="literal">SHOW
          ERRORS</code></a> indicates the <code class="literal">MYSQL_ERRNO</code>
          and <code class="literal">MESSAGE_TEXT</code> values in the
          <code class="literal">Code</code> and <code class="literal">Message</code>
          columns.
        </p><p>
          To retrieve information from the diagnostics area, use the
          <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement (see
          <a class="xref" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax">Section 13.6.7.3, “GET DIAGNOSTICS Syntax”</a>). For information about the
          diagnostics area, see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="signal-effects"></a>Effect of Signals on Handlers, Cursors, and Statements</h5>

</div>

</div>

</div>
<p>
          Signals have different effects on statement execution
          depending on the signal class. The class determines how severe
          an error is. MySQL ignores the value of the
          <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> system variable; in
          particular, strict SQL mode does not matter. MySQL also
          ignores <code class="literal">IGNORE</code>: The intent of
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> is to raise a
          user-generated error explicitly, so a signal is never ignored.
        </p><p>
          In the following descriptions, <span class="quote">“<span class="quote">unhandled</span>”</span> means
          that no handler for the signaled <code class="literal">SQLSTATE</code>
          value has been defined with
          <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
          HANDLER</code></a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Class = <code class="literal">'00'</code> (success)
            </p><p>
              Illegal. <code class="literal">SQLSTATE</code> values that begin
              with <code class="literal">'00'</code> indicate success and are not
              valid for <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>.
            </p></li><li class="listitem"><p>
              Class = <code class="literal">'01'</code> (warning)
            </p><p>
              The value of the
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> system
              variable goes up. <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW
              WARNINGS</code></a> shows the signal.
              <code class="literal">SQLWARNING</code> handlers catch the signal.
            </p><p>
              Warnings cannot be returned from stored functions because
              the <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> statement that
              causes the function to return clears the diagnostic area.
              The statement thus clears any warnings that may have been
              present there (and resets
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> to 0).
            </p></li><li class="listitem"><p>
              Class = <code class="literal">'02'</code> (not found)
            </p><p>
              <code class="literal">NOT FOUND</code> handlers catch the signal.
              There is no effect on cursors. If the signal is unhandled
              in a stored function, statements end.
            </p></li><li class="listitem"><p>
              Class &gt; <code class="literal">'02'</code> (exception)
            </p><p>
              <code class="literal">SQLEXCEPTION</code> handlers catch the signal.
              If the signal is unhandled in a stored function,
              statements end.
            </p></li><li class="listitem"><p>
              Class = <code class="literal">'40'</code>
            </p><p>
              Treated as an ordinary exception.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="handler-scope"></a>13.6.7.6 Scope Rules for Handlers</h4>

</div>

</div>

</div>
<p>
        A stored program may include handlers to be invoked when certain
        conditions occur within the program. The applicability of each
        handler depends on its location within the program definition
        and on the condition or conditions that it handles:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A handler declared in a
            <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
            END</code></a> block is in scope only for the SQL statements
            following the handler declarations in the block. If the
            handler itself raises a condition, it cannot handle that
            condition, nor can any other handlers declared in the block.
            In the following example, handlers <code class="literal">H1</code> and
            <code class="literal">H2</code> are in scope for conditions raised by
            statements <em class="replaceable"><code>stmt1</code></em> and
            <em class="replaceable"><code>stmt2</code></em>. But neither
            <code class="literal">H1</code> nor <code class="literal">H2</code> are in scope
            for conditions raised in the body of <code class="literal">H1</code>
            or <code class="literal">H2</code>.
          </p><pre data-lang="sql" class="programlisting">
BEGIN -- outer block
  DECLARE EXIT HANDLER FOR ...;  -- handler H1
  DECLARE EXIT HANDLER FOR ...;  -- handler H2
  <em class="replaceable"><code>stmt1</code></em>;
  <em class="replaceable"><code>stmt2</code></em>;
END;
</pre></li><li class="listitem"><p>
            A handler is in scope only for the block in which it is
            declared, and cannot be activated for conditions occurring
            outside that block. In the following example, handler
            <code class="literal">H1</code> is in scope for
            <em class="replaceable"><code>stmt1</code></em> in the inner block, but not
            for <em class="replaceable"><code>stmt2</code></em> in the outer block:
          </p><pre data-lang="sql" class="programlisting">
BEGIN -- outer block
  BEGIN -- inner block
    DECLARE EXIT HANDLER FOR ...;  -- handler H1
    <em class="replaceable"><code>stmt1</code></em>;
  END;
  <em class="replaceable"><code>stmt2</code></em>;
END;
</pre></li><li class="listitem"><p>
            A handler can be specific or general. A specific handler is
            for a MySQL error code, <code class="literal">SQLSTATE</code> value,
            or condition name. A general handler is for a condition in
            the <code class="literal">SQLWARNING</code>,
            <code class="literal">SQLEXCEPTION</code>, or <code class="literal">NOT
            FOUND</code> class. Condition specificity is related to
            condition precedence, as described later.
</p></li></ul>
</div>
<p>
        Multiple handlers can be declared in different scopes and with
        different specificities. For example, there might be a specific
        MySQL error code handler in an outer block, and a general
        <code class="literal">SQLWARNING</code> handler in an inner block. Or
        there might be handlers for a specific MySQL error code and the
        general <code class="literal">SQLWARNING</code> class in the same block.
      </p><p>
        Whether a handler is activated depends not only on its own scope
        and condition value, but on what other handlers are present.
        When a condition occurs in a stored program, the server searches
        for applicable handlers in the current scope (current
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block). If there are no applicable handlers, the
        search continues outward with the handlers in each successive
        containing scope (block). When the server finds one or more
        applicable handlers at a given scope, it chooses among them
        based on condition precedence:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A MySQL error code handler takes precedence over an
            <code class="literal">SQLSTATE</code> value handler.
          </p></li><li class="listitem"><p>
            An <code class="literal">SQLSTATE</code> value handler takes
            precedence over general <code class="literal">SQLWARNING</code>,
            <code class="literal">SQLEXCEPTION</code>, or <code class="literal">NOT
            FOUND</code> handlers.
          </p></li><li class="listitem"><p>
            An <code class="literal">SQLEXCEPTION</code> handler takes precedence
            over an <code class="literal">SQLWARNING</code> handler.
          </p></li><li class="listitem"><p>
            It is possible to have several applicable handlers with the
            same precedence. For example, a statement could generate
            multiple warnings with different error codes, for each of
            which an error-specific handler exists. In this case, the
            choice of which handler the server activates is
            nondeterministic, and may change depending on the
            circumstances under which the condition occurs.
</p></li></ul>
</div>
<p>
        One implication of the handler selection rules is that if
        multiple applicable handlers occur in different scopes, handlers
        with the most local scope take precedence over handlers in outer
        scopes, even over those for more specific conditions.
      </p><p>
        If there is no appropriate handler when a condition occurs, the
        action taken depends on the class of the condition:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For <code class="literal">SQLEXCEPTION</code> conditions, the stored
            program terminates at the statement that raised the
            condition, as if there were an <code class="literal">EXIT</code>
            handler. If the program was called by another stored
            program, the calling program handles the condition using the
            handler selection rules applied to its own handlers.
          </p></li><li class="listitem"><p>
            For <code class="literal">SQLWARNING</code> conditions, the program
            continues executing, as if there were a
            <code class="literal">CONTINUE</code> handler.
          </p></li><li class="listitem"><p>
            For <code class="literal">NOT FOUND</code> conditions, if the
            condition was raised normally, the action is
            <code class="literal">CONTINUE</code>. If it was raised by
            <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> or
            <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>, the action is
            <code class="literal">EXIT</code>.
</p></li></ul>
</div>
<p>
        The following examples demonstrate how MySQL applies the handler
        selection rules.
      </p><p>
        This procedure contains two handlers, one for the specific
        <code class="literal">SQLSTATE</code> value (<code class="literal">'42S02'</code>)
        that occurs for attempts to drop a nonexistent table, and one
        for the general <code class="literal">SQLEXCEPTION</code> class:
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p1()
BEGIN
  DECLARE CONTINUE HANDLER FOR SQLSTATE '42S02'
    SELECT 'SQLSTATE handler was activated' AS msg;
  DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
    SELECT 'SQLEXCEPTION handler was activated' AS msg;

  DROP TABLE test.t;
END;
</pre><p>
        Both handlers are declared in the same block and have the same
        scope. However, <code class="literal">SQLSTATE</code> handlers take
        precedence over <code class="literal">SQLEXCEPTION</code> handlers, so if
        the table <code class="literal">t</code> is nonexistent, the
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement raises a
        condition that activates the <code class="literal">SQLSTATE</code>
        handler:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL p1();</code></strong>
+--------------------------------+
| msg                            |
+--------------------------------+
| SQLSTATE handler was activated |
+--------------------------------+
</pre><p>
        This procedure contains the same two handlers. But this time,
        the <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement and
        <code class="literal">SQLEXCEPTION</code> handler are in an inner block
        relative to the <code class="literal">SQLSTATE</code> handler:
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p2()
BEGIN -- outer block
    DECLARE CONTINUE HANDLER FOR SQLSTATE '42S02'
      SELECT 'SQLSTATE handler was activated' AS msg;
  BEGIN -- inner block
    DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
      SELECT 'SQLEXCEPTION handler was activated' AS msg;

    DROP TABLE test.t; -- occurs within inner block
  END;
END;
</pre><p>
        In this case, the handler that is more local to where the
        condition occurs takes precedence. The
        <code class="literal">SQLEXCEPTION</code> handler activates, even though
        it is more general than the <code class="literal">SQLSTATE</code> handler:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL p2();</code></strong>
+------------------------------------+
| msg                                |
+------------------------------------+
| SQLEXCEPTION handler was activated |
+------------------------------------+
</pre><p>
        In this procedure, one of the handlers is declared in a block
        inner to the scope of the <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP
        TABLE</code></a> statement:
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p3()
BEGIN -- outer block
  DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
    SELECT 'SQLEXCEPTION handler was activated' AS msg;
  BEGIN -- inner block
    DECLARE CONTINUE HANDLER FOR SQLSTATE '42S02'
      SELECT 'SQLSTATE handler was activated' AS msg;
  END;

  DROP TABLE test.t; -- occurs within outer block
END;
</pre><p>
        Only the <code class="literal">SQLEXCEPTION</code> handler applies because
        the other one is not in scope for the condition raised by the
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL p3();</code></strong>
+------------------------------------+
| msg                                |
+------------------------------------+
| SQLEXCEPTION handler was activated |
+------------------------------------+
</pre><p>
        In this procedure, both handlers are declared in a block inner
        to the scope of the <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>
        statement:
      </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p4()
BEGIN -- outer block
  BEGIN -- inner block
    DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
      SELECT 'SQLEXCEPTION handler was activated' AS msg;
    DECLARE CONTINUE HANDLER FOR SQLSTATE '42S02'
      SELECT 'SQLSTATE handler was activated' AS msg;
  END;

  DROP TABLE test.t; -- occurs within outer block
END;
</pre><p>
        Neither handler applies because they are not in scope for the
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>. The condition raised
        by the statement goes unhandled and terminates the procedure
        with an error:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL p4();</code></strong>
ERROR 1051 (42S02): Unknown table 'test.t'
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="diagnostics-area"></a>13.6.7.7 The MySQL Diagnostics Area</h4>

</div>

</div>

</div>
<p>
        SQL statements produce diagnostic information that populates the
        diagnostics area. Standard SQL has a diagnostics area stack,
        containing a diagnostics area for each nested execution context.
        Standard SQL also supports
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET STACKED
        DIAGNOSTICS</code></a> syntax for referring to the second
        diagnostics area during condition handler execution.
      </p><p>
        The following discussion describes the structure of the
        diagnostics area in MySQL, the information items recognized by
        MySQL, how statements clear and set the diagnostics area, and
        how diagnostics areas are pushed to and popped from the stack.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#diagnostics-area-structure" title="Diagnostics Area Structure">Diagnostics Area Structure</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#diagnostics-area-information-items" title="Diagnostics Area Information Items">Diagnostics Area Information Items</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#diagnostics-area-populating" title="How the Diagnostics Area is Cleared and Populated">How the Diagnostics Area is Cleared and Populated</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#diagnostics-area-stack" title="How the Diagnostics Area Stack Works">How the Diagnostics Area Stack Works</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#diagnostics-area-system-variables" title="Diagnostics Area-Related System Variables">Diagnostics Area-Related System Variables</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="diagnostics-area-structure"></a>Diagnostics Area Structure</h5>

</div>

</div>

</div>
<p>
          The diagnostics area contains two kinds of information:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Statement information, such as the number of conditions
              that occurred or the affected-rows count.
            </p></li><li class="listitem"><p>
              Condition information, such as the error code and message.
              If a statement raises multiple conditions, this part of
              the diagnostics area has a condition area for each one. If
              a statement raises no conditions, this part of the
              diagnostics area is empty.
</p></li></ul>
</div>
<p>
          For a statement that produces three conditions, the
          diagnostics area contains statement and condition information
          like this:
        </p><pre data-lang="none" class="programlisting">
Statement information:
  row count
  ... other statement information items ...
Condition area list:
  Condition area 1:
    error code for condition 1
    error message for condition 1
    ... other condition information items ...
  Condition area 2:
    error code for condition 2:
    error message for condition 2
    ... other condition information items ...
  Condition area 3:
    error code for condition 3
    error message for condition 3
    ... other condition information items ...
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="diagnostics-area-information-items"></a>Diagnostics Area Information Items</h5>

</div>

</div>

</div>
<p>
          The diagnostics area contains statement and condition
          information items. Numeric items are integers. The character
          set for character items is UTF-8. No item can be
          <code class="literal">NULL</code>. If a statement or condition item is
          not set by a statement that populates the diagnostics area,
          its value is 0 or the empty string, depending on the item data
          type.
        </p><p>
          The statement information part of the diagnostics area
          contains these items:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NUMBER</code>: An integer indicating the
              number of condition areas that have information.
            </p></li><li class="listitem"><p>
              <code class="literal">ROW_COUNT</code>: An integer indicating the
              number of rows affected by the statement.
              <code class="literal">ROW_COUNT</code> has the same value as the
              <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> function (see
              <a class="xref" href="functions.html#information-functions" title="12.15 Information Functions">Section 12.15, “Information Functions”</a>).
</p></li></ul>
</div>
<p>
          The condition information part of the diagnostics area
          contains a condition area for each condition. Condition areas
          are numbered from 1 to the value of the
          <code class="literal">NUMBER</code> statement condition item. If
          <code class="literal">NUMBER</code> is 0, there are no condition areas.
        </p><p>
          Each condition area contains the items in the following list.
          All items are standard SQL except
          <code class="literal">MYSQL_ERRNO</code>, which is a MySQL extension.
          The definitions apply for conditions generated other than by a
          signal (that is, by a <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> or
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement). For
          nonsignal conditions, MySQL populates only those condition
          items not described as always empty. The effects of signals on
          the condition area are described later.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CLASS_ORIGIN</code>: A string containing the
              class of the <code class="literal">RETURNED_SQLSTATE</code> value.
              If the <code class="literal">RETURNED_SQLSTATE</code> value begins
              with a class value defined in SQL standards document ISO
              9075-2 (section 24.1, SQLSTATE),
              <code class="literal">CLASS_ORIGIN</code> is <code class="literal">'ISO
              9075'</code>. Otherwise,
              <code class="literal">CLASS_ORIGIN</code> is
              <code class="literal">'MySQL'</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">SUBCLASS_ORIGIN</code>: A string containing
              the subclass of the <code class="literal">RETURNED_SQLSTATE</code>
              value. If <code class="literal">CLASS_ORIGIN</code> is <code class="literal">'ISO
              9075'</code> or <code class="literal">RETURNED_SQLSTATE</code>
              ends with <code class="literal">'000'</code>,
              <code class="literal">SUBCLASS_ORIGIN</code> is <code class="literal">'ISO
              9075'</code>. Otherwise,
              <code class="literal">SUBCLASS_ORIGIN</code> is
              <code class="literal">'MySQL'</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">RETURNED_SQLSTATE</code>: A string that
              indicates the <code class="literal">SQLSTATE</code> value for the
              condition.
            </p></li><li class="listitem"><p>
              <code class="literal">MESSAGE_TEXT</code>: A string that indicates
              the error message for the condition.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_ERRNO</code>: An integer that indicates
              the MySQL error code for the condition.
            </p></li><li class="listitem"><p>
              <code class="literal">CONSTRAINT_CATALOG</code>,
              <code class="literal">CONSTRAINT_SCHEMA</code>,
              <code class="literal">CONSTRAINT_NAME</code>: Strings that indicate
              the catalog, schema, and name for a violated constraint.
              They are always empty.
            </p></li><li class="listitem"><p>
              <code class="literal">CATALOG_NAME</code>,
              <code class="literal">SCHEMA_NAME</code>,
              <code class="literal">TABLE_NAME</code>,
              <code class="literal">COLUMN_NAME</code>: Strings that indicate the
              catalog, schema, table, and column related to the
              condition. They are always empty.
            </p></li><li class="listitem"><p>
              <code class="literal">CURSOR_NAME</code>: A string that indicates
              the cursor name. This is always empty.
</p></li></ul>
</div>
<p>
          For the <code class="literal">RETURNED_SQLSTATE</code>,
          <code class="literal">MESSAGE_TEXT</code>, and
          <code class="literal">MYSQL_ERRNO</code> values for particular errors,
          see <a class="xref" href="error-handling.html#server-error-reference" title="B.3.1 Server Error Message Reference">Section B.3.1, “Server Error Message Reference”</a>.
        </p><p>
          If a <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> (or
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>) statement populates
          the diagnostics area, its <code class="literal">SET</code> clause can
          assign to any condition information item except
          <code class="literal">RETURNED_SQLSTATE</code> any value that is legal
          for the item data type. <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>
          also sets the <code class="literal">RETURNED_SQLSTATE</code> value, but
          not directly in its <code class="literal">SET</code> clause. That value
          comes from the <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement
          <code class="literal">SQLSTATE</code> argument.
        </p><p>
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> also sets statement
          information items. It sets <code class="literal">NUMBER</code> to 1. It
          sets <code class="literal">ROW_COUNT</code> to −1 for errors and 0
          otherwise.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="diagnostics-area-populating"></a>How the Diagnostics Area is Cleared and Populated</h5>

</div>

</div>

</div>
<p>
          Nondiagnostic SQL statements populate the diagnostics area
          automatically, and its contents can be set explicitly with the
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> and
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statements. The
          diagnostics area can be examined with <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
          DIAGNOSTICS</code></a> to extract specific items, or with
          <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> or
          <a class="link" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a> to see conditions
          or errors.
        </p><p>
          SQL statements clear and set the diagnostics area as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              When the server starts executing a statement after parsing
              it, it clears the diagnostics area for nondiagnostic
              statements. Diagnostic statements do not clear the
              diagnostics area. These statements are diagnostic:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a>
                </p></li><li class="listitem"><p>
                  <a class="link" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a>
                </p></li><li class="listitem"><p>
                  <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a>
</p></li></ul>
</div>
</li><li class="listitem"><p>
              If a statement raises a condition, the diagnostics area is
              cleared of conditions that belong to earlier statements.
              The exception is that conditions raised by
              <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> and
              <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> are added to the
              diagnostics area without clearing it.
</p></li></ul>
</div>
<p>
          Thus, even a statement that does not normally clear the
          diagnostics area when it begins executing clears it if the
          statement raises a condition.
        </p><p>
          The following example shows the effect of various statements
          on the diagnostics area, using <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW
          WARNINGS</code></a> to display information about conditions
          stored there.
        </p><p>
          This <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement
          clears the diagnostics area and populates it when the
          condition occurs:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS test.no_such_table;</code></strong>
Query OK, 0 rows affected, 1 warning (0.01 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------------+
| Level | Code | Message                            |
+-------+------+------------------------------------+
| Note  | 1051 | Unknown table 'test.no_such_table' |
+-------+------+------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          This
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          statement generates an error, so it clears and populates the
          diagnostics area:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @x = @@x;</code></strong>
ERROR 1193 (HY000): Unknown system variable 'x'

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+-----------------------------+
| Level | Code | Message                     |
+-------+------+-----------------------------+
| Error | 1193 | Unknown system variable 'x' |
+-------+------+-----------------------------+
1 row in set (0.00 sec)
</pre><p>
          The previous
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          statement produced a single condition, so 1 is the only valid
          condition number for <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
          DIAGNOSTICS</code></a> at this point. The following statement
          uses a condition number of 2, which produces a warning that is
          added to the diagnostics area without clearing it:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>GET DIAGNOSTICS CONDITION 2 @p = MESSAGE_TEXT;</code></strong>
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------+
| Level | Code | Message                      |
+-------+------+------------------------------+
| Error | 1193 | Unknown system variable 'xx' |
| Error | 1753 | Invalid condition number     |
+-------+------+------------------------------+
2 rows in set (0.00 sec)
</pre><p>
          Now there are two conditions in the diagnostics area, so the
          same <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement
          succeeds:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>GET DIAGNOSTICS CONDITION 2 @p = MESSAGE_TEXT;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @p;</code></strong>
+--------------------------+
| @p                       |
+--------------------------+
| Invalid condition number |
+--------------------------+
1 row in set (0.01 sec)
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="diagnostics-area-stack"></a>How the Diagnostics Area Stack Works</h5>

</div>

</div>

</div>
<p>
          When a push to the diagnostics area stack occurs, the first
          (current) diagnostics area becomes the second (stacked)
          diagnostics area and a new current diagnostics area is created
          as a copy of it. Diagnostics areas are pushed to and popped
          from the stack under the following circumstances:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Execution of a stored program
            </p><p>
              A push occurs before the program executes and a pop occurs
              afterward. If the stored program ends while handlers are
              executing, there can be more than one diagnostics area to
              pop; this occurs due to an exception for which there are
              no appropriate handlers or due to
              <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> in the handler.
            </p><p>
              Any warning or error conditions in the popped diagnostics
              areas then are added to the current diagnostics area,
              except that, for triggers, only errors are added. When the
              stored program ends, the caller sees these conditions in
              its current diagonstics area.
            </p></li><li class="listitem"><p>
              Execution of a condition handler within a stored program
            </p><p>
              When a push occurs as a result of condition handler
              activation, the stacked diagnostics area is the area that
              was current within the stored program prior to the push.
              The new now-current diagnostics area is the handler's
              current diagnostics area.
              <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
              [CURRENT] DIAGNOSTICS</code></a> and
              <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
              STACKED DIAGNOSTICS</code></a> can be used within the
              handler to access the contents of the current (handler)
              and stacked (stored program) diagnostics areas. Initially,
              they return the same result, but statements executing
              within the handler modify the current diagnostics area,
              clearing and setting its contents according to the normal
              rules (see <a class="xref" href="sql-syntax.html#diagnostics-area-populating" title="How the Diagnostics Area is Cleared and Populated">How the Diagnostics Area is Cleared and Populated</a>).
              The stacked diagnostics area cannot be modified by
              statements executing within the handler except
              <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>.
            </p><p>
              If the handler executes successfully, the current
              (handler) diagnostics area is popped and the stacked
              (stored program) diagnostics area again becomes the
              current diagnostics area. Conditions added to the handler
              diagnostics area during handler execution are added to the
              current diagnostics area.
            </p></li><li class="listitem"><p>
              Execution of <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>
            </p><p>
              The <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement
              passes on the error condition information that is
              available during execution of a condition handler within a
              compound statement inside a stored program.
              <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> may change some or
              all information before passing it on, modifying the
              diagnostics stack as described in
              <a class="xref" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax">Section 13.6.7.4, “RESIGNAL Syntax”</a>.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="diagnostics-area-system-variables"></a>Diagnostics Area-Related System Variables</h5>

</div>

</div>

</div>
<p>
          Certain system variables control or are related to some
          aspects of the diagnostics area:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> controls
              the number of condition areas in the diagnostics area. If
              more conditions than this occur, MySQL silently discards
              information for the excess conditions. (Conditions added
              by <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> are always
              added, with older conditions being discarded as necessary
              to make room.)
            </p></li><li class="listitem"><p>
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> indicates
              the number of conditions that occurred. This includes
              errors, warnings, and notes. Normally,
              <code class="literal">NUMBER</code> and
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> are the
              same. However, as the number of conditions generated
              exceeds <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>,
              the value of
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> continues
              to rise whereas <code class="literal">NUMBER</code> remains capped
              at <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>
              because no additional conditions are stored in the
              diagnostics area.
            </p></li><li class="listitem"><p>
              <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> indicates the
              number of errors that occurred. This value includes
              <span class="quote">“<span class="quote">not found</span>”</span> and exception conditions, but
              excludes warnings and notes. Like
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a>, its value
              can exceed
              <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>.
            </p></li><li class="listitem"><p>
              If the <a class="link" href="server-administration.html#sysvar_sql_notes"><code class="literal">sql_notes</code></a> system
              variable is set to 0, notes are not stored and do not
              increment <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a>.
</p></li></ul>
</div>
<p>
          Example: If <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>
          is 10, the diagnostics area can contain a maximum of 10
          condition areas. Suppose that a statement raises 20
          conditions, 12 of which are errors. In that case, the
          diagnostics area contains the first 10 conditions,
          <code class="literal">NUMBER</code> is 10,
          <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> is 20, and
          <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> is 12.
        </p><p>
          Changes to the value of
          <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> have no
          effect until the next attempt to modify the diagnostics area.
          If the diagnostics area contains 10 condition areas and
          <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> is set to 5,
          that has no immediate effect on the size or content of the
          diagnostics area.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="conditions-and-parameters"></a>13.6.7.8 Condition Handling and OUT or INOUT Parameters</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091660031008"></a><a class="indexterm" name="idm140091660029520"></a><a class="indexterm" name="idm140091660028032"></a><a class="indexterm" name="idm140091660026544"></a><p>
        If a stored procedure exits with an unhandled exception,
        modified values of <code class="literal">OUT</code> and
        <code class="literal">INOUT</code> parameters are not propogated back to
        the caller.
      </p><p>
        If an exception is handled by a <code class="literal">CONTINUE</code> or
        <code class="literal">EXIT</code> handler that contains a
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement, execution of
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> pops the Diagnostics
        Area stack, thus signalling the exception (that is, the
        information that existed before entry into the handler). If the
        exception is an error, the values of <code class="literal">OUT</code> and
        <code class="literal">INOUT</code> parameters are not propogated back to
        the caller.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-server-administration"></a>13.7 Database Administration Statements</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#account-management-sql">13.7.1 Account Management Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#resource-group-sql">13.7.2 Resource Group Management Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#table-maintenance-sql">13.7.3 Table Maintenance Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#component-sql">13.7.4 Component, Plugin, and User-Defined Function Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-statement">13.7.5 SET Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show">13.7.6 SHOW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#other-administrative-sql">13.7.7 Other Administrative Statements</a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="account-management-sql"></a>13.7.1 Account Management Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#alter-user">13.7.1.1 ALTER USER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-role">13.7.1.2 CREATE ROLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-user">13.7.1.3 CREATE USER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-role">13.7.1.4 DROP ROLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-user">13.7.1.5 DROP USER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#grant">13.7.1.6 GRANT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#rename-user">13.7.1.7 RENAME USER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#revoke">13.7.1.8 REVOKE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-default-role">13.7.1.9 SET DEFAULT ROLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-password">13.7.1.10 SET PASSWORD Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-role">13.7.1.11 SET ROLE Syntax</a></span></dt></dl>
</div>
<p>
      MySQL account information is stored in the tables of the
      <code class="literal">mysql</code> system database. This database and the
      access control system are discussed extensively in
      <a class="xref" href="server-administration.html" title="Chapter 5 MySQL Server Administration">Chapter 5, <i>MySQL Server Administration</i></a>, which you should consult
      for additional details.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        Some MySQL releases introduce changes to the grant tables to add
        new privileges or features. To make sure that you can take
        advantage of any new capabilities, update your grant tables to
        the current structure whenever you upgrade MySQL. See
        <a class="xref" href="installing.html#upgrading" title="2.11 Upgrading MySQL">Section 2.11, “Upgrading MySQL”</a>.
</p>
</div>
<p>
      When the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system
      variable is enabled, account-management statements require the
      <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, in addition to any
      other required privileges. This is because they modify tables in
      the <code class="literal">mysql</code> system database.
    </p><p>
      Account management statements are atomic and crash safe. For more
      information, see <a class="xref" href="sql-syntax.html#atomic-ddl" title="13.1.1 Atomic Data Definition Statement Support">Section 13.1.1, “Atomic Data Definition Statement Support”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="alter-user"></a>13.7.1.1 ALTER USER Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091660001872"></a><a class="indexterm" name="idm140091660000800"></a><a class="indexterm" name="idm140091659999312"></a><pre data-lang="sql" class="programlisting">
ALTER USER [IF EXISTS]
    <em class="replaceable"><code>user</code></em> [<em class="replaceable"><code>auth_option</code></em>] [, <em class="replaceable"><code>user</code></em> [<em class="replaceable"><code>auth_option</code></em>]] ...
    [REQUIRE {NONE | <em class="replaceable"><code>tls_option</code></em> [[AND] <em class="replaceable"><code>tls_option</code></em>] ...}]
    [WITH <em class="replaceable"><code>resource_option</code></em> [<em class="replaceable"><code>resource_option</code></em>] ...]
    [<em class="replaceable"><code>password_option</code></em> | <em class="replaceable"><code>lock_option</code></em>] ...

ALTER USER [IF EXISTS] USER() <em class="replaceable"><code>user_func_auth_option</code></em>

ALTER USER [IF EXISTS]
    <em class="replaceable"><code>user</code></em> DEFAULT ROLE
    {NONE | ALL | <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em> ] ...}

<em class="replaceable"><code>user</code></em>:
    (see <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>)

<em class="replaceable"><code>auth_option</code></em>: {
    IDENTIFIED BY '<em class="replaceable"><code>auth_string</code></em>'
        [REPLACE '<em class="replaceable"><code>current_auth_string</code></em>']
        [RETAIN CURRENT PASSWORD]
  | IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em>
  | IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em> BY '<em class="replaceable"><code>auth_string</code></em>'
        [REPLACE '<em class="replaceable"><code>current_auth_string</code></em>']
        [RETAIN CURRENT PASSWORD]
  | IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em> AS '<em class="replaceable"><code>auth_string</code></em>'
  | DISCARD OLD PASSWORD
}

<em class="replaceable"><code>user_func_auth_option</code></em>: {
    IDENTIFIED BY '<em class="replaceable"><code>auth_string</code></em>'
        [REPLACE '<em class="replaceable"><code>current_auth_string</code></em>']
        [RETAIN CURRENT PASSWORD]
  | DISCARD OLD PASSWORD
}

<em class="replaceable"><code>tls_option</code></em>: {
   SSL
 | X509
 | CIPHER '<em class="replaceable"><code>cipher</code></em>'
 | ISSUER '<em class="replaceable"><code>issuer</code></em>'
 | SUBJECT '<em class="replaceable"><code>subject</code></em>'
}

<em class="replaceable"><code>resource_option</code></em>: {
    MAX_QUERIES_PER_HOUR <em class="replaceable"><code>count</code></em>
  | MAX_UPDATES_PER_HOUR <em class="replaceable"><code>count</code></em>
  | MAX_CONNECTIONS_PER_HOUR <em class="replaceable"><code>count</code></em>
  | MAX_USER_CONNECTIONS <em class="replaceable"><code>count</code></em>
}

<em class="replaceable"><code>password_option</code></em>: {
    PASSWORD EXPIRE [DEFAULT | NEVER | INTERVAL <em class="replaceable"><code>N</code></em> DAY]
  | PASSWORD HISTORY {DEFAULT | <em class="replaceable"><code>N</code></em>}
  | PASSWORD REUSE INTERVAL {DEFAULT | <em class="replaceable"><code>N</code></em> DAY}
  | PASSWORD REQUIRE CURRENT [DEFAULT | OPTIONAL]
}

<em class="replaceable"><code>lock_option</code></em>: {
    ACCOUNT LOCK
  | ACCOUNT UNLOCK
}
</pre><p>
        The <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> statement modifies
        MySQL accounts. It enables authentication, role, SSL/TLS,
        resource-limit, and password-management properties to be
        modified for existing accounts. It can also be used to lock and
        unlock accounts.
      </p><p>
        In most cases, <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a>
        requires the global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a>
        privilege, or the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>
        privilege for the <code class="literal">mysql</code> system database. The
        exceptions are:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Any client who connects to the server using a nonanonymous
            account can change the password for that account. (In
            particular, you can change your own password.) To see which
            account the server authenticated you as, invoke the
            <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a> function:
          </p><pre data-lang="sql" class="programlisting">
SELECT CURRENT_USER();
</pre></li><li class="listitem"><p>
            For <code class="literal">DEFAULT ROLE</code> syntax,
            <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> requires these
            privileges:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                Setting the default roles for another user requires the
                global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a>
                privilege, or the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>
                privilege for the <code class="literal">mysql.default_roles</code>
                system table.
              </p></li><li class="listitem"><p>
                Setting the default roles for yourself requires no
                special privileges, as long as the roles you want as the
                default have been granted to you.
</p></li></ul>
</div>
</li><li class="listitem"><p>
            Statements that modify secondary passwords require these
            privileges:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                The
                <a class="link" href="security.html#priv_application-password-admin"><code class="literal">APPLICATION_PASSWORD_ADMIN</code></a>
                privilege is required to use the <code class="literal">RETAIN CURRENT
                PASSWORD</code> or <code class="literal">DISCARD OLD
                PASSWORD</code> clause for <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER
                USER</code></a> statements that apply to your own
                account. The privilege is required to manipulate your
                own secondary password because most users require only
                one password.
              </p></li><li class="listitem"><p>
                If an account is to be permitted to manipulate secondary
                passwords for all accounts, it should be granted the
                <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege
                rather than
                <a class="link" href="security.html#priv_application-password-admin"><code class="literal">APPLICATION_PASSWORD_ADMIN</code></a>.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
        When the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system
        variable is enabled, <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a>
        additionally requires the
        <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        By default, an error occurs if you try to modify a user that
        does not exist. If the <code class="literal">IF EXISTS</code> clause is
        given, the statement produces a warning for each named user that
        does not exist, rather than an error.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          Under some circumstances, <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER
          USER</code></a> may be recorded in server logs or on the client
          side in a history file such as
          <code class="filename">~/.mysql_history</code>, which means that
          cleartext passwords may be read by anyone having read access
          to that information. For information about the conditions
          under which this occurs for the server logs and how to control
          it, see <a class="xref" href="security.html#password-logging" title="6.1.2.3 Passwords and Logging">Section 6.1.2.3, “Passwords and Logging”</a>. For similar
          information about client-side logging, see
          <a class="xref" href="programs.html#mysql-logging" title="4.5.1.3 mysql Client Logging">Section 4.5.1.3, “mysql Client Logging”</a>.
</p>
</div>
<p>
        There are several aspects to the <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER
        USER</code></a> statement, described under the following topics:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-user-overview" title="ALTER USER Overview">ALTER USER Overview</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-user-authentication" title="ALTER USER Authentication Options">ALTER USER Authentication Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-user-role" title="ALTER USER Role Options">ALTER USER Role Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-user-tls" title="ALTER USER SSL/TLS Options">ALTER USER SSL/TLS Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-user-resource-limits" title="ALTER USER Resource-Limit Options">ALTER USER Resource-Limit Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-user-password-management" title="ALTER USER Password-Management Options">ALTER USER Password-Management Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-user-account-locking" title="ALTER USER Account-Locking Options">ALTER USER Account-Locking Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#alter-user-binary-logging" title="ALTER USER Binary Logging">ALTER USER Binary Logging</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="alter-user-overview"></a>ALTER USER Overview</h5>

</div>

</div>

</div>
<p>
          For each affected account, <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER
          USER</code></a> modifies the corresponding row in the
          <code class="literal">mysql.user</code> system table to reflect the
          properties specified in the statement. Unspecified properties
          retain their current values.
        </p><p>
          Each account name uses the format described in
          <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>. The host name part of the
          account name, if omitted, defaults to <code class="literal">'%'</code>.
          It is also possible to specify
          <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> or
          <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a> to refer to the
          account associated with the current session.
        </p><p>
          For one syntax only, the account may be specified with the
          <a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a> function:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER USER() IDENTIFIED BY '<em class="replaceable"><code>auth_string</code></em>';
</pre><p>
          This syntax enables changing your own password without naming
          your account literally. (The syntax also supports the
          <code class="literal">REPLACE</code>, <code class="literal">RETAIN CURRENT
          PASSWORD</code>, and <code class="literal">DISCARD OLD
          PASSWORD</code> clauses described at
          <a class="xref" href="sql-syntax.html#alter-user-authentication" title="ALTER USER Authentication Options">ALTER USER Authentication Options</a>.)
        </p><p>
          For <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> syntaxes that
          permit an <em class="replaceable"><code>auth_option</code></em> value to
          follow a <em class="replaceable"><code>user</code></em> value,
          <em class="replaceable"><code>auth_option</code></em> indicates how the
          account authenticates by specifying an account authentication
          plugin, credentials (for example, a password), or both. Each
          <em class="replaceable"><code>auth_option</code></em> value applies
          <span class="emphasis"><em>only</em></span> to the account named immediately
          preceding it.
        </p><p>
          Following the <em class="replaceable"><code>user</code></em> specifications,
          the statement may include options for SSL/TLS, resource-limit,
          password-management, and locking properties. All such options
          are <span class="emphasis"><em>global</em></span> to the statement and apply to
          <span class="emphasis"><em>all</em></span> accounts named in the statement.
        </p><p>
          Example: Change an account's password and expire it. As a
          result, the user must connect with the named password and
          choose a new one at the next connection:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  IDENTIFIED BY '<em class="replaceable"><code>new_password</code></em>' PASSWORD EXPIRE;
</pre><p>
          Example: Modify an account to use the
          <code class="literal">sha256_password</code> authentication plugin and
          the given password. Require that a new password be chosen
          every 180 days:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  IDENTIFIED WITH sha256_password BY '<em class="replaceable"><code>new_password</code></em>'
  PASSWORD EXPIRE INTERVAL 180 DAY;
</pre><p>
          Example: Lock or unlock an account:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' ACCOUNT LOCK;
ALTER USER 'jeffrey'@'localhost' ACCOUNT UNLOCK;
</pre><p>
          Example: Require an account to connect using SSL and establish
          a limit of 20 connections per hour:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  REQUIRE SSL WITH MAX_CONNECTIONS_PER_HOUR 20;
</pre><p>
          Example: Alter multiple accounts, specifying some per-account
          properties and some global properties:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER
  'jeffrey'@'localhost'
    IDENTIFIED BY '<em class="replaceable"><code>jeffrey_new_password</code></em>',
  'jeanne'@'localhost',
  'josh'@'localhost'
    IDENTIFIED BY '<em class="replaceable"><code>josh_new_password</code></em>'
    REPLACE '<em class="replaceable"><code>josh_current_password</code></em>'
    RETAIN CURRENT PASSWORD
  REQUIRE SSL WITH MAX_USER_CONNECTIONS 2
  PASSWORD HISTORY 5;
</pre><p>
          The <code class="literal">IDENTIFIED BY</code> value following
          <code class="literal">jeffrey</code> applies only to its immediately
          preceding account, so it changes the password to
          <code class="literal">'<em class="replaceable"><code>jeffrey_new_password</code></em>'</code>
          only for <code class="literal">jeffrey</code>. For
          <code class="literal">jeanne</code>, there is no per-account value (thus
          leaving the password unchanged). For <code class="literal">josh</code>,
          <code class="literal">IDENTIFIED BY</code> establishes a new password
          (<code class="literal">'<em class="replaceable"><code>josh_new_password</code></em>'</code>),
          <code class="literal">REPLACE</code> is specified to verify that the
          user issuing the <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a>
          statement knows the current password
          (<code class="literal">'<em class="replaceable"><code>josh_current_password</code></em>'</code>),
          and that current password is also retained as the account
          secondary password. (As a result, <code class="literal">josh</code> can
          connect with either the primary or secondary password.)
        </p><p>
          The remaining properties apply globally to all accounts named
          in the statement, so for both accounts:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Connections are required to use SSL.
            </p></li><li class="listitem"><p>
              The account can be used for a maximum of two simultaneous
              connections.
            </p></li><li class="listitem"><p>
              Password changes cannot reuse any of the five most recent
              passwords.
</p></li></ul>
</div>
<p>
          Example: Discard the secondary password for
          <code class="literal">josh</code>, leaving the account with only its
          primary password:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'josh'@'localhost' DISCARD OLD PASSWORD;
</pre><p>
          In the absence of a particular type of option, the account
          remains unchanged in that respect. For example, with no
          locking option, the locking state of the account is not
          changed.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="alter-user-authentication"></a>ALTER USER Authentication Options</h5>

</div>

</div>

</div>
<p>
          An account name may be followed by an
          <em class="replaceable"><code>auth_option</code></em> authentication option
          that specifies the account authentication plugin, credentials,
          or both. It may also include a password-verification clause
          that specifies the account current password to be replaced,
          and clauses that manage whether an account has a secondary
          password.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Clauses for password verification and secondary passwords
            apply only to accounts that store credentials internally in
            the <code class="literal">mysql.user</code> system table
            (<code class="literal">mysql_native_password</code>,
            <code class="literal">sha256_password</code>, or
            <code class="literal">caching_sha2_password</code>). For accounts that
            use plugins that perform authentication against an external
            credential system, password management must be handled
            externally against that system as well.
</p>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <em class="replaceable"><code>auth_plugin</code></em> names an
              authentication plugin. The plugin name can be a quoted
              string literal or an unquoted name. Plugin names are
              stored in the <code class="literal">plugin</code> column of the
              <code class="literal">mysql.user</code> system table.
            </p><p>
              For <em class="replaceable"><code>auth_option</code></em> syntaxes that
              do not specify an authentication plugin, the default
              plugin is indicated by the value of the
              <a class="link" href="server-administration.html#sysvar_default_authentication_plugin"><code class="literal">default_authentication_plugin</code></a>
              system variable. For descriptions of each plugin, see
              <a class="xref" href="security.html#authentication-plugins" title="6.4.1 Authentication Plugins">Section 6.4.1, “Authentication Plugins”</a>.
            </p></li><li class="listitem"><p>
              Credentials are stored in the
              <code class="literal">mysql.user</code> system table. An
              <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
              value specifies account credentials, either as a cleartext
              (unencrypted) string or hashed in the format expected by
              the authentication plugin associated with the account,
              respectively:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  For syntaxes that use <code class="literal">BY
                  '<em class="replaceable"><code>auth_string</code></em>'</code>,
                  the string is cleartext and is passed to the
                  authentication plugin for possible hashing. The result
                  returned by the plugin is stored in the
                  <code class="literal">mysql.user</code> table. A plugin may use
                  the value as specified, in which case no hashing
                  occurs.
                </p></li><li class="listitem"><p>
                  For syntaxes that use <code class="literal">AS
                  '<em class="replaceable"><code>auth_string</code></em>'</code>,
                  the string is assumed to be already in the format the
                  authentication plugin requires, and is stored as is in
                  the <code class="literal">mysql.user</code> table. If a plugin
                  requires a hashed value, the value must be hashed in a
                  format appropriate for the plugin. Otherwise, the
                  value is not usable by the plugin and correct
                  authentication of client connections will not occur.
                </p><p>
                  As of MySQL 8.0.17, a hashed string can be either a
                  string literal or a hexadecimal value. The latter
                  corresponds to the type of value displayed by
                  <a class="link" href="sql-syntax.html#show-create-user" title="13.7.6.12 SHOW CREATE USER Syntax"><code class="literal">SHOW CREATE USER</code></a> for
                  password hashes containing unprintable characters when
                  the
                  <a class="link" href="server-administration.html#sysvar_print_identified_with_as_hex"><code class="literal">print_identified_with_as_hex</code></a>
                  system variable is enabled.
                </p></li><li class="listitem"><p>
                  If an authentication plugin does not perform hashing
                  of the authentication string, the <code class="literal">BY
                  '<em class="replaceable"><code>auth_string</code></em>'</code> and
                  <code class="literal">AS
                  '<em class="replaceable"><code>auth_string</code></em>'</code>
                  clauses have the same effect: Storage of the
                  authentication string as is in the
                  <code class="literal">mysql.user</code> system table.
</p></li></ul>
</div>
</li><li class="listitem"><p>
              The <code class="literal">REPLACE
              '<em class="replaceable"><code>current_auth_string</code></em>'</code>
              clause is available as of MySQL 8.0.13. If given:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">REPLACE</code> specifies the account
                  current password to be replaced, as a cleartext
                  (unencrypted) string.
                </p></li><li class="listitem"><p>
                  The clause must be given if password changes for the
                  are required to specify the current password, as
                  verification that the user attempting to make the
                  change actually knows the current password.
                </p></li><li class="listitem"><p>
                  The clause is optional if password changes for the
                  account may but need not specify the current password.
                </p></li><li class="listitem"><p>
                  The statement fails if the clause is given but does
                  not match the current password, even if the clause is
                  optional.
                </p></li><li class="listitem"><p>
                  <code class="literal">REPLACE</code> can be specified only when
                  changing the account password for the current user.
</p></li></ul>
</div>
<p>
              For more information about password verification by
              specifying the current password, see
              <a class="xref" href="security.html#password-management" title="6.2.15 Password Management">Section 6.2.15, “Password Management”</a>.
            </p></li><li class="listitem"><p>
              The <code class="literal">RETAIN CURRENT PASSWORD</code> and
              <code class="literal">DISCARD OLD PASSWORD</code> clauses implement
              dual-password capability and are available as of MySQL
              8.0.14. Both are optional, but if given, have the
              following effects:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">RETAIN CURRENT PASSWORD</code> retains an
                  account current password as its secondary password,
                  replacing any existing secondary password. The new
                  password becomes the primary password, but clients can
                  use the account to connect to the server using either
                  the primary or secondary password. (Exception: If the
                  new password specified by the
                  <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> statement is
                  empty, the secondary password becomes empty as well,
                  even if <code class="literal">RETAIN CURRENT PASSWORD</code> is
                  given.)
                </p></li><li class="listitem"><p>
                  If you specify <code class="literal">RETAIN CURRENT
                  PASSWORD</code> for an account that has an empty
                  primary password, the statement fails.
                </p></li><li class="listitem"><p>
                  If an account has a secondary password and you change
                  its primary password without specifying
                  <code class="literal">RETAIN CURRENT PASSWORD</code>, the
                  secondary password remains unchanged.
                </p></li><li class="listitem"><p>
                  If you change the authentication plugin assigned to
                  the account, the secondary password is discarded. If
                  you change the authentication plugin and also specify
                  <code class="literal">RETAIN CURRENT PASSWORD</code>, the
                  statement fails.
                </p></li><li class="listitem"><p>
                  <code class="literal">DISCARD OLD PASSWORD</code> discards the
                  secondary password, if one exists. The account retains
                  only its primary password, and clients can use the
                  account to connect to the server only with the primary
                  password.
</p></li></ul>
</div>
<p>
              For more information about use of dual passwords, see
              <a class="xref" href="security.html#password-management" title="6.2.15 Password Management">Section 6.2.15, “Password Management”</a>.
</p></li></ul>
</div>
<p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> permits these
          <em class="replaceable"><code>auth_option</code></em> syntaxes:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">IDENTIFIED BY
              '<em class="replaceable"><code>auth_string</code></em>' [REPLACE
              '<em class="replaceable"><code>current_auth_string</code></em>'] [RETAIN
              CURRENT PASSWORD]</code>
            </p><p>
              Sets the account authentication plugin to the default
              plugin, passes the cleartext
              <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
              value to the plugin for possible hashing, and stores the
              result in the account row in the
              <code class="literal">mysql.user</code> system table.
            </p><p>
              The <code class="literal">REPLACE</code> clause, if given, specifies
              the account current password, as described previously in
              this section.
            </p><p>
              The <code class="literal">RETAIN CURRENT PASSWORD</code> clause, if
              given, causes the account current password to be retained
              as its secondary password, as described previously in this
              section.
            </p></li><li class="listitem"><p>
              <code class="literal">IDENTIFIED WITH
              <em class="replaceable"><code>auth_plugin</code></em></code>
            </p><p>
              Sets the account authentication plugin to
              <em class="replaceable"><code>auth_plugin</code></em>, clears the
              credentials to the empty string (the credentials are
              associated with the old authentication plugin, not the new
              one), and stores the result in the account row in the
              <code class="literal">mysql.user</code> system table.
            </p><p>
              In addition, the password is marked expired. The user must
              choose a new one when next connecting.
            </p></li><li class="listitem"><p>
              <code class="literal">IDENTIFIED WITH
              <em class="replaceable"><code>auth_plugin</code></em> BY
              '<em class="replaceable"><code>auth_string</code></em>' [REPLACE
              '<em class="replaceable"><code>current_auth_string</code></em>'] [RETAIN
              CURRENT PASSWORD]</code>
            </p><p>
              Sets the account authentication plugin to
              <em class="replaceable"><code>auth_plugin</code></em>, passes the
              cleartext
              <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
              value to the plugin for possible hashing, and stores the
              result in the account row in the
              <code class="literal">mysql.user</code> system table.
            </p><p>
              The <code class="literal">REPLACE</code> clause, if given, specifies
              the account current password, as described previously in
              this section.
            </p><p>
              The <code class="literal">RETAIN CURRENT PASSWORD</code> clause, if
              given, causes the account current password to be retained
              as its secondary password, as described previously in this
              section.
            </p></li><li class="listitem"><p>
              <code class="literal">IDENTIFIED WITH
              <em class="replaceable"><code>auth_plugin</code></em> AS
              '<em class="replaceable"><code>auth_string</code></em>'</code>
            </p><p>
              Sets the account authentication plugin to
              <em class="replaceable"><code>auth_plugin</code></em> and stores the
              <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
              value as is in the <code class="literal">mysql.user</code> account
              row. If the plugin requires a hashed string, the string is
              assumed to be already hashed in the format the plugin
              requires.
            </p></li><li class="listitem"><p>
              <code class="literal">DISCARD OLD PASSWORD</code>
            </p><p>
              Discards the account secondary password, if there is one,
              as described previously in this section.
</p></li></ul>
</div>
<p>
          Example: Specify the password as cleartext; the default plugin
          is used:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  IDENTIFIED BY '<em class="replaceable"><code>password</code></em>';
</pre><p>
          Example: Specify the authentication plugin, along with a
          cleartext password value:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  IDENTIFIED WITH mysql_native_password
             BY '<em class="replaceable"><code>password</code></em>';
</pre><p>
          Example: Like the preceding example, but in addition, specify
          the current password as a cleartext value to satisfy any
          account requirement that the user making the change knows that
          password:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  IDENTIFIED WITH mysql_native_password
             BY '<em class="replaceable"><code>password</code></em>'
             REPLACE '<em class="replaceable"><code>current_password</code></em>';
</pre><p>
          The preceding statement fails unless the current user is
          <code class="literal">jeffrey</code> because <code class="literal">REPLACE</code>
          is permitted only for changes to the current user's password.
        </p><p>
          Example: Establish a new primary password and retain the
          existing password as the secondary password:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  IDENTIFIED BY '<em class="replaceable"><code>new_password</code></em>'
  RETAIN CURRENT PASSWORD;
</pre><p>
          Example: Discard the secondary password, leaving the account
          with only its primary password:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffery'@'localhost' DISCARD OLD PASSWORD;
</pre><p>
          Example: Specify the authentication plugin, along with a
          hashed password value:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  IDENTIFIED WITH mysql_native_password
             AS '*6C8989366EAF75BB670AD8EA7A7FC1176A95CEF4';
</pre><p>
          For additional information about setting passwords and
          authentication plugins, see
          <a class="xref" href="security.html#assigning-passwords" title="6.2.14 Assigning Account Passwords">Section 6.2.14, “Assigning Account Passwords”</a>, and
          <a class="xref" href="security.html#pluggable-authentication" title="6.2.17 Pluggable Authentication">Section 6.2.17, “Pluggable Authentication”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="alter-user-role"></a>ALTER USER Role Options</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659773344"></a><p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER ...
          DEFAULT ROLE</code></a> defines which roles become active when
          the user connects to the server and authenticates, or when the
          user executes the
          <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE
          DEFAULT</code></a> statement during a session.
        </p><p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER ...
          DEFAULT ROLE</code></a> is alternative syntax for
          <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT ROLE</code></a> (see
          <a class="xref" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax">Section 13.7.1.9, “SET DEFAULT ROLE Syntax”</a>). However,
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> can set the default
          for only a single user, whereas <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET
          DEFAULT ROLE</code></a> can set the default for multiple users.
          On the other hand, you can specify
          <code class="literal">CURRENT_USER</code> as the user name for the
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> statement, whereas
          you cannot for <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT
          ROLE</code></a>.
        </p><p>
          Each user account name uses the format described previously.
        </p><p>
          Each role name uses the format described in
          <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>. For example:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'joe'@'10.0.0.1' DEFAULT ROLE administrator, developer;
</pre><p>
          The host name part of the role name, if omitted, defaults to
          <code class="literal">'%'</code>.
        </p><p>
          The clause following the <code class="literal">DEFAULT ROLE</code>
          keywords permits these values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NONE</code>: Set the default to
              <code class="literal">NONE</code> (no roles).
            </p></li><li class="listitem"><p>
              <code class="literal">ALL</code>: Set the default to all roles
              granted to the account.
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>role</code></em> [,
              <em class="replaceable"><code>role</code></em> ] ...</code>: Set the
              default to the named roles, which must exist and be
              granted to the account at the time
              <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER ...
              DEFAULT ROLE</code></a> is executed.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="alter-user-tls"></a>ALTER USER SSL/TLS Options</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659745472"></a><a class="indexterm" name="idm140091659744016"></a><a class="indexterm" name="idm140091659742528"></a><p>
          MySQL can check X.509 certificate attributes in addition to
          the usual authentication that is based on the user name and
          credentials. For background information on the use of SSL/TLS
          with MySQL, see <a class="xref" href="security.html#encrypted-connections" title="6.3 Using Encrypted Connections">Section 6.3, “Using Encrypted Connections”</a>.
        </p><p>
          To specify SSL/TLS-related options for a MySQL account, use a
          <code class="literal">REQUIRE</code> clause that specifies one or more
          <em class="replaceable"><code>tls_option</code></em> values.
        </p><p>
          Order of <code class="literal">REQUIRE</code> options does not matter,
          but no option can be specified twice. The
          <code class="literal">AND</code> keyword is optional between
          <code class="literal">REQUIRE</code> options.
        </p><p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> permits these
          <em class="replaceable"><code>tls_option</code></em> values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NONE</code>
            </p><p>
              Indicates that all accounts named by the statement have no
              SSL or X.509 requirements. Unencrypted connections are
              permitted if the user name and password are valid.
              Encrypted connections can be used, at the client's option,
              if the client has the proper certificate and key files.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' REQUIRE NONE;
</pre><p>
              Clients attempt to establish a secure connection by
              default. For clients that have <code class="literal">REQUIRE
              NONE</code>, the connection attempt falls back to an
              unencrypted connection if a secure connection cannot be
              established. To require an encrypted connection, a client
              need specify only the
              <a class="link" href="security.html#option_general_ssl-mode"><code class="option">--ssl-mode=REQUIRED</code></a>
              option; the connection attempt fails if a secure
              connection cannot be established.
            </p></li><li class="listitem"><p>
              <code class="literal">SSL</code>
            </p><p>
              Tells the server to permit only encrypted connections for
              all accounts named by the statement.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' REQUIRE SSL;
</pre><p>
              Clients attempt to establish a secure connection by
              default. For accounts that have <code class="literal">REQUIRE
              SSL</code>, the connection attempt fails if a secure
              connection cannot be established.
            </p></li><li class="listitem"><p>
              <code class="literal">X509</code>
            </p><p>
              For all accounts named by the statement, requires that
              clients present a valid certificate, but the exact
              certificate, issuer, and subject do not matter. The only
              requirement is that it should be possible to verify its
              signature with one of the CA certificates. Use of X.509
              certificates always implies encryption, so the
              <code class="literal">SSL</code> option is unnecessary in this case.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' REQUIRE X509;
</pre><p>
              For accounts with <code class="literal">REQUIRE X509</code>, clients
              must specify the <a class="link" href="security.html#option_general_ssl-key"><code class="option">--ssl-key</code></a>
              and <a class="link" href="security.html#option_general_ssl-cert"><code class="option">--ssl-cert</code></a> options to
              connect. (It is recommended but not required that
              <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a> also be specified
              so that the public certificate provided by the server can
              be verified.) This is true for <code class="literal">ISSUER</code>
              and <code class="literal">SUBJECT</code> as well because those
              <code class="literal">REQUIRE</code> options imply the requirements
              of <code class="literal">X509</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">ISSUER
              '<em class="replaceable"><code>issuer</code></em>'</code>
            </p><p>
              For all accounts named by the statement, requires that
              clients present a valid X.509 certificate issued by CA
              <code class="literal">'<em class="replaceable"><code>issuer</code></em>'</code>. If
              a client presents a certificate that is valid but has a
              different issuer, the server rejects the connection. Use
              of X.509 certificates always implies encryption, so the
              <code class="literal">SSL</code> option is unnecessary in this case.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  REQUIRE ISSUER '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL/CN=CA/emailAddress=ca@example.com';
</pre><p>
              Because <code class="literal">ISSUER</code> implies the requirements
              of <code class="literal">X509</code>, clients must specify the
              <a class="link" href="security.html#option_general_ssl-key"><code class="option">--ssl-key</code></a> and
              <a class="link" href="security.html#option_general_ssl-cert"><code class="option">--ssl-cert</code></a> options to
              connect. (It is recommended but not required that
              <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a> also be specified
              so that the public certificate provided by the server can
              be verified.)
            </p></li><li class="listitem"><p>
              <code class="literal">SUBJECT
              '<em class="replaceable"><code>subject</code></em>'</code>
            </p><p>
              For all accounts named by the statement, requires that
              clients present a valid X.509 certificate containing the
              subject <em class="replaceable"><code>subject</code></em>. If a client
              presents a certificate that is valid but has a different
              subject, the server rejects the connection. Use of X.509
              certificates always implies encryption, so the
              <code class="literal">SSL</code> option is unnecessary in this case.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  REQUIRE SUBJECT '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL demo client certificate/
    CN=client/emailAddress=client@example.com';
</pre><p>
              MySQL does a simple string comparison of the
              <code class="literal">'<em class="replaceable"><code>subject</code></em>'</code>
              value to the value in the certificate, so lettercase and
              component ordering must be given exactly as present in the
              certificate.
            </p><p>
              Because <code class="literal">SUBJECT</code> implies the
              requirements of <code class="literal">X509</code>, clients must
              specify the <a class="link" href="security.html#option_general_ssl-key"><code class="option">--ssl-key</code></a> and
              <a class="link" href="security.html#option_general_ssl-cert"><code class="option">--ssl-cert</code></a> options to
              connect. (It is recommended but not required that
              <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a> also be specified
              so that the public certificate provided by the server can
              be verified.)
            </p></li><li class="listitem"><p>
              <code class="literal">CIPHER
              '<em class="replaceable"><code>cipher</code></em>'</code>
            </p><p>
              For all accounts named by the statement, requires a
              specific cipher method for encrypting connections. This
              option is needed to ensure that ciphers and key lengths of
              sufficient strength are used. Encryption can be weak if
              old algorithms using short encryption keys are used.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  REQUIRE CIPHER 'EDH-RSA-DES-CBC3-SHA';
</pre></li></ul>
</div>
<p>
          The <code class="literal">SUBJECT</code>, <code class="literal">ISSUER</code>, and
          <code class="literal">CIPHER</code> options can be combined in the
          <code class="literal">REQUIRE</code> clause:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  REQUIRE SUBJECT '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL demo client certificate/
    CN=client/emailAddress=client@example.com'
  AND ISSUER '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL/CN=CA/emailAddress=ca@example.com'
  AND CIPHER 'EDH-RSA-DES-CBC3-SHA';
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="alter-user-resource-limits"></a>ALTER USER Resource-Limit Options</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659680256"></a><a class="indexterm" name="idm140091659678768"></a><p>
          It is possible to place limits on use of server resources by
          an account, as discussed in <a class="xref" href="security.html#user-resources" title="6.2.20 Setting Account Resource Limits">Section 6.2.20, “Setting Account Resource Limits”</a>.
          To do so, use a <code class="literal">WITH</code> clause that specifies
          one or more <em class="replaceable"><code>resource_option</code></em> values.
        </p><p>
          Order of <code class="literal">WITH</code> options does not matter,
          except that if a given resource limit is specified multiple
          times, the last instance takes precedence.
        </p><p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> permits these
          <em class="replaceable"><code>resource_option</code></em> values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">MAX_QUERIES_PER_HOUR
              <em class="replaceable"><code>count</code></em></code>,
              <code class="literal">MAX_UPDATES_PER_HOUR
              <em class="replaceable"><code>count</code></em></code>,
              <code class="literal">MAX_CONNECTIONS_PER_HOUR
              <em class="replaceable"><code>count</code></em></code>
            </p><p>
              For all accounts named by the statement, these options
              restrict how many queries, updates, and connections to the
              server are permitted to each account during any given
              one-hour period. If <em class="replaceable"><code>count</code></em> is
              <code class="literal">0</code> (the default), this means that there
              is no limitation for the account.
            </p></li><li class="listitem"><p>
              <code class="literal">MAX_USER_CONNECTIONS
              <em class="replaceable"><code>count</code></em></code>
            </p><p>
              For all accounts named by the statement, restricts the
              maximum number of simultaneous connections to the server
              by each account. A nonzero
              <em class="replaceable"><code>count</code></em> specifies the limit for
              the account explicitly. If
              <em class="replaceable"><code>count</code></em> is <code class="literal">0</code>
              (the default), the server determines the number of
              simultaneous connections for the account from the global
              value of the
              <a class="link" href="server-administration.html#sysvar_max_user_connections"><code class="literal">max_user_connections</code></a>
              system variable. If
              <a class="link" href="server-administration.html#sysvar_max_user_connections"><code class="literal">max_user_connections</code></a> is
              also zero, there is no limit for the account.
</p></li></ul>
</div>
<p>
          Example:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost'
  WITH MAX_QUERIES_PER_HOUR 500 MAX_UPDATES_PER_HOUR 100;
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="alter-user-password-management"></a>ALTER USER Password-Management Options</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> supports several
          <em class="replaceable"><code>password_option</code></em> values for password
          management:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Password expiration options: You can expire an account
              password manually and establish its password expiration
              policy. Policy options do not expire the password.
              Instead, they determine how the server applies automatic
              expiration to the account based on password age, which is
              assessed from the date and time of the most recent account
              password change.
            </p></li><li class="listitem"><p>
              Password reuse options: You can restrict password reuse
              based on number of password changes, time elapsed, or
              both.
            </p></li><li class="listitem"><p>
              Password verification-required options: You can indicate
              whether attempts to change an account password must
              specify the current password, as verification that the
              user attempting to make the change actually knows the
              current password.
</p></li></ul>
</div>
<p>
          This section describes the syntax for password-management
          options. For information about establishing policy for
          password management, see
          <a class="xref" href="security.html#password-management" title="6.2.15 Password Management">Section 6.2.15, “Password Management”</a>.
        </p><p>
          If multiple password-management options of a given type
          (<code class="literal">PASSWORD EXPIRE</code>, <code class="literal">PASSWORD
          HISTORY</code>, <code class="literal">PASSWORD REUSE INTERVAL</code>,
          <code class="literal">PASSWORD REQUIRE</code>) are specified, the last
          one takes precedence.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Password-management options apply only to accounts that
            store credentials internally in the
            <code class="literal">mysql.user</code> system table
            (<code class="literal">mysql_native_password</code>,
            <code class="literal">sha256_password</code>, or
            <code class="literal">caching_sha2_password</code>). For accounts that
            use plugins that perform authentication against an external
            credential system, password management must be handled
            externally against that system as well.
</p>
</div>
<p>
          A client has an expired password if the account password was
          expired manually or the password age is considered greater
          than its permitted lifetime per the automatic expiration
          policy. In this case, the server either disconnects the client
          or restricts the operations permitted to it (see
          <a class="xref" href="security.html#expired-password-handling" title="6.2.16 Server Handling of Expired Passwords">Section 6.2.16, “Server Handling of Expired Passwords”</a>). Operations
          performed by a restricted client result in an error until the
          user establishes a new account password.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            It is possible to <span class="quote">“<span class="quote">reset</span>”</span> a password by setting
            it to its current value. As a matter of good policy, it is
            preferable to choose a different password. DBAs can enforce
            non-reuse by establishing an appropriate password-reuse
            policy. See <a class="xref" href="security.html#password-reuse-policy" title="Password Reuse Policy">Password Reuse Policy</a>.
</p>
</div>
<p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> permits these
          <em class="replaceable"><code>password_option</code></em> values for
          controlling password expiration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PASSWORD EXPIRE</code>
            </p><p>
              Immediately marks the password expired for all accounts
              named by the statement.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD EXPIRE;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD EXPIRE DEFAULT</code>
            </p><p>
              Sets all accounts named by the statement so that the
              global expiration policy applies, as specified by the
              <a class="link" href="server-administration.html#sysvar_default_password_lifetime"><code class="literal">default_password_lifetime</code></a>
              system variable.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD EXPIRE DEFAULT;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD EXPIRE NEVER</code>
            </p><p>
              This expiration option overrides the global policy for all
              accounts named by the statement. For each, it disables
              password expiration so that the password never expires.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD EXPIRE NEVER;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD EXPIRE INTERVAL
              <em class="replaceable"><code>N</code></em> DAY</code>
            </p><p>
              This expiration option overrides the global policy for all
              accounts named by the statement. For each, it sets the
              password lifetime to <em class="replaceable"><code>N</code></em> days.
              The following statement requires the password to be
              changed every 180 days:
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD EXPIRE INTERVAL 180 DAY;
</pre></li></ul>
</div>
<p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> permits these
          <em class="replaceable"><code>password_option</code></em> values for
          controlling reuse of previous passwords based on required
          minimum number of password changes:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PASSWORD HISTORY DEFAULT</code>
            </p><p>
              Sets all accounts named by the statement so that the
              global policy about password history length applies, to
              prohibit reuse of passwords before the number of changes
              specified by the
              <a class="link" href="server-administration.html#sysvar_password_history"><code class="literal">password_history</code></a> system
              variable.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD HISTORY DEFAULT;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD HISTORY
              <em class="replaceable"><code>N</code></em></code>
            </p><p>
              This history-length option overrides the global policy for
              all accounts named by the statement. For each, it sets the
              password history length to <em class="replaceable"><code>N</code></em>
              passwords, to prohibit reusing any of the
              <em class="replaceable"><code>N</code></em> most recently chosen
              passwords. The following statement prohibits reuse of any
              of the previous 6 passwords:
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD HISTORY 6;
</pre></li></ul>
</div>
<p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> permits these
          <em class="replaceable"><code>password_option</code></em> values for
          controlling reuse of previous passwords based on time elapsed:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PASSWORD REUSE INTERVAL DEFAULT</code>
            </p><p>
              Sets all statements named by the account so that the
              global policy about time elapsed applies, to prohibit
              reuse of passwords newer than the number of days specified
              by the
              <a class="link" href="server-administration.html#sysvar_password_reuse_interval"><code class="literal">password_reuse_interval</code></a>
              system variable.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD REUSE INTERVAL DEFAULT;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD REUSE INTERVAL
              <em class="replaceable"><code>N</code></em> DAY</code>
            </p><p>
              This time-elapsed option overrides the global policy for
              all accounts named by the statement. For each, it sets the
              password reuse interval to <em class="replaceable"><code>N</code></em>
              days, to prohibit reuse of passwords newer than that many
              days. The following statement prohibits password reuse for
              360 days:
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD REUSE INTERVAL 360 DAY;
</pre></li></ul>
</div>
<p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> permits these
          <em class="replaceable"><code>password_option</code></em> values for
          controlling whether attempts to change an account password
          must specify the current password, as verification that the
          user attempting to make the change actually knows the current
          password:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PASSWORD REQUIRE CURRENT</code>
            </p><p>
              This verification option overrides the global policy for
              all accounts named by the statement. For each, it requires
              that password changes specify the current password.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD REQUIRE CURRENT;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD REQUIRE CURRENT OPTIONAL</code>
            </p><p>
              This verification option overrides the global policy for
              all accounts named by the statement. For each, it does not
              require that password changes specify the current
              password. (The current password may but need not be
              given.)
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD REQUIRE CURRENT OPTIONAL;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD REQUIRE CURRENT DEFAULT</code>
            </p><p>
              Sets all statements named by the account so that the
              global policy about password verification applies, as
              specified by the
              <a class="link" href="server-administration.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a>
              system variable.
            </p><pre data-lang="sql" class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD REQUIRE CURRENT DEFAULT;
</pre></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="alter-user-account-locking"></a>ALTER USER Account-Locking Options</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659584336"></a><p>
          MySQL supports account locking and unlocking using the
          <code class="literal">ACCOUNT LOCK</code> and <code class="literal">ACCOUNT
          UNLOCK</code> options, which specify the locking state for
          an account. For additional discussion, see
          <a class="xref" href="security.html#account-locking" title="6.2.19 Account Locking">Section 6.2.19, “Account Locking”</a>.
        </p><p>
          If multiple account-locking options are specified, the last
          one takes precedence.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="alter-user-binary-logging"></a>ALTER USER Binary Logging</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659578352"></a><p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> is written to the
          binary log if it succeeds, but not if it fails; in that case,
          rollback occurs and no changes are made. A statement written
          to the binary log includes all named users. If the <code class="literal">IF
          EXISTS</code> clause is given, this includes even users
          that do not exist and were not altered.
        </p><p>
          If the original statement changes the credentials for a user,
          the statement written to the binary log specifies the
          applicable authentication plugin for that user, determined as
          follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              The plugin named in the original statement, if one was
              specified.
            </p></li><li class="listitem"><p>
              Otherwise, the plugin associated with the user account if
              the user exists, or the default authentication plugin if
              the user does not exist. (If the statement written to the
              binary log must specify a particular authentication plugin
              for a user, include it in the original statement.)
</p></li></ul>
</div>
<p>
          If the server adds the default authentication plugin for any
          users in the statement written to the binary log, it writes a
          warning to the error log naming those users.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-role"></a>13.7.1.2 CREATE ROLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659569264"></a><a class="indexterm" name="idm140091659568192"></a><a class="indexterm" name="idm140091659566704"></a><pre data-lang="sql" class="programlisting">
CREATE ROLE [IF NOT EXISTS] <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em> ] ...
</pre><p>
        <a class="link" href="sql-syntax.html#create-role" title="13.7.1.2 CREATE ROLE Syntax"><code class="literal">CREATE ROLE</code></a> creates one or more
        roles, which are named collections of privileges. To use this
        statement, you must have the global <a class="link" href="security.html#priv_create-role"><code class="literal">CREATE
        ROLE</code></a> or <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a>
        privilege. When the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a>
        system variable is enabled, <a class="link" href="sql-syntax.html#create-role" title="13.7.1.2 CREATE ROLE Syntax"><code class="literal">CREATE
        ROLE</code></a> additionally requires the
        <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        A role when created is locked, has no password, and is assigned
        the default authentication plugin. (These role attributes can be
        changed later with the <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a>
        statement, by users who have the global
        <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege.)
      </p><p>
        <a class="link" href="sql-syntax.html#create-role" title="13.7.1.2 CREATE ROLE Syntax"><code class="literal">CREATE ROLE</code></a> either succeeds for
        all named roles or rolls back and has no effect if any error
        occurs. By default, an error occurs if you try to create a role
        that already exists. If the <code class="literal">IF NOT EXISTS</code>
        clause is given, the statement produces a warning for each named
        role that already exists, rather than an error.
      </p><p>
        The statement is written to the binary log if it succeeds, but
        not if it fails; in that case, rollback occurs and no changes
        are made. A statement written to the binary log includes all
        named roles. If the <code class="literal">IF NOT EXISTS</code> clause is
        given, this includes even roles that already exist and were not
        created.
      </p><p>
        Each role name uses the format described in
        <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>. For example:
      </p><pre data-lang="sql" class="programlisting">
CREATE ROLE 'administrator', 'developer';
CREATE ROLE 'webapp'@'localhost';
</pre><p>
        The host name part of the role name, if omitted, defaults to
        <code class="literal">'%'</code>.
      </p><p>
        For role usage examples, see <a class="xref" href="security.html#roles" title="6.2.10 Using Roles">Section 6.2.10, “Using Roles”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-user"></a>13.7.1.3 CREATE USER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659538704"></a><a class="indexterm" name="idm140091659537632"></a><a class="indexterm" name="idm140091659536144"></a><pre data-lang="sql" class="programlisting">
CREATE USER [IF NOT EXISTS]
    <em class="replaceable"><code>user</code></em> [<em class="replaceable"><code>auth_option</code></em>] [, <em class="replaceable"><code>user</code></em> [<em class="replaceable"><code>auth_option</code></em>]] ...
    DEFAULT ROLE <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em> ] ...
    [REQUIRE {NONE | <em class="replaceable"><code>tls_option</code></em> [[AND] <em class="replaceable"><code>tls_option</code></em>] ...}]
    [WITH <em class="replaceable"><code>resource_option</code></em> [<em class="replaceable"><code>resource_option</code></em>] ...]
    [<em class="replaceable"><code>password_option</code></em> | <em class="replaceable"><code>lock_option</code></em>] ...

<em class="replaceable"><code>user</code></em>:
    (see <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>)

<em class="replaceable"><code>auth_option</code></em>: {
    IDENTIFIED BY '<em class="replaceable"><code>auth_string</code></em>'
  | IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em>
  | IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em> BY '<em class="replaceable"><code>auth_string</code></em>'
  | IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em> AS '<em class="replaceable"><code>auth_string</code></em>'
}

<em class="replaceable"><code>tls_option</code></em>: {
   SSL
 | X509
 | CIPHER '<em class="replaceable"><code>cipher</code></em>'
 | ISSUER '<em class="replaceable"><code>issuer</code></em>'
 | SUBJECT '<em class="replaceable"><code>subject</code></em>'
}

<em class="replaceable"><code>resource_option</code></em>: {
    MAX_QUERIES_PER_HOUR <em class="replaceable"><code>count</code></em>
  | MAX_UPDATES_PER_HOUR <em class="replaceable"><code>count</code></em>
  | MAX_CONNECTIONS_PER_HOUR <em class="replaceable"><code>count</code></em>
  | MAX_USER_CONNECTIONS <em class="replaceable"><code>count</code></em>
}

<em class="replaceable"><code>password_option</code></em>: {
    PASSWORD EXPIRE [DEFAULT | NEVER | INTERVAL <em class="replaceable"><code>N</code></em> DAY]
  | PASSWORD HISTORY {DEFAULT | <em class="replaceable"><code>N</code></em>}
  | PASSWORD REUSE INTERVAL {DEFAULT | <em class="replaceable"><code>N</code></em> DAY}
  | PASSWORD REQUIRE CURRENT [DEFAULT | OPTIONAL]
}

<em class="replaceable"><code>lock_option</code></em>: {
    ACCOUNT LOCK
  | ACCOUNT UNLOCK
}
</pre><p>
        The <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> statement creates
        new MySQL accounts. It enables authentication, role, SSL/TLS,
        resource-limit, and password-management properties to be
        established for new accounts. It also controls whether accounts
        are initially locked or unlocked.
      </p><p>
        To use <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>, you must have
        the global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege,
        or the <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for the
        <code class="literal">mysql</code> system database. When the
        <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system variable is
        enabled, <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> additionally
        requires the <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> either succeeds for
        all named users or rolls back and has no effect if any error
        occurs. By default, an error occurs if you try to create a user
        that already exists. If the <code class="literal">IF NOT EXISTS</code>
        clause is given, the statement produces a warning for each named
        user that already exists, rather than an error.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          Under some circumstances, <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE
          USER</code></a> may be recorded in server logs or on the client
          side in a history file such as
          <code class="filename">~/.mysql_history</code>, which means that
          cleartext passwords may be read by anyone having read access
          to that information. For information about the conditions
          under which this occurs for the server logs and how to control
          it, see <a class="xref" href="security.html#password-logging" title="6.1.2.3 Passwords and Logging">Section 6.1.2.3, “Passwords and Logging”</a>. For similar
          information about client-side logging, see
          <a class="xref" href="programs.html#mysql-logging" title="4.5.1.3 mysql Client Logging">Section 4.5.1.3, “mysql Client Logging”</a>.
</p>
</div>
<p>
        There are several aspects to the <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE
        USER</code></a> statement, described under the following topics:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-user-overview" title="CREATE USER Overview">CREATE USER Overview</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-user-authentication" title="CREATE USER Authentication Options">CREATE USER Authentication Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-user-role" title="CREATE USER Role Options">CREATE USER Role Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-user-tls" title="CREATE USER SSL/TLS Options">CREATE USER SSL/TLS Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-user-resource-limits" title="CREATE USER Resource-Limit Options">CREATE USER Resource-Limit Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-user-password-management" title="CREATE USER Password-Management Options">CREATE USER Password-Management Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-user-account-locking" title="CREATE USER Account-Locking Options">CREATE USER Account-Locking Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#create-user-binary-logging" title="CREATE USER Binary Logging">CREATE USER Binary Logging</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="create-user-overview"></a>CREATE USER Overview</h5>

</div>

</div>

</div>
<p>
          For each account, <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>
          creates a new row in the <code class="literal">mysql.user</code> system
          table. The account row reflects the properties specified in
          the statement. Unspecified properties are set to their default
          values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Authentication: The authentication plugin defined by the
              <a class="link" href="server-administration.html#sysvar_default_authentication_plugin"><code class="literal">default_authentication_plugin</code></a>
              system variable, and empty credentials
            </p></li><li class="listitem"><p>
              Default role: <code class="literal">NONE</code>
            </p></li><li class="listitem"><p>
              SSL/TLS: <code class="literal">NONE</code>
            </p></li><li class="listitem"><p>
              Resource limits: Unlimited
            </p></li><li class="listitem"><p>
              Password management: <code class="literal">PASSWORD EXPIRE DEFAULT
              PASSWORD HISTORY DEFAULT PASSWORD REUSE INTERVAL DEFAULT
              PASSWORD REQUIRE CURRENT DEFAULT</code>
            </p></li><li class="listitem"><p>
              Account locking: <code class="literal">ACCOUNT UNLOCK</code>
</p></li></ul>
</div>
<p>
          An account when first created has no privileges and a default
          role of <code class="literal">NONE</code>. To assign privileges or
          roles, use the <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement.
        </p><p>
          Each account name uses the format described in
          <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>. For example:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' IDENTIFIED BY '<em class="replaceable"><code>password</code></em>';
</pre><p>
          The host name part of the account name, if omitted, defaults
          to <code class="literal">'%'</code>.
        </p><p>
          Each <em class="replaceable"><code>user</code></em> value naming an account
          may be followed by an optional
          <em class="replaceable"><code>auth_option</code></em> value that indicates
          how the account authenticates. These values enable account
          authentication plugins and credentials (for example, a
          password) to be specified. Each
          <em class="replaceable"><code>auth_option</code></em> value applies
          <span class="emphasis"><em>only</em></span> to the account named immediately
          preceding it.
        </p><p>
          Following the <em class="replaceable"><code>user</code></em> specifications,
          the statement may include options for SSL/TLS, resource-limit,
          password-management, and locking properties. All such options
          are <span class="emphasis"><em>global</em></span> to the statement and apply to
          <span class="emphasis"><em>all</em></span> accounts named in the statement.
        </p><p>
          Example: Create an account that uses the default
          authentication plugin and the given password. Mark the
          password expired so that the user must choose a new one at the
          first connection to the server:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost'
  IDENTIFIED BY '<em class="replaceable"><code>new_password</code></em>' PASSWORD EXPIRE;
</pre><p>
          Example: Create an account that uses the
          <code class="literal">sha256_password</code> authentication plugin and
          the given password. Require that a new password be chosen
          every 180 days:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost'
  IDENTIFIED WITH sha256_password BY '<em class="replaceable"><code>new_password</code></em>'
  PASSWORD EXPIRE INTERVAL 180 DAY;
</pre><p>
          Example: Create multiple accounts, specifying some per-account
          properties and some global properties:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER
  'jeffrey'@'localhost' IDENTIFIED WITH mysql_native_password
                                   BY '<em class="replaceable"><code>new_password1</code></em>',
  'jeanne'@'localhost' IDENTIFIED WITH sha256_password
                                  BY '<em class="replaceable"><code>new_password2</code></em>'
  REQUIRE X509 WITH MAX_QUERIES_PER_HOUR 60
  PASSWORD HISTORY 5
  ACCOUNT LOCK;
</pre><p>
          Each <em class="replaceable"><code>auth_option</code></em> value
          (<code class="literal">IDENTIFIED WITH ... BY</code> in this case)
          applies only to the account named immediately preceding it, so
          each account uses the immediately following authentication
          plugin and password.
        </p><p>
          The remaining properties apply globally to all accounts named
          in the statement, so for both accounts:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Connections must be made using a valid X.509 certificate.
            </p></li><li class="listitem"><p>
              Up to 60 queries per hour are permitted.
            </p></li><li class="listitem"><p>
              Password changes cannot reuse any of the five most recent
              passwords.
            </p></li><li class="listitem"><p>
              The account is locked initially, so effectively it is a
              placeholder and cannot be used until an administrator
              unlocks it.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="create-user-authentication"></a>CREATE USER Authentication Options</h5>

</div>

</div>

</div>
<p>
          An account name may be followed by an
          <em class="replaceable"><code>auth_option</code></em> authentication option
          that specifies the account authentication plugin, credentials,
          or both:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <em class="replaceable"><code>auth_plugin</code></em> names an
              authentication plugin. The plugin name can be a quoted
              string literal or an unquoted name. Plugin names are
              stored in the <code class="literal">plugin</code> column of the
              <code class="literal">mysql.user</code> system table.
            </p><p>
              For <em class="replaceable"><code>auth_option</code></em> syntaxes that
              do not specify an authentication plugin, the default
              plugin is indicated by the value of the
              <a class="link" href="server-administration.html#sysvar_default_authentication_plugin"><code class="literal">default_authentication_plugin</code></a>
              system variable. For descriptions of each plugin, see
              <a class="xref" href="security.html#authentication-plugins" title="6.4.1 Authentication Plugins">Section 6.4.1, “Authentication Plugins”</a>.
            </p></li><li class="listitem"><p>
              Credentials are stored in the
              <code class="literal">mysql.user</code> system table. An
              <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
              value specifies account credentials, either as a cleartext
              (unencrypted) string or hashed in the format expected by
              the authentication plugin associated with the account,
              respectively:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  For syntaxes that use <code class="literal">BY
                  '<em class="replaceable"><code>auth_string</code></em>'</code>,
                  the string is cleartext and is passed to the
                  authentication plugin for possible hashing. The result
                  returned by the plugin is stored in the
                  <code class="literal">mysql.user</code> table. A plugin may use
                  the value as specified, in which case no hashing
                  occurs.
                </p></li><li class="listitem"><p>
                  For syntaxes that use <code class="literal">AS
                  '<em class="replaceable"><code>auth_string</code></em>'</code>,
                  the string is assumed to be already in the format the
                  authentication plugin requires, and is stored as is in
                  the <code class="literal">mysql.user</code> table. If a plugin
                  requires a hashed value, the value must be hashed in a
                  format appropriate for the plugin. Otherwise, the
                  value is not usable by the plugin and correct
                  authentication of client connections will not occur.
                </p><p>
                  As of MySQL 8.0.17, a hashed string can be either a
                  string literal or a hexadecimal value. The latter
                  corresponds to the type of value displayed by
                  <a class="link" href="sql-syntax.html#show-create-user" title="13.7.6.12 SHOW CREATE USER Syntax"><code class="literal">SHOW CREATE USER</code></a> for
                  password hashes containing unprintable characters when
                  the
                  <a class="link" href="server-administration.html#sysvar_print_identified_with_as_hex"><code class="literal">print_identified_with_as_hex</code></a>
                  system variable is enabled.
                </p></li><li class="listitem"><p>
                  If an authentication plugin does not perform hashing
                  of the authentication string, the <code class="literal">BY
                  '<em class="replaceable"><code>auth_string</code></em>'</code> and
                  <code class="literal">AS
                  '<em class="replaceable"><code>auth_string</code></em>'</code>
                  clauses have the same effect: Storage of the
                  authentication string as is in the
                  <code class="literal">mysql.user</code> table.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> permits these
          <em class="replaceable"><code>auth_option</code></em> syntaxes:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">IDENTIFIED BY
              '<em class="replaceable"><code>auth_string</code></em>'</code>
            </p><p>
              Sets the account authentication plugin to the default
              plugin, passes the cleartext
              <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
              value to the plugin for possible hashing, and stores the
              result in the account row in the
              <code class="literal">mysql.user</code> system table.
            </p></li><li class="listitem"><p>
              <code class="literal">IDENTIFIED WITH
              <em class="replaceable"><code>auth_plugin</code></em></code>
            </p><p>
              Sets the account authentication plugin to
              <em class="replaceable"><code>auth_plugin</code></em>, clears the
              credentials to the empty string, and stores the result in
              the account row in the <code class="literal">mysql.user</code>
              system table.
            </p></li><li class="listitem"><p>
              <code class="literal">IDENTIFIED WITH
              <em class="replaceable"><code>auth_plugin</code></em> BY
              '<em class="replaceable"><code>auth_string</code></em>'</code>
            </p><p>
              Sets the account authentication plugin to
              <em class="replaceable"><code>auth_plugin</code></em>, passes the
              cleartext
              <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
              value to the plugin for possible hashing, and stores the
              result in the account row in the
              <code class="literal">mysql.user</code> system table.
            </p></li><li class="listitem"><p>
              <code class="literal">IDENTIFIED WITH
              <em class="replaceable"><code>auth_plugin</code></em> AS
              '<em class="replaceable"><code>auth_string</code></em>'</code>
            </p><p>
              Sets the account authentication plugin to
              <em class="replaceable"><code>auth_plugin</code></em> and stores the
              <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
              value as is in the <code class="literal">mysql.user</code> account
              row. If the plugin requires a hashed string, the string is
              assumed to be already hashed in the format the plugin
              requires.
</p></li></ul>
</div>
<p>
          Example: Specify the password as cleartext; the default plugin
          is used:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost'
  IDENTIFIED BY '<em class="replaceable"><code>password</code></em>';
</pre><p>
          Example: Specify the authentication plugin, along with a
          cleartext password value:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost'
  IDENTIFIED WITH mysql_native_password BY '<em class="replaceable"><code>password</code></em>';
</pre><p>
          In each case, the password value stored in the account row is
          the cleartext value
          <code class="literal">'<em class="replaceable"><code>password</code></em>'</code> after
          it has been hashed by the authentication plugin associated
          with the account.
        </p><p>
          For additional information about setting passwords and
          authentication plugins, see
          <a class="xref" href="security.html#assigning-passwords" title="6.2.14 Assigning Account Passwords">Section 6.2.14, “Assigning Account Passwords”</a>, and
          <a class="xref" href="security.html#pluggable-authentication" title="6.2.17 Pluggable Authentication">Section 6.2.17, “Pluggable Authentication”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="create-user-role"></a>CREATE USER Role Options</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659392928"></a><p>
          The <code class="literal">DEFAULT ROLE</code> clause defines which roles
          become active when the user connects to the server and
          authenticates, or when the user executes the
          <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE
          DEFAULT</code></a> statement during a session.
        </p><p>
          Each role name uses the format described in
          <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>. For example:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER 'joe'@'10.0.0.1' DEFAULT ROLE administrator, developer;
</pre><p>
          The host name part of the role name, if omitted, defaults to
          <code class="literal">'%'</code>.
        </p><p>
          The <code class="literal">DEFAULT ROLE</code> clause permits a list of
          one or more comma-separated role names. These roles need not
          exist at the time <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>
          is executed.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="create-user-tls"></a>CREATE USER SSL/TLS Options</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659381872"></a><a class="indexterm" name="idm140091659380416"></a><a class="indexterm" name="idm140091659378928"></a><p>
          MySQL can check X.509 certificate attributes in addition to
          the usual authentication that is based on the user name and
          credentials. For background information on the use of SSL/TLS
          with MySQL, see <a class="xref" href="security.html#encrypted-connections" title="6.3 Using Encrypted Connections">Section 6.3, “Using Encrypted Connections”</a>.
        </p><p>
          To specify SSL/TLS-related options for a MySQL account, use a
          <code class="literal">REQUIRE</code> clause that specifies one or more
          <em class="replaceable"><code>tls_option</code></em> values.
        </p><p>
          Order of <code class="literal">REQUIRE</code> options does not matter,
          but no option can be specified twice. The
          <code class="literal">AND</code> keyword is optional between
          <code class="literal">REQUIRE</code> options.
        </p><p>
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> permits these
          <em class="replaceable"><code>tls_option</code></em> values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NONE</code>
            </p><p>
              Indicates that all accounts named by the statement have no
              SSL or X.509 requirements. Unencrypted connections are
              permitted if the user name and password are valid.
              Encrypted connections can be used, at the client's option,
              if the client has the proper certificate and key files.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' REQUIRE NONE;
</pre><p>
              Clients attempt to establish a secure connection by
              default. For clients that have <code class="literal">REQUIRE
              NONE</code>, the connection attempt falls back to an
              unencrypted connection if a secure connection cannot be
              established. To require an encrypted connection, a client
              need specify only the
              <a class="link" href="security.html#option_general_ssl-mode"><code class="option">--ssl-mode=REQUIRED</code></a>
              option; the connection attempt fails if a secure
              connection cannot be established.
            </p><p>
              <code class="literal">NONE</code> is the default if no SSL-related
              <code class="literal">REQUIRE</code> options are specified.
            </p></li><li class="listitem"><p>
              <code class="literal">SSL</code>
            </p><p>
              Tells the server to permit only encrypted connections for
              all accounts named by the statement.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' REQUIRE SSL;
</pre><p>
              Clients attempt to establish a secure connection by
              default. For accounts that have <code class="literal">REQUIRE
              SSL</code>, the connection attempt fails if a secure
              connection cannot be established.
            </p></li><li class="listitem"><p>
              <code class="literal">X509</code>
            </p><p>
              For all accounts named by the statement, requires that
              clients present a valid certificate, but the exact
              certificate, issuer, and subject do not matter. The only
              requirement is that it should be possible to verify its
              signature with one of the CA certificates. Use of X.509
              certificates always implies encryption, so the
              <code class="literal">SSL</code> option is unnecessary in this case.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' REQUIRE X509;
</pre><p>
              For accounts with <code class="literal">REQUIRE X509</code>, clients
              must specify the <a class="link" href="security.html#option_general_ssl-key"><code class="option">--ssl-key</code></a>
              and <a class="link" href="security.html#option_general_ssl-cert"><code class="option">--ssl-cert</code></a> options to
              connect. (It is recommended but not required that
              <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a> also be specified
              so that the public certificate provided by the server can
              be verified.) This is true for <code class="literal">ISSUER</code>
              and <code class="literal">SUBJECT</code> as well because those
              <code class="literal">REQUIRE</code> options imply the requirements
              of <code class="literal">X509</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">ISSUER
              '<em class="replaceable"><code>issuer</code></em>'</code>
            </p><p>
              For all accounts named by the statement, requires that
              clients present a valid X.509 certificate issued by CA
              <code class="literal">'<em class="replaceable"><code>issuer</code></em>'</code>. If
              a client presents a certificate that is valid but has a
              different issuer, the server rejects the connection. Use
              of X.509 certificates always implies encryption, so the
              <code class="literal">SSL</code> option is unnecessary in this case.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost'
  REQUIRE ISSUER '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL/CN=CA/emailAddress=ca@example.com';
</pre><p>
              Because <code class="literal">ISSUER</code> implies the requirements
              of <code class="literal">X509</code>, clients must specify the
              <a class="link" href="security.html#option_general_ssl-key"><code class="option">--ssl-key</code></a> and
              <a class="link" href="security.html#option_general_ssl-cert"><code class="option">--ssl-cert</code></a> options to
              connect. (It is recommended but not required that
              <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a> also be specified
              so that the public certificate provided by the server can
              be verified.)
            </p></li><li class="listitem"><p>
              <code class="literal">SUBJECT
              '<em class="replaceable"><code>subject</code></em>'</code>
            </p><p>
              For all accounts named by the statement, requires that
              clients present a valid X.509 certificate containing the
              subject <em class="replaceable"><code>subject</code></em>. If a client
              presents a certificate that is valid but has a different
              subject, the server rejects the connection. Use of X.509
              certificates always implies encryption, so the
              <code class="literal">SSL</code> option is unnecessary in this case.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost'
  REQUIRE SUBJECT '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL demo client certificate/
    CN=client/emailAddress=client@example.com';
</pre><p>
              MySQL does a simple string comparison of the
              <code class="literal">'<em class="replaceable"><code>subject</code></em>'</code>
              value to the value in the certificate, so lettercase and
              component ordering must be given exactly as present in the
              certificate.
            </p><p>
              Because <code class="literal">SUBJECT</code> implies the
              requirements of <code class="literal">X509</code>, clients must
              specify the <a class="link" href="security.html#option_general_ssl-key"><code class="option">--ssl-key</code></a> and
              <a class="link" href="security.html#option_general_ssl-cert"><code class="option">--ssl-cert</code></a> options to
              connect. (It is recommended but not required that
              <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a> also be specified
              so that the public certificate provided by the server can
              be verified.)
            </p></li><li class="listitem"><p>
              <code class="literal">CIPHER
              '<em class="replaceable"><code>cipher</code></em>'</code>
            </p><p>
              For all accounts named by the statement, requires a
              specific cipher method for encrypting connections. This
              option is needed to ensure that ciphers and key lengths of
              sufficient strength are used. Encryption can be weak if
              old algorithms using short encryption keys are used.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost'
  REQUIRE CIPHER 'EDH-RSA-DES-CBC3-SHA';
</pre></li></ul>
</div>
<p>
          The <code class="literal">SUBJECT</code>, <code class="literal">ISSUER</code>, and
          <code class="literal">CIPHER</code> options can be combined in the
          <code class="literal">REQUIRE</code> clause:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost'
  REQUIRE SUBJECT '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL demo client certificate/
    CN=client/emailAddress=client@example.com'
  AND ISSUER '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL/CN=CA/emailAddress=ca@example.com'
  AND CIPHER 'EDH-RSA-DES-CBC3-SHA';
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="create-user-resource-limits"></a>CREATE USER Resource-Limit Options</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659314784"></a><a class="indexterm" name="idm140091659313296"></a><p>
          It is possible to place limits on use of server resources by
          an account, as discussed in <a class="xref" href="security.html#user-resources" title="6.2.20 Setting Account Resource Limits">Section 6.2.20, “Setting Account Resource Limits”</a>.
          To do so, use a <code class="literal">WITH</code> clause that specifies
          one or more <em class="replaceable"><code>resource_option</code></em> values.
        </p><p>
          Order of <code class="literal">WITH</code> options does not matter,
          except that if a given resource limit is specified multiple
          times, the last instance takes precedence.
        </p><p>
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> permits these
          <em class="replaceable"><code>resource_option</code></em> values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">MAX_QUERIES_PER_HOUR
              <em class="replaceable"><code>count</code></em></code>,
              <code class="literal">MAX_UPDATES_PER_HOUR
              <em class="replaceable"><code>count</code></em></code>,
              <code class="literal">MAX_CONNECTIONS_PER_HOUR
              <em class="replaceable"><code>count</code></em></code>
            </p><p>
              For all accounts named by the statement, these options
              restrict how many queries, updates, and connections to the
              server are permitted to each account during any given
              one-hour period. If <em class="replaceable"><code>count</code></em> is
              <code class="literal">0</code> (the default), this means that there
              is no limitation for the account.
            </p></li><li class="listitem"><p>
              <code class="literal">MAX_USER_CONNECTIONS
              <em class="replaceable"><code>count</code></em></code>
            </p><p>
              For all accounts named by the statement, restricts the
              maximum number of simultaneous connections to the server
              by each account. A nonzero
              <em class="replaceable"><code>count</code></em> specifies the limit for
              the account explicitly. If
              <em class="replaceable"><code>count</code></em> is <code class="literal">0</code>
              (the default), the server determines the number of
              simultaneous connections for the account from the global
              value of the
              <a class="link" href="server-administration.html#sysvar_max_user_connections"><code class="literal">max_user_connections</code></a>
              system variable. If
              <a class="link" href="server-administration.html#sysvar_max_user_connections"><code class="literal">max_user_connections</code></a> is
              also zero, there is no limit for the account.
</p></li></ul>
</div>
<p>
          Example:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost'
  WITH MAX_QUERIES_PER_HOUR 500 MAX_UPDATES_PER_HOUR 100;
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="create-user-password-management"></a>CREATE USER Password-Management Options</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> supports several
          <em class="replaceable"><code>password_option</code></em> values for password
          management:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Password expiration options: You can expire an account
              password manually and establish its password expiration
              policy. Policy options do not expire the password.
              Instead, they determine how the server applies automatic
              expiration to the account based on password age, which is
              assessed from the date and time of the most recent account
              password change.
            </p></li><li class="listitem"><p>
              Password reuse options: You can restrict password reuse
              based on number of password changes, time elapsed, or
              both.
            </p></li><li class="listitem"><p>
              Password verification-required options: You can indicate
              whether attempts to change an account password must
              specify the current password, as verification that the
              user attempting to make the change actually knows the
              current password.
</p></li></ul>
</div>
<p>
          This section describes the syntax for password-management
          options. For information about establishing policy for
          password management, see
          <a class="xref" href="security.html#password-management" title="6.2.15 Password Management">Section 6.2.15, “Password Management”</a>.
        </p><p>
          If multiple password-management options of a given type
          (<code class="literal">PASSWORD EXPIRE</code>, <code class="literal">PASSWORD
          HISTORY</code>, <code class="literal">PASSWORD REUSE INTERVAL</code>,
          <code class="literal">PASSWORD REQUIRE</code>) are specified, the last
          one takes precedence.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Password-management options apply only to accounts that
            store credentials internally in the
            <code class="literal">mysql.user</code> system table
            (<code class="literal">mysql_native_password</code>,
            <code class="literal">sha256_password</code>, or
            <code class="literal">caching_sha2_password</code>). For accounts that
            use plugins that perform authentication against an external
            credential system, password management must be handled
            externally against that system as well.
</p>
</div>
<p>
          A client has an expired password if the account password was
          expired manually or the password age is considered greater
          than its permitted lifetime per the automatic expiration
          policy. In this case, the server either disconnects the client
          or restricts the operations permitted to it (see
          <a class="xref" href="security.html#expired-password-handling" title="6.2.16 Server Handling of Expired Passwords">Section 6.2.16, “Server Handling of Expired Passwords”</a>). Operations
          performed by a restricted client result in an error until the
          user establishes a new account password.
        </p><p>
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> permits these
          <em class="replaceable"><code>password_option</code></em> values for
          controlling password expiration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PASSWORD EXPIRE</code>
            </p><p>
              Immediately marks the password expired for all accounts
              named by the statement.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD EXPIRE;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD EXPIRE DEFAULT</code>
            </p><p>
              Sets all accounts named by the statement so that the
              global expiration policy applies, as specified by the
              <a class="link" href="server-administration.html#sysvar_default_password_lifetime"><code class="literal">default_password_lifetime</code></a>
              system variable.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD EXPIRE DEFAULT;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD EXPIRE NEVER</code>
            </p><p>
              This expiration option overrides the global policy for all
              accounts named by the statement. For each, it disables
              password expiration so that the password never expires.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD EXPIRE NEVER;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD EXPIRE INTERVAL
              <em class="replaceable"><code>N</code></em> DAY</code>
            </p><p>
              This expiration option overrides the global policy for all
              accounts named by the statement. For each, it sets the
              password lifetime to <em class="replaceable"><code>N</code></em> days.
              The following statement requires the password to be
              changed every 180 days:
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD EXPIRE INTERVAL 180 DAY;
</pre></li></ul>
</div>
<p>
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> permits these
          <em class="replaceable"><code>password_option</code></em> values for
          controlling reuse of previous passwords based on required
          minimum number of password changes:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PASSWORD HISTORY DEFAULT</code>
            </p><p>
              Sets all accounts named by the statement so that the
              global policy about password history length applies, to
              prohibit reuse of passwords before the number of changes
              specified by the
              <a class="link" href="server-administration.html#sysvar_password_history"><code class="literal">password_history</code></a> system
              variable.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD HISTORY DEFAULT;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD HISTORY
              <em class="replaceable"><code>N</code></em></code>
            </p><p>
              This history-length option overrides the global policy for
              all accounts named by the statement. For each, it sets the
              password history length to <em class="replaceable"><code>N</code></em>
              passwords, to prohibit reusing any of the
              <em class="replaceable"><code>N</code></em> most recently chosen
              passwords. The following statement prohibits reuse of any
              of the previous 6 passwords:
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD HISTORY 6;
</pre></li></ul>
</div>
<p>
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> permits these
          <em class="replaceable"><code>password_option</code></em> values for
          controlling reuse of previous passwords based on time elapsed:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PASSWORD REUSE INTERVAL DEFAULT</code>
            </p><p>
              Sets all statements named by the account so that the
              global policy about time elapsed applies, to prohibit
              reuse of passwords newer than the number of days specified
              by the
              <a class="link" href="server-administration.html#sysvar_password_reuse_interval"><code class="literal">password_reuse_interval</code></a>
              system variable.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD REUSE INTERVAL DEFAULT;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD REUSE INTERVAL
              <em class="replaceable"><code>N</code></em> DAY</code>
            </p><p>
              This time-elapsed option overrides the global policy for
              all accounts named by the statement. For each, it sets the
              password reuse interval to <em class="replaceable"><code>N</code></em>
              days, to prohibit reuse of passwords newer than that many
              days. The following statement prohibits password reuse for
              360 days:
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD REUSE INTERVAL 360 DAY;
</pre></li></ul>
</div>
<p>
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> permits these
          <em class="replaceable"><code>password_option</code></em> values for
          controlling whether attempts to change an account password
          must specify the current password, as verification that the
          user attempting to make the change actually knows the current
          password:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PASSWORD REQUIRE CURRENT</code>
            </p><p>
              This verification option overrides the global policy for
              all accounts named by the statement. For each, it requires
              that password changes specify the current password.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD REQUIRE CURRENT;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD REQUIRE CURRENT OPTIONAL</code>
            </p><p>
              This verification option overrides the global policy for
              all accounts named by the statement. For each, it does not
              require that password changes specify the current
              password. (The current password may but need not be
              given.)
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD REQUIRE CURRENT OPTIONAL;
</pre></li><li class="listitem"><p>
              <code class="literal">PASSWORD REQUIRE CURRENT DEFAULT</code>
            </p><p>
              Sets all statements named by the account so that the
              global policy about password verification applies, as
              specified by the
              <a class="link" href="server-administration.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a>
              system variable.
            </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' PASSWORD REQUIRE CURRENT DEFAULT;
</pre></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="create-user-account-locking"></a>CREATE USER Account-Locking Options</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659221040"></a><p>
          MySQL supports account locking and unlocking using the
          <code class="literal">ACCOUNT LOCK</code> and <code class="literal">ACCOUNT
          UNLOCK</code> options, which specify the locking state for
          an account. For additional discussion, see
          <a class="xref" href="security.html#account-locking" title="6.2.19 Account Locking">Section 6.2.19, “Account Locking”</a>.
        </p><p>
          If multiple account-locking options are specified, the last
          one takes precedence.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="create-user-binary-logging"></a>CREATE USER Binary Logging</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659215056"></a><p>
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> is written to the
          binary log if it succeeds, but not if it fails; in that case,
          rollback occurs and no changes are made. A statement written
          to the binary log includes all named users. If the <code class="literal">IF
          NOT EXISTS</code> clause is given, this includes even users
          that already exist and were not created.
        </p><p>
          The statement written to the binary log specifies an
          authentication plugin for each user, determined as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              The plugin named in the original statement, if one was
              specified.
            </p></li><li class="listitem"><p>
              Otherwise, the default authentication plugin. In
              particular, if a user <code class="literal">u1</code> already exists
              and uses a nondefault authentication plugin, the statement
              written to the binary log for <code class="literal">CREATE USER IF NOT
              EXISTS u1</code> names the default authentication
              plugin. (If the statement written to the binary log must
              specify a nondefault authentication plugin for a user,
              include it in the original statement.)
</p></li></ul>
</div>
<p>
          If the server adds the default authentication plugin for any
          nonexisting users in the statement written to the binary log,
          it writes a warning to the error log naming those users.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="drop-role"></a>13.7.1.4 DROP ROLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659204480"></a><a class="indexterm" name="idm140091659203408"></a><a class="indexterm" name="idm140091659201920"></a><pre data-lang="sql" class="programlisting">
DROP ROLE [IF EXISTS] <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em> ] ...
</pre><p>
        <a class="link" href="sql-syntax.html#drop-role" title="13.7.1.4 DROP ROLE Syntax"><code class="literal">DROP ROLE</code></a> removes one or more
        roles (named collections of privileges). To use this statement,
        you must have the global <a class="link" href="security.html#priv_drop-role"><code class="literal">DROP
        ROLE</code></a> or <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a>
        privilege. When the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a>
        system variable is enabled, <a class="link" href="sql-syntax.html#drop-role" title="13.7.1.4 DROP ROLE Syntax"><code class="literal">DROP
        ROLE</code></a> additionally requires the
        <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        As of MySQL 8.0.16, users who have the
        <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege can use
        this statement to drop accounts that are locked or unlocked.
        Users who have the <a class="link" href="security.html#priv_drop-role"><code class="literal">DROP ROLE</code></a>
        privilege can use this statement only to drop accounts that are
        locked (unlocked accounts are presumably user accounts used to
        log in to the server and not just as roles).
      </p><p>
        Roles named in the
        <a class="link" href="server-administration.html#sysvar_mandatory_roles"><code class="literal">mandatory_roles</code></a> system variable
        value cannot be dropped.
      </p><p>
        <a class="link" href="sql-syntax.html#drop-role" title="13.7.1.4 DROP ROLE Syntax"><code class="literal">DROP ROLE</code></a> either succeeds for all
        named roles or rolls back and has no effect if any error occurs.
        By default, an error occurs if you try to drop a role that does
        not exist. If the <code class="literal">IF EXISTS</code> clause is given,
        the statement produces a warning for each named role that does
        not exist, rather than an error.
      </p><p>
        The statement is written to the binary log if it succeeds, but
        not if it fails; in that case, rollback occurs and no changes
        are made. A statement written to the binary log includes all
        named roles. If the <code class="literal">IF EXISTS</code> clause is
        given, this includes even roles that do not exist and were not
        dropped.
      </p><p>
        Each role name uses the format described in
        <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>. For example:
      </p><pre data-lang="sql" class="programlisting">
DROP ROLE 'administrator', 'developer';
DROP ROLE 'webapp'@'localhost';
</pre><p>
        The host name part of the role name, if omitted, defaults to
        <code class="literal">'%'</code>.
      </p><p>
        A dropped role is automatically revoked from any user account
        (or role) to which the role was granted. Within any current
        session for such an account, its adjusted privileges apply
        beginning with the next statement executed.
      </p><p>
        For role usage examples, see <a class="xref" href="security.html#roles" title="6.2.10 Using Roles">Section 6.2.10, “Using Roles”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="drop-user"></a>13.7.1.5 DROP USER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659171440"></a><a class="indexterm" name="idm140091659170368"></a><a class="indexterm" name="idm140091659168880"></a><a class="indexterm" name="idm140091659167392"></a><a class="indexterm" name="idm140091659165904"></a><a class="indexterm" name="idm140091659164416"></a><a class="indexterm" name="idm140091659162928"></a><a class="indexterm" name="idm140091659161440"></a><a class="indexterm" name="idm140091659159952"></a><pre data-lang="sql" class="programlisting">
DROP USER [IF EXISTS] <em class="replaceable"><code>user</code></em> [, <em class="replaceable"><code>user</code></em>] ...
</pre><p>
        The <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a> statement removes
        one or more MySQL accounts and their privileges. It removes
        privilege rows for the account from all grant tables.
      </p><p>
        Roles named in the
        <a class="link" href="server-administration.html#sysvar_mandatory_roles"><code class="literal">mandatory_roles</code></a> system variable
        value cannot be dropped.
      </p><p>
        To use <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a>, you must have
        the global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege,
        or the <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege for the
        <code class="literal">mysql</code> system database. When the
        <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system variable is
        enabled, <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a> additionally
        requires the <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a> either succeeds for all
        named users or rolls back and has no effect if any error occurs.
        By default, an error occurs if you try to drop a user that does
        not exist. If the <code class="literal">IF EXISTS</code> clause is given,
        the statement produces a warning for each named user that does
        not exist, rather than an error.
      </p><p>
        The statement is written to the binary log if it succeeds, but
        not if it fails; in that case, rollback occurs and no changes
        are made. A statement written to the binary log includes all
        named users. If the <code class="literal">IF EXISTS</code> clause is
        given, this includes even users that do not exist and were not
        dropped.
      </p><p>
        Each account name uses the format described in
        <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>. For example:
      </p><pre data-lang="sql" class="programlisting">
DROP USER 'jeffrey'@'localhost';
</pre><p>
        The host name part of the account name, if omitted, defaults to
        <code class="literal">'%'</code>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a> does not
          automatically close any open user sessions. Rather, in the
          event that a user with an open session is dropped, the
          statement does not take effect until that user's session is
          closed. Once the session is closed, the user is dropped, and
          that user's next attempt to log in will fail. <span class="emphasis"><em>This
          is by design</em></span>.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a> does not automatically
        drop or invalidate databases or objects within them that the old
        user created. This includes stored programs or views for which
        the <code class="literal">DEFINER</code> attribute names the dropped user.
        Attempts to access such objects may produce an error if they
        execute in definer security context. (For information about
        security context, see
        <a class="xref" href="stored-objects.html#stored-objects-security" title="24.6 Stored Object Access Control">Section 24.6, “Stored Object Access Control”</a>.)
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="grant"></a>13.7.1.6 GRANT Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091659125472"></a><a class="indexterm" name="idm140091659124400"></a><a class="indexterm" name="idm140091659123312"></a><a class="indexterm" name="idm140091659121824"></a><a class="indexterm" name="idm140091659120752"></a><a class="indexterm" name="idm140091659119264"></a><a class="indexterm" name="idm140091659117776"></a><pre data-lang="sql" class="programlisting">
GRANT
    <em class="replaceable"><code>priv_type</code></em> [(<em class="replaceable"><code>column_list</code></em>)]
      [, <em class="replaceable"><code>priv_type</code></em> [(<em class="replaceable"><code>column_list</code></em>)]] ...
    ON [<em class="replaceable"><code>object_type</code></em>] <em class="replaceable"><code>priv_level</code></em>
    TO <em class="replaceable"><code>user_or_role</code></em> [, <em class="replaceable"><code>user_or_role</code></em>] ...
    [WITH GRANT OPTION]
    [AS <em class="replaceable"><code>user</code></em>
        [WITH ROLE
            DEFAULT
          | NONE
          | ALL
          | ALL EXCEPT <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em> ] ...
          | <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em> ] ...
        ]
    ]
}

GRANT PROXY ON <em class="replaceable"><code>user_or_role</code></em>
    TO <em class="replaceable"><code>user_or_role</code></em> [, <em class="replaceable"><code>user_or_role</code></em>] ...
    [WITH GRANT OPTION]

GRANT <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em>] ...
    TO <em class="replaceable"><code>user_or_role</code></em> [, <em class="replaceable"><code>user_or_role</code></em>] ...
    [WITH ADMIN OPTION]

<em class="replaceable"><code>object_type</code></em>: {
    TABLE
  | FUNCTION
  | PROCEDURE
}

<em class="replaceable"><code>priv_level</code></em>: {
    *
  | *.*
  | <em class="replaceable"><code>db_name</code></em>.*
  | <em class="replaceable"><code>db_name.tbl_name</code></em>
  | <em class="replaceable"><code>tbl_name</code></em>
  | <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>routine_name</code></em>
}

<em class="replaceable"><code>user_or_role</code></em>: {
    <em class="replaceable"><code>user</code></em>
  | <em class="replaceable"><code>role</code></em>
}

<em class="replaceable"><code>user</code></em>:
    (see <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>)

<em class="replaceable"><code>role</code></em>:
    (see <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>)
</pre><p>
        The <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement assigns
        privileges and roles to MySQL user accounts and roles. There are
        several aspects to the <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a>
        statement, described under the following topics:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-overview" title="GRANT General Overview">GRANT General Overview</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-quoting" title="Object Quoting Guidelines">Object Quoting Guidelines</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-accounts" title="Account Names">Account Names</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-privileges" title="Privileges Supported by MySQL">Privileges Supported by MySQL</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-global-privileges" title="Global Privileges">Global Privileges</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-database-privileges" title="Database Privileges">Database Privileges</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-table-privileges" title="Table Privileges">Table Privileges</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-column-privileges" title="Column Privileges">Column Privileges</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-routine-privileges" title="Stored Routine Privileges">Stored Routine Privileges</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-proxy-privileges" title="Proxy User Privileges">Proxy User Privileges</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-roles" title="Granting Roles">Granting Roles</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-as" title="The AS Clause and Privilege Restrictions">The <code class="literal">AS</code> Clause and Privilege Restrictions</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-other-characteristics" title="Other Account Characteristics">Other Account Characteristics</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#grant-mysql-vs-standard-sql" title="MySQL and Standard SQL Versions of GRANT">MySQL and Standard SQL Versions of GRANT</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="grant-overview"></a>GRANT General Overview</h5>

</div>

</div>

</div>
<p>
          The <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement enables
          system administrators to grant privileges and roles, which can
          be granted to user accounts and roles. These syntax
          restrictions apply:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> cannot mix granting
              both privileges and roles in the same statement. A given
              <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement must grant
              either privileges or roles.
            </p></li><li class="listitem"><p>
              The <code class="literal">ON</code> clause distinguishes whether the
              statement grants privileges or roles:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  With <code class="literal">ON</code>, the statement grants
                  privileges.
                </p></li><li class="listitem"><p>
                  Without <code class="literal">ON</code>, the statement grants
                  roles.
                </p></li><li class="listitem"><p>
                  It is permitted to assign both privileges and roles to
                  an account, but you must use separate
                  <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statements, each
                  with syntax appropriate to what is to be granted.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
          For more information about roles, see <a class="xref" href="security.html#roles" title="6.2.10 Using Roles">Section 6.2.10, “Using Roles”</a>.
        </p><p>
          To use <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a>, you must have the
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> privilege, and you
          must have the privileges that you are granting. When the
          <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system variable is
          enabled, <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> additionally
          requires the <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a>
          or <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
        </p><p>
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> either succeeds for all
          named users and roles or rolls back and has no effect if any
          error occurs. The statement is written to the binary log only
          if it succeeds for all named users and roles.
        </p><p>
          The <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> statement is related
          to <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> and enables
          administrators to remove account privileges. See
          <a class="xref" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax">Section 13.7.1.8, “REVOKE Syntax”</a>.
        </p><p>
          Each account name uses the format described in
          <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>. Each role name uses the
          format described in <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>. For example:
        </p><pre data-lang="sql" class="programlisting">
GRANT ALL ON db1.* TO 'jeffrey'@'localhost';
GRANT 'role1', 'role2' TO 'user1'@'localhost', 'user2'@'localhost';
GRANT SELECT ON world.* TO 'role3';
</pre><p>
          The host name part of the account or role name, if omitted,
          defaults to <code class="literal">'%'</code>.
        </p><p>
          Normally, a database administrator first uses
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> to create an
          account and define its nonprivilege characteristics such as
          its password, whether it uses secure connections, and limits
          on access to server resources, then uses
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> to define its privileges.
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> may be used to
          change the nonprivilege characteristics of existing accounts.
          For example:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER 'jeffrey'@'localhost' IDENTIFIED BY '<em class="replaceable"><code>password</code></em>';
GRANT ALL ON db1.* TO 'jeffrey'@'localhost';
GRANT SELECT ON db2.invoice TO 'jeffrey'@'localhost';
ALTER USER 'jeffrey'@'localhost' WITH MAX_QUERIES_PER_HOUR 90;
</pre><p>
          From the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> program,
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> responds with
          <code class="literal">Query OK, 0 rows affected</code> when executed
          successfully. To determine what privileges result from the
          operation, use <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a>. See
          <a class="xref" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax">Section 13.7.6.21, “SHOW GRANTS Syntax”</a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            Under some circumstances,
            <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> may be recorded in
            server logs or on the client side in a history file such as
            <code class="filename">~/.mysql_history</code>, which means that
            cleartext passwords may be read by anyone having read access
            to that information. For information about the conditions
            under which this occurs for the server logs and how to
            control it, see <a class="xref" href="security.html#password-logging" title="6.1.2.3 Passwords and Logging">Section 6.1.2.3, “Passwords and Logging”</a>. For
            similar information about client-side logging, see
            <a class="xref" href="programs.html#mysql-logging" title="4.5.1.3 mysql Client Logging">Section 4.5.1.3, “mysql Client Logging”</a>.
</p>
</div>
<p>
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> supports host names up to
          255 characters long (60 characters prior to MySQL 8.0.17).
          User names can be up to 32 characters. Database, table,
          column, and routine names can be up to 64 characters.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
            <span class="emphasis"><em>Do not attempt to change the permissible length
            for user names by altering the <code class="literal">mysql.user</code>
            system table. Doing so results in unpredictable behavior
            which may even make it impossible for users to log in to the
            MySQL server</em></span>. Never alter the structure of tables
            in the <code class="literal">mysql</code> system database in any
            manner except by means of the procedure described in
            <a class="xref" href="installing.html#upgrading" title="2.11 Upgrading MySQL">Section 2.11, “Upgrading MySQL”</a>.
</p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-quoting"></a>Object Quoting Guidelines</h5>

</div>

</div>

</div>
<p>
          Several objects within <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a>
          statements are subject to quoting, although quoting is
          optional in many cases: Account, role, database, table,
          column, and routine names. For example, if a
          <em class="replaceable"><code>user_name</code></em> or
          <em class="replaceable"><code>host_name</code></em> value in an account name
          is legal as an unquoted identifier, you need not quote it.
          However, quotation marks are necessary to specify a
          <em class="replaceable"><code>user_name</code></em> string containing special
          characters (such as <code class="literal">-</code>), or a
          <em class="replaceable"><code>host_name</code></em> string containing special
          characters or wildcard characters such as <code class="literal">%</code>
          (for example, <code class="literal">'test-user'@'%.com'</code>). Quote
          the user name and host name separately.
        </p><p>
          To specify quoted values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Quote database, table, column, and routine names as
              identifiers.
            </p></li><li class="listitem"><p>
              Quote user names and host names as identifiers or as
              strings.
            </p></li><li class="listitem"><p>
              Quote passwords as strings.
</p></li></ul>
</div>
<p>
          For string-quoting and identifier-quoting guidelines, see
          <a class="xref" href="language-structure.html#string-literals" title="9.1.1 String Literals">Section 9.1.1, “String Literals”</a>, and
          <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>.
        </p><p>
          The <code class="literal">_</code> and <code class="literal">%</code> wildcards
          are permitted when specifying database names in
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statements that grant
          privileges at the database level (<code class="literal">GRANT ... ON
          <em class="replaceable"><code>db_name</code></em>.*</code>). This means,
          for example, that to use a <code class="literal">_</code> character as
          part of a database name, specify it as <code class="literal">\_</code>
          in the <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement, to
          prevent the user from being able to access additional
          databases matching the wildcard pattern (for example,
          <code class="literal">GRANT ... ON `foo\_bar`.* TO ...</code>).
        </p><p>
          When a database name not is used to grant privileges at the
          database level, but as a qualifier for granting privileges to
          some other object such as a table or routine (for example,
          <code class="literal">GRANT ... ON
          <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em></code>),
          wildcard characters are treated as normal characters.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-accounts"></a>Account Names</h5>

</div>

</div>

</div>
<p>
          A <em class="replaceable"><code>user</code></em> value in a
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement indicates a
          MySQL account to which the statement applies. To accommodate
          granting rights to users from arbitrary hosts, MySQL supports
          specifying the <em class="replaceable"><code>user</code></em> value in the
          form
          <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>.
        </p><p>
          You can specify wildcards in the host name. For example,
          <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'%.example.com'</code>
          applies to <em class="replaceable"><code>user_name</code></em> for any host
          in the <code class="literal">example.com</code> domain, and
          <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'198.51.100.%'</code>
          applies to <em class="replaceable"><code>user_name</code></em> for any host
          in the <code class="literal">198.51.100</code> class C subnet.
        </p><p>
          The simple form
          <code class="literal">'<em class="replaceable"><code>user_name</code></em>'</code> is a
          synonym for
          <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'%'</code>.
        </p><p>
          <span class="emphasis"><em>MySQL does not support wildcards in user
          names</em></span>. To refer to an anonymous user, specify an
          account with an empty user name with the
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement:
        </p><pre data-lang="sql" class="programlisting">
GRANT ALL ON test.* TO ''@'localhost' ...;
</pre><p>
          In this case, any user who connects from the local host with
          the correct password for the anonymous user will be permitted
          access, with the privileges associated with the anonymous-user
          account.
        </p><p>
          For additional information about user name and host name
          values in account names, see <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
            If you permit local anonymous users to connect to the MySQL
            server, you should also grant privileges to all local users
            as
            <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'localhost'</code>.
            Otherwise, the anonymous user account for
            <code class="literal">localhost</code> in the
            <code class="literal">mysql.user</code> system table is used when
            named users try to log in to the MySQL server from the local
            machine. For details, see
            <a class="xref" href="security.html#connection-access" title="6.2.6 Access Control, Stage 1: Connection Verification">Section 6.2.6, “Access Control, Stage 1: Connection Verification”</a>.
          </p><p>
            To determine whether this issue applies to you, execute the
            following query, which lists any anonymous users:
          </p><pre data-lang="sql" class="programlisting">
SELECT Host, User FROM mysql.user WHERE User='';
</pre><p>
            To avoid the problem just described, delete the local
            anonymous user account using this statement:
          </p><pre data-lang="sql" class="programlisting">
DROP USER ''@'localhost';
</pre>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-privileges"></a>Privileges Supported by MySQL</h5>

</div>

</div>

</div>
<p>
          The following tables summarize the permissible static and
          dynamic <em class="replaceable"><code>priv_type</code></em> privilege types
          that can be specified for the
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> and
          <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> statements, and the
          levels at which each privilege can be granted. For additional
          information about each privilege, see
          <a class="xref" href="security.html#privileges-provided" title="6.2.2 Privileges Provided by MySQL">Section 6.2.2, “Privileges Provided by MySQL”</a>. For information about
          the differences between static and dynamic privileges, see
          <a class="xref" href="security.html#static-dynamic-privileges" title="Static Versus Dynamic Privileges">Static Versus Dynamic Privileges</a>.
</p>
<div class="table">
<a name="idm140091658968448"></a><p class="title"><b>Table 13.11 Permissible Static Privileges for GRANT and REVOKE</b></p>
<div class="table-contents">
<table><col width="30%"><col width="70%"><thead><tr>
              <th scope="col">Privilege</th>
              <th scope="col">Meaning and Grantable Levels</th>
            </tr></thead><tbody><tr>
              <td scope="row"><a class="link" href="security.html#priv_all"><code class="literal">ALL [PRIVILEGES]</code></a></td>
              <td>Grant all privileges at specified access level except
                <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> and
                <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a>.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a></td>
              <td>Enable use of <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>. Levels:
                Global, database, table.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a></td>
              <td>Enable stored routines to be altered or dropped. Levels: Global,
                database, routine.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a></td>
              <td>Enable database and table creation. Levels: Global, database, table.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_create-role"><code class="literal">CREATE ROLE</code></a></td>
              <td>Enable role creation. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_create-routine"><code class="literal">CREATE ROUTINE</code></a></td>
              <td>Enable stored routine creation. Levels: Global, database.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_create-tablespace"><code class="literal">CREATE TABLESPACE</code></a></td>
              <td>Enable tablespaces and log file groups to be created, altered, or
                dropped. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_create-temporary-tables"><code class="literal">CREATE TEMPORARY TABLES</code></a></td>
              <td>Enable use of <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
                TEMPORARY TABLE</code></a>. Levels: Global, database.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a></td>
              <td>Enable use of <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>,
                <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a>,
                <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.7 RENAME USER Syntax"><code class="literal">RENAME USER</code></a>, and
                <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE ALL
                PRIVILEGES</code></a>. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_create-view"><code class="literal">CREATE VIEW</code></a></td>
              <td>Enable views to be created or altered. Levels: Global, database, table.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a></td>
              <td>Enable use of <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>. Level: Global,
                database, table.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a></td>
              <td>Enable databases, tables, and views to be dropped. Levels: Global,
                database, table.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_drop-role"><code class="literal">DROP ROLE</code></a></td>
              <td>Enable roles to be dropped. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a></td>
              <td>Enable use of events for the Event Scheduler. Levels: Global, database.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a></td>
              <td>Enable the user to execute stored routines. Levels: Global, database,
                routine.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a></td>
              <td>Enable the user to cause the server to read or write files. Level:
                Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a></td>
              <td>Enable privileges to be granted to or removed from other accounts.
                Levels: Global, database, table, routine, proxy.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_index"><code class="literal">INDEX</code></a></td>
              <td>Enable indexes to be created or dropped. Levels: Global, database,
                table.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a></td>
              <td>Enable use of <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>. Levels: Global,
                database, table, column.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_lock-tables"><code class="literal">LOCK TABLES</code></a></td>
              <td>Enable use of <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> on tables for
                which you have the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
                privilege. Levels: Global, database.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a></td>
              <td>Enable the user to see all processes with <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
                PROCESSLIST</code></a>. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a></td>
              <td>Enable user proxying. Level: From user to user.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_references"><code class="literal">REFERENCES</code></a></td>
              <td>Enable foreign key creation. Levels: Global, database, table, column.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a></td>
              <td>Enable use of <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> operations. Level:
                Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_replication-client"><code class="literal">REPLICATION CLIENT</code></a></td>
              <td>Enable the user to ask where master or slave servers are. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_replication-slave"><code class="literal">REPLICATION SLAVE</code></a></td>
              <td>Enable replication slaves to read binary log events from the master.
                Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a></td>
              <td>Enable use of <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>. Levels: Global,
                database, table, column.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_show-databases"><code class="literal">SHOW DATABASES</code></a></td>
              <td>Enable <a class="link" href="sql-syntax.html#show-databases" title="13.7.6.14 SHOW DATABASES Syntax"><code class="literal">SHOW DATABASES</code></a> to show all
                databases. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_show-view"><code class="literal">SHOW VIEW</code></a></td>
              <td>Enable use of <a class="link" href="sql-syntax.html#show-create-view" title="13.7.6.13 SHOW CREATE VIEW Syntax"><code class="literal">SHOW CREATE VIEW</code></a>. Levels:
                Global, database, table.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_shutdown"><code class="literal">SHUTDOWN</code></a></td>
              <td>Enable use of <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin shutdown</strong></span></a>. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a></td>
              <td>Enable use of other administrative operations such as
                <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>,
                <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL</code></a>,
                <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY LOGS</code></a>,
                <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET
                GLOBAL</code></a>, and <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin
                debug</strong></span></a> command. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a></td>
              <td>Enable trigger operations. Levels: Global, database, table.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a></td>
              <td>Enable use of <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>. Levels: Global,
                database, table, column.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_usage"><code class="literal">USAGE</code></a></td>
              <td>Synonym for <span class="quote">“<span class="quote">no privileges</span>”</span></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="table">
<a name="idm140091658817216"></a><p class="title"><b>Table 13.12 Permissible Dynamic Privileges for GRANT and REVOKE</b></p>
<div class="table-contents">
<table><col width="30%"><col width="70%"><thead><tr>
              <th scope="col">Privilege</th>
              <th scope="col">Meaning and Grantable Levels</th>
            </tr></thead><tbody><tr>
              <td scope="row"><a class="link" href="security.html#priv_application-password-admin"><code class="literal">APPLICATION_PASSWORD_ADMIN</code></a></td>
              <td>Enable dual password administration. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_audit-admin"><code class="literal">AUDIT_ADMIN</code></a></td>
              <td>Enable audit log configuration. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_backup-admin"><code class="literal">BACKUP_ADMIN</code></a></td>
              <td>Enable backup administration. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_binlog-admin"><code class="literal">BINLOG_ADMIN</code></a></td>
              <td>Enable binary log control. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_binlog-encryption-admin"><code class="literal">BINLOG_ENCRYPTION_ADMIN</code></a></td>
              <td>Enable activation and deactivation of binary log encryption. Level:
                Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a></td>
              <td>Enable connection limit/restriction control. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_encryption-key-admin"><code class="literal">ENCRYPTION_KEY_ADMIN</code></a></td>
              <td>Enable <code class="literal">InnoDB</code> key rotation. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_firewall-admin"><code class="literal">FIREWALL_ADMIN</code></a></td>
              <td>Enable firewall rule administration, any user. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_firewall-user"><code class="literal">FIREWALL_USER</code></a></td>
              <td>Enable firewall rule administration, self. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_group-replication-admin"><code class="literal">GROUP_REPLICATION_ADMIN</code></a></td>
              <td>Enable Group Replication control. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_persist-ro-variables-admin"><code class="literal">PERSIST_RO_VARIABLES_ADMIN</code></a></td>
              <td>Enable persisting read-only system variables. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_replication-slave-admin"><code class="literal">REPLICATION_SLAVE_ADMIN</code></a></td>
              <td>Enable regular replication control. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_resource-group-admin"><code class="literal">RESOURCE_GROUP_ADMIN</code></a></td>
              <td>Enable resource group administration. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_resource-group-user"><code class="literal">RESOURCE_GROUP_USER</code></a></td>
              <td>Enable resource group administration. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_role-admin"><code class="literal">ROLE_ADMIN</code></a></td>
              <td>Enable roles to be granted or revoked, use of <code class="literal">WITH ADMIN
                OPTION</code>. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_session-variables-admin"><code class="literal">SESSION_VARIABLES_ADMIN</code></a></td>
              <td>Enable setting restricted session system variables. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_set-user-id"><code class="literal">SET_USER_ID</code></a></td>
              <td>Enable setting non-self <code class="literal">DEFINER</code> values. Level:
                Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_system-user"><code class="literal">SYSTEM_USER</code></a></td>
              <td>Designate account as system account. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_system-variables-admin"><code class="literal">SYSTEM_VARIABLES_ADMIN</code></a></td>
              <td>Enable modifying or persisting global system variables. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_table-encryption-admin"><code class="literal">TABLE_ENCRYPTION_ADMIN</code></a></td>
              <td>Enable overriding default encryption settings. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_version-token-admin"><code class="literal">VERSION_TOKEN_ADMIN</code></a></td>
              <td>Enable use of Version Tokens UDFs. Level: Global.</td>
            </tr><tr>
              <td scope="row"><a class="link" href="security.html#priv_xa-recover-admin"><code class="literal">XA_RECOVER_ADMIN</code></a></td>
              <td>Enable <a class="link" href="sql-syntax.html#xa-statements" title="13.3.8.1 XA Transaction SQL Syntax"><code class="literal">XA
                RECOVER</code></a> execution. Level: Global.</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
          A trigger is associated with a table. To create or drop a
          trigger, you must have the
          <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a> privilege for the
          table, not the trigger.
        </p><p>
          In <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statements, the
          <a class="link" href="security.html#priv_all"><code class="literal">ALL
          [PRIVILEGES]</code></a> or <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a>
          privilege must be named by itself and cannot be specified
          along with other privileges.
          <a class="link" href="security.html#priv_all"><code class="literal">ALL
          [PRIVILEGES]</code></a> stands for all privileges available for
          the level at which privileges are to be granted except for the
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> and
          <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a> privileges.
        </p><p>
          MySQL account information is stored in the tables of the
          <code class="literal">mysql</code> system database. For additional
          details, consult <a class="xref" href="security.html#access-control" title="6.2 Access Control and Account Management">Section 6.2, “Access Control and Account Management”</a>, which
          discusses the <code class="literal">mysql</code> system database and the
          access control system extensively.
        </p><a class="indexterm" name="idm140091658721008"></a><p>
          If the grant tables hold privilege rows that contain
          mixed-case database or table names and the
          <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> system
          variable is set to a nonzero value,
          <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> cannot be used to revoke
          these privileges. It will be necessary to manipulate the grant
          tables directly. (<a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> will
          not create such rows when
          <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> is
          set, but such rows might have been created prior to setting
          that variable. The
          <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a>
          setting can only be configured at server startup.)
        </p><p>
          Privileges can be granted at several levels, depending on the
          syntax used for the <code class="literal">ON</code> clause. For
          <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a>, the same
          <code class="literal">ON</code> syntax specifies which privileges to
          remove.
        </p><p>
          For the global, database, table, and routine levels,
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT ALL</code></a>
          assigns only the privileges that exist at the level you are
          granting. For example, <code class="literal">GRANT ALL ON
          <em class="replaceable"><code>db_name</code></em>.*</code> is a
          database-level statement, so it does not grant any global-only
          privileges such as <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a>.
          Granting <a class="link" href="security.html#priv_all"><code class="literal">ALL</code></a> does not assign
          the <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> or
          <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a> privilege.
        </p><p>
          The <em class="replaceable"><code>object_type</code></em> clause, if present,
          should be specified as <code class="literal">TABLE</code>,
          <code class="literal">FUNCTION</code>, or <code class="literal">PROCEDURE</code>
          when the following object is a table, a stored function, or a
          stored procedure.
        </p><p>
          The privileges that a user holds for a database, table,
          column, or routine are formed additively as the logical
          <a class="link" href="functions.html#operator_or"><code class="literal">OR</code></a> of the account privileges at
          each of the privilege levels, including the global level. It
          is not possible to deny a privilege granted at a higher level
          by absence of that privilege at a lower level. For example,
          this statement grants the
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> and
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges globally:
        </p><pre data-lang="sql" class="programlisting">
GRANT SELECT, INSERT ON *.* TO u1;
</pre><p>
          The globally granted privileges apply to all databases,
          tables, and columns, even though not granted at any of those
          lower levels.
        </p><p>
          As of MySQL 8.0.16, it is possible to explicitly deny a
          privilege granted at the global level by revoking it for
          particular databases, if the
          <a class="link" href="server-administration.html#sysvar_partial_revokes"><code class="literal">partial_revokes</code></a> system
          variable is enabled:
        </p><pre data-lang="sql" class="programlisting">
GRANT SELECT, INSERT, UPDATE ON *.* TO u1;
REVOKE INSERT, UPDATE ON db1.* FROM u1;
</pre><p>
          The result of the preceding statements is that
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> applies globally to all
          tables, whereas <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> and
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> apply globally except to
          tables in <code class="literal">db1</code>. Account access to
          <code class="literal">db1</code> is read only.
        </p><p>
          Details of the privilege-checking procedure are presented in
          <a class="xref" href="security.html#request-access" title="6.2.7 Access Control, Stage 2: Request Verification">Section 6.2.7, “Access Control, Stage 2: Request Verification”</a>.
        </p><p>
          If you are using table, column, or routine privileges for even
          one user, the server examines table, column, and routine
          privileges for all users and this slows down MySQL a bit.
          Similarly, if you limit the number of queries, updates, or
          connections for any users, the server must monitor these
          values.
        </p><p>
          MySQL enables you to grant privileges on databases or tables
          that do not exist. For tables, the privileges to be granted
          must include the <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a>
          privilege. <span class="emphasis"><em>This behavior is by design</em></span>,
          and is intended to enable the database administrator to
          prepare user accounts and privileges for databases or tables
          that are to be created at a later time.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            <span class="emphasis"><em>MySQL does not automatically revoke any privileges
            when you drop a database or table</em></span>. However, if
            you drop a routine, any routine-level privileges granted for
            that routine are revoked.
</p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-global-privileges"></a>Global Privileges</h5>

</div>

</div>

</div>
<p>
          Global privileges are administrative or apply to all databases
          on a given server. To assign global privileges, use
          <code class="literal">ON *.*</code> syntax:
        </p><pre data-lang="sql" class="programlisting">
GRANT ALL ON *.* TO 'someuser'@'somehost';
GRANT SELECT, INSERT ON *.* TO 'someuser'@'somehost';
</pre><p>
          The <a class="link" href="security.html#priv_create-tablespace"><code class="literal">CREATE TABLESPACE</code></a>,
          <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a>,
          <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a>,
          <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a>,
          <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a>,
          <a class="link" href="security.html#priv_replication-client"><code class="literal">REPLICATION CLIENT</code></a>,
          <a class="link" href="security.html#priv_replication-slave"><code class="literal">REPLICATION SLAVE</code></a>,
          <a class="link" href="security.html#priv_show-databases"><code class="literal">SHOW DATABASES</code></a>,
          <a class="link" href="security.html#priv_shutdown"><code class="literal">SHUTDOWN</code></a>, and
          <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> static privileges are
          administrative and can only be granted globally.
        </p><p>
          Dynamic privileges are all global and can only be granted
          globally.
        </p><p>
          Other privileges can be granted globally or at more specific
          levels.
        </p><p>
          The effect of <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>
          granted at the global level differs for static and dynamic
          privileges:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> granted for
              any static global privilege applies to all static global
              privileges.
            </p></li><li class="listitem"><p>
              <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> granted for
              any dynamic privilege applies only to that dynamic
              privilege.
</p></li></ul>
</div>
<p>
          <code class="literal">GRANT ALL</code> at the global level grants all
          static global privileges and all currently registered dynamic
          privileges. A dynamic privilege registered subsequent to
          execution of the <code class="literal">GRANT</code> statement is not
          granted retroactively to any account.
        </p><p>
          MySQL stores global privileges in the
          <code class="literal">mysql.user</code> system table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-database-privileges"></a>Database Privileges</h5>

</div>

</div>

</div>
<p>
          Database privileges apply to all objects in a given database.
          To assign database-level privileges, use <code class="literal">ON
          <em class="replaceable"><code>db_name</code></em>.*</code> syntax:
        </p><pre data-lang="sql" class="programlisting">
GRANT ALL ON mydb.* TO 'someuser'@'somehost';
GRANT SELECT, INSERT ON mydb.* TO 'someuser'@'somehost';
</pre><p>
          If you use <code class="literal">ON *</code> syntax (rather than
          <code class="literal">ON *.*</code>), privileges are assigned at the
          database level for the default database. An error occurs if
          there is no default database.
        </p><p>
          The <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a>,
          <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a>,
          <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a>,
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>,
          <a class="link" href="security.html#priv_lock-tables"><code class="literal">LOCK TABLES</code></a>, and
          <a class="link" href="security.html#priv_references"><code class="literal">REFERENCES</code></a> privileges can be
          specified at the database level. Table or routine privileges
          also can be specified at the database level, in which case
          they apply to all tables or routines in the database.
        </p><p>
          MySQL stores database privileges in the
          <code class="literal">mysql.db</code> system table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-table-privileges"></a>Table Privileges</h5>

</div>

</div>

</div>
<p>
          Table privileges apply to all columns in a given table. To
          assign table-level privileges, use <code class="literal">ON
          <em class="replaceable"><code>db_name.tbl_name</code></em></code> syntax:
        </p><pre data-lang="sql" class="programlisting">
GRANT ALL ON mydb.mytbl TO 'someuser'@'somehost';
GRANT SELECT, INSERT ON mydb.mytbl TO 'someuser'@'somehost';
</pre><p>
          If you specify <em class="replaceable"><code>tbl_name</code></em> rather than
          <em class="replaceable"><code>db_name.tbl_name</code></em>, the statement
          applies to <em class="replaceable"><code>tbl_name</code></em> in the default
          database. An error occurs if there is no default database.
        </p><p>
          The permissible <em class="replaceable"><code>priv_type</code></em> values at
          the table level are <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a>,
          <a class="link" href="security.html#priv_create-view"><code class="literal">CREATE VIEW</code></a>,
          <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a>,
          <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a>,
          <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a>,
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>,
          <a class="link" href="security.html#priv_index"><code class="literal">INDEX</code></a>,
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a>,
          <a class="link" href="security.html#priv_references"><code class="literal">REFERENCES</code></a>,
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>,
          <a class="link" href="security.html#priv_show-view"><code class="literal">SHOW VIEW</code></a>,
          <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a>, and
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>.
        </p><p>
          Table-level privileges apply to base tables and views. They do
          not apply to tables created with <a class="link" href="sql-syntax.html#create-temporary-table" title="13.1.20.3 CREATE TEMPORARY TABLE Syntax"><code class="literal">CREATE
          TEMPORARY TABLE</code></a>, even if the table names match. For
          information about <code class="literal">TEMPORARY</code> table
          privileges, see <a class="xref" href="sql-syntax.html#create-temporary-table" title="13.1.20.3 CREATE TEMPORARY TABLE Syntax">Section 13.1.20.3, “CREATE TEMPORARY TABLE Syntax”</a>.
        </p><a class="indexterm" name="idm140091658610032"></a><a class="indexterm" name="idm140091658608544"></a><p>
          MySQL stores table privileges in the
          <code class="literal">mysql.tables_priv</code> system table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-column-privileges"></a>Column Privileges</h5>

</div>

</div>

</div>
<p>
          Column privileges apply to single columns in a given table.
          Each privilege to be granted at the column level must be
          followed by the column or columns, enclosed within
          parentheses.
        </p><pre data-lang="sql" class="programlisting">
GRANT SELECT (col1), INSERT (col1, col2) ON mydb.mytbl TO 'someuser'@'somehost';
</pre><p>
          The permissible <em class="replaceable"><code>priv_type</code></em> values
          for a column (that is, when you use a
          <em class="replaceable"><code>column_list</code></em> clause) are
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a>,
          <a class="link" href="security.html#priv_references"><code class="literal">REFERENCES</code></a>,
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>, and
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>.
        </p><p>
          MySQL stores column privileges in the
          <code class="literal">mysql.columns_priv</code> system table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-routine-privileges"></a>Stored Routine Privileges</h5>

</div>

</div>

</div>
<p>
          The <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a>,
          <a class="link" href="security.html#priv_create-routine"><code class="literal">CREATE ROUTINE</code></a>,
          <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a>, and
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> privileges apply
          to stored routines (procedures and functions). They can be
          granted at the global and database levels. Except for
          <a class="link" href="security.html#priv_create-routine"><code class="literal">CREATE ROUTINE</code></a>, these
          privileges can be granted at the routine level for individual
          routines.
        </p><pre data-lang="sql" class="programlisting">
GRANT CREATE ROUTINE ON mydb.* TO 'someuser'@'somehost';
GRANT EXECUTE ON PROCEDURE mydb.myproc TO 'someuser'@'somehost';
</pre><p>
          The permissible <em class="replaceable"><code>priv_type</code></em> values at
          the routine level are <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER
          ROUTINE</code></a>, <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a>, and
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>.
          <a class="link" href="security.html#priv_create-routine"><code class="literal">CREATE ROUTINE</code></a> is not a
          routine-level privilege because you must have the privilege at
          the global or database level to create a routine in the first
          place.
        </p><p>
          MySQL stores routine-level privileges in the
          <code class="literal">mysql.procs_priv</code> system table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-proxy-privileges"></a>Proxy User Privileges</h5>

</div>

</div>

</div>
<p>
          The <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a> privilege enables one
          user to be a proxy for another. The proxy user impersonates or
          takes the identity of the proxied user; that is, it assumes
          the privileges of the proxied user.
        </p><pre data-lang="sql" class="programlisting">
GRANT PROXY ON 'localuser'@'localhost' TO 'externaluser'@'somehost';
</pre><p>
          When <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a> is granted, it must
          be the only privilege named in the
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement, and the only
          permitted <code class="literal">WITH</code> option is <code class="literal">WITH
          GRANT OPTION</code>.
        </p><p>
          Proxying requires that the proxy user authenticate through a
          plugin that returns the name of the proxied user to the server
          when the proxy user connects, and that the proxy user have the
          <code class="literal">PROXY</code> privilege for the proxied user. For
          details and examples, see <a class="xref" href="security.html#proxy-users" title="6.2.18 Proxy Users">Section 6.2.18, “Proxy Users”</a>.
        </p><p>
          MySQL stores proxy privileges in the
          <code class="literal">mysql.proxies_priv</code> system table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-roles"></a>Granting Roles</h5>

</div>

</div>

</div>
<p>
          <code class="literal">GRANT</code> syntax without an
          <code class="literal">ON</code> clause grants roles rather than
          individual privileges. A role is a named collection of
          privileges; see <a class="xref" href="security.html#roles" title="6.2.10 Using Roles">Section 6.2.10, “Using Roles”</a>. For example:
        </p><pre data-lang="sql" class="programlisting">
GRANT 'role1', 'role2' TO 'user1'@'localhost', 'user2'@'localhost';
</pre><p>
          Each role to be granted must exist, as well as each user
          account or role to which it is to be granted. As of MySQL
          8.0.16, roles cannot be granted to anonymous users.
        </p><p>
          Granting a role does not automatically cause the role to be
          active. For information about role activation and
          inactivation, see <a class="xref" href="security.html#roles-activating" title="Activating Roles">Activating Roles</a>.
        </p><p>
          These privileges are required to grant roles:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              If you have the <a class="link" href="security.html#priv_role-admin"><code class="literal">ROLE_ADMIN</code></a>
              or <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, you can
              grant or revoke any role to users or roles.
            </p></li><li class="listitem"><p>
              If you were granted a role with a
              <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement that
              includes the <code class="literal">WITH ADMIN OPTION</code> clause,
              you become able to grant that role to other users or
              roles, or revoke it from other users or roles, as long as
              the role is active at such time as you subsequently grant
              or revoke it. This includes the ability to use
              <code class="literal">WITH ADMIN OPTION</code> itself.
            </p></li><li class="listitem"><p>
              To grant a role that has the
              <a class="link" href="security.html#priv_system-user"><code class="literal">SYSTEM_USER</code></a> privilege, you
              must have the <a class="link" href="security.html#priv_system-user"><code class="literal">SYSTEM_USER</code></a>
              privilege.
</p></li></ul>
</div>
<p>
          It is possible to create circular references with
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a>. For example:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER 'u1', 'u2';
CREATE ROLE 'r1', 'r2';

GRANT 'u1' TO 'u1';   -- simple loop: u1 =&gt; u1
GRANT 'r1' TO 'r1';   -- simple loop: r1 =&gt; r1

GRANT 'r2' TO 'u2';
GRANT 'u2' TO 'r2';   -- mixed user/role loop: u2 =&gt; r2 =&gt; u2
</pre><p>
          Circular grant references are permitted but add no new
          privileges or roles to the grantee because a user or role
          already has its privileges and roles.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-as"></a>The <code class="literal">AS</code> Clause and Privilege Restrictions</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091658544192"></a><a class="indexterm" name="idm140091658542704"></a><p>
          As of MySQL 8.0.16, <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> has
          an <code class="literal">AS <em class="replaceable"><code>user</code></em> [WITH
          ROLE]</code> clause that specifies additional information
          about the privilege context to use for statement execution.
          This syntax is visible at the SQL level, although its primary
          purpose is to enable uniform replication across all nodes of
          grantor privilege restrictions imposed by partial revokes, by
          causing those restrictions to appear in the binary log. For
          information about partial revokes, see
          <a class="xref" href="security.html#partial-revokes" title="6.2.12 Privilege Restriction Using Partial Revokes">Section 6.2.12, “Privilege Restriction Using Partial Revokes”</a>.
        </p><p>
          When the <code class="literal">AS <em class="replaceable"><code>user</code></em></code>
          clause is specified, statement execution takes into account
          any privilege restrictions associated with the named user,
          including all roles specified by <code class="literal">WITH ROLE</code>,
          if present. The result is that the privileges actually granted
          by the statement may be reduced relative to those specified.
        </p><p>
          These conditions apply to the <code class="literal">AS
          <em class="replaceable"><code>user</code></em></code> clause:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">AS</code> has an effect only when the named
              <em class="replaceable"><code>user</code></em> has privilege restrictions
              (which implies that the
              <a class="link" href="server-administration.html#sysvar_partial_revokes"><code class="literal">partial_revokes</code></a> system
              variable is enabled).
            </p></li><li class="listitem"><p>
              If <code class="literal">WITH ROLE</code> is given, all roles named
              must be granted to the named
              <em class="replaceable"><code>user</code></em>.
            </p></li><li class="listitem"><p>
              The named <em class="replaceable"><code>user</code></em> should be a
              MySQL account specified as
              <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>,
              <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>, or
              <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>. The current
              user may be named together with <code class="literal">WITH
              ROLE</code> for the case that the executing user wants
              <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> to execute with a set
              of roles applied that may differ from the roles active
              within the current session.
            </p></li><li class="listitem"><p>
              <code class="literal">AS</code> cannot be used to gain privileges
              not possessed by the user who executes the
              <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement. The
              executing user must have at least the privileges to be
              granted, but the <code class="literal">AS</code> clause can only
              restrict the privileges granted, not escalate them.
            </p></li><li class="listitem"><p>
              With respect to the privileges to be granted,
              <code class="literal">AS</code> cannot specify a user/role
              combination that has more privileges (fewer restrictions)
              than the user who executes the
              <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement. The
              <code class="literal">AS</code> user/role combination is permitted
              to have more privileges than the executing user, but only
              if the statement does not grant those additional
              privileges.
            </p></li><li class="listitem"><p>
              <code class="literal">AS</code> is supported only for granting
              global privileges (<code class="literal">ON *.*</code>).
            </p></li><li class="listitem"><p>
              <code class="literal">AS</code> is not supported for
              <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a> grants.
</p></li></ul>
</div>
<p>
          The following example illustrates the effect of the
          <code class="literal">AS</code> clause. Create a user
          <code class="literal">u1</code> that has some global privileges, as well
          as restrictions on those privileges:
        </p><pre data-lang="sql" class="programlisting">
CREATE USER u1;
GRANT SELECT, INSERT, UPDATE, DELETE ON *.* TO u1;
REVOKE INSERT, UPDATE ON schema1.* FROM u1;
REVOKE SELECT ON schema2.* FROM u1;
</pre><p>
          Also create a role <code class="literal">r1</code> that lifts some of
          the privilege restrictions and grant the role to
          <code class="literal">u1</code>:
        </p><pre data-lang="sql" class="programlisting">
CREATE ROLE r1;
GRANT INSERT ON schema1.* TO r1;
GRANT SELECT ON schema2.* TO r1;
GRANT r1 TO u1;
</pre><p>
          Now, using an account that has no privilege restrictions of
          its own, grant to multiple users the same set of global
          privileges, but each with different restrictions imposed by
          the <code class="literal">AS</code> clause, and check which privileges
          are actually granted.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              The <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement here
              has no <code class="literal">AS</code> clause, so the privileges
              granted are exactly those specified:
            </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE USER u2;</code></strong>
mysql&gt; <strong class="userinput"><code>GRANT SELECT, INSERT, UPDATE ON *.* TO u2;</code></strong>
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR u2;</code></strong>
+-------------------------------------------------+
| Grants for u2@%                                 |
+-------------------------------------------------+
| GRANT SELECT, INSERT, UPDATE ON *.* TO `u2`@`%` |
+-------------------------------------------------+
</pre></li><li class="listitem"><p>
              The <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement here
              has an <code class="literal">AS</code> clause, so the privileges
              granted are those specified but with the restrictions from
              <code class="literal">u1</code> applied:
            </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE USER u3;</code></strong>
mysql&gt; <strong class="userinput"><code>GRANT SELECT, INSERT, UPDATE ON *.* TO u3 AS u1;</code></strong>
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR u3;</code></strong>
+----------------------------------------------------+
| Grants for u3@%                                    |
+----------------------------------------------------+
| GRANT SELECT, INSERT, UPDATE ON *.* TO `u3`@`%`    |
| REVOKE INSERT, UPDATE ON `schema1`.* FROM `u3`@`%` |
| REVOKE SELECT ON `schema2`.* FROM `u3`@`%`         |
+----------------------------------------------------+
</pre><p>
              As mentioned previously, the <code class="literal">AS</code> clause
              can only add privilege restrictions; it cannot escalate
              privileges. Thus, although <code class="literal">u1</code> has the
              <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege, that is
              not included in the privileges granted because the
              statement does not specify granting
              <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a>.
            </p></li><li class="listitem"><p>
              The <code class="literal">AS</code> clause for the
              <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement here makes
              the role <code class="literal">r1</code> active for
              <code class="literal">u1</code>. That role lifts some of the
              restrictions on <code class="literal">u1</code>. Consequently, the
              privileges granted have some restrictions, but not so many
              as for the previous <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a>
              statement:
            </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE USER u4;</code></strong>
mysql&gt; <strong class="userinput"><code>GRANT SELECT, INSERT, UPDATE ON *.* TO u4 AS u1 WITH ROLE r1;</code></strong>
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR u4;</code></strong>
+-------------------------------------------------+
| Grants for u4@%                                 |
+-------------------------------------------------+
| GRANT SELECT, INSERT, UPDATE ON *.* TO `u4`@`%` |
| REVOKE UPDATE ON `schema1`.* FROM `u4`@`%`      |
+-------------------------------------------------+
</pre></li></ul>
</div>
<p>
          If a <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement includes
          an <code class="literal">AS <em class="replaceable"><code>user</code></em></code>
          clause, privilege restrictions on the user who executes the
          statement are ignored (rather than applied as they would be in
          the absence of an <code class="literal">AS</code> clause).
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-other-characteristics"></a>Other Account Characteristics</h5>

</div>

</div>

</div>
<p>
          The optional <code class="literal">WITH</code> clause is used to enable
          a user to grant privileges to other users. The <code class="literal">WITH
          GRANT OPTION</code> clause gives the user the ability to
          give to other users any privileges the user has at the
          specified privilege level.
        </p><p>
          To grant the <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>
          privilege to an account without otherwise changing its
          privileges, do this:
        </p><pre data-lang="sql" class="programlisting">
GRANT USAGE ON *.* TO 'someuser'@'somehost' WITH GRANT OPTION;
</pre><p>
          Be careful to whom you give the <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT
          OPTION</code></a> privilege because two users with different
          privileges may be able to combine privileges!
        </p><p>
          You cannot grant another user a privilege which you yourself
          do not have; the <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>
          privilege enables you to assign only those privileges which
          you yourself possess.
        </p><p>
          Be aware that when you grant a user the
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> privilege at a
          particular privilege level, any privileges the user possesses
          (or may be given in the future) at that level can also be
          granted by that user to other users. Suppose that you grant a
          user the <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege on a
          database. If you then grant the
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege on the
          database and specify <code class="literal">WITH GRANT OPTION</code>,
          that user can give to other users not only the
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege, but also
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a>. If you then grant the
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege to the user on
          the database, the user can grant
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a>,
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>, and
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>.
        </p><p>
          For a nonadministrative user, you should not grant the
          <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a> privilege globally or for
          the <code class="literal">mysql</code> system database. If you do that,
          the user can try to subvert the privilege system by renaming
          tables!
        </p><p>
          For additional information about security risks associated
          with particular privileges, see
          <a class="xref" href="security.html#privileges-provided" title="6.2.2 Privileges Provided by MySQL">Section 6.2.2, “Privileges Provided by MySQL”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-mysql-vs-standard-sql"></a>MySQL and Standard SQL Versions of GRANT</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091658441776"></a><p>
          The biggest differences between the MySQL and standard SQL
          versions of <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> are:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              MySQL associates privileges with the combination of a host
              name and user name and not with only a user name.
            </p></li><li class="listitem"><p>
              Standard SQL does not have global or database-level
              privileges, nor does it support all the privilege types
              that MySQL supports.
            </p></li><li class="listitem"><p>
              MySQL does not support the standard SQL
              <code class="literal">UNDER</code> privilege.
            </p></li><li class="listitem"><p>
              Standard SQL privileges are structured in a hierarchical
              manner. If you remove a user, all privileges the user has
              been granted are revoked. This is also true in MySQL if
              you use <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a>. See
              <a class="xref" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax">Section 13.7.1.5, “DROP USER Syntax”</a>.
            </p></li><li class="listitem"><p>
              In standard SQL, when you drop a table, all privileges for
              the table are revoked. In standard SQL, when you revoke a
              privilege, all privileges that were granted based on that
              privilege are also revoked. In MySQL, privileges can be
              dropped with <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a> or
              <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> statements.
            </p></li><li class="listitem"><p>
              In MySQL, it is possible to have the
              <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for only
              some of the columns in a table. In this case, you can
              still execute <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>
              statements on the table, provided that you insert values
              only for those columns for which you have the
              <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege. The
              omitted columns are set to their implicit default values
              if strict SQL mode is not enabled. In strict mode, the
              statement is rejected if any of the omitted columns have
              no default value. (Standard SQL requires you to have the
              <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege on all
              columns.) For information about strict SQL mode and
              implicit default values, see <a class="xref" href="server-administration.html#sql-mode" title="5.1.11 Server SQL Modes">Section 5.1.11, “Server SQL Modes”</a>,
              and <a class="xref" href="data-types.html#data-type-defaults" title="11.7 Data Type Default Values">Section 11.7, “Data Type Default Values”</a>.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="rename-user"></a>13.7.1.7 RENAME USER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091658419104"></a><a class="indexterm" name="idm140091658418032"></a><a class="indexterm" name="idm140091658416544"></a><pre data-lang="sql" class="programlisting">
RENAME USER <em class="replaceable"><code>old_user</code></em> TO <em class="replaceable"><code>new_user</code></em>
    [, <em class="replaceable"><code>old_user</code></em> TO <em class="replaceable"><code>new_user</code></em>] ...
</pre><p>
        The <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.7 RENAME USER Syntax"><code class="literal">RENAME USER</code></a> statement renames
        existing MySQL accounts. An error occurs for old accounts that
        do not exist or new accounts that already exist.
      </p><p>
        To use <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.7 RENAME USER Syntax"><code class="literal">RENAME USER</code></a>, you must have
        the global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege,
        or the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege for the
        <code class="literal">mysql</code> system database. When the
        <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system variable is
        enabled, <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.7 RENAME USER Syntax"><code class="literal">RENAME USER</code></a> additionally
        requires the <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        Each account name uses the format described in
        <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>. For example:
      </p><pre data-lang="sql" class="programlisting">
RENAME USER 'jeffrey'@'localhost' TO 'jeff'@'127.0.0.1';
</pre><p>
        The host name part of the account name, if omitted, defaults to
        <code class="literal">'%'</code>.
      </p><p>
        <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.7 RENAME USER Syntax"><code class="literal">RENAME USER</code></a> causes the privileges
        held by the old user to be those held by the new user. However,
        <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.7 RENAME USER Syntax"><code class="literal">RENAME USER</code></a> does not
        automatically drop or invalidate databases or objects within
        them that the old user created. This includes stored programs or
        views for which the <code class="literal">DEFINER</code> attribute names
        the old user. Attempts to access such objects may produce an
        error if they execute in definer security context. (For
        information about security context, see
        <a class="xref" href="stored-objects.html#stored-objects-security" title="24.6 Stored Object Access Control">Section 24.6, “Stored Object Access Control”</a>.)
      </p><p>
        The privilege changes take effect as indicated in
        <a class="xref" href="security.html#privilege-changes" title="6.2.13 When Privilege Changes Take Effect">Section 6.2.13, “When Privilege Changes Take Effect”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="revoke"></a>13.7.1.8 REVOKE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091658387696"></a><a class="indexterm" name="idm140091658386624"></a><a class="indexterm" name="idm140091658385584"></a><a class="indexterm" name="idm140091658384096"></a><a class="indexterm" name="idm140091658383024"></a><a class="indexterm" name="idm140091658381536"></a><a class="indexterm" name="idm140091658380048"></a><pre data-lang="sql" class="programlisting">
REVOKE
    <em class="replaceable"><code>priv_type</code></em> [(<em class="replaceable"><code>column_list</code></em>)]
      [, <em class="replaceable"><code>priv_type</code></em> [(<em class="replaceable"><code>column_list</code></em>)]] ...
    ON [<em class="replaceable"><code>object_type</code></em>] <em class="replaceable"><code>priv_level</code></em>
    FROM <em class="replaceable"><code>user_or_role</code></em> [, <em class="replaceable"><code>user_or_role</code></em>] ...

REVOKE ALL [PRIVILEGES], GRANT OPTION
    FROM <em class="replaceable"><code>user_or_role</code></em> [, <em class="replaceable"><code>user_or_role</code></em>] ...

REVOKE PROXY ON <em class="replaceable"><code>user_or_role</code></em>
    FROM <em class="replaceable"><code>user_or_role</code></em> [, <em class="replaceable"><code>user_or_role</code></em>] ...

REVOKE <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em> ] ...
    FROM <em class="replaceable"><code>user_or_role</code></em> [, <em class="replaceable"><code>user_or_role</code></em> ] ...

<em class="replaceable"><code>user_or_role</code></em>: {
    <em class="replaceable"><code>user</code></em>
  | <em class="replaceable"><code>role</code></em>
}

<em class="replaceable"><code>user</code></em>:
    (see <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>)

<em class="replaceable"><code>role</code></em>:
    (see <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>.
</pre><p>
        The <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> statement enables
        system administrators to revoke privileges and roles, which can
        be revoked from user accounts and roles.
      </p><p>
        For information about roles, see <a class="xref" href="security.html#roles" title="6.2.10 Using Roles">Section 6.2.10, “Using Roles”</a>.
      </p><p>
        When the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system
        variable is enabled, <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a>
        requires the <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege in addition to
        any other required privileges described in the following
        discussion.
      </p><p>
        <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> either succeeds for all
        named users and roles or rolls back and has no effect if any
        error occurs. The statement is written to the binary log only if
        it succeeds for all named users and roles.
      </p><p>
        Each account name uses the format described in
        <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>. Each role name uses the format
        described in <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>. For example:
      </p><pre data-lang="sql" class="programlisting">
REVOKE INSERT ON *.* FROM 'jeffrey'@'localhost';
REVOKE 'role1', 'role2' FROM 'user1'@'localhost', 'user2'@'localhost';
REVOKE SELECT ON world.* FROM 'role3';
</pre><p>
        The host name part of the account or role name, if omitted,
        defaults to <code class="literal">'%'</code>.
      </p><p>
        For details on the levels at which privileges exist, the
        permissible <em class="replaceable"><code>priv_type</code></em>,
        <em class="replaceable"><code>priv_level</code></em>, and
        <em class="replaceable"><code>object_type</code></em> values, and the syntax
        for specifying users and passwords, see <a class="xref" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax">Section 13.7.1.6, “GRANT Syntax”</a>.
      </p><p>
        To use the first <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> syntax,
        you must have the <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>
        privilege, and you must have the privileges that you are
        revoking.
      </p><p>
        To revoke all privileges, use the second syntax, which drops all
        global, database, table, column, and routine privileges for the
        named users or roles:
      </p><pre data-lang="sql" class="programlisting">
REVOKE ALL PRIVILEGES, GRANT OPTION
  FROM <em class="replaceable"><code>user_or_role</code></em> [, <em class="replaceable"><code>user_or_role</code></em>] ...
</pre><p>
        <code class="literal">REVOKE ALL PRIVILEGES, GRANT OPTION</code> does not
        revoke any roles.
      </p><p>
        To use this <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> syntax, you
        must have the global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a>
        privilege, or the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>
        privilege for the <code class="literal">mysql</code> system database.
      </p><p>
        The syntax for which the <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a>
        keyword is followed by one or more role names takes a
        <code class="literal">FROM</code> clause indicating one or more users or
        roles from which to revoke the roles.
      </p><p>
        Roles named in the
        <a class="link" href="server-administration.html#sysvar_mandatory_roles"><code class="literal">mandatory_roles</code></a> system variable
        value cannot be revoked.
      </p><p>
        A revoked role immediately affects any user account from which
        it was revoked, such that within any current session for the
        account, its privileges are adjusted for the next statement
        executed.
      </p><p>
        Revoking a role revokes the role itself, not the privileges that
        it represents. If an account is granted a role that includes a
        given privilege, and is also granted the privilege explicitly or
        another role that includes the privilege, the account still is
        granted that privilege after the first role is revoked. For
        example, if an account is granted two roles that each include
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>, the account still can
        select after either role is revoked.
      </p><p>
        <code class="literal">REVOKE ALL ON *.*</code> (at the global level)
        revokes all granted static global privileges and all granted
        dynamic privileges.
      </p><p>
        User accounts and roles from which privileges and roles are to
        be revoked must exist, but the roles to be revoked need not be
        currently granted to them.
      </p><p>
        <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> removes privileges, but
        does not drop <code class="literal">mysql.user</code> system table
        entries. To remove a user account entirely, use
        <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a>. See
        <a class="xref" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax">Section 13.7.1.5, “DROP USER Syntax”</a>.
      </p><p>
        If the grant tables hold privilege rows that contain mixed-case
        database or table names and the
        <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> system
        variable is set to a nonzero value,
        <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> cannot be used to revoke
        these privileges. It will be necessary to manipulate the grant
        tables directly. (<a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> will not
        create such rows when
        <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> is set,
        but such rows might have been created prior to setting the
        variable. The
        <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> setting
        can only be configured when initializing the server.)
      </p><p>
        When successfully executed from the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a>
        program, <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a> responds with
        <code class="literal">Query OK, 0 rows affected</code>. To determine what
        privileges remain after the operation, use
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a>. See
        <a class="xref" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax">Section 13.7.6.21, “SHOW GRANTS Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-default-role"></a>13.7.1.9 SET DEFAULT ROLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091658307840"></a><a class="indexterm" name="idm140091658306752"></a><a class="indexterm" name="idm140091658305264"></a><pre data-lang="sql" class="programlisting">
SET DEFAULT ROLE
    {NONE | ALL | <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em> ] ...}
    TO <em class="replaceable"><code>user</code></em> [, <em class="replaceable"><code>user</code></em> ] ...
</pre><p>
        For each <em class="replaceable"><code>user</code></em> named immediately after
        the <code class="literal">TO</code> keyword, this statement defines which
        roles become active when the user connects to the server and
        authenticates, or when the user executes the
        <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE
        DEFAULT</code></a> statement during a session.
      </p><p>
        <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT ROLE</code></a> is alternative
        syntax for <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER
        USER ... DEFAULT ROLE</code></a> (see
        <a class="xref" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax">Section 13.7.1.1, “ALTER USER Syntax”</a>). However,
        <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> can set the default
        for only a single user, whereas <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT
        ROLE</code></a> can set the default for multiple users. On the
        other hand, you can specify <code class="literal">CURRENT_USER</code> as
        the user name for the <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a>
        statement, whereas you cannot for <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET
        DEFAULT ROLE</code></a>.
      </p><p>
        <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT ROLE</code></a> requires these
        privileges:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Setting the default roles for another user requires the
            global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege,
            or the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege for
            the <code class="literal">mysql.default_roles</code> system table.
          </p></li><li class="listitem"><p>
            Setting the default roles for yourself requires no special
            privileges, as long as the roles you want as the default
            have been granted to you.
</p></li></ul>
</div>
<p>
        Each role name uses the format described in
        <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>. For example:
      </p><pre data-lang="sql" class="programlisting">
SET DEFAULT ROLE administrator, developer TO 'joe'@'10.0.0.1';
</pre><p>
        The host name part of the role name, if omitted, defaults to
        <code class="literal">'%'</code>.
      </p><p>
        The clause following the <code class="literal">DEFAULT ROLE</code>
        keywords permits these values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">NONE</code>: Set the default to
            <code class="literal">NONE</code> (no roles).
          </p></li><li class="listitem"><p>
            <code class="literal">ALL</code>: Set the default to all roles granted
            to the account.
          </p></li><li class="listitem"><p>
            <code class="literal"><em class="replaceable"><code>role</code></em> [,
            <em class="replaceable"><code>role</code></em> ] ...</code>: Set the
            default to the named roles, which must exist and be granted
            to the account at the time <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT
            ROLE</code></a> is executed.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT ROLE</code></a> and
          <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE
          DEFAULT</code></a> are different statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT ROLE</code></a> defines
              which account roles to activate by default within account
              sessions.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE
              DEFAULT</code></a> sets the active roles within the current
              session to the current account default roles.
</p></li></ul>
</div>

</div>
<p>
        For role usage examples, see <a class="xref" href="security.html#roles" title="6.2.10 Using Roles">Section 6.2.10, “Using Roles”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-password"></a>13.7.1.10 SET PASSWORD Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091658256464"></a><a class="indexterm" name="idm140091658255392"></a><a class="indexterm" name="idm140091658253904"></a><pre data-lang="sql" class="programlisting">
SET PASSWORD [FOR <em class="replaceable"><code>user</code></em>] = '<em class="replaceable"><code>auth_string</code></em>'
    [REPLACE '<em class="replaceable"><code>current_auth_string</code></em>']
    [RETAIN CURRENT PASSWORD]
</pre><p>
        The <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> statement
        assigns a password to a MySQL user account. It may also include
        a password-verification clause that specifies the account
        current password to be replaced, and a clause that manages
        whether an account has a secondary password.
        <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code> and
        <code class="literal">'<em class="replaceable"><code>current_auth_string</code></em>'</code>
        each represent a cleartext (unencrypted) password.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Clauses for password verification and secondary passwords
          apply only to accounts that store credentials internally in
          the <code class="literal">mysql.user</code> system table
          (<code class="literal">mysql_native_password</code>,
          <code class="literal">sha256_password</code>, or
          <code class="literal">caching_sha2_password</code>). For accounts that
          use plugins that perform authentication against an external
          credential system, password management must be handled
          externally against that system as well.
</p>
</div>
<p>
        The <code class="literal">REPLACE
        '<em class="replaceable"><code>current_auth_string</code></em>'</code>
        clause is available as of MySQL 8.0.13. If given:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">REPLACE</code> specifies the account current
            password to be replaced, as a cleartext (unencrypted)
            string.
          </p></li><li class="listitem"><p>
            The clause must be given if password changes for the account
            are required to specify the current password, as
            verification that the user attempting to make the change
            actually knows the current password.
          </p></li><li class="listitem"><p>
            The clause is optional if password changes for the account
            may but need not specify the current password.
          </p></li><li class="listitem"><p>
            The statement fails if the clause is given but does not
            match the current password, even if the clause is optional.
          </p></li><li class="listitem"><p>
            <code class="literal">REPLACE</code> can be specified only when
            changing the account password for the current user.
</p></li></ul>
</div>
<p>
        For more information about password verification by specifying
        the current password, see <a class="xref" href="security.html#password-management" title="6.2.15 Password Management">Section 6.2.15, “Password Management”</a>.
      </p><p>
        The <code class="literal">RETAIN CURRENT PASSWORD</code> clause implements
        dual-password capability and is available as of MySQL 8.0.14. If
        given:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">RETAIN CURRENT PASSWORD</code> retains an
            account current password as its secondary password,
            replacing any existing secondary password. The new password
            becomes the primary password, but clients can use the
            account to connect to the server using either the primary or
            secondary password. (Exception: If the new password
            specified by the <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a>
            statement is empty, the secondary password becomes empty as
            well, even if <code class="literal">RETAIN CURRENT PASSWORD</code> is
            given.)
          </p></li><li class="listitem"><p>
            If you specify <code class="literal">RETAIN CURRENT PASSWORD</code>
            for an account that has an empty primary password, the
            statement fails.
          </p></li><li class="listitem"><p>
            If an account has a secondary password and you change its
            primary password without specifying <code class="literal">RETAIN CURRENT
            PASSWORD</code>, the secondary password remains
            unchanged.
</p></li></ul>
</div>
<p>
        For more information about use of dual passwords, see
        <a class="xref" href="security.html#password-management" title="6.2.15 Password Management">Section 6.2.15, “Password Management”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Rather than using
          <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax"><code class="literal">SET PASSWORD ...
          = '<em class="replaceable"><code>auth_string</code></em>'</code></a> syntax,
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> syntax is the
          preferred statement for account alterations, including
          assigning passwords. For example:
        </p><pre data-lang="sql" class="programlisting">
ALTER USER <em class="replaceable"><code>user</code></em> IDENTIFIED BY '<em class="replaceable"><code>auth_string</code></em>';
</pre>
</div>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Important
</div>
<p>
          Under some circumstances, <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax"><code class="literal">SET
          PASSWORD</code></a> may be recorded in server logs or on the
          client side in a history file such as
          <code class="filename">~/.mysql_history</code>, which means that
          cleartext passwords may be read by anyone having read access
          to that information. For information about the conditions
          under which this occurs for the server logs and how to control
          it, see <a class="xref" href="security.html#password-logging" title="6.1.2.3 Passwords and Logging">Section 6.1.2.3, “Passwords and Logging”</a>. For similar
          information about client-side logging, see
          <a class="xref" href="programs.html#mysql-logging" title="4.5.1.3 mysql Client Logging">Section 4.5.1.3, “mysql Client Logging”</a>.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> can be used with or
        without a <code class="literal">FOR</code> clause that explicitly names a
        user account:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            With a <code class="literal">FOR
            <em class="replaceable"><code>user</code></em></code> clause, the
            statement sets the password for the named account, which
            must exist:
          </p><pre data-lang="sql" class="programlisting">
SET PASSWORD FOR 'jeffrey'@'localhost' = '<em class="replaceable"><code>auth_string</code></em>';
</pre></li><li class="listitem"><p>
            With no <code class="literal">FOR
            <em class="replaceable"><code>user</code></em></code> clause, the
            statement sets the password for the current user:
          </p><pre data-lang="sql" class="programlisting">
SET PASSWORD = '<em class="replaceable"><code>auth_string</code></em>';
</pre><p>
            Any client who connects to the server using a nonanonymous
            account can change the password for that account. (In
            particular, you can change your own password.) To see which
            account the server authenticated you as, invoke the
            <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a> function:
          </p><pre data-lang="sql" class="programlisting">
SELECT CURRENT_USER();
</pre></li></ul>
</div>
<p>
        If a <code class="literal">FOR <em class="replaceable"><code>user</code></em></code>
        clause is given, the account name uses the format described in
        <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>. For example:
      </p><pre data-lang="sql" class="programlisting">
SET PASSWORD FOR 'bob'@'%.example.org' = '<em class="replaceable"><code>auth_string</code></em>';
</pre><p>
        The host name part of the account name, if omitted, defaults to
        <code class="literal">'%'</code>.
      </p><p>
        <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> interprets the
        string as a cleartext string, passes it to the authentication
        plugin associated with the account, and stores the result
        returned by the plugin in the account row in the
        <code class="literal">mysql.user</code> system table. (The plugin is given
        the opportunity to hash the value into the encryption format it
        expects. The plugin may use the value as specified, in which
        case no hashing occurs.)
      </p><p>
        Setting the password for a named account (with a
        <code class="literal">FOR</code> clause) requires the
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> privilege for the
        <code class="literal">mysql</code> system database. Setting the password
        for yourself (for a nonanonymous account with no
        <code class="literal">FOR</code> clause) requires no special privileges.
      </p><p>
        Statements that modify secondary passwords require these
        privileges:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The
            <a class="link" href="security.html#priv_application-password-admin"><code class="literal">APPLICATION_PASSWORD_ADMIN</code></a>
            privilege is required to use the <code class="literal">RETAIN CURRENT
            PASSWORD</code> clause for <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax"><code class="literal">SET
            PASSWORD</code></a> statements that apply to your own
            account. The privilege is required to manipulate your own
            secondary password because most users require only one
            password.
          </p></li><li class="listitem"><p>
            If an account is to be permitted to manipulate secondary
            passwords for all accounts, it should be granted the
            <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege rather
            than
            <a class="link" href="security.html#priv_application-password-admin"><code class="literal">APPLICATION_PASSWORD_ADMIN</code></a>.
</p></li></ul>
</div>
<p>
        When the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system
        variable is enabled, <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a>
        requires the <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege in addition to
        any other required privileges.
      </p><p>
        For additional information about setting passwords and
        authentication plugins, see
        <a class="xref" href="security.html#assigning-passwords" title="6.2.14 Assigning Account Passwords">Section 6.2.14, “Assigning Account Passwords”</a>, and
        <a class="xref" href="security.html#pluggable-authentication" title="6.2.17 Pluggable Authentication">Section 6.2.17, “Pluggable Authentication”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-role"></a>13.7.1.11 SET ROLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091658168320"></a><a class="indexterm" name="idm140091658167248"></a><a class="indexterm" name="idm140091658165760"></a><pre data-lang="sql" class="programlisting">
SET ROLE {
    DEFAULT
  | NONE
  | ALL
  | ALL EXCEPT <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em> ] ...
  | <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em> ] ...
}
</pre><p>
        <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE</code></a> modifies the current
        user's effective privileges within the current session by
        specifying which of its granted roles are active. Granted roles
        include those granted explicitly to the user and those named in
        the <a class="link" href="server-administration.html#sysvar_mandatory_roles"><code class="literal">mandatory_roles</code></a> system
        variable value.
      </p><p>
        Examples:
      </p><pre data-lang="sql" class="programlisting">
SET ROLE DEFAULT;
SET ROLE 'role1', 'role2';
SET ROLE ALL;
SET ROLE ALL EXCEPT 'role1', 'role2';
</pre><p>
        Each role name uses the format described in
        <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>. The host name part of the role
        name, if omitted, defaults to <code class="literal">'%'</code>.
      </p><p>
        Privileges that the user has been granted directly (rather than
        through roles) remain unaffected by changes to the active roles.
      </p><p>
        The statement permits these role specifiers:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">DEFAULT</code>: Activate the account default
            roles. Default roles are those specified with
            <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT ROLE</code></a>.
          </p><p>
            When a user connects to the server and authenticates
            successfully, the server determines which roles to activate
            as the default roles. If the
            <a class="link" href="server-administration.html#sysvar_activate_all_roles_on_login"><code class="literal">activate_all_roles_on_login</code></a>
            system variable is enabled, the server activates all granted
            roles. Otherwise, the server executes
            <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE
            DEFAULT</code></a> implicitly. The server activates only
            default roles that can be activated. The server writes
            warnings to its error log for default roles that cannot be
            activated, but the client receives no warnings.
          </p><p>
            If a user executes
            <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE
            DEFAULT</code></a> during a session, an error occurs if any
            default role cannot be activated (for example, if it does
            not exist or is not granted to the user). In this case, the
            current active roles are not changed.
          </p></li><li class="listitem"><p>
            <code class="literal">NONE</code>: Set the active roles to
            <code class="literal">NONE</code> (no active roles).
          </p></li><li class="listitem"><p>
            <code class="literal">ALL</code>: Activate all roles granted to the
            account.
          </p></li><li class="listitem"><p>
            <code class="literal">ALL EXCEPT <em class="replaceable"><code>role</code></em> [,
            <em class="replaceable"><code>role</code></em> ] ...</code>: Activate
            all roles granted to the account except those named. The
            named roles need not exist or be granted to the account.
          </p></li><li class="listitem"><p>
            <code class="literal"><em class="replaceable"><code>role</code></em> [,
            <em class="replaceable"><code>role</code></em> ] ...</code>: Activate
            the named roles, which must be granted to the account.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT ROLE</code></a> and
          <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE
          DEFAULT</code></a> are different statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT ROLE</code></a> defines
              which account roles to activate by default within account
              sessions.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE
              DEFAULT</code></a> sets the active roles within the current
              session to the current account default roles.
</p></li></ul>
</div>

</div>
<p>
        For role usage examples, see <a class="xref" href="security.html#roles" title="6.2.10 Using Roles">Section 6.2.10, “Using Roles”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="resource-group-sql"></a>13.7.2 Resource Group Management Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#alter-resource-group">13.7.2.1 ALTER RESOURCE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-resource-group">13.7.2.2 CREATE RESOURCE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-resource-group">13.7.2.3 DROP RESOURCE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-resource-group">13.7.2.4 SET RESOURCE GROUP Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091658123872"></a><p>
      MySQL supports creation and management of resource groups, and
      permits assigning threads running within the server to particular
      groups so that threads execute according to the resources
      available to the group. This section describes the SQL statements
      available for resource group management. For general discussion of
      the resource group capability, see
      <a class="xref" href="optimization.html#resource-groups" title="8.12.5 Resource Groups">Section 8.12.5, “Resource Groups”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="alter-resource-group"></a>13.7.2.1 ALTER RESOURCE GROUP Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091658119792"></a><pre data-lang="sql" class="programlisting">
ALTER RESOURCE GROUP <em class="replaceable"><code>group_name</code></em>
    [VCPU [=] <em class="replaceable"><code>vcpu_spec</code></em> [, <em class="replaceable"><code>vcpu_spec</code></em>] ...]
    [THREAD_PRIORITY [=] <em class="replaceable"><code>N</code></em>]
    [ENABLE|DISABLE [FORCE]]

<em class="replaceable"><code>vcpu_spec</code></em>: {<em class="replaceable"><code>N</code></em> | <em class="replaceable"><code>M</code></em> - <em class="replaceable"><code>N</code></em>}
</pre><p>
        <a class="link" href="sql-syntax.html#alter-resource-group" title="13.7.2.1 ALTER RESOURCE GROUP Syntax"><code class="literal">ALTER RESOURCE GROUP</code></a> is used for
        resource group management (see
        <a class="xref" href="optimization.html#resource-groups" title="8.12.5 Resource Groups">Section 8.12.5, “Resource Groups”</a>). This statement alters
        modifiable attributes of an existing resource group. It requires
        the <a class="link" href="security.html#priv_resource-group-admin"><code class="literal">RESOURCE_GROUP_ADMIN</code></a>
        privilege.
      </p><p>
        <em class="replaceable"><code>group_name</code></em> identifies which resource
        group to alter. If the group does not exist, an error occurs.
      </p><p>
        The attributes for CPU affinity, priority, and whether the group
        is enabled can be modified with <a class="link" href="sql-syntax.html#alter-resource-group" title="13.7.2.1 ALTER RESOURCE GROUP Syntax"><code class="literal">ALTER
        RESOURCE GROUP</code></a>. These attributes are specified the
        same way as described for <a class="link" href="sql-syntax.html#create-resource-group" title="13.7.2.2 CREATE RESOURCE GROUP Syntax"><code class="literal">CREATE RESOURCE
        GROUP</code></a> (see <a class="xref" href="sql-syntax.html#create-resource-group" title="13.7.2.2 CREATE RESOURCE GROUP Syntax">Section 13.7.2.2, “CREATE RESOURCE GROUP Syntax”</a>).
        Only the attributes specified are altered. Unspecified
        attributes retain their current values.
      </p><p>
        The <code class="literal">FORCE</code> modifier is used with
        <code class="literal">DISABLE</code>. It determines statement behavior if
        the resource group has any threads assigned to it:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If <code class="literal">FORCE</code> is not given, existing threads
            in the group continue to run until they terminate, but new
            threads cannot be assigned to the group.
          </p></li><li class="listitem"><p>
            If <code class="literal">FORCE</code> is given, existing threads in
            the group are moved to their respective default group
            (system threads to <code class="literal">SYS_default</code>, user
            threads to <code class="literal">USR_default</code>).
</p></li></ul>
</div>
<p>
        The name and type attributes are set at group creation time and
        cannot be modified thereafter with <a class="link" href="sql-syntax.html#alter-resource-group" title="13.7.2.1 ALTER RESOURCE GROUP Syntax"><code class="literal">ALTER
        RESOURCE GROUP</code></a>.
      </p><p>
        Examples:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Alter a group CPU affinity:
          </p><pre data-lang="sql" class="programlisting">
ALTER RESOURCE GROUP rg1 VCPU = 0-63;
</pre></li><li class="listitem"><p>
            Alter a group thread priority:
          </p><pre data-lang="sql" class="programlisting">
ALTER RESOURCE GROUP rg2 THREAD_PRIORITY = 5;
</pre></li><li class="listitem"><p>
            Disable a group, moving any threads assigned to it to the
            default groups:
          </p><pre data-lang="sql" class="programlisting">
ALTER RESOURCE GROUP rg3 DISABLE FORCE;
</pre></li></ul>
</div>
<p>
        Resource group management is local to the server on which it
        occurs. <a class="link" href="sql-syntax.html#alter-resource-group" title="13.7.2.1 ALTER RESOURCE GROUP Syntax"><code class="literal">ALTER RESOURCE GROUP</code></a>
        statements are not written to the binary log and are not
        replicated.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-resource-group"></a>13.7.2.2 CREATE RESOURCE GROUP Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091658084160"></a><pre data-lang="sql" class="programlisting">
CREATE RESOURCE GROUP <em class="replaceable"><code>group_name</code></em>
    TYPE = {SYSTEM|USER}
    [VCPU [=] <em class="replaceable"><code>vcpu_spec</code></em> [, <em class="replaceable"><code>vcpu_spec</code></em>] ...]
    [THREAD_PRIORITY [=] <em class="replaceable"><code>N</code></em>]
    [ENABLE|DISABLE]

<em class="replaceable"><code>vcpu_spec</code></em>: {<em class="replaceable"><code>N</code></em> | <em class="replaceable"><code>M</code></em> - <em class="replaceable"><code>N</code></em>}
</pre><p>
        <a class="link" href="sql-syntax.html#create-resource-group" title="13.7.2.2 CREATE RESOURCE GROUP Syntax"><code class="literal">CREATE RESOURCE GROUP</code></a> is used for
        resource group management (see
        <a class="xref" href="optimization.html#resource-groups" title="8.12.5 Resource Groups">Section 8.12.5, “Resource Groups”</a>). This statement creates a new
        resource group and assigns its initial attribute values. It
        requires the <a class="link" href="security.html#priv_resource-group-admin"><code class="literal">RESOURCE_GROUP_ADMIN</code></a>
        privilege.
      </p><p>
        <em class="replaceable"><code>group_name</code></em> identifies which resource
        group to create. If the group already exists, an error occurs.
      </p><p>
        The <code class="literal">TYPE</code> attribute is required. It should be
        <code class="literal">SYSTEM</code> for a system resource group,
        <code class="literal">USER</code> for a user resource group. The group
        type affects permitted <code class="literal">THREAD_PRIORITY</code>
        values, as described later.
      </p><p>
        The <code class="literal">VCPU</code> attribute indicates the CPU
        affinity; that is, the set of virtual CPUs the group can use:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If <code class="literal">VCPU</code> is not given, the resource group
            has no CPU affinity and can use all available CPUs.
          </p></li><li class="listitem"><p>
            If <code class="literal">VCPU</code> is given, the attribute value is
            a list of comma-separated CPU numbers or ranges:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                Each number must be an integer in the range from 0 to
                the number of CPUs − 1. For example, on a system
                with 64 CPUs, the number can range from 0 to 63.
              </p></li><li class="listitem"><p>
                A range is given in the form
                <em class="replaceable"><code>M</code></em> −
                <em class="replaceable"><code>N</code></em>, where
                <em class="replaceable"><code>M</code></em> is less than or equal to
                <em class="replaceable"><code>N</code></em> and both numbers are in the
                CPU range.
              </p></li><li class="listitem"><p>
                If a CPU number is an integer outside the permitted
                range or is not an integer, an error occurs.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
        Example <code class="literal">VCPU</code> specifiers (these are all
        equivalent):
      </p><pre data-lang="sql" class="programlisting">
VCPU = 0,1,2,3,9,10
VCPU = 0-3,9-10
VCPU = 9,10,0-3
VCPU = 0,10,1,9,3,2
</pre><p>
        The <code class="literal">THREAD_PRIORITY</code> attribute indicates the
        priority for threads assigned to the group:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If <code class="literal">THREAD_PRIORITY</code> is not given, the
            default priority is 0.
          </p></li><li class="listitem"><p>
            If <code class="literal">THREAD_PRIORITY</code> is given, the
            attribute value must be in the range from -20 (highest
            priority) to 19 (lowest priority). The priority for system
            resource groups must be in the range from -20 to 0. The
            priority for user resource groups must be in the range from
            0 to 19. Use of different ranges for system and user groups
            ensures that user threads never have a higher priority than
            system threads.
</p></li></ul>
</div>
<p>
        <code class="literal">ENABLE</code> and <code class="literal">DISABLE</code> specify
        that the resource group is initially enabled or disabled. If
        neither is specified, the group is enabled by default. A
        disabled group cannot have threads assigned to it.
      </p><p>
        Examples:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Create an enabled user group that has a single CPU and the
            lowest priority:
          </p><pre data-lang="sql" class="programlisting">
CREATE RESOURCE GROUP rg1
  TYPE = USER
  VCPU = 0
  THREAD_PRIORITY = 19;
</pre></li><li class="listitem"><p>
            Create a disabled system group that has no CPU affinity (can
            use all CPUs) and the highest priority:
          </p><pre data-lang="sql" class="programlisting">
CREATE RESOURCE GROUP rg2
  TYPE = SYSTEM
  THREAD_PRIORITY = -20
  DISABLE;
</pre></li></ul>
</div>
<p>
        Resource group management is local to the server on which it
        occurs. <a class="link" href="sql-syntax.html#create-resource-group" title="13.7.2.2 CREATE RESOURCE GROUP Syntax"><code class="literal">CREATE RESOURCE GROUP</code></a>
        statements are not written to the binary log and are not
        replicated.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="drop-resource-group"></a>13.7.2.3 DROP RESOURCE GROUP Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091658040000"></a><pre data-lang="sql" class="programlisting">
DROP RESOURCE GROUP <em class="replaceable"><code>group_name</code></em> [FORCE]
</pre><p>
        <a class="link" href="sql-syntax.html#drop-resource-group" title="13.7.2.3 DROP RESOURCE GROUP Syntax"><code class="literal">DROP RESOURCE GROUP</code></a> is used for
        resource group management (see
        <a class="xref" href="optimization.html#resource-groups" title="8.12.5 Resource Groups">Section 8.12.5, “Resource Groups”</a>). This statement drops a
        resource group. It requires the
        <a class="link" href="security.html#priv_resource-group-admin"><code class="literal">RESOURCE_GROUP_ADMIN</code></a> privilege.
      </p><p>
        <em class="replaceable"><code>group_name</code></em> identifies which resource
        group to drop. If the group does not exist, an error occurs.
      </p><p>
        The <code class="literal">FORCE</code> modifier determines statement
        behavior if the resource group has any threads assigned to it:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If <code class="literal">FORCE</code> is not given and any threads are
            assigned to the group, an error occurs.
          </p></li><li class="listitem"><p>
            If <code class="literal">FORCE</code> is given, existing threads in
            the group are moved to their respective default group
            (system threads to <code class="literal">SYS_default</code>, user
            threads to <code class="literal">USR_default</code>).
</p></li></ul>
</div>
<p>
        Examples:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Drop a group, failing if the group contains any threads:
          </p><pre data-lang="sql" class="programlisting">
DROP RESOURCE GROUP rg1;
</pre></li><li class="listitem"><p>
            Drop a group and move existing threads to the default
            groups:
          </p><pre data-lang="sql" class="programlisting">
DROP RESOURCE GROUP rg2 FORCE;
</pre></li></ul>
</div>
<p>
        Resource group management is local to the server on which it
        occurs. <a class="link" href="sql-syntax.html#drop-resource-group" title="13.7.2.3 DROP RESOURCE GROUP Syntax"><code class="literal">DROP RESOURCE GROUP</code></a>
        statements are not written to the binary log and are not
        replicated.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-resource-group"></a>13.7.2.4 SET RESOURCE GROUP Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091658015536"></a><pre data-lang="sql" class="programlisting">
SET RESOURCE GROUP <em class="replaceable"><code>group_name</code></em>
    [FOR <em class="replaceable"><code>thread_id</code></em> [, <em class="replaceable"><code>thread_id</code></em>] ...]
</pre><p>
        <a class="link" href="sql-syntax.html#set-resource-group" title="13.7.2.4 SET RESOURCE GROUP Syntax"><code class="literal">SET RESOURCE GROUP</code></a> is used for
        resource group management (see
        <a class="xref" href="optimization.html#resource-groups" title="8.12.5 Resource Groups">Section 8.12.5, “Resource Groups”</a>). This statement assigns
        threads to a resource group. It requires the
        <a class="link" href="security.html#priv_resource-group-admin"><code class="literal">RESOURCE_GROUP_ADMIN</code></a> or
        <a class="link" href="security.html#priv_resource-group-user"><code class="literal">RESOURCE_GROUP_USER</code></a> privilege.
      </p><p>
        <em class="replaceable"><code>group_name</code></em> identifies which resource
        group to be assigned. Any <em class="replaceable"><code>thread_id</code></em>
        values indicate threads to assign to the group. Thread IDs can
        be determined from the Performance Schema
        <a class="link" href="performance-schema.html#threads-table" title="26.12.17.5 The threads Table"><code class="literal">threads</code></a> table. If the resource
        group or any named thread ID does not exist, an error occurs.
      </p><p>
        With no <code class="literal">FOR</code> clause, the statement assigns the
        current thread for the session to the resource group.
      </p><p>
        With a <code class="literal">FOR</code> clause that names thread IDs, the
        statement assigns those threads to the resource group.
      </p><p>
        For attempts to assign a system thread to a user resource group
        or a user thread to a system resource group, a warning occurs.
      </p><p>
        Examples:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Assign the current session thread to a group:
          </p><pre data-lang="sql" class="programlisting">
SET RESOURCE GROUP rg1;
</pre></li><li class="listitem"><p>
            Assign the named threads to a group:
          </p><pre data-lang="sql" class="programlisting">
SET RESOURCE GROUP rg2 FOR 14, 78, 4;
</pre></li></ul>
</div>
<p>
        Resource group management is local to the server on which it
        occurs. <a class="link" href="sql-syntax.html#set-resource-group" title="13.7.2.4 SET RESOURCE GROUP Syntax"><code class="literal">SET RESOURCE GROUP</code></a>
        statements are not written to the binary log and are not
        replicated.
      </p><p>
        An alternative to <a class="link" href="sql-syntax.html#set-resource-group" title="13.7.2.4 SET RESOURCE GROUP Syntax"><code class="literal">SET RESOURCE
        GROUP</code></a> is the
        <a class="link" href="optimization.html#optimizer-hints-resource-group" title="Resource Group Hint Syntax"><code class="literal">RESOURCE_GROUP</code></a> optimizer hint,
        which assigns individual statements to a resource group. See
        <a class="xref" href="optimization.html#optimizer-hints" title="8.9.3 Optimizer Hints">Section 8.9.3, “Optimizer Hints”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="table-maintenance-sql"></a>13.7.3 Table Maintenance Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#analyze-table">13.7.3.1 ANALYZE TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#check-table">13.7.3.2 CHECK TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#checksum-table">13.7.3.3 CHECKSUM TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#optimize-table">13.7.3.4 OPTIMIZE TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#repair-table">13.7.3.5 REPAIR TABLE Syntax</a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="analyze-table"></a>13.7.3.1 ANALYZE TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657984816"></a><pre data-lang="sql" class="programlisting">
ANALYZE [NO_WRITE_TO_BINLOG | LOCAL]
    TABLE <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ...

ANALYZE [NO_WRITE_TO_BINLOG | LOCAL]
    TABLE <em class="replaceable"><code>tbl_name</code></em>
    UPDATE HISTOGRAM ON <em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...
        [WITH <em class="replaceable"><code>N</code></em> BUCKETS]

ANALYZE [NO_WRITE_TO_BINLOG | LOCAL]
    TABLE <em class="replaceable"><code>tbl_name</code></em>
    DROP HISTOGRAM ON <em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...
</pre><p>
        <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> generates table
        statistics:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> without either
            <code class="literal">HISTOGRAM</code> clause performs a key
            distribution analysis and stores the distribution for the
            named table or tables. For <code class="literal">MyISAM</code> tables,
            <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> for key
            distribution analysis is equivalent to using
            <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk --analyze</strong></span></a>.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> with the
            <code class="literal">UPDATE HISTOGRAM</code> clause generates
            histogram statistics for the named table columns and stores
            them in the data dictionary. Only one table name is
            permitted for this syntax.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> with the
            <code class="literal">DROP HISTOGRAM</code> clause removes histogram
            statistics for the named table columns from the data
            dictionary. Only one table name is permitted for this
            syntax.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          If the <a class="link" href="innodb-storage-engine.html#sysvar_innodb_read_only"><code class="literal">innodb_read_only</code></a>
          system variable is enabled, <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
          TABLE</code></a> may fail because it cannot update statistics
          tables in the data dictionary, which use
          <code class="literal">InnoDB</code>. For <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
          TABLE</code></a> operations that update the key distribution,
          failure may occur even if the operation updates the table
          itself (for example, if it is a <code class="literal">MyISAM</code>
          table). To obtain the updated distribution statistics, set
          <a class="link" href="server-administration.html#sysvar_information_schema_stats_expiry"><code class="literal">information_schema_stats_expiry=0</code></a>.
</p>
</div>
<p>
        This statement requires <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>
        and <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges for the
        table.
      </p><p>
        <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> works with
        <code class="literal">InnoDB</code>, <code class="literal">NDB</code>, and
        <code class="literal">MyISAM</code> tables. It does not work with views.
      </p><p>
        <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> is supported for
        partitioned tables, and you can use <code class="literal">ALTER TABLE ...
        ANALYZE PARTITION</code> to analyze one or more partitions;
        for more information, see <a class="xref" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax">Section 13.1.9, “ALTER TABLE Syntax”</a>, and
        <a class="xref" href="partitioning.html#partitioning-maintenance" title="23.3.4 Maintenance of Partitions">Section 23.3.4, “Maintenance of Partitions”</a>.
      </p><p>
        During the analysis, the table is locked with a read lock for
        <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code>.
      </p><p>
        By default, the server writes <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
        TABLE</code></a> statements to the binary log so that they
        replicate to replication slaves. To suppress logging, specify
        the optional <code class="literal">NO_WRITE_TO_BINLOG</code> keyword or
        its alias <code class="literal">LOCAL</code>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#analyze-table-output" title="ANALYZE TABLE Output">ANALYZE TABLE Output</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#analyze-table-key-distribution-analysis" title="Key Distribution Analysis">Key Distribution Analysis</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#analyze-table-histogram-statistics-analysis" title="Histogram Statistics Analysis">Histogram Statistics Analysis</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#analyze-table-other-considerations" title="Other Considerations">Other Considerations</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="analyze-table-output"></a>ANALYZE TABLE Output</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> returns a result
          set with the columns shown in the following table.
</p>
<div class="informaltable">
<table summary="Columns of the ANALYZE TABLE result set."><col width="15%"><col width="60%"><thead><tr>
              <th scope="col">Column</th>
              <th scope="col">Value</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">Table</code></td>
              <td>The table name</td>
            </tr><tr>
              <td scope="row"><code class="literal">Op</code></td>
              <td><code class="literal">analyze</code> or <code class="literal">histogram</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">Msg_type</code></td>
              <td><code class="literal">status</code>, <code class="literal">error</code>,
                <code class="literal">info</code>, <code class="literal">note</code>, or
                <code class="literal">warning</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">Msg_text</code></td>
              <td>An informational message</td>
</tr></tbody></table>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="analyze-table-key-distribution-analysis"></a>Key Distribution Analysis</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> without either
          <code class="literal">HISTOGRAM</code> clause performs a key
          distribution analysis and stores the distribution for the
          table or tables. Any existing histogram statistics remain
          unaffected.
        </p><p>
          If the table has not changed since the last key distribution
          analysis, the table is not analyzed again.
        </p><p>
          MySQL uses the stored key distribution to decide the order in
          which tables should be joined for joins on something other
          than a constant. In addition, key distributions can be used
          when deciding which indexes to use for a specific table within
          a query.
        </p><p>
          For more information on how key distribution analysis works
          within <code class="literal">InnoDB</code>, see
          <a class="xref" href="innodb-storage-engine.html#innodb-persistent-stats" title="15.8.10.1 Configuring Persistent Optimizer Statistics Parameters">Section 15.8.10.1, “Configuring Persistent Optimizer Statistics Parameters”</a> and
          <a class="xref" href="innodb-storage-engine.html#innodb-analyze-table-complexity" title="15.8.10.3 Estimating ANALYZE TABLE Complexity for InnoDB Tables">Section 15.8.10.3, “Estimating ANALYZE TABLE Complexity for InnoDB Tables”</a>. Also see
          <a class="xref" href="innodb-storage-engine.html#innodb-restrictions" title="15.6.1.6 Limits on InnoDB Tables">Section 15.6.1.6, “Limits on InnoDB Tables”</a>. In particular, when you
          enable the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_stats_persistent"><code class="literal">innodb_stats_persistent</code></a>
          option, you must run <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
          TABLE</code></a> after loading substantial data into an
          <code class="literal">InnoDB</code> table, or creating a new index for
          one.
        </p><p>
          To check the stored key distribution cardinality, use the
          <a class="link" href="sql-syntax.html#show-index" title="13.7.6.22 SHOW INDEX Syntax"><code class="literal">SHOW INDEX</code></a> statement or the
          <code class="literal">INFORMATION_SCHEMA</code>
          <a class="link" href="information-schema.html#statistics-table" title="25.26 The INFORMATION_SCHEMA STATISTICS Table"><code class="literal">STATISTICS</code></a> table. See
          <a class="xref" href="sql-syntax.html#show-index" title="13.7.6.22 SHOW INDEX Syntax">Section 13.7.6.22, “SHOW INDEX Syntax”</a>, and
          <a class="xref" href="information-schema.html#statistics-table" title="25.26 The INFORMATION_SCHEMA STATISTICS Table">Section 25.26, “The INFORMATION_SCHEMA STATISTICS Table”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="analyze-table-histogram-statistics-analysis"></a>Histogram Statistics Analysis</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> with the
          <code class="literal">HISTOGRAM</code> clauses enables management of
          histogram statistics for table column values. For information
          about histogram statistics, see
          <a class="xref" href="optimization.html#optimizer-statistics" title="8.9.6 Optimizer Statistics">Section 8.9.6, “Optimizer Statistics”</a>.
        </p><p>
          These histogram operations are available:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> with an
              <code class="literal">UPDATE HISTOGRAM</code> clause generates
              histogram statistics for the named table columns and
              stores them in the data dictionary. Only one table name is
              permitted for this syntax.
            </p><p>
              The optional <code class="literal">WITH <em class="replaceable"><code>N</code></em>
              BUCKETS</code> clauses specifies the number of buckets
              for the histogram. The value of
              <em class="replaceable"><code>N</code></em> must be an integer in the
              range from 1 to 1024. If this clause is omitted, the
              number of buckets is 100.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a> with a
              <code class="literal">DROP HISTOGRAM</code> clause removes histogram
              statistics for the named table columns from the data
              dictionary. Only one table name is permitted for this
              syntax.
</p></li></ul>
</div>
<p>
          Stored histogram management statements affect only the named
          columns. Consider these statements:
        </p><pre data-lang="sql" class="programlisting">
ANALYZE TABLE t UPDATE HISTOGRAM ON c1, c2, c3 WITH 10 BUCKETS;
ANALYZE TABLE t UPDATE HISTOGRAM ON c1, c3 WITH 10 BUCKETS;
ANALYZE TABLE t DROP HISTOGRAM ON c2;
</pre><p>
          The first statement updates the histograms for columns
          <code class="literal">c1</code>, <code class="literal">c2</code>, and
          <code class="literal">c3</code>, replacing any existing histograms for
          those columns. The second statement updates the histograms for
          <code class="literal">c1</code> and <code class="literal">c3</code>, leaving the
          <code class="literal">c2</code> histogram unaffected. The third
          statement removes the histogram for <code class="literal">c2</code>,
          leaving those for <code class="literal">c1</code> and
          <code class="literal">c3</code> unaffected.
        </p><p>
          Histogram generation is not supported for encrypted tables (to
          avoid exposing data in the statistics) or
          <code class="literal">TEMPORARY</code> tables.
        </p><p>
          Histogram generation applies to columns of all data types
          except geometry types (spatial data) and
          <a class="link" href="data-types.html#json" title="11.6 The JSON Data Type"><code class="literal">JSON</code></a>.
        </p><p>
          Histograms can be generated for stored and virtual generated
          columns.
        </p><p>
          Histograms cannot be generated for columns that are covered by
          single-column unique indexes.
        </p><p>
          Histogram management statements attempt to perform as much of
          the requested operation as possible, and report diagnostic
          messages for the remainder. For example, if an <code class="literal">UPDATE
          HISTOGRAM</code> statement names multiple columns, but some
          of them do not exist or have an unsupported data type,
          histograms are generated for the other columns, and messages
          are produced for the invalid columns.
        </p><p>
          The
          <a class="link" href="server-administration.html#sysvar_histogram_generation_max_mem_size"><code class="literal">histogram_generation_max_mem_size</code></a>
          system variable controls the maximum amount of memory
          available for histogram generation. The global and session
          values may be set at runtime.
        </p><p>
          Changing the global
          <a class="link" href="server-administration.html#sysvar_histogram_generation_max_mem_size"><code class="literal">histogram_generation_max_mem_size</code></a>
          value requires privileges sufficient to set global system
          variables. Changing the session
          <a class="link" href="server-administration.html#sysvar_histogram_generation_max_mem_size"><code class="literal">histogram_generation_max_mem_size</code></a>
          value requires privileges sufficient to set restricted session
          system variables. See
          <a class="xref" href="server-administration.html#system-variable-privileges" title="5.1.9.1 System Variable Privileges">Section 5.1.9.1, “System Variable Privileges”</a>.
        </p><p>
          For information about memory allocations performed for
          histogram generation, monitor the Performance Schema
          <code class="literal">memory/sql/histograms</code> instrument. See
          <a class="xref" href="performance-schema.html#memory-summary-tables" title="26.12.16.10 Memory Summary Tables">Section 26.12.16.10, “Memory Summary Tables”</a>.
        </p><p>
          Histograms are affected by these DDL statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> removes
              histograms for columns in the dropped table.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#drop-database" title="13.1.24 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> removes
              histograms for any table in the dropped database because
              the statement drops all tables in the database.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#rename-table" title="13.1.36 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a> does not
              remove histograms. Instead, it renames histograms for the
              renamed table to be associated with the new table name.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statements that
              remove or modify a column remove histograms for that
              column.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
              ... CONVERT TO CHARACTER SET</code></a> removes histograms
              for character columns because they are affected by the
              change of character set. Histograms for noncharacter
              columns remain unaffected.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="analyze-table-other-considerations"></a>Other Considerations</h5>

</div>

</div>

</div>
<p>
          <code class="literal">ANALYZE TABLE</code> clears table statistics from
          the
          <a class="link" href="information-schema.html#innodb-tablestats-table" title="25.39.27 The INFORMATION_SCHEMA INNODB_TABLESTATS View"><code class="literal">INFORMATION_SCHEMA.INNODB_TABLESTATS</code></a>
          table and sets the <code class="literal">STATS_INITIALIZED</code> column
          to <code class="literal">Uninitialized</code>. Statistics are collected
          again the next time the table is accessed.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="check-table"></a>13.7.3.2 CHECK TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657839600"></a><pre data-lang="sql" class="programlisting">
CHECK TABLE <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ... [<em class="replaceable"><code>option</code></em>] ...

<em class="replaceable"><code>option</code></em>: {
    FOR UPGRADE
  | QUICK
  | FAST
  | MEDIUM
  | EXTENDED
  | CHANGED
}
</pre><p>
        <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> checks a table or
        tables for errors. <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a>
        can also check views for problems, such as tables that are
        referenced in the view definition that no longer exist.
      </p><p>
        To check a table, you must have some privilege for it.
      </p><p>
        <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> works for
        <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>,
        <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>,
        <a class="link" href="storage-engines.html#archive-storage-engine" title="16.5 The ARCHIVE Storage Engine"><code class="literal">ARCHIVE</code></a>, and
        <a class="link" href="storage-engines.html#csv-storage-engine" title="16.4 The CSV Storage Engine"><code class="literal">CSV</code></a> tables.
      </p><p>
        Before running <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> on
        <code class="literal">InnoDB</code> tables, see
        <a class="xref" href="sql-syntax.html#check-table-innodb" title="CHECK TABLE Usage Notes for InnoDB Tables">CHECK TABLE Usage Notes for InnoDB Tables</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> is supported for
        partitioned tables, and you can use <code class="literal">ALTER TABLE ...
        CHECK PARTITION</code> to check one or more partitions; for
        more information, see <a class="xref" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax">Section 13.1.9, “ALTER TABLE Syntax”</a>, and
        <a class="xref" href="partitioning.html#partitioning-maintenance" title="23.3.4 Maintenance of Partitions">Section 23.3.4, “Maintenance of Partitions”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> ignores virtual
        generated columns that are not indexed.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#check-table-output" title="CHECK TABLE Output">CHECK TABLE Output</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#check-table-version-compatibility" title="Checking Version Compatibility">Checking Version Compatibility</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#check-table-data-consistency" title="Checking Data Consistency">Checking Data Consistency</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#check-table-innodb" title="CHECK TABLE Usage Notes for InnoDB Tables">CHECK TABLE Usage Notes for InnoDB Tables</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#check-table-myisam" title="CHECK TABLE Usage Notes for MyISAM Tables">CHECK TABLE Usage Notes for MyISAM Tables</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="check-table-output"></a>CHECK TABLE Output</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> returns a result
          set with the columns shown in the following table.
</p>
<div class="informaltable">
<table summary="Columns of the CHECK TABLE result set."><col width="15%"><col width="60%"><thead><tr>
              <th scope="col">Column</th>
              <th scope="col">Value</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">Table</code></td>
              <td>The table name</td>
            </tr><tr>
              <td scope="row"><code class="literal">Op</code></td>
              <td>Always <code class="literal">check</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">Msg_type</code></td>
              <td><code class="literal">status</code>, <code class="literal">error</code>,
                <code class="literal">info</code>, <code class="literal">note</code>, or
                <code class="literal">warning</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">Msg_text</code></td>
              <td>An informational message</td>
</tr></tbody></table>
</div>
<p>
          The statement might produce many rows of information for each
          checked table. The last row has a <code class="literal">Msg_type</code>
          value of <code class="literal">status</code> and the
          <code class="literal">Msg_text</code> normally should be
          <code class="literal">OK</code>. <code class="literal">Table is already up to
          date</code> means that the storage engine for the table
          indicated that there was no need to check the table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="check-table-version-compatibility"></a>Checking Version Compatibility</h5>

</div>

</div>

</div>
<p>
          The <code class="literal">FOR UPGRADE</code> option checks whether the
          named tables are compatible with the current version of MySQL.
          With <code class="literal">FOR UPGRADE</code>, the server checks each
          table to determine whether there have been any incompatible
          changes in any of the table's data types or indexes since the
          table was created. If not, the check succeeds. Otherwise, if
          there is a possible incompatibility, the server runs a full
          check on the table (which might take some time).
        </p><p>
          Incompatibilities might occur because the storage format for a
          data type has changed or because its sort order has changed.
          Our aim is to avoid these changes, but occasionally they are
          necessary to correct problems that would be worse than an
          incompatibility between releases.
        </p><p>
          <code class="literal">FOR UPGRADE</code> discovers these
          incompatibilities:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              The indexing order for end-space in
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns for
              <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code>
              tables changed between MySQL 4.1 and 5.0.
            </p></li><li class="listitem"><p>
              The storage method of the new
              <a class="link" href="data-types.html#fixed-point-types" title="11.2.2 Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">DECIMAL</code></a> data type changed
              between MySQL 5.0.3 and 5.0.5.
            </p></li><li class="listitem"><p>
              Changes are sometimes made to character sets or collations
              that require table indexes to be rebuilt. For details
              about such changes, see
              <a class="xref" href="installing.html#upgrading-from-previous-series" title="2.11.4 Changes in MySQL 8.0">Section 2.11.4, “Changes in MySQL 8.0”</a>. For
              information about rebuilding tables, see
              <a class="xref" href="installing.html#rebuilding-tables" title="2.11.13 Rebuilding or Repairing Tables or Indexes">Section 2.11.13, “Rebuilding or Repairing Tables or Indexes”</a>.
            </p></li><li class="listitem"><p>
              MySQL 8.0 does not support the
              <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR(2)</code></a> data type permitted
              in older versions of MySQL. For tables containing
              <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR(2)</code></a> columns,
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> recommends
              <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>, which
              converts <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR(2)</code></a> to
              <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR(4)</code></a>.
            </p></li><li class="listitem"><p>
              Trigger creation time is maintained.
            </p></li><li class="listitem"><p>
              A table is reported as needing a rebuild if it contains
              old temporal columns in pre-5.6.4 format
              (<a class="link" href="data-types.html#time" title="11.3.2 The TIME Type"><code class="literal">TIME</code></a>,
              <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a>, and
              <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> columns without
              support for fractional seconds precision) and the
              <a class="link" href="server-administration.html#sysvar_avoid_temporal_upgrade"><code class="literal">avoid_temporal_upgrade</code></a>
              system variable is disabled. This helps the MySQL upgrade
              procedure detect and upgrade tables containing old
              temporal columns. If
              <a class="link" href="server-administration.html#sysvar_avoid_temporal_upgrade"><code class="literal">avoid_temporal_upgrade</code></a> is
              enabled, <code class="literal">FOR UPGRADE</code> ignores the old
              temporal columns present in the table; consequently, the
              upgrade procedure does not upgrade them.
            </p><p>
              To check for tables that contain such temporal columns and
              need a rebuild, disable
              <a class="link" href="server-administration.html#sysvar_avoid_temporal_upgrade"><code class="literal">avoid_temporal_upgrade</code></a>
              before executing
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE
              ... FOR UPGRADE</code></a>.
            </p></li><li class="listitem"><p>
              Warnings are issued for tables that use nonnative
              partitioning because nonnative partitioning is removed in
              MySQL 8.0. See
              <a class="xref" href="partitioning.html" title="Chapter 23 Partitioning">Chapter 23, <i>Partitioning</i></a>.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="check-table-data-consistency"></a>Checking Data Consistency</h5>

</div>

</div>

</div>
<p>
          The following table shows the other check options that can be
          given. These options are passed to the storage engine, which
          may use or ignore them.
</p>
<div class="informaltable">
<table summary="Other CHECK TABLE options."><col width="15%"><col width="85%"><thead><tr>
              <th scope="col">Type</th>
              <th scope="col">Meaning</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">QUICK</code></td>
              <td>Do not scan the rows to check for incorrect links. Applies to
                <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code>
                tables and views.</td>
            </tr><tr>
              <td scope="row"><code class="literal">FAST</code></td>
              <td>Check only tables that have not been closed properly. Ignored for
                <code class="literal">InnoDB</code>; applies only to
                <code class="literal">MyISAM</code> tables and views.</td>
            </tr><tr>
              <td scope="row"><code class="literal">CHANGED</code></td>
              <td>Check only tables that have been changed since the last check or that
                have not been closed properly. Ignored for
                <code class="literal">InnoDB</code>; applies only to
                <code class="literal">MyISAM</code> tables and views.</td>
            </tr><tr>
              <td scope="row"><code class="literal">MEDIUM</code></td>
              <td>Scan rows to verify that deleted links are valid. This also calculates a
                key checksum for the rows and verifies this with a
                calculated checksum for the keys. Ignored for
                <code class="literal">InnoDB</code>; applies only to
                <code class="literal">MyISAM</code> tables and views.</td>
            </tr><tr>
              <td scope="row"><code class="literal">EXTENDED</code></td>
              <td>Do a full key lookup for all keys for each row. This ensures that the
                table is 100% consistent, but takes a long time. Ignored
                for <code class="literal">InnoDB</code>; applies only to
                <code class="literal">MyISAM</code> tables and views.</td>
</tr></tbody></table>
</div>
<p>
          You can combine check options, as in the following example
          that does a quick check on the table to determine whether it
          was closed properly:
        </p><pre data-lang="sql" class="programlisting">
CHECK TABLE test_table FAST QUICK;
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            If <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> finds no
            problems with a table that is marked as
            <span class="quote">“<span class="quote">corrupted</span>”</span> or <span class="quote">“<span class="quote">not closed
            properly</span>”</span>, <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a>
            may remove the mark.
</p>
</div>
<p>
          If a table is corrupted, the problem is most likely in the
          indexes and not in the data part. All of the preceding check
          types check the indexes thoroughly and should thus find most
          errors.
        </p><p>
          To check a table that you assume is okay, use no check options
          or the <code class="literal">QUICK</code> option. The latter should be
          used when you are in a hurry and can take the very small risk
          that <code class="literal">QUICK</code> does not find an error in the
          data file. (In most cases, under normal usage, MySQL should
          find any error in the data file. If this happens, the table is
          marked as <span class="quote">“<span class="quote">corrupted</span>”</span> and cannot be used until it
          is repaired.)
        </p><p>
          <code class="literal">FAST</code> and <code class="literal">CHANGED</code> are
          mostly intended to be used from a script (for example, to be
          executed from <span class="command"><strong>cron</strong></span>) to check tables
          periodically. In most cases, <code class="literal">FAST</code> is to be
          preferred over <code class="literal">CHANGED</code>. (The only case when
          it is not preferred is when you suspect that you have found a
          bug in the <code class="literal">MyISAM</code> code.)
        </p><p>
          <code class="literal">EXTENDED</code> is to be used only after you have
          run a normal check but still get errors from a table when
          MySQL tries to update a row or find a row by key. This is very
          unlikely if a normal check has succeeded.
        </p><p>
          Use of <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK
          TABLE ... EXTENDED</code></a> might influence execution plans
          generated by the query optimizer.
        </p><p>
          Some problems reported by <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK
          TABLE</code></a> cannot be corrected automatically:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">Found row where the auto_increment column has the
              value 0</code>.
            </p><p>
              This means that you have a row in the table where the
              <code class="literal">AUTO_INCREMENT</code> index column contains
              the value 0. (It is possible to create a row where the
              <code class="literal">AUTO_INCREMENT</code> column is 0 by
              explicitly setting the column to 0 with an
              <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement.)
            </p><p>
              This is not an error in itself, but could cause trouble if
              you decide to dump the table and restore it or do an
              <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> on the table.
              In this case, the <code class="literal">AUTO_INCREMENT</code> column
              changes value according to the rules of
              <code class="literal">AUTO_INCREMENT</code> columns, which could
              cause problems such as a duplicate-key error.
            </p><p>
              To get rid of the warning, execute an
              <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement to set the
              column to some value other than 0.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="check-table-innodb"></a>CHECK TABLE Usage Notes for InnoDB Tables</h5>

</div>

</div>

</div>
<p>
          The following notes apply to
          <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              If <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> encounters a
              corrupt page, the server exits to prevent error
              propagation (Bug #10132). If the corruption occurs in a
              secondary index but table data is readable, running
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> can still cause
              a server exit.
            </p></li><li class="listitem"><p>
              If <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> encounters a
              corrupted <code class="literal">DB_TRX_ID</code> or
              <code class="literal">DB_ROLL_PTR</code> field in a clustered index,
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> can cause
              <code class="literal">InnoDB</code> to access an invalid undo log
              record, resulting in an
              <a class="link" href="glossary.html#glos_mvcc" title="MVCC">MVCC</a>-related server exit.
            </p></li><li class="listitem"><p>
              If <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> encounters
              errors in <code class="literal">InnoDB</code> tables or indexes, it
              reports an error, and usually marks the index and
              sometimes marks the table as corrupted, preventing further
              use of the index or table. Such errors include an
              incorrect number of entries in a secondary index or
              incorrect links.
            </p></li><li class="listitem"><p>
              If <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> finds an
              incorrect number of entries in a secondary index, it
              reports an error but does not cause a server exit or
              prevent access to the file.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> surveys the
              index page structure, then surveys each key entry. It does
              not validate the key pointer to a clustered record or
              follow the path for <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>
              pointers.
            </p></li><li class="listitem"><p>
              When an <code class="literal">InnoDB</code> table is stored in its
              own
              <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file"><code class="filename">.ibd</code>
              file</a>, the first 3
              <a class="link" href="glossary.html#glos_page" title="page">pages</a> of the
              <code class="literal">.ibd</code> file contain header information
              rather than table or index data. The
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> statement does
              not detect inconsistencies that affect only the header
              data. To verify the entire contents of an
              <code class="literal">InnoDB</code> <code class="literal">.ibd</code> file,
              use the <a class="link" href="programs.html#innochecksum" title="4.6.2 innochecksum — Offline InnoDB File Checksum Utility"><span class="command"><strong>innochecksum</strong></span></a> command.
            </p></li><li class="listitem"><p>
              When running <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> on
              large <code class="literal">InnoDB</code> tables, other threads may
              be blocked during <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK
              TABLE</code></a> execution. To avoid timeouts, the
              semaphore wait threshold (600 seconds) is extended by 2
              hours (7200 seconds) for <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK
              TABLE</code></a> operations. If <code class="literal">InnoDB</code>
              detects semaphore waits of 240 seconds or more, it starts
              printing <code class="literal">InnoDB</code> monitor output to the
              error log. If a lock request extends beyond the semaphore
              wait threshold, <code class="literal">InnoDB</code> aborts the
              process. To avoid the possibility of a semaphore wait
              timeout entirely, run
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE
              QUICK</code></a> instead of <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK
              TABLE</code></a>.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> functionality
              for <code class="literal">InnoDB</code> <code class="literal">SPATIAL</code>
              indexes includes an R-tree validity check and a check to
              ensure that the R-tree row count matches the clustered
              index.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> supports
              secondary indexes on virtual generated columns, which are
              supported by <code class="literal">InnoDB</code>.
            </p></li><li class="listitem"><p>
              As of MySQL 8.0.14, <code class="literal">InnoDB</code> supports
              parallel clustered index reads, which can improve
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> performance.
              <code class="literal">InnoDB</code> reads the clustered index twice
              during a <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a>
              operation. The second read can be performed in parallel.
              The
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_parallel_read_threads"><code class="literal">innodb_parallel_read_threads</code></a>
              session variable must be set to a value greater than 1 for
              parallel clustered index reads to occur. The default value
              is 4. The actual number of threads used to perform a
              parallel clustered index read is determined by the
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_parallel_read_threads"><code class="literal">innodb_parallel_read_threads</code></a>
              setting or the number of index subtrees to scan, whichever
              is smaller.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="check-table-myisam"></a>CHECK TABLE Usage Notes for MyISAM Tables</h5>

</div>

</div>

</div>
<p>
          The following notes apply to
          <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> updates key
              statistics for <code class="literal">MyISAM</code> tables.
            </p></li><li class="listitem"><p>
              If <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> output does
              not return <code class="literal">OK</code> or <code class="literal">Table is
              already up to date</code>, you should normally run a
              repair of the table. See
              <a class="xref" href="backup-and-recovery.html#myisam-table-maintenance" title="7.6 MyISAM Table Maintenance and Crash Recovery">Section 7.6, “MyISAM Table Maintenance and Crash Recovery”</a>.
            </p></li><li class="listitem"><p>
              If none of the <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a>
              options <code class="literal">QUICK</code>,
              <code class="literal">MEDIUM</code>, or <code class="literal">EXTENDED</code>
              are specified, the default check type for dynamic-format
              <code class="literal">MyISAM</code> tables is
              <code class="literal">MEDIUM</code>. This has the same result as
              running <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk --medium-check
              <em class="replaceable"><code>tbl_name</code></em></strong></span></a> on the
              table. The default check type also is
              <code class="literal">MEDIUM</code> for static-format
              <code class="literal">MyISAM</code> tables, unless
              <code class="literal">CHANGED</code> or <code class="literal">FAST</code> is
              specified. In that case, the default is
              <code class="literal">QUICK</code>. The row scan is skipped for
              <code class="literal">CHANGED</code> and <code class="literal">FAST</code>
              because the rows are very seldom corrupted.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="checksum-table"></a>13.7.3.3 CHECKSUM TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657606416"></a><pre data-lang="sql" class="programlisting">
CHECKSUM TABLE <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ... [QUICK | EXTENDED]
</pre><p>
        <a class="link" href="sql-syntax.html#checksum-table" title="13.7.3.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM TABLE</code></a> reports a
        <a class="link" href="glossary.html#glos_checksum" title="checksum">checksum</a> for the contents
        of a table. You can use this statement to verify that the
        contents are the same before and after a backup, rollback, or
        other operation that is intended to put the data back to a known
        state.
      </p><p>
        This statement requires the
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the table.
      </p><p>
        This statement is not supported for views. If you run
        <a class="link" href="sql-syntax.html#checksum-table" title="13.7.3.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM TABLE</code></a> against a view,
        the <code class="literal">Checksum</code> value is always
        <code class="literal">NULL</code>, and a warning is returned.
      </p><p>
        For a nonexistent table, <a class="link" href="sql-syntax.html#checksum-table" title="13.7.3.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM
        TABLE</code></a> returns <code class="literal">NULL</code> and generates a
        warning.
      </p><p>
        During the checksum operation, the table is locked with a read
        lock for <code class="literal">InnoDB</code> and
        <code class="literal">MyISAM</code>.
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="checksum-table-performance-considerations"></a>Performance Considerations</h5>
</div>
</div>
</div>
<p>
          By default, the entire table is read row by row and the
          checksum is calculated. For large tables, this could take a
          long time, thus you would only perform this operation
          occasionally. This row-by-row calculation is what you get with
          the <code class="literal">EXTENDED</code> clause, with
          <code class="literal">InnoDB</code> and all other storage engines other
          than <code class="literal">MyISAM</code>, and with
          <code class="literal">MyISAM</code> tables not created with the
          <code class="literal">CHECKSUM=1</code> clause.
        </p><p>
          For <code class="literal">MyISAM</code> tables created with the
          <code class="literal">CHECKSUM=1</code> clause,
          <a class="link" href="sql-syntax.html#checksum-table" title="13.7.3.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM TABLE</code></a> or
          <a class="link" href="sql-syntax.html#checksum-table" title="13.7.3.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM TABLE
          ... QUICK</code></a> returns the <span class="quote">“<span class="quote">live</span>”</span> table
          checksum that can be returned very fast. If the table does not
          meet all these conditions, the <code class="literal">QUICK</code> method
          returns <code class="literal">NULL</code>. The <code class="literal">QUICK</code>
          method is not supported with <code class="literal">InnoDB</code> tables.
          See <a class="xref" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax">Section 13.1.20, “CREATE TABLE Syntax”</a> for the syntax of the
          <code class="literal">CHECKSUM</code> clause.
        </p><p>
          The checksum value depends on the table row format. If the row
          format changes, the checksum also changes. For example, the
          storage format for temporal types such as
          <a class="link" href="data-types.html#time" title="11.3.2 The TIME Type"><code class="literal">TIME</code></a>,
          <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a>, and
          <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> changed in MySQL 5.6
          prior to MySQL 5.6.5, so if a 5.5 table is upgraded to MySQL
          5.6, the checksum value may change.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            If the checksums for two tables are different, then it is
            almost certain that the tables are different in some way.
            However, because the hashing function used by
            <a class="link" href="sql-syntax.html#checksum-table" title="13.7.3.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM TABLE</code></a> is not
            guaranteed to be collision-free, there is a slight chance
            that two tables which are not identical can produce the same
            checksum.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="optimize-table"></a>13.7.3.4 OPTIMIZE TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657565296"></a><a class="indexterm" name="idm140091657564208"></a><a class="indexterm" name="idm140091657562720"></a><pre data-lang="sql" class="programlisting">
OPTIMIZE [NO_WRITE_TO_BINLOG | LOCAL]
    TABLE <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ...
</pre><p>
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> reorganizes the
        physical storage of table data and associated index data, to
        reduce storage space and improve I/O efficiency when accessing
        the table. The exact changes made to each table depend on the
        <a class="link" href="glossary.html#glos_storage_engine" title="storage engine">storage engine</a> used
        by that table.
      </p><p>
        Use <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> in these
        cases, depending on the type of table:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            After doing substantial insert, update, or delete operations
            on an <code class="literal">InnoDB</code> table that has its own
            <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file">.ibd file</a> because it
            was created with the
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a>
            option enabled. The table and indexes are reorganized, and
            disk space can be reclaimed for use by the operating system.
          </p></li><li class="listitem"><p>
            After doing substantial insert, update, or delete operations
            on columns that are part of a <code class="literal">FULLTEXT</code>
            index in an <code class="literal">InnoDB</code> table. Set the
            configuration option
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_optimize_fulltext_only"><code class="literal">innodb_optimize_fulltext_only=1</code></a>
            first. To keep the index maintenance period to a reasonable
            time, set the
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_num_word_optimize"><code class="literal">innodb_ft_num_word_optimize</code></a>
            option to specify how many words to update in the search
            index, and run a sequence of <code class="literal">OPTIMIZE
            TABLE</code> statements until the search index is fully
            updated.
          </p></li><li class="listitem"><p>
            After deleting a large part of a <code class="literal">MyISAM</code>
            or <code class="literal">ARCHIVE</code> table, or making many changes
            to a <code class="literal">MyISAM</code> or <code class="literal">ARCHIVE
            </code>table with variable-length rows (tables that have
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>,
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>, or
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns). Deleted rows
            are maintained in a linked list and subsequent
            <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a> operations reuse old
            row positions. You can use <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
            TABLE</code></a> to reclaim the unused space and to
            defragment the data file. After extensive changes to a
            table, this statement may also improve performance of
            statements that use the table, sometimes significantly.
</p></li></ul>
</div>
<p>
        This statement requires <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>
        and <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges for the
        table.
      </p><p>
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> works for
        <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>,
        <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>, and
        <a class="link" href="storage-engines.html#archive-storage-engine" title="16.5 The ARCHIVE Storage Engine"><code class="literal">ARCHIVE</code></a> tables.
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is also supported
        for dynamic columns of in-memory
        <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables. It does not work for
        fixed-width columns of in-memory tables, nor does it work for
        Disk Data tables. The performance of <code class="literal">OPTIMIZE</code>
        on NDB Cluster tables can be tuned using
        <a class="link" href="mysql-cluster.html#option_mysqld_ndb-optimization-delay"><code class="option">--ndb-optimization-delay</code></a>, which
        controls the length of time to wait between processing batches
        of rows by <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a>. For
        more information, see
        <a class="ulink" href="https://dev.mysql.com/doc/refman/5.6/en/mysql-cluster-limitations-resolved.html" target="_top">Previous NDB Cluster Issues Resolved in NDB Cluster 7.3</a>.
      </p><p>
        For NDB Cluster tables, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> can be interrupted by (for example) killing the
        SQL thread performing the <code class="literal">OPTIMIZE</code> operation.
      </p><p>
        By default, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> does
        <span class="emphasis"><em>not</em></span> work for tables created using any other
        storage engine and returns a result indicating this lack of
        support. You can make <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> work for other storage engines by starting
        <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> with the <code class="option">--skip-new</code>
        option. In this case, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> is just mapped to <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a>.
      </p><p>
        This statement does not work with views.
      </p><p>
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is supported for
        partitioned tables. For information about using this statement
        with partitioned tables and table partitions, see
        <a class="xref" href="partitioning.html#partitioning-maintenance" title="23.3.4 Maintenance of Partitions">Section 23.3.4, “Maintenance of Partitions”</a>.
      </p><p>
        By default, the server writes <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> statements to the binary log so that they
        replicate to replication slaves. To suppress logging, specify
        the optional <code class="literal">NO_WRITE_TO_BINLOG</code> keyword or
        its alias <code class="literal">LOCAL</code>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#optimize-table-output" title="OPTIMIZE TABLE Output">OPTIMIZE TABLE Output</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#optimize-table-innodb-details" title="InnoDB Details">InnoDB Details</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#optimize-table-myisam-details" title="MyISAM Details">MyISAM Details</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#optimize-table-other-considerations" title="Other Considerations">Other Considerations</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="optimize-table-output"></a>OPTIMIZE TABLE Output</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> returns a result
          set with the columns shown in the following table.
</p>
<div class="informaltable">
<table summary="Columns of the OPTIMIZE TABLE result set."><col width="15%"><col width="60%"><thead><tr>
              <th scope="col">Column</th>
              <th scope="col">Value</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">Table</code></td>
              <td>The table name</td>
            </tr><tr>
              <td scope="row"><code class="literal">Op</code></td>
              <td>Always <code class="literal">optimize</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">Msg_type</code></td>
              <td><code class="literal">status</code>, <code class="literal">error</code>,
                <code class="literal">info</code>, <code class="literal">note</code>, or
                <code class="literal">warning</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">Msg_text</code></td>
              <td>An informational message</td>
</tr></tbody></table>
</div>
<p>
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> table catches
          and throws any errors that occur while copying table
          statistics from the old file to the newly created file. For
          example. if the user ID of the owner of the
          <code class="filename">.MYD</code> or <code class="filename">.MYI</code> file is
          different from the user ID of the <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>
          process, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a>
          generates a "cannot change ownership of the file" error unless
          <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> is started by the
          <code class="literal">root</code> user.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="optimize-table-innodb-details"></a>InnoDB Details</h5>

</div>

</div>

</div>
<p>
          For <code class="literal">InnoDB</code> tables,
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is mapped to
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          FORCE</code></a>, which rebuilds the table to update index
          statistics and free unused space in the clustered index. This
          is displayed in the output of <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
          TABLE</code></a> when you run it on an
          <code class="literal">InnoDB</code> table, as shown here:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; OPTIMIZE TABLE foo;
+----------+----------+----------+-------------------------------------------------------------------+
| Table    | Op       | Msg_type | Msg_text                                                          |
+----------+----------+----------+-------------------------------------------------------------------+
| test.foo | optimize | note     | Table does not support optimize, doing recreate + analyze instead |
| test.foo | optimize | status   | OK                                                                |
+----------+----------+----------+-------------------------------------------------------------------+
</pre><p>
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> uses
          <a class="link" href="innodb-storage-engine.html#innodb-online-ddl" title="15.12 InnoDB and Online DDL">online DDL</a> for
          regular and partitioned <code class="literal">InnoDB</code> tables,
          which reduces downtime for concurrent DML operations. The
          table rebuild triggered by <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
          TABLE</code></a> and performed under the cover by
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          FORCE</code></a> is completed in place. An exclusive table lock
          is only taken briefly during the prepare phase and the commit
          phase of the operation. During the prepare phase, metadata is
          updated and an intermediate table is created. During the
          commit phase, table metadata changes are committed.
        </p><p>
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> rebuilds the
          table using the table copy method under the following
          conditions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              When the <a class="link" href="server-administration.html#sysvar_old_alter_table"><code class="literal">old_alter_table</code></a>
              system variable is enabled.
            </p></li><li class="listitem"><p>
              When the <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>
              <code class="literal">--skip-new</code> option is enabled.
</p></li></ul>
</div>
<p>
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> using
          <a class="link" href="innodb-storage-engine.html#innodb-online-ddl" title="15.12 InnoDB and Online DDL">online DDL</a> is not
          supported for <code class="literal">InnoDB</code> tables that contain
          <code class="literal">FULLTEXT</code> indexes. The table copy method is
          used instead.
        </p><p>
          <code class="literal">InnoDB</code> stores data using a page-allocation
          method and does not suffer from fragmentation in the same way
          that legacy storage engines (such as
          <code class="literal">MyISAM</code>) will. When considering whether or
          not to run optimize, consider the workload of transactions
          that your server will process:

</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                Some level of fragmentation is expected.
                <code class="literal">InnoDB</code> only fills
                <a class="link" href="glossary.html#glos_page" title="page">pages</a> 93% full, to
                leave room for updates without having to split pages.
              </p></li><li class="listitem"><p>
                Delete operations might leave gaps that leave pages less
                filled than desired, which could make it worthwhile to
                optimize the table.
              </p></li><li class="listitem"><p>
                Updates to rows usually rewrite the data within the same
                page, depending on the data type and row format, when
                sufficient space is available. See
                <a class="xref" href="innodb-storage-engine.html#innodb-compression-internals" title="15.9.1.5 How Compression Works for InnoDB Tables">Section 15.9.1.5, “How Compression Works for InnoDB Tables”</a> and
                <a class="xref" href="innodb-storage-engine.html#innodb-row-format" title="15.10 InnoDB Row Formats">Section 15.10, “InnoDB Row Formats”</a>.
              </p></li><li class="listitem"><p>
                High-concurrency workloads might leave gaps in indexes
                over time, as <code class="literal">InnoDB</code> retains multiple
                versions of the same data due through its
                <a class="link" href="glossary.html#glos_mvcc" title="MVCC">MVCC</a> mechanism. See
                <a class="xref" href="innodb-storage-engine.html#innodb-multi-versioning" title="15.3 InnoDB Multi-Versioning">Section 15.3, “InnoDB Multi-Versioning”</a>.
</p></li></ul>
</div>
<p>
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="optimize-table-myisam-details"></a>MyISAM Details</h5>

</div>

</div>

</div>
<p>
          For <code class="literal">MyISAM</code> tables,
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> works as
          follows:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
              If the table has deleted or split rows, repair the table.
            </p></li><li class="listitem"><p>
              If the index pages are not sorted, sort them.
            </p></li><li class="listitem"><p>
              If the table's statistics are not up to date (and the
              repair could not be accomplished by sorting the index),
              update them.
</p></li></ol>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="optimize-table-other-considerations"></a>Other Considerations</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is performed
          online for regular and partitioned <code class="literal">InnoDB</code>
          tables. Otherwise, MySQL <a class="link" href="glossary.html#glos_table_lock" title="table lock">locks
          the table</a> during the time <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
          TABLE</code></a> is running.
        </p><p>
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> does not sort
          R-tree indexes, such as spatial indexes on
          <code class="literal">POINT</code> columns. (Bug #23578)
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="repair-table"></a>13.7.3.5 REPAIR TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657408352"></a><pre data-lang="sql" class="programlisting">
REPAIR [NO_WRITE_TO_BINLOG | LOCAL]
    TABLE <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ...
    [QUICK] [EXTENDED] [USE_FRM]
</pre><p>
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> repairs a possibly
        corrupted table, for certain storage engines only.
      </p><p>
        This statement requires <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>
        and <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges for the
        table.
      </p><p>
        Although normally you should never have to run
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>, if disaster
        strikes, this statement is very likely to get back all your data
        from a <code class="literal">MyISAM</code> table. If your tables become
        corrupted often, try to find the reason for it, to eliminate the
        need to use <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>. See
        <a class="xref" href="error-handling.html#crashing" title="B.4.3.3 What to Do If MySQL Keeps Crashing">Section B.4.3.3, “What to Do If MySQL Keeps Crashing”</a>, and
        <a class="xref" href="storage-engines.html#myisam-table-problems" title="16.2.4 MyISAM Table Problems">Section 16.2.4, “MyISAM Table Problems”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> checks the table to
        see whether an upgrade is required. If so, it performs the
        upgrade, following the same rules as
        <a class="link" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE ... FOR
        UPGRADE</code></a>. See <a class="xref" href="sql-syntax.html#check-table" title="13.7.3.2 CHECK TABLE Syntax">Section 13.7.3.2, “CHECK TABLE Syntax”</a>, for more
        information.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>

<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Make a backup of a table before performing a table repair
              operation; under some circumstances the operation might
              cause data loss. Possible causes include but are not
              limited to file system errors. See
              <a class="xref" href="backup-and-recovery.html" title="Chapter 7 Backup and Recovery">Chapter 7, <i>Backup and Recovery</i></a>.
            </p></li><li class="listitem"><p>
              If the server crashes during a <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
              TABLE</code></a> operation, it is essential after
              restarting it that you immediately execute another
              <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> statement for
              the table before performing any other operations on it. In
              the worst case, you might have a new clean index file
              without information about the data file, and then the next
              operation you perform could overwrite the data file. This
              is an unlikely but possible scenario that underscores the
              value of making a backup first.
            </p></li><li class="listitem"><p>
              In the event that a table on the master becomes corrupted
              and you run <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> on
              it, any resulting changes to the original table are
              <span class="emphasis"><em>not</em></span> propagated to slaves.
</p></li></ul>
</div>

</div>
<a class="indexterm" name="idm140091657380400"></a><a class="indexterm" name="idm140091657378896"></a>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#repair-table-support" title="REPAIR TABLE Storage Engine and Partitioning Support">REPAIR TABLE Storage Engine and Partitioning Support</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#repair-table-options" title="REPAIR TABLE Options">REPAIR TABLE Options</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#repair-table-output" title="REPAIR TABLE Output">REPAIR TABLE Output</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#repair-table-table-repair-considerations" title="Table Repair Considerations">Table Repair Considerations</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="repair-table-support"></a>REPAIR TABLE Storage Engine and Partitioning Support</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657371104"></a><a class="indexterm" name="idm140091657369648"></a><p>
          <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> works for
          <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>,
          <a class="link" href="storage-engines.html#archive-storage-engine" title="16.5 The ARCHIVE Storage Engine"><code class="literal">ARCHIVE</code></a>, and
          <a class="link" href="storage-engines.html#csv-storage-engine" title="16.4 The CSV Storage Engine"><code class="literal">CSV</code></a> tables. For
          <a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> tables, it has the same
          effect as <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk --recover
          <em class="replaceable"><code>tbl_name</code></em></strong></span></a> by default. This
          statement does not work with views.
        </p><p>
          <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> is supported for
          partitioned tables. However, the <code class="literal">USE_FRM</code>
          option cannot be used with this statement on a partitioned
          table.
        </p><p>
          You can use <code class="literal">ALTER TABLE ... REPAIR
          PARTITION</code> to repair one or more partitions; for more
          information, see <a class="xref" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax">Section 13.1.9, “ALTER TABLE Syntax”</a>, and
          <a class="xref" href="partitioning.html#partitioning-maintenance" title="23.3.4 Maintenance of Partitions">Section 23.3.4, “Maintenance of Partitions”</a>.
</p>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="repair-table-options"></a>REPAIR TABLE Options</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657353744"></a>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NO_WRITE_TO_BINLOG</code> or
              <code class="literal">LOCAL</code>
            </p><p>
              By default, the server writes <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
              TABLE</code></a> statements to the binary log so that they
              replicate to replication slaves. To suppress logging,
              specify the optional <code class="literal">NO_WRITE_TO_BINLOG</code>
              keyword or its alias <code class="literal">LOCAL</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">QUICK</code>
            </p><p>
              If you use the <code class="literal">QUICK</code> option,
              <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> tries to
              repair only the index file, and not the data file. This
              type of repair is like that done by <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk
              --recover --quick</strong></span></a>.
            </p></li><li class="listitem"><p>
              <code class="literal">EXTENDED</code>
            </p><p>
              If you use the <code class="literal">EXTENDED</code> option, MySQL
              creates the index row by row instead of creating one index
              at a time with sorting. This type of repair is like that
              done by <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk --safe-recover</strong></span></a>.
            </p></li><li class="listitem"><p>
              <code class="literal">USE_FRM</code>
            </p><p>
              The <code class="literal">USE_FRM</code> option is available for use
              if the <code class="filename">.MYI</code> index file is missing or
              if its header is corrupted. This option tells MySQL not to
              trust the information in the <code class="filename">.MYI</code>
              file header and to re-create it using information from the
              data dictionary. This kind of repair cannot be done with
              <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk</strong></span></a>.
</p>
<div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Caution
</div>
<p>
                Use the <code class="literal">USE_FRM</code> option
                <span class="emphasis"><em>only</em></span> if you cannot use regular
                <code class="literal">REPAIR</code> modes. Telling the server to
                ignore the <code class="filename">.MYI</code> file makes
                important table metadata stored in the
                <code class="filename">.MYI</code> unavailable to the repair
                process, which can have deleterious consequences:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                    The current <code class="literal">AUTO_INCREMENT</code> value
                    is lost.
                  </p></li><li class="listitem"><p>
                    The link to deleted records in the table is lost,
                    which means that free space for deleted records will
                    remain unoccupied thereafter.
                  </p></li><li class="listitem"><p>
                    The <code class="filename">.MYI</code> header indicates
                    whether the table is compressed. If the server
                    ignores this information, it cannot tell that a
                    table is compressed and repair can cause change or
                    loss of table contents. This means that
                    <code class="literal">USE_FRM</code> should not be used with
                    compressed tables. That should not be necessary,
                    anyway: Compressed tables are read only, so they
                    should not become corrupt.
</p></li></ul>
</div>
<p>
                If you use <code class="literal">USE_FRM</code> for a table that
                was created by a different version of the MySQL server
                than the one you are currently running,
                <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> does not
                attempt to repair the table. In this case, the result
                set returned by <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
                TABLE</code></a> contains a line with a
                <code class="literal">Msg_type</code> value of
                <code class="literal">error</code> and a
                <code class="literal">Msg_text</code> value of <code class="literal">Failed
                repairing incompatible .FRM file</code>.
              </p><p>
                If <code class="literal">USE_FRM</code> is used,
                <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> does not
                check the table to see whether an upgrade is required.
</p>
</div>
</li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="repair-table-output"></a>REPAIR TABLE Output</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657311104"></a><p>
          <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> returns a result
          set with the columns shown in the following table.
</p>
<div class="informaltable">
<table summary="Columns of the REPAIR TABLE result set."><col width="15%"><col width="60%"><thead><tr>
              <th scope="col">Column</th>
              <th scope="col">Value</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">Table</code></td>
              <td>The table name</td>
            </tr><tr>
              <td scope="row"><code class="literal">Op</code></td>
              <td>Always <code class="literal">repair</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">Msg_type</code></td>
              <td><code class="literal">status</code>, <code class="literal">error</code>,
                <code class="literal">info</code>, <code class="literal">note</code>, or
                <code class="literal">warning</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">Msg_text</code></td>
              <td>An informational message</td>
</tr></tbody></table>
</div>
<p>
          The <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> statement
          might produce many rows of information for each repaired
          table. The last row has a <code class="literal">Msg_type</code> value of
          <code class="literal">status</code> and <code class="literal">Msg_test</code>
          normally should be <code class="literal">OK</code>. For a
          <code class="literal">MyISAM</code> table, if you do not get
          <code class="literal">OK</code>, you should try repairing it with
          <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk --safe-recover</strong></span></a>.
          (<a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> does not
          implement all the options of <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk</strong></span></a>.
          With <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk --safe-recover</strong></span></a>, you can also
          use options that <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>
          does not support, such as
          <a class="link" href="programs.html#option_myisamchk_max-record-length"><code class="option">--max-record-length</code></a>.)
        </p><p>
          <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> table catches and
          throws any errors that occur while copying table statistics
          from the old corrupted file to the newly created file. For
          example. if the user ID of the owner of the
          <code class="filename">.MYD</code> or <code class="filename">.MYI</code> file is
          different from the user ID of the <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>
          process, <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> generates
          a "cannot change ownership of the file" error unless
          <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> is started by the
          <code class="literal">root</code> user.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="repair-table-table-repair-considerations"></a>Table Repair Considerations</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> upgrades a table
          if it contains old temporal columns in pre-5.6.4 format
          (<a class="link" href="data-types.html#time" title="11.3.2 The TIME Type"><code class="literal">TIME</code></a>,
          <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a>, and
          <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> columns without
          support for fractional seconds precision) and the
          <a class="link" href="server-administration.html#sysvar_avoid_temporal_upgrade"><code class="literal">avoid_temporal_upgrade</code></a> system
          variable is disabled. If
          <a class="link" href="server-administration.html#sysvar_avoid_temporal_upgrade"><code class="literal">avoid_temporal_upgrade</code></a> is
          enabled, <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> ignores
          the old temporal columns present in the table and does not
          upgrade them.
        </p><p>
          To upgrade tables that contain such temporal columns, disable
          <a class="link" href="server-administration.html#sysvar_avoid_temporal_upgrade"><code class="literal">avoid_temporal_upgrade</code></a> before
          executing <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>.
        </p><p>
          You may be able to increase <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
          TABLE</code></a> performance by setting certain system
          variables. See <a class="xref" href="optimization.html#repair-table-optimization" title="8.6.3 Optimizing REPAIR TABLE Statements">Section 8.6.3, “Optimizing REPAIR TABLE Statements”</a>.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="component-sql"></a>13.7.4 Component, Plugin, and User-Defined Function Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#create-function-udf">13.7.4.1 CREATE FUNCTION Syntax for User-Defined Functions</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-function-udf">13.7.4.2 DROP FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#install-component">13.7.4.3 INSTALL COMPONENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#install-plugin">13.7.4.4 INSTALL PLUGIN Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#uninstall-component">13.7.4.5 UNINSTALL COMPONENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#uninstall-plugin">13.7.4.6 UNINSTALL PLUGIN Syntax</a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-function-udf"></a>13.7.4.1 CREATE FUNCTION Syntax for User-Defined Functions</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657246512"></a><a class="indexterm" name="idm140091657245424"></a><a class="indexterm" name="idm140091657243936"></a><a class="indexterm" name="idm140091657242448"></a><a class="indexterm" name="idm140091657241376"></a><a class="indexterm" name="idm140091657240304"></a><pre data-lang="sql" class="programlisting">
CREATE [AGGREGATE] FUNCTION <em class="replaceable"><code>function_name</code></em>
    RETURNS {STRING|INTEGER|REAL|DECIMAL}
    SONAME <em class="replaceable"><code>shared_library_name</code></em>
</pre><p>
        A user-defined function (UDF) is a way to extend MySQL with a
        new function that works like a native (built-in) MySQL function
        such as <a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a> or
        <a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a>.
      </p><p>
        <em class="replaceable"><code>function_name</code></em> is the name that should
        be used in SQL statements to invoke the function. The
        <code class="literal">RETURNS</code> clause indicates the type of the
        function's return value. <a class="link" href="data-types.html#fixed-point-types" title="11.2.2 Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">DECIMAL</code></a>
        is a legal value after <code class="literal">RETURNS</code>, but currently
        <a class="link" href="data-types.html#fixed-point-types" title="11.2.2 Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">DECIMAL</code></a> functions return string
        values and should be written like <code class="literal">STRING</code>
        functions.
      </p><p>
        <em class="replaceable"><code>shared_library_name</code></em> is the base name
        of the shared library file that contains the code that
        implements the function. The file must be located in the plugin
        directory. This directory is given by the value of the
        <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> system variable. For
        more information, see <a class="xref" href="server-administration.html#udf-loading" title="5.7.1 Installing and Uninstalling User-Defined Functions">Section 5.7.1, “Installing and Uninstalling User-Defined Functions”</a>.
      </p><p>
        To create a function, you must have the
        <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for the
        <code class="literal">mysql</code> system database. This is necessary
        because <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> adds a
        row to the <code class="literal">mysql.func</code> system table that
        records the function's name, type, and shared library name.
      </p><p>
        UDFs registered using <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE
        FUNCTION</code></a> are listed in the Performance Schema
        <a class="link" href="performance-schema.html#user-defined-functions-table" title="26.12.17.6 The user_defined_functions Table"><code class="literal">user_defined_functions</code></a> table; see
        <a class="xref" href="performance-schema.html#user-defined-functions-table" title="26.12.17.6 The user_defined_functions Table">Section 26.12.17.6, “The user_defined_functions Table”</a>.
      </p><p>
        An active function is one that has been loaded with
        <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> and not removed
        with <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a>. All active
        functions are reloaded each time the server starts, unless you
        start <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> with the
        <a class="link" href="server-administration.html#option_mysqld_skip-grant-tables"><code class="option">--skip-grant-tables</code></a> option. In
        this case, UDF initialization is skipped and UDFs are
        unavailable.
      </p><p>
        For instructions on writing user-defined functions, see
        <a class="xref" href="extending-mysql.html#adding-udf" title="29.4.2 Adding a New User-Defined Function">Section 29.4.2, “Adding a New User-Defined Function”</a>. For the UDF mechanism to work,
        functions must be written in C or C++ (or another language that
        can use C calling conventions), your operating system must
        support dynamic loading and you must have compiled
        <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> dynamically (not statically).
      </p><p>
        An <code class="literal">AGGREGATE</code> function works exactly like a
        native MySQL aggregate (summary) function such as
        <code class="literal">SUM</code> or
        <a class="link" href="functions.html#function_count"><code class="literal">COUNT()</code></a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          To upgrade the shared library associated with a UDF, issue a
          <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> statement,
          upgrade the shared library, and then issue a
          <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> statement. If
          you upgrade the shared library first and then use
          <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a>, the server may
          crash.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="drop-function-udf"></a>13.7.4.2 DROP FUNCTION Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657196288"></a><a class="indexterm" name="idm140091657195216"></a><a class="indexterm" name="idm140091657193728"></a><a class="indexterm" name="idm140091657192240"></a><a class="indexterm" name="idm140091657191168"></a><a class="indexterm" name="idm140091657190096"></a><pre data-lang="sql" class="programlisting">
DROP FUNCTION <em class="replaceable"><code>function_name</code></em>
</pre><p>
        This statement drops the user-defined function (UDF) named
        <em class="replaceable"><code>function_name</code></em>.
      </p><p>
        To drop a function, you must have the
        <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege for the
        <code class="literal">mysql</code> system database. This is because
        <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> removes a row from
        the <code class="literal">mysql.func</code> system table that records the
        function's name, type, and shared library name.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          To upgrade the shared library associated with a UDF, issue a
          <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> statement,
          upgrade the shared library, and then issue a
          <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> statement. If
          you upgrade the shared library first and then use
          <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a>, the server may
          crash.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#drop-function" title="13.1.26 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> is also used to
        drop stored functions (see <a class="xref" href="sql-syntax.html#drop-procedure" title="13.1.29 DROP PROCEDURE and DROP FUNCTION Syntax">Section 13.1.29, “DROP PROCEDURE and DROP FUNCTION Syntax”</a>).
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="install-component"></a>13.7.4.3 INSTALL COMPONENT Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657169136"></a><a class="indexterm" name="idm140091657168048"></a><a class="indexterm" name="idm140091657166976"></a><pre data-lang="sql" class="programlisting">
INSTALL COMPONENT <em class="replaceable"><code>component_name</code></em> [, <em class="replaceable"><code>component_name</code></em> ] ...
</pre><p>
        This statement installs one or more server components, which
        become active immediately. A component provides services that
        are available to the server and other components; see
        <a class="xref" href="server-administration.html#server-components" title="5.5 MySQL Server Components">Section 5.5, “MySQL Server Components”</a>.
        <a class="link" href="sql-syntax.html#install-component" title="13.7.4.3 INSTALL COMPONENT Syntax"><code class="literal">INSTALL COMPONENT</code></a> requires the
        <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for the
        <code class="literal">mysql.component</code> system table.
      </p><p>
        Example:
      </p><pre data-lang="sql" class="programlisting">
INSTALL COMPONENT 'file://component1', 'file://component2';
</pre><p>
        Component names are URNs that begin with
        <code class="literal">file://</code> and indicate the base name of the
        file that implements the component, located in the directory
        named by the <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> system
        variable. Component names do not include any platform-dependent
        file name suffix such as <code class="filename">.so</code> or
        <code class="filename">.dll</code>. (These naming details are subject to
        change because component name interpretation is itself performed
        by a service and the component infrastructure makes it possible
        to replace the default service implementation with alternative
        implementations.)
      </p><p>
        If any error occurs, the statement fails and has no effect. For
        example, this happens if a component name is erroneous, a named
        component does not exist or is already installed, or component
        initialization fails.
      </p><p>
        A loader service handles component loading, which includes
        adding installed components to the
        <code class="literal">mysql.component</code> system table that serves as a
        registry. For subsequent server restarts, any components listed
        in <code class="literal">mysql.component</code> are loaded by the loader
        service during the startup sequence. This occurs even if the
        server is started with the
        <a class="link" href="server-administration.html#option_mysqld_skip-grant-tables"><code class="option">--skip-grant-tables</code></a> option.
      </p><p>
        If a component depends on services not present in the registry
        and you attempt to install the component without also installing
        the component or components that provide the services on which
        it depends, an error occurs:
      </p><pre data-lang="none" class="programlisting">
ERROR 3527 (HY000): Cannot satisfy dependency for service 'component_a'
required by component 'component_b'.
</pre><p>
        To avoid this problem, either install all components in the same
        statement, or install the dependent component after installing
        any components on which it depends.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="install-plugin"></a>13.7.4.4 INSTALL PLUGIN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657141648"></a><a class="indexterm" name="idm140091657140608"></a><a class="indexterm" name="idm140091657139536"></a><pre data-lang="sql" class="programlisting">
INSTALL PLUGIN <em class="replaceable"><code>plugin_name</code></em> SONAME '<em class="replaceable"><code>shared_library_name</code></em>'
</pre><p>
        This statement installs a server plugin. It requires the
        <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for the
        <code class="literal">mysql.plugin</code> system table.
      </p><p>
        <em class="replaceable"><code>plugin_name</code></em> is the name of the plugin
        as defined in the plugin descriptor structure contained in the
        library file (see <a class="xref" href="extending-mysql.html#plugin-data-structures" title="29.2.4.2 Plugin Data Structures">Section 29.2.4.2, “Plugin Data Structures”</a>).
        Plugin names are not case-sensitive. For maximal compatibility,
        plugin names should be limited to ASCII letters, digits, and
        underscore because they are used in C source files, shell
        command lines, M4 and Bourne shell scripts, and SQL
        environments.
      </p><p>
        <em class="replaceable"><code>shared_library_name</code></em> is the name of
        the shared library that contains the plugin code. The name
        includes the file name extension (for example,
        <code class="filename">libmyplugin.so</code>,
        <code class="filename">libmyplugin.dll</code>, or
        <code class="filename">libmyplugin.dylib</code>).
      </p><p>
        The shared library must be located in the plugin directory (the
        directory named by the
        <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> system variable).
        The library must be in the plugin directory itself, not in a
        subdirectory. By default,
        <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> is the
        <code class="filename">plugin</code> directory under the directory named
        by the <code class="literal">pkglibdir</code> configuration variable, but
        it can be changed by setting the value of
        <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> at server startup.
        For example, set its value in a <code class="filename">my.cnf</code>
        file:
      </p><pre data-lang="ini" class="programlisting">
[mysqld]
plugin_dir=<em class="replaceable"><code>/path/to/plugin/directory</code></em>
</pre><p>
        If the value of <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> is a
        relative path name, it is taken to be relative to the MySQL base
        directory (the value of the
        <a class="link" href="server-administration.html#sysvar_basedir"><code class="literal">basedir</code></a> system variable).
      </p><p>
        <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> loads and
        initializes the plugin code to make the plugin available for
        use. A plugin is initialized by executing its initialization
        function, which handles any setup that the plugin must perform
        before it can be used. When the server shuts down, it executes
        the deinitialization function for each plugin that is loaded so
        that the plugin has a chance to perform any final cleanup.
      </p><p>
        <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> also registers the
        plugin by adding a line that indicates the plugin name and
        library file name to the <code class="literal">mysql.plugin</code> system
        table. At server startup, the server loads and initializes any
        plugin that is listed in <code class="literal">mysql.plugin</code>. This
        means that a plugin is installed with
        <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> only once, not
        every time the server starts. Plugin loading at startup does not
        occur if the server is started with the
        <a class="link" href="server-administration.html#option_mysqld_skip-grant-tables"><code class="option">--skip-grant-tables</code></a> option.
      </p><p>
        A plugin library can contain multiple plugins. For each of them
        to be installed, use a separate <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL
        PLUGIN</code></a> statement. Each statement names a different
        plugin, but all of them specify the same library name.
      </p><p>
        <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> causes the server
        to read option (<code class="filename">my.cnf</code>) files just as
        during server startup. This enables the plugin to pick up any
        relevant options from those files. It is possible to add plugin
        options to an option file even before loading a plugin (if the
        <code class="literal">loose</code> prefix is used). It is also possible to
        uninstall a plugin, edit <code class="filename">my.cnf</code>, and
        install the plugin again. Restarting the plugin this way enables
        it to the new option values without a server restart.
      </p><p>
        For options that control individual plugin loading at server
        startup, see <a class="xref" href="server-administration.html#plugin-loading" title="5.6.1 Installing and Uninstalling Plugins">Section 5.6.1, “Installing and Uninstalling Plugins”</a>. If you need to
        load plugins for a single server startup when the
        <a class="link" href="server-administration.html#option_mysqld_skip-grant-tables"><code class="option">--skip-grant-tables</code></a> option is
        given (which tells the server not to read system tables), use
        the <a class="link" href="server-administration.html#option_mysqld_plugin-load"><code class="option">--plugin-load</code></a> option. See
        <a class="xref" href="server-administration.html#server-options" title="5.1.7 Server Command Options">Section 5.1.7, “Server Command Options”</a>.
      </p><p>
        To remove a plugin, use the <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL
        PLUGIN</code></a> statement.
      </p><p>
        For additional information about plugin loading, see
        <a class="xref" href="server-administration.html#plugin-loading" title="5.6.1 Installing and Uninstalling Plugins">Section 5.6.1, “Installing and Uninstalling Plugins”</a>.
      </p><p>
        To see what plugins are installed, use the
        <a class="link" href="sql-syntax.html#show-plugins" title="13.7.6.25 SHOW PLUGINS Syntax"><code class="literal">SHOW PLUGINS</code></a> statement or query
        the <code class="literal">INFORMATION_SCHEMA</code> the
        <a class="link" href="information-schema.html#plugins-table" title="25.18 The INFORMATION_SCHEMA PLUGINS Table"><code class="literal">PLUGINS</code></a> table.
      </p><p>
        If you recompile a plugin library and need to reinstall it, you
        can use either of the following methods:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Use <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a> to
            uninstall all plugins in the library, install the new plugin
            library file in the plugin directory, and then use
            <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> to install all
            plugins in the library. This procedure has the advantage
            that it can be used without stopping the server. However, if
            the plugin library contains many plugins, you must issue
            many <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> and
            <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a> statements.
          </p></li><li class="listitem"><p>
            Stop the server, install the new plugin library file in the
            plugin directory, and restart the server.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="uninstall-component"></a>13.7.4.5 UNINSTALL COMPONENT Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657079344"></a><a class="indexterm" name="idm140091657078256"></a><a class="indexterm" name="idm140091657077184"></a><pre data-lang="sql" class="programlisting">
UNINSTALL COMPONENT <em class="replaceable"><code>component_name</code></em> [, <em class="replaceable"><code>component_name</code></em> ] ...
</pre><p>
        This statement deactivates and uninstalls one or more server
        components. A component provides services that are available to
        the server and other components; see
        <a class="xref" href="server-administration.html#server-components" title="5.5 MySQL Server Components">Section 5.5, “MySQL Server Components”</a>.
        <a class="link" href="sql-syntax.html#uninstall-component" title="13.7.4.5 UNINSTALL COMPONENT Syntax"><code class="literal">UNINSTALL COMPONENT</code></a> is the
        complement of <a class="link" href="sql-syntax.html#install-component" title="13.7.4.3 INSTALL COMPONENT Syntax"><code class="literal">INSTALL COMPONENT</code></a>.
        It requires the <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege
        for the <code class="literal">mysql.component</code> system table.
      </p><p>
        Example:
      </p><pre data-lang="sql" class="programlisting">
UNINSTALL COMPONENT 'file://component1', 'file://component2';
</pre><p>
        For information about component naming, see
        <a class="xref" href="sql-syntax.html#install-component" title="13.7.4.3 INSTALL COMPONENT Syntax">Section 13.7.4.3, “INSTALL COMPONENT Syntax”</a>.
      </p><p>
        If any error occurs, the statement fails and has no effect. For
        example, this happens if a component name is erroneous, a named
        component is not installed, or cannot be uninstalled because
        other installed components depend on it.
      </p><p>
        A loader service handles component unloading, which includes
        removing uninstalled components from the
        <code class="literal">mysql.component</code> system table that serves as a
        registry. As a result, unloaded components are not loaded during
        the startup sequence for subsequent server restarts.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="uninstall-plugin"></a>13.7.4.6 UNINSTALL PLUGIN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657058736"></a><a class="indexterm" name="idm140091657057648"></a><a class="indexterm" name="idm140091657056576"></a><pre data-lang="sql" class="programlisting">
UNINSTALL PLUGIN <em class="replaceable"><code>plugin_name</code></em>
</pre><p>
        This statement removes an installed server plugin. It requires
        the <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege for the
        <code class="literal">mysql.plugin</code> system table.
        <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a> is the
        complement of <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a>.
      </p><p>
        <em class="replaceable"><code>plugin_name</code></em> must be the name of some
        plugin that is listed in the <code class="literal">mysql.plugin</code>
        table. The server executes the plugin's deinitialization
        function and removes the row for the plugin from the
        <code class="literal">mysql.plugin</code> system table, so that subsequent
        server restarts will not load and initialize the plugin.
        <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a> does not remove
        the plugin's shared library file.
      </p><p>
        You cannot uninstall a plugin if any table that uses it is open.
      </p><p>
        Plugin removal has implications for the use of associated
        tables. For example, if a full-text parser plugin is associated
        with a <code class="literal">FULLTEXT</code> index on the table,
        uninstalling the plugin makes the table unusable. Any attempt to
        access the table results in an error. The table cannot even be
        opened, so you cannot drop an index for which the plugin is
        used. This means that uninstalling a plugin is something to do
        with care unless you do not care about the table contents. If
        you are uninstalling a plugin with no intention of reinstalling
        it later and you care about the table contents, you should dump
        the table with <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a> and remove the
        <code class="literal">WITH PARSER</code> clause from the dumped
        <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement so that
        you can reload the table later. If you do not care about the
        table, <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> can be used
        even if any plugins associated with the table are missing.
      </p><p>
        For additional information about plugin loading, see
        <a class="xref" href="server-administration.html#plugin-loading" title="5.6.1 Installing and Uninstalling Plugins">Section 5.6.1, “Installing and Uninstalling Plugins”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="set-statement"></a>13.7.5 SET Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#set-variable">13.7.5.1 SET Syntax for Variable Assignment</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-character-set">13.7.5.2 SET CHARACTER SET Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-names">13.7.5.3 SET NAMES Syntax</a></span></dt></dl>
</div>
<p>
      The <a class="link" href="sql-syntax.html#set-statement" title="13.7.5 SET Syntax"><code class="literal">SET</code></a>
      statement has several forms. Descriptions for those forms that are
      not associated with a specific server capability appear in
      subsections of this section:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET
          <em class="replaceable"><code>var_name</code></em> =
          <em class="replaceable"><code>value</code></em></code></a> enables you to
          assign values to variables that affect the operation of the
          server or clients. See <a class="xref" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment">Section 13.7.5.1, “SET Syntax for Variable Assignment”</a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#set-character-set" title="13.7.5.2 SET CHARACTER SET Syntax"><code class="literal">SET CHARACTER SET</code></a> and
          <a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES Syntax"><code class="literal">SET NAMES</code></a> assign values to
          character set and collation variables associated with the
          current connection to the server. See
          <a class="xref" href="sql-syntax.html#set-character-set" title="13.7.5.2 SET CHARACTER SET Syntax">Section 13.7.5.2, “SET CHARACTER SET Syntax”</a>, and
          <a class="xref" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES Syntax">Section 13.7.5.3, “SET NAMES Syntax”</a>.
</p></li></ul>
</div>
<p>
      Descriptions for the other forms appear elsewhere, grouped with
      other statements related to the capability they help implement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax"><code class="literal">SET DEFAULT ROLE</code></a> and
          <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE</code></a> set the default role
          and current role for user accounts. See
          <a class="xref" href="sql-syntax.html#set-default-role" title="13.7.1.9 SET DEFAULT ROLE Syntax">Section 13.7.1.9, “SET DEFAULT ROLE Syntax”</a>, and
          <a class="xref" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax">Section 13.7.1.11, “SET ROLE Syntax”</a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> assigns account
          passwords. See <a class="xref" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD Syntax">Section 13.7.1.10, “SET PASSWORD Syntax”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">SET RESOURCE GROUP</code> assigns threads to a
          resource group. See <a class="xref" href="sql-syntax.html#set-resource-group" title="13.7.2.4 SET RESOURCE GROUP Syntax">Section 13.7.2.4, “SET RESOURCE GROUP Syntax”</a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax"><code class="literal">SET
          TRANSACTION ISOLATION LEVEL</code></a> sets the isolation level
          for transaction processing. See
          <a class="xref" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION Syntax">Section 13.3.7, “SET TRANSACTION Syntax”</a>.
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-variable"></a>13.7.5.1 SET Syntax for Variable Assignment</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091657007264"></a><a class="indexterm" name="idm140091657005808"></a><a class="indexterm" name="idm140091657004320"></a><a class="indexterm" name="idm140091657002832"></a><a class="indexterm" name="idm140091657001344"></a><a class="indexterm" name="idm140091656999856"></a><a class="indexterm" name="idm140091656998768"></a><pre data-lang="sql" class="programlisting">
SET <em class="replaceable"><code>variable</code></em> = <em class="replaceable"><code>expr</code></em> [, <em class="replaceable"><code>variable</code></em> = <em class="replaceable"><code>expr</code></em>] ...

<em class="replaceable"><code>variable</code></em>: {
    <em class="replaceable"><code>user_var_name</code></em>
  | <em class="replaceable"><code>param_name</code></em>
  | <em class="replaceable"><code>local_var_name</code></em>
  | {GLOBAL | @@GLOBAL.} <em class="replaceable"><code>system_var_name</code></em>
  | {PERSIST | @@PERSIST.} <em class="replaceable"><code>system_var_name</code></em>
  | {PERSIST_ONLY | @@PERSIST_ONLY.} <em class="replaceable"><code>system_var_name</code></em>
  | [SESSION | @@SESSION. | @@] <em class="replaceable"><code>system_var_name</code></em>
}
</pre><p>
        <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
        syntax for variable assignment enables you to assign values to
        different types of variables that affect the operation of the
        server or clients:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            User-defined variables. See
            <a class="xref" href="language-structure.html#user-variables" title="9.4 User-Defined Variables">Section 9.4, “User-Defined Variables”</a>.
          </p></li><li class="listitem"><p>
            Stored procedure and function parameters, and stored program
            local variables. See
            <a class="xref" href="sql-syntax.html#stored-program-variables" title="13.6.4 Variables in Stored Programs">Section 13.6.4, “Variables in Stored Programs”</a>.
          </p></li><li class="listitem"><p>
            System variables. See
            <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>. System variables
            also can be set at server startup, as described in
            <a class="xref" href="server-administration.html#using-system-variables" title="5.1.9 Using System Variables">Section 5.1.9, “Using System Variables”</a>.
</p></li></ul>
</div>
<p>
        A <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
        statement that assigns variable values is not written to the
        binary log, so in replication scenarios it affects only the host
        on which you execute it. To affect all replication hosts,
        execute the statement on each host.
      </p><p>
        The following sections describe
        <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
        syntax for setting variables. They use the
        <a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a>
        assignment operator, but the
        <a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a>
        assignment operator is also permitted for this purpose.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#set-variable-user-variables" title="User-Defined Variable Assignment">User-Defined Variable Assignment</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#set-variable-parameters-local-variables" title="Parameter and Local Variable Assignment">Parameter and Local Variable Assignment</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#set-variable-system-variables" title="System Variable Assignment">System Variable Assignment</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#set-variable-error-handling" title="SET Error Handling">SET Error Handling</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#set-variable-multiple-assignments" title="Multiple Variable Assignment">Multiple Variable Assignment</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#variable-references-in-expressions" title="System Variable References in Expressions">System Variable References in Expressions</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="set-variable-user-variables"></a>User-Defined Variable Assignment</h5>

</div>

</div>

</div>
<p>
          User-defined variables are created locally within a session
          and exist only within the context of that session; see
          <a class="xref" href="language-structure.html#user-variables" title="9.4 User-Defined Variables">Section 9.4, “User-Defined Variables”</a>.
        </p><p>
          A user-defined variable is written as
          <code class="literal">@<em class="replaceable"><code>var_name</code></em></code> and is
          assigned an expression value as follows:
        </p><pre data-lang="sql" class="programlisting">
SET @<em class="replaceable"><code>var_name</code></em> = <em class="replaceable"><code>expr</code></em>;
</pre><p>
          Examples:
        </p><pre data-lang="sql" class="programlisting">
SET @name = 43;
SET @total_tax = (SELECT SUM(tax) FROM taxable_transactions);
</pre><p>
          As demonstrated by those statements,
          <em class="replaceable"><code>expr</code></em> can range from simple (a
          literal value) to more complex (the value returned by a scalar
          subquery).
        </p><p>
          The Performance Schema
          <a class="link" href="performance-schema.html#performance-schema-user-variable-tables" title="26.12.10 Performance Schema User-Defined Variable Tables"><code class="literal">user_variables_by_thread</code></a> table
          contains information about user-defined variables. See
          <a class="xref" href="performance-schema.html#performance-schema-user-variable-tables" title="26.12.10 Performance Schema User-Defined Variable Tables">Section 26.12.10, “Performance Schema User-Defined Variable Tables”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="set-variable-parameters-local-variables"></a>Parameter and Local Variable Assignment</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          applies to parameters and local variables in the context of
          the stored object within which they are defined. The following
          procedure uses the <code class="literal">increment</code> procedure
          parameter and <code class="literal">counter</code> local variable:
        </p><pre data-lang="sql" class="programlisting">
CREATE PROCEDURE p(increment INT)
BEGIN
  DECLARE counter INT DEFAULT 0;
  WHILE counter &lt; 10 DO
    -- ... do work ...
    SET counter = counter + increment;
  END WHILE;
END;
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="set-variable-system-variables"></a>System Variable Assignment</h5>

</div>

</div>

</div>
<p>
          The MySQL server maintains system variables that configure its
          operation. A system variable can have a global value that
          affects server operation as a whole, a session value that
          affects the current session, or both. Many system variables
          are dynamic and can be changed at runtime using the
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          statement to affect operation of the current server instance.
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          can also be used to persist certain system variables to the
          <code class="filename">mysqld-auto.cnf</code> file in the data
          directory, to affect server operation for subsequent startups.
        </p><p>
          If you change a session system variable, the value remains in
          effect within your session until you change the variable to a
          different value or the session ends. The change has no effect
          on other sessions.
        </p><p>
          If you change a global system variable, the value is
          remembered and used to initialize the session value for new
          sessions until you change the variable to a different value or
          the server exits. The change is visible to any client that
          accesses the global value. However, the change affects the
          corresponding session value only for clients that connect
          after the change. The global variable change does not affect
          the session value for any current client sessions (not even
          the session within which the global value change occurs).
        </p><p>
          To make a global system variable setting permanent so that it
          applies across server restarts, you can persist it to the
          <code class="filename">mysqld-auto.cnf</code> file in the data
          directory. It is also possible to make persistent
          configuration changes by manually modifying a
          <code class="filename">my.cnf</code> option file, but that is more
          cumbersome, and an error in a manually entered setting might
          not be discovered until much later.
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          statements that persist system variables are more convenient
          and avoid the possibility of malformed settings because
          settings with syntax errors do not succeed and do not change
          server configuration. For more information about persisting
          system variables and the <code class="filename">mysqld-auto.cnf</code>
          file, see <a class="xref" href="server-administration.html#persisted-system-variables" title="5.1.9.3 Persisted System Variables">Section 5.1.9.3, “Persisted System Variables”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Setting or persisting a global system variable value always
            requires special privileges. Setting a session system
            variable value normally requires no special privileges and
            can be done by any user, although there are exceptions. For
            more information, see
            <a class="xref" href="server-administration.html#system-variable-privileges" title="5.1.9.1 System Variable Privileges">Section 5.1.9.1, “System Variable Privileges”</a>.
</p>
</div>
<p>
          The following discussion describes the syntax options for
          setting and persisting system variables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              To assign a value to a global system variable, precede the
              variable name by the <code class="literal">GLOBAL</code> keyword or
              the <code class="literal">@@GLOBAL.</code> qualifier:
            </p><pre data-lang="sql" class="programlisting">
SET GLOBAL max_connections = 1000;
SET @@GLOBAL.max_connections = 1000;
</pre></li><li class="listitem"><p>
              To assign a value to a session system variable, precede
              the variable name by the <code class="literal">SESSION</code> or
              <code class="literal">LOCAL</code> keyword, by the
              <code class="literal">@@SESSION.</code>,
              <code class="literal">@@LOCAL.</code>, or <code class="literal">@@</code>
              qualifier, or by no keyword or no modifier at all:
            </p><pre data-lang="sql" class="programlisting">
SET SESSION sql_mode = 'TRADITIONAL';
SET LOCAL sql_mode = 'TRADITIONAL';
SET @@SESSION.sql_mode = 'TRADITIONAL';
SET @@LOCAL.sql_mode = 'TRADITIONAL';
SET @@sql_mode = 'TRADITIONAL';
SET sql_mode = 'TRADITIONAL';
</pre><p>
              A client can change its own session variables, but not
              those of any other client.
            </p></li><li class="listitem"><p>
              To persist a global system variable to the
              <code class="filename">mysqld-auto.cnf</code> option file in the
              data directory, precede the variable name by the
              <code class="literal">PERSIST</code> keyword or the
              <code class="literal">@@PERSIST.</code> qualifier:
            </p><pre data-lang="sql" class="programlisting">
SET PERSIST max_connections = 1000;
SET @@PERSIST.max_connections = 1000;
</pre><p>
              This
              <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
              syntax enables you to make configuration changes at
              runtime that also persist across server restarts. Like
              <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET
              GLOBAL</code></a>,
              <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET
              PERSIST</code></a> sets the global variable runtime value,
              but also writes the variable setting to the
              <code class="filename">mysqld-auto.cnf</code> file (replacing any
              existing variable setting if there is one).
            </p></li><li class="listitem"><p>
              To persist a global system variable to the
              <code class="filename">mysqld-auto.cnf</code> file without setting
              the global variable runtime value, precede the variable
              name by the <code class="literal">PERSIST_ONLY</code> keyword or the
              <code class="literal">@@PERSIST_ONLY.</code> qualifier:
            </p><pre data-lang="sql" class="programlisting">
SET PERSIST_ONLY back_log = 100;
SET @@PERSIST_ONLY.back_log = 100;
</pre><p>
              Like <code class="literal">PERSIST</code>,
              <code class="literal">PERSIST_ONLY</code> writes the variable
              setting to <code class="filename">mysqld-auto.cnf</code>. However,
              unlike <code class="literal">PERSIST</code>,
              <code class="literal">PERSIST_ONLY</code> does not modify the global
              variable runtime value. This makes
              <code class="literal">PERSIST_ONLY</code> suitable for configuring
              read-only system variables that can be set only at server
              startup.
</p></li></ul>
</div>
<p>
          To set a global system variable value to the compiled-in MySQL
          default value or a session system variable to the current
          corresponding global value, set the variable to the value
          <code class="literal">DEFAULT</code>. For example, the following two
          statements are identical in setting the session value of
          <a class="link" href="server-administration.html#sysvar_max_join_size"><code class="literal">max_join_size</code></a> to the current
          global value:
        </p><pre data-lang="sql" class="programlisting">
SET @@SESSION.max_join_size = DEFAULT;
SET @@SESSION.max_join_size = @@GLOBAL.max_join_size;
</pre><p>
          Using
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a> to
          persist a global system variable to a value of
          <code class="literal">DEFAULT</code> or to its literal default value
          assigns the variable its default value and adds a setting for
          the variable to <code class="filename">mysqld-auto.cnf</code>. To
          remove the variable from the file, use
          <a class="link" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax"><code class="literal">RESET PERSIST</code></a>.
        </p><p>
          Some system variables cannot be persisted or are
          persist-restricted. See
          <a class="xref" href="server-administration.html#nonpersistible-system-variables" title="5.1.9.4 Nonpersistible and Persist-Restricted System Variables">Section 5.1.9.4, “Nonpersistible and Persist-Restricted System Variables”</a>.
        </p><p>
          A system variable implemented by a plugin can be persisted if
          the plugin is installed when the
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          statement is executed. Assignment of the persisted plugin
          variable takes effect for subsequent server restarts if the
          plugin is still installed. If the plugin is no longer
          installed, the plugin variable will not exist when the server
          reads the <code class="filename">mysqld-auto.cnf</code> file. In this
          case, the server writes a warning to the error log and
          continues:
        </p><pre data-lang="simple" class="programlisting">
currently unknown variable '<em class="replaceable"><code>var_name</code></em>'
was read from the persisted config file
</pre><p>
          To display system variable names and values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Use the <a class="link" href="sql-syntax.html#show-variables" title="13.7.6.39 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a>
              statement; see <a class="xref" href="sql-syntax.html#show-variables" title="13.7.6.39 SHOW VARIABLES Syntax">Section 13.7.6.39, “SHOW VARIABLES Syntax”</a>.
            </p></li><li class="listitem"><p>
              Several Performance Schema tables provide system variable
              information. See
              <a class="xref" href="performance-schema.html#performance-schema-system-variable-tables" title="26.12.13 Performance Schema System Variable Tables">Section 26.12.13, “Performance Schema System Variable Tables”</a>.
            </p></li><li class="listitem"><p>
              The Performance Schema
              <a class="link" href="performance-schema.html#variables-info-table" title="26.12.13.2 Performance Schema variables_info Table"><code class="literal">variables_info</code></a> table contains
              information showing when and by which user each system
              variable was most recently set. See
              <a class="xref" href="performance-schema.html#variables-info-table" title="26.12.13.2 Performance Schema variables_info Table">Section 26.12.13.2, “Performance Schema variables_info Table”</a>.
            </p></li><li class="listitem"><p>
              The Performance Schema
              <a class="link" href="performance-schema.html#persisted-variables-table" title="26.12.13.1 Performance Schema persisted_variables Table"><code class="literal">persisted_variables</code></a> table
              provides an SQL interface to the
              <code class="filename">mysqld-auto.cnf</code> file, enabling its
              contents to be inspected at runtime using
              <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statements. See
              <a class="xref" href="performance-schema.html#persisted-variables-table" title="26.12.13.1 Performance Schema persisted_variables Table">Section 26.12.13.1, “Performance Schema persisted_variables Table”</a>.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="set-variable-error-handling"></a>SET Error Handling</h5>

</div>

</div>

</div>
<p>
          If any variable assignment in a
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          statement fails, the entire statement fails and no variables
          are changed, nor is the <code class="filename">mysqld-auto.cnf</code>
          file changed.
        </p><p>
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          produces an error under the circumstances described here. Most
          of the examples show
          <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          statements that use keyword syntax (for example,
          <code class="literal">GLOBAL</code> or <code class="literal">SESSION</code>), but
          the principles are also true for statements that use the
          corresponding modifiers (for example,
          <code class="literal">@@GLOBAL.</code> or
          <code class="literal">@@SESSION.</code>).
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Use of
              <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
              (any variant) to set a read-only variable:
            </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET GLOBAL version = 'abc';</code></strong>
ERROR 1238 (HY000): Variable 'version' is a read only variable
</pre></li><li class="listitem"><p>
              Use of <code class="literal">GLOBAL</code>,
              <code class="literal">PERSIST</code>, or
              <code class="literal">PERSIST_ONLY</code> to set a variable that has
              only a session value:
            </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET GLOBAL sql_log_bin = ON;</code></strong>
ERROR 1228 (HY000): Variable 'sql_log_bin' is a SESSION
variable and can't be used with SET GLOBAL
</pre></li><li class="listitem"><p>
              Use of <code class="literal">SESSION</code> to set a variable that
              has only a global value:
            </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET SESSION max_connections = 1000;</code></strong>
ERROR 1229 (HY000): Variable 'max_connections' is a
GLOBAL variable and should be set with SET GLOBAL
</pre></li><li class="listitem"><p>
              Omission of <code class="literal">GLOBAL</code>,
              <code class="literal">PERSIST</code>, or
              <code class="literal">PERSIST_ONLY</code> to set a variable that has
              only a global value:
            </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET max_connections = 1000;</code></strong>
ERROR 1229 (HY000): Variable 'max_connections' is a
GLOBAL variable and should be set with SET GLOBAL
</pre></li><li class="listitem"><p>
              Use of <code class="literal">PERSIST</code> or
              <code class="literal">PERSIST_ONLY</code> to set a variable that
              cannot be persisted:
            </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET PERSIST port = 3307;</code></strong>
ERROR 1238 (HY000): Variable 'port' is a read only variable
mysql&gt; <strong class="userinput"><code>SET PERSIST_ONLY port = 3307;</code></strong>
ERROR 1238 (HY000): Variable 'port' is a non persistent read only variable
</pre></li><li class="listitem"><p>
              The <code class="literal">@@GLOBAL.</code>,
              <code class="literal">@@PERSIST.</code>,
              <code class="literal">@@PERSIST_ONLY.</code>,
              <code class="literal">@@SESSION.</code>, and <code class="literal">@@</code>
              modifiers apply only to system variables. An error occurs
              for attempts to apply them to user-defined variables,
              stored procedure or function parameters, or stored program
              local variables.
            </p></li><li class="listitem"><p>
              Not all system variables can be set to
              <code class="literal">DEFAULT</code>. In such cases, assigning
              <code class="literal">DEFAULT</code> results in an error.
            </p></li><li class="listitem"><p>
              An error occurs for attempts to assign
              <code class="literal">DEFAULT</code> to user-defined variables,
              stored procedure or function parameters, or stored program
              local variables.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="set-variable-multiple-assignments"></a>Multiple Variable Assignment</h5>

</div>

</div>

</div>
<p>
          A <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
          statement can contain multiple variable assignments, separated
          by commas. This statement assigns values to a user-defined
          variable and a system variable:
        </p><pre data-lang="sql" class="programlisting">
SET @x = 1, SESSION sql_mode = '';
</pre><p>
          If you set multiple system variables in a single statement,
          the most recent <code class="literal">GLOBAL</code>,
          <code class="literal">PERSIST</code>, <code class="literal">PERSIST_ONLY</code>,
          or <code class="literal">SESSION</code> keyword in the statement is used
          for following assignments that have no keyword specified.
        </p><p>
          Examples of multiple-variable assignment:
        </p><pre data-lang="sql" class="programlisting">
SET GLOBAL sort_buffer_size = 1000000, SESSION sort_buffer_size = 1000000;
SET @@GLOBAL.sort_buffer_size = 1000000, @@LOCAL.sort_buffer_size = 1000000;
SET GLOBAL max_connections = 1000, sort_buffer_size = 1000000;
</pre><p>
          The <code class="literal">@@GLOBAL.</code>,
          <code class="literal">@@PERSIST.</code>,
          <code class="literal">@@PERSIST_ONLY.</code>,
          <code class="literal">@@SESSION.</code>, and <code class="literal">@@</code>
          modifiers apply only to the immediately following system
          variable, not any remaining system variables. This statement
          sets the <a class="link" href="server-administration.html#sysvar_sort_buffer_size"><code class="literal">sort_buffer_size</code></a>
          global value to 50000 and the session value to 1000000:
        </p><pre data-lang="sql" class="programlisting">
SET @@GLOBAL.sort_buffer_size = 50000, sort_buffer_size = 1000000;
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="variable-references-in-expressions"></a>System Variable References in Expressions</h5>

</div>

</div>

</div>
<p>
          To refer to the value of a system variable in expressions, use
          one of the <code class="literal">@@</code>-modifiers (except
          <code class="literal">@@PERSIST.</code> and
          <code class="literal">@@PERSIST_ONLY.</code>, which are not permitted in
          expressions). For example, you can retrieve system variable
          values in a <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement
          like this:
        </p><pre data-lang="sql" class="programlisting">
SELECT @@GLOBAL.sql_mode, @@SESSION.sql_mode, @@sql_mode;
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            A reference to a system variable in an expression as
            <code class="literal">@@<em class="replaceable"><code>var_name</code></em></code>
            (with <code class="literal">@@</code> rather than
            <code class="literal">@@GLOBAL.</code> or
            <code class="literal">@@SESSION.</code>) returns the session value if
            it exists and the global value otherwise. This differs from
            <code class="literal">SET @@<em class="replaceable"><code>var_name</code></em> =
            <em class="replaceable"><code>expr</code></em></code>, which always
            refers to the session value.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-character-set"></a>13.7.5.2 SET CHARACTER SET Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656812224"></a><a class="indexterm" name="idm140091656811168"></a><a class="indexterm" name="idm140091656810096"></a><a class="indexterm" name="idm140091656808608"></a><pre data-lang="sql" class="programlisting">
SET {CHARACTER SET | CHARSET}
    {'<em class="replaceable"><code>charset_name</code></em>' | DEFAULT}
</pre><p>
        This statement maps all strings sent between the server and the
        current client with the given mapping. <code class="literal">SET CHARACTER
        SET</code> sets three session system variables:
        <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> and
        <a class="link" href="server-administration.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a> are set
        to the given character set, and
        <a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a> to the
        value of
        <a class="link" href="server-administration.html#sysvar_character_set_database"><code class="literal">character_set_database</code></a>. See
        <a class="xref" href="charset.html#charset-connection" title="10.4 Connection Character Sets and Collations">Section 10.4, “Connection Character Sets and Collations”</a>.
      </p><p>
        <em class="replaceable"><code>charset_name</code></em> may be quoted or
        unquoted.
      </p><p>
        The default character set mapping can be restored by using the
        value <code class="literal">DEFAULT</code>. The default depends on the
        server configuration.
      </p><p>
        Some character sets cannot be used as the client character set.
        Attempting to use them with <a class="link" href="sql-syntax.html#set-character-set" title="13.7.5.2 SET CHARACTER SET Syntax"><code class="literal">SET CHARACTER
        SET</code></a> produces an error. See
        <a class="xref" href="charset.html#charset-connection-impermissible-client-charset" title="Impermissible Client Character Sets">Impermissible Client Character Sets</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-names"></a>13.7.5.3 SET NAMES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656788144"></a><a class="indexterm" name="idm140091656787072"></a><pre data-lang="sql" class="programlisting">
SET NAMES {'<em class="replaceable"><code>charset_name</code></em>'
    [COLLATE '<em class="replaceable"><code>collation_name</code></em>'] | DEFAULT}
</pre><p>
        This statement sets the three session system variables
        <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a>,
        <a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a>, and
        <a class="link" href="server-administration.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a> to the
        given character set. Setting
        <a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a> to
        <code class="literal">charset_name</code> also sets
        <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> to the
        default collation for <code class="literal">charset_name</code>. See
        <a class="xref" href="charset.html#charset-connection" title="10.4 Connection Character Sets and Collations">Section 10.4, “Connection Character Sets and Collations”</a>.
      </p><p>
        The optional <code class="literal">COLLATE</code> clause may be used to
        specify a collation explicitly. If given, the collation must one
        of the permitted collations for
        <em class="replaceable"><code>charset_name</code></em>.
      </p><p>
        <em class="replaceable"><code>charset_name</code></em> and
        <em class="replaceable"><code>collation_name</code></em> may be quoted or
        unquoted.
      </p><p>
        The default mapping can be restored by using a value of
        <code class="literal">DEFAULT</code>. The default depends on the server
        configuration.
      </p><p>
        Some character sets cannot be used as the client character set.
        Attempting to use them with <a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES Syntax"><code class="literal">SET
        NAMES</code></a> produces an error. See
        <a class="xref" href="charset.html#charset-connection-impermissible-client-charset" title="Impermissible Client Character Sets">Impermissible Client Character Sets</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="show"></a>13.7.6 SHOW Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#show-binary-logs">13.7.6.1 SHOW BINARY LOGS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-binlog-events">13.7.6.2 SHOW BINLOG EVENTS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-character-set">13.7.6.3 SHOW CHARACTER SET Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-collation">13.7.6.4 SHOW COLLATION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-columns">13.7.6.5 SHOW COLUMNS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-database">13.7.6.6 SHOW CREATE DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-event">13.7.6.7 SHOW CREATE EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-function">13.7.6.8 SHOW CREATE FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-procedure">13.7.6.9 SHOW CREATE PROCEDURE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-table">13.7.6.10 SHOW CREATE TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-trigger">13.7.6.11 SHOW CREATE TRIGGER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-user">13.7.6.12 SHOW CREATE USER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-view">13.7.6.13 SHOW CREATE VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-databases">13.7.6.14 SHOW DATABASES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-engine">13.7.6.15 SHOW ENGINE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-engines">13.7.6.16 SHOW ENGINES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-errors">13.7.6.17 SHOW ERRORS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-events">13.7.6.18 SHOW EVENTS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-function-code">13.7.6.19 SHOW FUNCTION CODE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-function-status">13.7.6.20 SHOW FUNCTION STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-grants">13.7.6.21 SHOW GRANTS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-index">13.7.6.22 SHOW INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-master-status">13.7.6.23 SHOW MASTER STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-open-tables">13.7.6.24 SHOW OPEN TABLES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-plugins">13.7.6.25 SHOW PLUGINS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-privileges">13.7.6.26 SHOW PRIVILEGES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-procedure-code">13.7.6.27 SHOW PROCEDURE CODE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-procedure-status">13.7.6.28 SHOW PROCEDURE STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-processlist">13.7.6.29 SHOW PROCESSLIST Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-profile">13.7.6.30 SHOW PROFILE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-profiles">13.7.6.31 SHOW PROFILES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-relaylog-events">13.7.6.32 SHOW RELAYLOG EVENTS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-slave-hosts">13.7.6.33 SHOW SLAVE HOSTS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-slave-status">13.7.6.34 SHOW SLAVE STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-status">13.7.6.35 SHOW STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-table-status">13.7.6.36 SHOW TABLE STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-tables">13.7.6.37 SHOW TABLES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-triggers">13.7.6.38 SHOW TRIGGERS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-variables">13.7.6.39 SHOW VARIABLES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-warnings">13.7.6.40 SHOW WARNINGS Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091656762320"></a><a class="indexterm" name="idm140091656759504"></a><a class="indexterm" name="idm140091656758016"></a><a class="indexterm" name="idm140091656756928"></a><a class="indexterm" name="idm140091656755840"></a><a class="indexterm" name="idm140091656754752"></a><a class="indexterm" name="idm140091656753664"></a><a class="indexterm" name="idm140091656752592"></a><a class="indexterm" name="idm140091656751504"></a><a class="indexterm" name="idm140091656750416"></a><a class="indexterm" name="idm140091656749328"></a><a class="indexterm" name="idm140091656748240"></a><a class="indexterm" name="idm140091656747152"></a><a class="indexterm" name="idm140091656746064"></a><a class="indexterm" name="idm140091656744976"></a><a class="indexterm" name="idm140091656743888"></a><a class="indexterm" name="idm140091656742800"></a><a class="indexterm" name="idm140091656741728"></a><a class="indexterm" name="idm140091656740656"></a><a class="indexterm" name="idm140091656739584"></a><a class="indexterm" name="idm140091656738512"></a><a class="indexterm" name="idm140091656737440"></a><a class="indexterm" name="idm140091656736352"></a><a class="indexterm" name="idm140091656735264"></a><a class="indexterm" name="idm140091656734192"></a><a class="indexterm" name="idm140091656733120"></a><a class="indexterm" name="idm140091656732048"></a><a class="indexterm" name="idm140091656730960"></a><a class="indexterm" name="idm140091656729872"></a><a class="indexterm" name="idm140091656728784"></a><a class="indexterm" name="idm140091656727712"></a><a class="indexterm" name="idm140091656726624"></a><a class="indexterm" name="idm140091656725536"></a><a class="indexterm" name="idm140091656724448"></a><a class="indexterm" name="idm140091656723360"></a><a class="indexterm" name="idm140091656722288"></a><a class="indexterm" name="idm140091656721216"></a><a class="indexterm" name="idm140091656720128"></a><a class="indexterm" name="idm140091656719040"></a><a class="indexterm" name="idm140091656717952"></a><a class="indexterm" name="idm140091656716880"></a><a class="indexterm" name="idm140091656715808"></a><a class="indexterm" name="idm140091656714720"></a><a class="indexterm" name="idm140091656713648"></a><a class="indexterm" name="idm140091656712560"></a><p>
      <a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax"><code class="literal">SHOW</code></a> has many forms that provide
      information about databases, tables, columns, or status
      information about the server. This section describes those
      following:
    </p><pre data-lang="sql" class="programlisting">
SHOW {BINARY | MASTER} LOGS
SHOW BINLOG EVENTS [IN '<em class="replaceable"><code>log_name</code></em>'] [FROM <em class="replaceable"><code>pos</code></em>] [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
SHOW CHARACTER SET [<em class="replaceable"><code>like_or_where</code></em>]
SHOW COLLATION [<em class="replaceable"><code>like_or_where</code></em>]
SHOW [FULL] COLUMNS FROM <em class="replaceable"><code>tbl_name</code></em> [FROM <em class="replaceable"><code>db_name</code></em>] [<em class="replaceable"><code>like_or_where</code></em>]
SHOW CREATE DATABASE <em class="replaceable"><code>db_name</code></em>
SHOW CREATE EVENT <em class="replaceable"><code>event_name</code></em>
SHOW CREATE FUNCTION <em class="replaceable"><code>func_name</code></em>
SHOW CREATE PROCEDURE <em class="replaceable"><code>proc_name</code></em>
SHOW CREATE TABLE <em class="replaceable"><code>tbl_name</code></em>
SHOW CREATE TRIGGER <em class="replaceable"><code>trigger_name</code></em>
SHOW CREATE VIEW <em class="replaceable"><code>view_name</code></em>
SHOW DATABASES [<em class="replaceable"><code>like_or_where</code></em>]
SHOW ENGINE <em class="replaceable"><code>engine_name</code></em> {STATUS | MUTEX}
SHOW [STORAGE] ENGINES
SHOW ERRORS [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
SHOW EVENTS
SHOW FUNCTION CODE <em class="replaceable"><code>func_name</code></em>
SHOW FUNCTION STATUS [<em class="replaceable"><code>like_or_where</code></em>]
SHOW GRANTS FOR <em class="replaceable"><code>user</code></em>
SHOW INDEX FROM <em class="replaceable"><code>tbl_name</code></em> [FROM <em class="replaceable"><code>db_name</code></em>]
SHOW MASTER STATUS
SHOW OPEN TABLES [FROM <em class="replaceable"><code>db_name</code></em>] [<em class="replaceable"><code>like_or_where</code></em>]
SHOW PLUGINS
SHOW PROCEDURE CODE <em class="replaceable"><code>proc_name</code></em>
SHOW PROCEDURE STATUS [<em class="replaceable"><code>like_or_where</code></em>]
SHOW PRIVILEGES
SHOW [FULL] PROCESSLIST
SHOW PROFILE [<em class="replaceable"><code>types</code></em>] [FOR QUERY <em class="replaceable"><code>n</code></em>] [OFFSET <em class="replaceable"><code>n</code></em>] [LIMIT <em class="replaceable"><code>n</code></em>]
SHOW PROFILES
SHOW RELAYLOG EVENTS [IN '<em class="replaceable"><code>log_name</code></em>'] [FROM <em class="replaceable"><code>pos</code></em>] [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
SHOW SLAVE HOSTS
SHOW SLAVE STATUS [FOR CHANNEL <em class="replaceable"><code>channel</code></em>]
SHOW [GLOBAL | SESSION] STATUS [<em class="replaceable"><code>like_or_where</code></em>]
SHOW TABLE STATUS [FROM <em class="replaceable"><code>db_name</code></em>] [<em class="replaceable"><code>like_or_where</code></em>]
SHOW [FULL] TABLES [FROM <em class="replaceable"><code>db_name</code></em>] [<em class="replaceable"><code>like_or_where</code></em>]
SHOW TRIGGERS [FROM <em class="replaceable"><code>db_name</code></em>] [<em class="replaceable"><code>like_or_where</code></em>]
SHOW [GLOBAL | SESSION] VARIABLES [<em class="replaceable"><code>like_or_where</code></em>]
SHOW WARNINGS [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]

<em class="replaceable"><code>like_or_where</code></em>:
    LIKE '<em class="replaceable"><code>pattern</code></em>'
  | WHERE <em class="replaceable"><code>expr</code></em>
</pre><p>
      If the syntax for a given <a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax"><code class="literal">SHOW</code></a>
      statement includes a <a class="link" href="functions.html#operator_like"><code class="literal">LIKE
      '<em class="replaceable"><code>pattern</code></em>'</code></a> part,
      <code class="literal">'<em class="replaceable"><code>pattern</code></em>'</code> is a
      string that can contain the SQL <code class="literal">%</code> and
      <code class="literal">_</code> wildcard characters. The pattern is useful
      for restricting statement output to matching values.
    </p><p>
      Several <a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax"><code class="literal">SHOW</code></a> statements also accept
      a <code class="literal">WHERE</code> clause that provides more flexibility
      in specifying which rows to display. See
      <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
    </p><p>
      Many MySQL APIs (such as PHP) enable you to treat the result
      returned from a <a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax"><code class="literal">SHOW</code></a> statement as
      you would a result set from a
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>; see
      <a class="xref" href="connectors-apis.html" title="Chapter 28 Connectors and APIs">Chapter 28, <i>Connectors and APIs</i></a>, or your API documentation for
      more information. In addition, you can work in SQL with results
      from queries on tables in the
      <code class="literal">INFORMATION_SCHEMA</code> database, which you cannot
      easily do with results from <a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax"><code class="literal">SHOW</code></a>
      statements. See <a class="xref" href="information-schema.html" title="Chapter 25 INFORMATION_SCHEMA Tables">Chapter 25, <i>INFORMATION_SCHEMA Tables</i></a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-binary-logs"></a>13.7.6.1 SHOW BINARY LOGS Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091656666416"></a><a class="indexterm" name="idm140091656665328"></a><pre data-lang="sql" class="programlisting">
SHOW BINARY LOGS
SHOW MASTER LOGS
</pre><p>
        Lists the binary log files on the server. This statement is used
        as part of the procedure described in
        <a class="xref" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax">Section 13.4.1.1, “PURGE BINARY LOGS Syntax”</a>, that shows how to determine
        which logs can be purged. <a class="link" href="sql-syntax.html#show-binary-logs" title="13.7.6.1 SHOW BINARY LOGS Syntax"><code class="literal">SHOW BINARY
        LOGS</code></a> requires the <a class="link" href="security.html#priv_replication-client"><code class="literal">REPLICATION
        CLIENT</code></a> or <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
        privilege.
      </p><p>
        Encrypted binary log files have a 512-byte file header that
        stores information required for encryption and decryption of the
        file. This is included in the file size displayed by
        <a class="link" href="sql-syntax.html#show-binary-logs" title="13.7.6.1 SHOW BINARY LOGS Syntax"><code class="literal">SHOW BINARY LOGS</code></a>. The
        <code class="literal">Encrypted</code> column shows whether or not the
        binary log file is encrypted. Binary log encryption is active if
        <a class="link" href="replication.html#sysvar_binlog_encryption"><code class="literal">binlog_encryption=ON</code></a> is set for
        the server. Existing binary log files are not encrypted or
        decrypted if binary log encryption is activated or deactivated
        while the server is running.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW BINARY LOGS;</code></strong>
+---------------+-----------+-----------+
| Log_name      | File_size | Encrypted |
+---------------+-----------+-----------+
| binlog.000015 |    724935 |       Yes |
| binlog.000016 |    733481 |       Yes |
+---------------+-----------+-----------+
</pre><p>
        <a class="link" href="sql-syntax.html#show-binary-logs" title="13.7.6.1 SHOW BINARY LOGS Syntax"><code class="literal">SHOW MASTER
        LOGS</code></a> is equivalent to <a class="link" href="sql-syntax.html#show-binary-logs" title="13.7.6.1 SHOW BINARY LOGS Syntax"><code class="literal">SHOW BINARY
        LOGS</code></a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-binlog-events"></a>13.7.6.2 SHOW BINLOG EVENTS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656644272"></a><pre data-lang="sql" class="programlisting">
SHOW BINLOG EVENTS
   [IN '<em class="replaceable"><code>log_name</code></em>']
   [FROM <em class="replaceable"><code>pos</code></em>]
   [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
</pre><p>
        Shows the events in the binary log. If you do not specify
        <code class="literal">'<em class="replaceable"><code>log_name</code></em>'</code>, the
        first binary log is displayed. <code class="literal">SHOW BINLOG
        EVENTS</code> requires the <a class="link" href="security.html#priv_replication-slave"><code class="literal">REPLICATION
        SLAVE</code></a> privilege.
      </p><p>
        The <code class="literal">LIMIT</code> clause has the same syntax as for
        the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement. See
        <a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax">Section 13.2.10, “SELECT Syntax”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Issuing a <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.6.2 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a>
          with no <code class="literal">LIMIT</code> clause could start a very
          time- and resource-consuming process because the server
          returns to the client the complete contents of the binary log
          (which includes all statements executed by the server that
          modify data). As an alternative to <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.6.2 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW
          BINLOG EVENTS</code></a>, use the
          <a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files"><span class="command"><strong>mysqlbinlog</strong></span></a> utility to save the binary log
          to a text file for later examination and analysis. See
          <a class="xref" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files">Section 4.6.8, “<span class="command"><strong>mysqlbinlog</strong></span> — Utility for Processing Binary Log Files”</a>.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.6.2 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a> displays the
        following fields for each event in the binary log:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Log_name</code>
          </p><p>
            The name of the file that is being listed.
          </p></li><li class="listitem"><p>
            <code class="literal">Pos</code>
          </p><p>
            The position at which the event occurs.
          </p></li><li class="listitem"><p>
            <code class="literal">Event_type</code>
          </p><p>
            An identifier that describes the event type.
          </p></li><li class="listitem"><p>
            <code class="literal">Server_id</code>
          </p><p>
            The server ID of the server on which the event originated.
          </p></li><li class="listitem"><p>
            <code class="literal">End_log_pos</code>
          </p><p>
            The position at which the next event begins, which is equal
            to <code class="literal">Pos</code> plus the size of the event.
          </p></li><li class="listitem"><p>
            <code class="literal">Info</code>
          </p><p>
            More detailed information about the event type. The format
            of this information depends on the event type.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          Some events relating to the setting of user and system
          variables are not included in the output from
          <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.6.2 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a>. To get
          complete coverage of events within a binary log, use
          <a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files"><span class="command"><strong>mysqlbinlog</strong></span></a>.
</p>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.6.2 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a> does
          <span class="emphasis"><em>not</em></span> work with relay log files. You can
          use <a class="link" href="sql-syntax.html#show-relaylog-events" title="13.7.6.32 SHOW RELAYLOG EVENTS Syntax"><code class="literal">SHOW RELAYLOG EVENTS</code></a> for
          this purpose.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-character-set"></a>13.7.6.3 SHOW CHARACTER SET Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656601680"></a><pre data-lang="sql" class="programlisting">
SHOW CHARACTER SET
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        The <a class="link" href="sql-syntax.html#show-character-set" title="13.7.6.3 SHOW CHARACTER SET Syntax"><code class="literal">SHOW CHARACTER SET</code></a> statement
        shows all available character sets. The
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which character set names to match. The <code class="literal">WHERE</code>
        clause can be given to select rows using more general
        conditions, as discussed in <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>. For
        example:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CHARACTER SET LIKE 'latin%';</code></strong>
+---------+-----------------------------+-------------------+--------+
| Charset | Description                 | Default collation | Maxlen |
+---------+-----------------------------+-------------------+--------+
| latin1  | cp1252 West European        | latin1_swedish_ci |      1 |
| latin2  | ISO 8859-2 Central European | latin2_general_ci |      1 |
| latin5  | ISO 8859-9 Turkish          | latin5_turkish_ci |      1 |
| latin7  | ISO 8859-13 Baltic          | latin7_general_ci |      1 |
+---------+-----------------------------+-------------------+--------+
</pre><p>
        <a class="link" href="sql-syntax.html#show-character-set" title="13.7.6.3 SHOW CHARACTER SET Syntax"><code class="literal">SHOW CHARACTER SET</code></a> output has
        these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Charset</code>
          </p><p>
            The character set name.
          </p></li><li class="listitem"><p>
            <code class="literal">Description</code>
          </p><p>
            A description of the character set.
          </p></li><li class="listitem"><p>
            <code class="literal">Default collation</code>
          </p><p>
            The default collation for the character set.
          </p></li><li class="listitem"><p>
            <code class="literal">Maxlen</code>
          </p><p>
            The maximum number of bytes required to store one character.
</p></li></ul>
</div>
<p>
        The <code class="literal">filename</code> character set is for internal
        use only; consequently, <a class="link" href="sql-syntax.html#show-character-set" title="13.7.6.3 SHOW CHARACTER SET Syntax"><code class="literal">SHOW CHARACTER
        SET</code></a> does not display it.
      </p><p>
        Character set information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#character-sets-table" title="25.2 The INFORMATION_SCHEMA CHARACTER_SETS Table"><code class="literal">CHARACTER_SETS</code></a> table. See
        <a class="xref" href="information-schema.html#character-sets-table" title="25.2 The INFORMATION_SCHEMA CHARACTER_SETS Table">Section 25.2, “The INFORMATION_SCHEMA CHARACTER_SETS Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-collation"></a>13.7.6.4 SHOW COLLATION Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656572576"></a><pre data-lang="sql" class="programlisting">
SHOW COLLATION
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        This statement lists collations supported by the server. By
        default, the output from <a class="link" href="sql-syntax.html#show-collation" title="13.7.6.4 SHOW COLLATION Syntax"><code class="literal">SHOW
        COLLATION</code></a> includes all available collations. The
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which collation names to match. The <code class="literal">WHERE</code>
        clause can be given to select rows using more general
        conditions, as discussed in <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>. For
        example:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW COLLATION WHERE Charset = 'latin1';</code></strong>
+-------------------+---------+----+---------+----------+---------+
| Collation         | Charset | Id | Default | Compiled | Sortlen |
+-------------------+---------+----+---------+----------+---------+
| latin1_german1_ci | latin1  |  5 |         | Yes      |       1 |
| latin1_swedish_ci | latin1  |  8 | Yes     | Yes      |       1 |
| latin1_danish_ci  | latin1  | 15 |         | Yes      |       1 |
| latin1_german2_ci | latin1  | 31 |         | Yes      |       2 |
| latin1_bin        | latin1  | 47 |         | Yes      |       1 |
| latin1_general_ci | latin1  | 48 |         | Yes      |       1 |
| latin1_general_cs | latin1  | 49 |         | Yes      |       1 |
| latin1_spanish_ci | latin1  | 94 |         | Yes      |       1 |
+-------------------+---------+----+---------+----------+---------+
</pre><p>
        <a class="link" href="sql-syntax.html#show-collation" title="13.7.6.4 SHOW COLLATION Syntax"><code class="literal">SHOW COLLATION</code></a> output has these
        columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Collation</code>
          </p><p>
            The collation name.
          </p></li><li class="listitem"><p>
            <code class="literal">Charset</code>
          </p><p>
            The name of the character set with which the collation is
            associated.
          </p></li><li class="listitem"><p>
            <code class="literal">Id</code>
          </p><p>
            The collation ID.
          </p></li><li class="listitem"><p>
            <code class="literal">Default</code>
          </p><p>
            Whether the collation is the default for its character set.
          </p></li><li class="listitem"><p>
            <code class="literal">Compiled</code>
          </p><p>
            Whether the character set is compiled into the server.
          </p></li><li class="listitem"><p>
            <code class="literal">Sortlen</code>
          </p><p>
            This is related to the amount of memory required to sort
            strings expressed in the character set.
</p></li></ul>
</div>
<p>
        To see the default collation for each character set, use the
        following statement. <code class="literal">Default</code> is a reserved
        word, so to use it as an identifier, it must be quoted as such:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW COLLATION WHERE `Default` = 'Yes';</code></strong>
+---------------------+----------+----+---------+----------+---------+
| Collation           | Charset  | Id | Default | Compiled | Sortlen |
+---------------------+----------+----+---------+----------+---------+
| big5_chinese_ci     | big5     |  1 | Yes     | Yes      |       1 |
| dec8_swedish_ci     | dec8     |  3 | Yes     | Yes      |       1 |
| cp850_general_ci    | cp850    |  4 | Yes     | Yes      |       1 |
| hp8_english_ci      | hp8      |  6 | Yes     | Yes      |       1 |
| koi8r_general_ci    | koi8r    |  7 | Yes     | Yes      |       1 |
| latin1_swedish_ci   | latin1   |  8 | Yes     | Yes      |       1 |
...
</pre><p>
        Collation information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#collations-table" title="25.4 The INFORMATION_SCHEMA COLLATIONS Table"><code class="literal">COLLATIONS</code></a> table. See
        <a class="xref" href="information-schema.html#collations-table" title="25.4 The INFORMATION_SCHEMA COLLATIONS Table">Section 25.4, “The INFORMATION_SCHEMA COLLATIONS Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-columns"></a>13.7.6.5 SHOW COLUMNS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656537248"></a><a class="indexterm" name="idm140091656534432"></a><a class="indexterm" name="idm140091656533360"></a><pre data-lang="sql" class="programlisting">
SHOW [EXTENDED] [FULL] {COLUMNS | FIELDS}
    {FROM | IN} <em class="replaceable"><code>tbl_name</code></em>
    [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-columns" title="13.7.6.5 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a> displays information
        about the columns in a given table. It also works for views.
        <a class="link" href="sql-syntax.html#show-columns" title="13.7.6.5 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a> displays information
        only for those columns for which you have some privilege.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW COLUMNS FROM City;</code></strong>
+-------------+----------+------+-----+---------+----------------+
| Field       | Type     | Null | Key | Default | Extra          |
+-------------+----------+------+-----+---------+----------------+
| ID          | int(11)  | NO   | PRI | NULL    | auto_increment |
| Name        | char(35) | NO   |     |         |                |
| CountryCode | char(3)  | NO   | MUL |         |                |
| District    | char(20) | NO   |     |         |                |
| Population  | int(11)  | NO   |     | 0       |                |
+-------------+----------+------+-----+---------+----------------+
</pre><p>
        An alternative to <code class="literal"><em class="replaceable"><code>tbl_name</code></em>
        FROM <em class="replaceable"><code>db_name</code></em></code> syntax is
        <em class="replaceable"><code>db_name.tbl_name</code></em>. These two
        statements are equivalent:
      </p><pre data-lang="sql" class="programlisting">
SHOW COLUMNS FROM mytable FROM mydb;
SHOW COLUMNS FROM mydb.mytable;
</pre><p>
        The optional <code class="literal">EXTENDED</code> keyword causes the
        output to include information about hidden columns that MySQL
        uses internally and are not accessible by users.
      </p><p>
        The optional <code class="literal">FULL</code> keyword causes the output
        to include the column collation and comments, as well as the
        privileges you have for each column.
      </p><p>
        The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present,
        indicates which column names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><p>
        The data types may differ from what you expect them to be based
        on a <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement
        because MySQL sometimes changes data types when you create or
        alter a table. The conditions under which this occurs are
        described in <a class="xref" href="sql-syntax.html#silent-column-changes" title="13.1.20.8 Silent Column Specification Changes">Section 13.1.20.8, “Silent Column Specification Changes”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-columns" title="13.7.6.5 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a> displays the
        following values for each table column:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Field</code>
          </p><p>
            The name of the column.
          </p></li><li class="listitem"><p>
            <code class="literal">Type</code>
          </p><p>
            The column data type.
          </p></li><li class="listitem"><p>
            <code class="literal">Collation</code>
          </p><p>
            The collation for nonbinary string columns, or
            <code class="literal">NULL</code> for other columns. This value is
            displayed only if you use the <code class="literal">FULL</code>
            keyword.
          </p></li><li class="listitem"><p>
            <code class="literal">Null</code>
          </p><p>
            The column nullability. The value is <code class="literal">YES</code>
            if <code class="literal">NULL</code> values can be stored in the
            column, <code class="literal">NO</code> if not.
          </p></li><li class="listitem"><p>
            <code class="literal">Key</code>
          </p><p>
            Whether the column is indexed:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                If <code class="literal">Key</code> is empty, the column either is
                not indexed or is indexed only as a secondary column in
                a multiple-column, nonunique index.
              </p></li><li class="listitem"><p>
                If <code class="literal">Key</code> is <code class="literal">PRI</code>, the
                column is a <code class="literal">PRIMARY KEY</code> or is one of
                the columns in a multiple-column <code class="literal">PRIMARY
                KEY</code>.
              </p></li><li class="listitem"><p>
                If <code class="literal">Key</code> is <code class="literal">UNI</code>, the
                column is the first column of a
                <code class="literal">UNIQUE</code> index. (A
                <code class="literal">UNIQUE</code> index permits multiple
                <code class="literal">NULL</code> values, but you can tell whether
                the column permits <code class="literal">NULL</code> by checking
                the <code class="literal">Null</code> field.)
              </p></li><li class="listitem"><p>
                If <code class="literal">Key</code> is <code class="literal">MUL</code>, the
                column is the first column of a nonunique index in which
                multiple occurrences of a given value are permitted
                within the column.
</p></li></ul>
</div>
<p>
            If more than one of the <code class="literal">Key</code> values
            applies to a given column of a table, <code class="literal">Key</code>
            displays the one with the highest priority, in the order
            <code class="literal">PRI</code>, <code class="literal">UNI</code>,
            <code class="literal">MUL</code>.
          </p><p>
            A <code class="literal">UNIQUE</code> index may be displayed as
            <code class="literal">PRI</code> if it cannot contain
            <code class="literal">NULL</code> values and there is no
            <code class="literal">PRIMARY KEY</code> in the table. A
            <code class="literal">UNIQUE</code> index may display as
            <code class="literal">MUL</code> if several columns form a composite
            <code class="literal">UNIQUE</code> index; although the combination of
            the columns is unique, each column can still hold multiple
            occurrences of a given value.
          </p></li><li class="listitem"><p>
            <code class="literal">Default</code>
          </p><p>
            The default value for the column. This is
            <code class="literal">NULL</code> if the column has an explicit
            default of <code class="literal">NULL</code>, or if the column
            definition includes no <code class="literal">DEFAULT</code> clause.
          </p></li><li class="listitem"><p>
            <code class="literal">Extra</code>
          </p><p>
            Any additional information that is available about a given
            column. The value is nonempty in these cases:
</p><a class="indexterm" name="idm140091656464592"></a>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">auto_increment</code> for columns that have
                the <code class="literal">AUTO_INCREMENT</code> attribute.
              </p></li><li class="listitem"><p>
                <code class="literal">on update CURRENT_TIMESTAMP</code> for
                <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> or
                <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> columns that
                have the <code class="literal">ON UPDATE CURRENT_TIMESTAMP</code>
                attribute.
              </p></li><li class="listitem"><p>
                <code class="literal">VIRTUAL GENERATED</code> or <code class="literal">VIRTUAL
                STORED</code> for generated columns.
              </p></li><li class="listitem"><p>
                <code class="literal">DEFAULT_GENERATED</code> for columns that
                have an expression default value.
</p></li></ul>
</div>
</li><li class="listitem"><p>
            <code class="literal">Privileges</code>
          </p><p>
            The privileges you have for the column. This value is
            displayed only if you use the <code class="literal">FULL</code>
            keyword.
          </p></li><li class="listitem"><p>
            <code class="literal">Comment</code>
          </p><p>
            Any comment included in the column definition. This value is
            displayed only if you use the <code class="literal">FULL</code>
            keyword.
</p></li></ul>
</div>
<p>
        Table column information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#columns-table" title="25.6 The INFORMATION_SCHEMA COLUMNS Table"><code class="literal">COLUMNS</code></a> table. See
        <a class="xref" href="information-schema.html#columns-table" title="25.6 The INFORMATION_SCHEMA COLUMNS Table">Section 25.6, “The INFORMATION_SCHEMA COLUMNS Table”</a>. The extended information about
        hidden columns is available only using <code class="literal">SHOW EXTENDED
        COLUMNS</code>; it cannot be obtained from the
        <a class="link" href="information-schema.html#columns-table" title="25.6 The INFORMATION_SCHEMA COLUMNS Table"><code class="literal">COLUMNS</code></a> table.
      </p><p>
        You can list a table's columns with the <a class="link" href="programs.html#mysqlshow" title="4.5.7 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow
        <em class="replaceable"><code>db_name</code></em>
        <em class="replaceable"><code>tbl_name</code></em></strong></span></a> command.
      </p><p>
        The <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> statement provides
        information similar to <a class="link" href="sql-syntax.html#show-columns" title="13.7.6.5 SHOW COLUMNS Syntax"><code class="literal">SHOW
        COLUMNS</code></a>. See <a class="xref" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax">Section 13.8.1, “DESCRIBE Syntax”</a>.
      </p><p>
        The <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>,
        <a class="link" href="sql-syntax.html#show-table-status" title="13.7.6.36 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a>, and
        <a class="link" href="sql-syntax.html#show-index" title="13.7.6.22 SHOW INDEX Syntax"><code class="literal">SHOW INDEX</code></a> statements also
        provide information about tables. See <a class="xref" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax">Section 13.7.6, “SHOW Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-database"></a>13.7.6.6 SHOW CREATE DATABASE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656428528"></a><a class="indexterm" name="idm140091656427472"></a><pre data-lang="sql" class="programlisting">
SHOW CREATE {DATABASE | SCHEMA} [IF NOT EXISTS] <em class="replaceable"><code>db_name</code></em>
</pre><p>
        Shows the <a class="link" href="sql-syntax.html#create-database" title="13.1.12 CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a>
        statement that creates the named database. If the
        <code class="literal">SHOW</code> statement includes an <code class="literal">IF NOT
        EXISTS</code> clause, the output too includes such a clause.
        <a class="link" href="sql-syntax.html#show-create-database" title="13.7.6.6 SHOW CREATE DATABASE Syntax"><code class="literal">SHOW
        CREATE SCHEMA</code></a> is a synonym for
        <a class="link" href="sql-syntax.html#show-create-database" title="13.7.6.6 SHOW CREATE DATABASE Syntax"><code class="literal">SHOW CREATE DATABASE</code></a>.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE DATABASE test\G</code></strong>
*************************** 1. row ***************************
       Database: test
Create Database: CREATE DATABASE `test` /*!40100 DEFAULT CHARACTER SET utf8mb4 
                 COLLATE utf8mb4_0900_ai_ci */ /*!80014 DEFAULT ENCRYPTION='N' */

mysql&gt; <strong class="userinput"><code>SHOW CREATE SCHEMA test\G</code></strong>
*************************** 1. row ***************************
       Database: test
Create Database: CREATE DATABASE `test` /*!40100 DEFAULT CHARACTER SET utf8mb4 
                 COLLATE utf8mb4_0900_ai_ci */ /*!80014 DEFAULT ENCRYPTION='N' */   
</pre><p>
        <a class="link" href="sql-syntax.html#show-create-database" title="13.7.6.6 SHOW CREATE DATABASE Syntax"><code class="literal">SHOW CREATE DATABASE</code></a> quotes table
        and column names according to the value of the
        <a class="link" href="server-administration.html#sysvar_sql_quote_show_create"><code class="literal">sql_quote_show_create</code></a> option.
        See <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-event"></a>13.7.6.7 SHOW CREATE EVENT Syntax</h4>

</div>

</div>

</div>
<pre data-lang="sql" class="programlisting">
SHOW CREATE EVENT <em class="replaceable"><code>event_name</code></em>
</pre><p>
        This statement displays the <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE
        EVENT</code></a> statement needed to re-create a given event. It
        requires the <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a> privilege for
        the database from which the event is to be shown. For example
        (using the same event <code class="literal">e_daily</code> defined and
        then altered in <a class="xref" href="sql-syntax.html#show-events" title="13.7.6.18 SHOW EVENTS Syntax">Section 13.7.6.18, “SHOW EVENTS Syntax”</a>):
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE EVENT myschema.e_daily\G</code></strong>
*************************** 1. row ***************************
               Event: e_daily
            sql_mode: ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,
                      NO_ZERO_IN_DATE,NO_ZERO_DATE,
                      ERROR_FOR_DIVISION_BY_ZERO,
                      NO_ENGINE_SUBSTITUTION
           time_zone: SYSTEM
        Create Event: CREATE DEFINER=`jon`@`ghidora` EVENT `e_daily`
                        ON SCHEDULE EVERY 1 DAY
                        STARTS CURRENT_TIMESTAMP + INTERVAL 6 HOUR
                        ON COMPLETION NOT PRESERVE
                        ENABLE
                        COMMENT 'Saves total number of sessions then
                                clears the table each day'
                        DO BEGIN
                          INSERT INTO site_activity.totals (time, total)
                            SELECT CURRENT_TIMESTAMP, COUNT(*)
                              FROM site_activity.sessions;
                          DELETE FROM site_activity.sessions;
                        END
character_set_client: utf8mb4
collation_connection: utf8mb4_0900_ai_ci
  Database Collation: utf8mb4_0900_ai_ci
</pre><p>
        <code class="literal">character_set_client</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
        variable when the event was created.
        <code class="literal">collation_connection</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
        variable when the event was created. <code class="literal">Database
        Collation</code> is the collation of the database with which
        the event is associated.
      </p><p>
        The output reflects the current status of the event
        (<code class="literal">ENABLE</code>) rather than the status with which it
        was created.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-function"></a>13.7.6.8 SHOW CREATE FUNCTION Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656385808"></a><pre data-lang="sql" class="programlisting">
SHOW CREATE FUNCTION <em class="replaceable"><code>func_name</code></em>
</pre><p>
        This statement is similar to <a class="link" href="sql-syntax.html#show-create-procedure" title="13.7.6.9 SHOW CREATE PROCEDURE Syntax"><code class="literal">SHOW CREATE
        PROCEDURE</code></a> but for stored functions. See
        <a class="xref" href="sql-syntax.html#show-create-procedure" title="13.7.6.9 SHOW CREATE PROCEDURE Syntax">Section 13.7.6.9, “SHOW CREATE PROCEDURE Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-procedure"></a>13.7.6.9 SHOW CREATE PROCEDURE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656376736"></a><pre data-lang="sql" class="programlisting">
SHOW CREATE PROCEDURE <em class="replaceable"><code>proc_name</code></em>
</pre><p>
        This statement is a MySQL extension. It returns the exact string
        that can be used to re-create the named stored procedure. A
        similar statement, <a class="link" href="sql-syntax.html#show-create-function" title="13.7.6.8 SHOW CREATE FUNCTION Syntax"><code class="literal">SHOW CREATE
        FUNCTION</code></a>, displays information about stored functions
        (see <a class="xref" href="sql-syntax.html#show-create-function" title="13.7.6.8 SHOW CREATE FUNCTION Syntax">Section 13.7.6.8, “SHOW CREATE FUNCTION Syntax”</a>).
      </p><p>
        To use either statement, you must have the global
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> privilege.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE PROCEDURE test.simpleproc\G</code></strong>
*************************** 1. row ***************************
           Procedure: simpleproc
            sql_mode: ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,
                      NO_ZERO_IN_DATE,NO_ZERO_DATE,
                      ERROR_FOR_DIVISION_BY_ZERO,
                      NO_ENGINE_SUBSTITUTION
    Create Procedure: CREATE PROCEDURE `simpleproc`(OUT param1 INT)
                      BEGIN
                      SELECT COUNT(*) INTO param1 FROM t;
                      END
character_set_client: utf8mb4
collation_connection: utf8mb4_0900_ai_ci
  Database Collation: utf8mb4_0900_ai_ci

mysql&gt; <strong class="userinput"><code>SHOW CREATE FUNCTION test.hello\G</code></strong>
*************************** 1. row ***************************
            Function: hello
            sql_mode: ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,
                      NO_ZERO_IN_DATE,NO_ZERO_DATE,
                      ERROR_FOR_DIVISION_BY_ZERO,
                      NO_ENGINE_SUBSTITUTION
     Create Function: CREATE FUNCTION `hello`(s CHAR(20))
                      RETURNS char(50) CHARSET utf8mb4
                      RETURN CONCAT('Hello, ',s,'!')
character_set_client: utf8mb4
collation_connection: utf8mb4_0900_ai_ci
  Database Collation: utf8mb4_0900_ai_ci
</pre><p>
        <code class="literal">character_set_client</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
        variable when the routine was created.
        <code class="literal">collation_connection</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
        variable when the routine was created. <code class="literal">Database
        Collation</code> is the collation of the database with which
        the routine is associated.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-table"></a>13.7.6.10 SHOW CREATE TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656355776"></a><pre data-lang="sql" class="programlisting">
SHOW CREATE TABLE <em class="replaceable"><code>tbl_name</code></em>
</pre><p>
        Shows the <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement
        that creates the named table. To use this statement, you must
        have some privilege for the table. This statement also works
        with views.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t\G</code></strong>
*************************** 1. row ***************************
       Table: t
Create Table: CREATE TABLE `t` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `s` char(60) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4</pre><a class="indexterm" name="idm140091656345024"></a><p>
        As of MySQL 8.0.16, MySQL implements <code class="literal">CHECK</code>
        constraints and <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>
        displays them. All <code class="literal">CHECK</code> constraints are
        displayed as table constraints. That is, a
        <code class="literal">CHECK</code> constraint originally specified as part
        of a column definition displays as a separate clause not part of
        the column definition. Example:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
         <strong class="userinput"><code>i1 INT CHECK (i1 &lt;&gt; 0),      -- column constraint</code></strong>
         <strong class="userinput"><code>i2 INT,</code></strong>
         <strong class="userinput"><code>CHECK (i2 &gt; i1),             -- table constraint</code></strong>
         <strong class="userinput"><code>CHECK (i2 &lt;&gt; 0) NOT ENFORCED -- table constraint, not enforced</code></strong>
       <strong class="userinput"><code>);</code></strong>

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t1\G</code></strong>
*************************** 1. row ***************************
       Table: t1
Create Table: CREATE TABLE `t1` (
  `i1` int(11) DEFAULT NULL,
  `i2` int(11) DEFAULT NULL,
  CONSTRAINT `t1_chk_1` CHECK ((`i1` &lt;&gt; 0)),
  CONSTRAINT `t1_chk_2` CHECK ((`i2` &gt; `i1`)),
  CONSTRAINT `t1_chk_3` CHECK ((`i2` &lt;&gt; 0)) /*!80016 NOT ENFORCED */
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
</pre><p>
        <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a> quotes table
        and column names according to the value of the
        <a class="link" href="server-administration.html#sysvar_sql_quote_show_create"><code class="literal">sql_quote_show_create</code></a> option.
        See <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>.
      </p><p>
        For information about how <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
        TABLE</code></a> statements are stored by MySQL, see
        <a class="xref" href="sql-syntax.html#create-table-statement-retention" title="13.1.20.1 CREATE TABLE Statement Retention">Section 13.1.20.1, “CREATE TABLE Statement Retention”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-trigger"></a>13.7.6.11 SHOW CREATE TRIGGER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656325120"></a><pre data-lang="sql" class="programlisting">
SHOW CREATE TRIGGER <em class="replaceable"><code>trigger_name</code></em>
</pre><p>
        This statement shows the <a class="link" href="sql-syntax.html#create-trigger" title="13.1.22 CREATE TRIGGER Syntax"><code class="literal">CREATE
        TRIGGER</code></a> statement that creates the named trigger. This
        statement requires the <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a>
        privilege for the table associated with the trigger.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TRIGGER ins_sum\G</code></strong>
*************************** 1. row ***************************
               Trigger: ins_sum
              sql_mode: ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,
                        NO_ZERO_IN_DATE,NO_ZERO_DATE,
                        ERROR_FOR_DIVISION_BY_ZERO,
                        NO_ENGINE_SUBSTITUTION
SQL Original Statement: CREATE DEFINER=`me`@`localhost` TRIGGER `ins_sum`
                        BEFORE INSERT ON `account`
                        FOR EACH ROW SET @sum = @sum + NEW.amount
  character_set_client: utf8mb4
  collation_connection: utf8mb4_0900_ai_ci
    Database Collation: utf8mb4_0900_ai_ci
               Created: 2018-08-08 10:10:12.61
</pre><p>
        <a class="link" href="sql-syntax.html#show-create-trigger" title="13.7.6.11 SHOW CREATE TRIGGER Syntax"><code class="literal">SHOW CREATE TRIGGER</code></a> output has
        these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Trigger</code>: The trigger name.
          </p></li><li class="listitem"><p>
            <code class="literal">sql_mode</code>: The SQL mode in effect when the
            trigger executes.
          </p></li><li class="listitem"><p>
            <code class="literal">SQL Original Statement</code>: The
            <a class="link" href="sql-syntax.html#create-trigger" title="13.1.22 CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a> statement that
            defines the trigger.
          </p></li><li class="listitem"><p>
            <code class="literal">character_set_client</code>: The session value
            of the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a>
            system variable when the trigger was created.
          </p></li><li class="listitem"><p>
            <code class="literal">collation_connection</code>: The session value
            of the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a>
            system variable when the trigger was created.
          </p></li><li class="listitem"><p>
            <code class="literal">Database Collation</code>: The collation of the
            database with which the trigger is associated.
          </p></li><li class="listitem"><p>
            <code class="literal">Created</code>: The date and time when the
            trigger was created. This is a
            <code class="literal">TIMESTAMP(2)</code> value (with a fractional
            part in hundredths of seconds) for triggers.
</p></li></ul>
</div>
<p>
        Trigger information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#triggers-table" title="25.34 The INFORMATION_SCHEMA TRIGGERS Table"><code class="literal">TRIGGERS</code></a> table. See
        <a class="xref" href="information-schema.html#triggers-table" title="25.34 The INFORMATION_SCHEMA TRIGGERS Table">Section 25.34, “The INFORMATION_SCHEMA TRIGGERS Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-user"></a>13.7.6.12 SHOW CREATE USER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656293184"></a><pre data-lang="sql" class="programlisting">
SHOW CREATE USER <em class="replaceable"><code>user</code></em>
</pre><p>
        This statement shows the <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE
        USER</code></a> statement that creates the named user. An error
        occurs if the user does not exist. The statement requires the
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the
        <code class="literal">mysql</code> system database, except to see
        information for the current user. For the current user, the
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the
        <code class="literal">mysql.user</code> system table is required for
        display of the password hash in the <code class="literal">IDENTIFIED
        AS</code> clause; otherwise, the hash displays as
        <code class="literal">&lt;secret&gt;</code>.
      </p><p>
        To name the account, use the format described in
        <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>. The host name part of the
        account name, if omitted, defaults to <code class="literal">'%'</code>. It
        is also possible to specify
        <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> or
        <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a> to refer to the
        account associated with the current session.
      </p><p>
        Password hash values displayed in the <code class="literal">IDENTIFIED
        WITH</code> clause of output from <a class="link" href="sql-syntax.html#show-create-user" title="13.7.6.12 SHOW CREATE USER Syntax"><code class="literal">SHOW
        CREATE USER</code></a> may contain unprintable characters that
        have adverse effects on terminal displays and in other
        environments. Enabling the
        <a class="link" href="server-administration.html#sysvar_print_identified_with_as_hex"><code class="literal">print_identified_with_as_hex</code></a>
        system variable (available as of MySQL 8.0.17) causes
        <a class="link" href="sql-syntax.html#show-create-user" title="13.7.6.12 SHOW CREATE USER Syntax"><code class="literal">SHOW CREATE USER</code></a> to display such
        hash values as hexadecimal strings rather than as regular string
        literals. Hash values that do not contain unprintable characters
        still display as regular string literals, even with this
        variable enabled.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE USER 'u1'@'localhost' IDENTIFIED BY 'secret';</code></strong>
mysql&gt; <strong class="userinput"><code>SET print_identified_with_as_hex = ON;</code></strong>
mysql&gt; <strong class="userinput"><code>SHOW CREATE USER 'u1'@'localhost'\G</code></strong>
*************************** 1. row ***************************
CREATE USER for u1@localhost: CREATE USER 'u1'@'localhost'
IDENTIFIED WITH 'caching_sha2_password'
AS 0x244124303035240C7745603626313D613C4C10633E0A104B1E14135A544A7871567245614F4872344643546336546F624F6C7861326932752F45622F4F473273597557627139
REQUIRE NONE PASSWORD EXPIRE DEFAULT ACCOUNT UNLOCK
PASSWORD HISTORY DEFAULT PASSWORD REUSE INTERVAL DEFAULT
PASSWORD REQUIRE CURRENT DEFAULT
</pre><p>
        To display the privileges granted to an account, use the
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> statement. See
        <a class="xref" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax">Section 13.7.6.21, “SHOW GRANTS Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-view"></a>13.7.6.13 SHOW CREATE VIEW Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656263312"></a><pre data-lang="sql" class="programlisting">
SHOW CREATE VIEW <em class="replaceable"><code>view_name</code></em>
</pre><p>
        This statement shows the <a class="link" href="sql-syntax.html#create-view" title="13.1.23 CREATE VIEW Syntax"><code class="literal">CREATE
        VIEW</code></a> statement that creates the named view.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE VIEW v\G</code></strong>
*************************** 1. row ***************************
                View: v
         Create View: CREATE ALGORITHM=UNDEFINED
                      DEFINER=`bob`@`localhost`
                      SQL SECURITY DEFINER VIEW
                      `v` AS select 1 AS `a`,2 AS `b`
character_set_client: utf8mb4
collation_connection: utf8mb4_0900_ai_ci
</pre><p>
        <code class="literal">character_set_client</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
        variable when the view was created.
        <code class="literal">collation_connection</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
        variable when the view was created.
      </p><p>
        Use of <a class="link" href="sql-syntax.html#show-create-view" title="13.7.6.13 SHOW CREATE VIEW Syntax"><code class="literal">SHOW CREATE VIEW</code></a> requires
        the <a class="link" href="security.html#priv_show-view"><code class="literal">SHOW VIEW</code></a> privilege, and the
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the view in
        question.
      </p><p>
        View information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#views-table" title="25.36 The INFORMATION_SCHEMA VIEWS Table"><code class="literal">VIEWS</code></a> table. See
        <a class="xref" href="information-schema.html#views-table" title="25.36 The INFORMATION_SCHEMA VIEWS Table">Section 25.36, “The INFORMATION_SCHEMA VIEWS Table”</a>.
      </p><p>
        MySQL lets you use different
        <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> settings to tell the
        server the type of SQL syntax to support. For example, you might
        use the <a class="link" href="server-administration.html#sqlmode_ansi"><code class="literal">ANSI</code></a> SQL mode to
        ensure MySQL correctly interprets the standard SQL concatenation
        operator, the double bar (<code class="literal">||</code>), in your
        queries. If you then create a view that concatenates items, you
        might worry that changing the
        <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> setting to a value
        different from <a class="link" href="server-administration.html#sqlmode_ansi"><code class="literal">ANSI</code></a> could
        cause the view to become invalid. But this is not the case. No
        matter how you write out a view definition, MySQL always stores
        it the same way, in a canonical form. Here is an example that
        shows how the server changes a double bar concatenation operator
        to a <a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a> function:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET sql_mode = 'ANSI';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE VIEW test.v AS SELECT 'a' || 'b' as col1;</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SHOW CREATE VIEW test.v\G</code></strong>
*************************** 1. row ***************************
                View: v
         Create View: CREATE VIEW "v" AS select concat('a','b') AS "col1"
...
1 row in set (0.00 sec)
</pre><p>
        The advantage of storing a view definition in canonical form is
        that changes made later to the value of
        <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> will not affect the
        results from the view. However an additional consequence is that
        comments prior to <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> are
        stripped from the definition by the server.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-databases"></a>13.7.6.14 SHOW DATABASES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656227200"></a><a class="indexterm" name="idm140091656226112"></a><pre data-lang="sql" class="programlisting">
SHOW {DATABASES | SCHEMAS}
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-databases" title="13.7.6.14 SHOW DATABASES Syntax"><code class="literal">SHOW DATABASES</code></a> lists the
        databases on the MySQL server host.
        <a class="link" href="sql-syntax.html#show-databases" title="13.7.6.14 SHOW DATABASES Syntax"><code class="literal">SHOW
        SCHEMAS</code></a> is a synonym for <a class="link" href="sql-syntax.html#show-databases" title="13.7.6.14 SHOW DATABASES Syntax"><code class="literal">SHOW
        DATABASES</code></a>. The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a>
        clause, if present, indicates which database names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><p>
        You see only those databases for which you have some kind of
        privilege, unless you have the global <a class="link" href="sql-syntax.html#show-databases" title="13.7.6.14 SHOW DATABASES Syntax"><code class="literal">SHOW
        DATABASES</code></a> privilege. You can also get this list using
        the <a class="link" href="programs.html#mysqlshow" title="4.5.7 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow</strong></span></a> command.
      </p><p>
        If the server was started with the
        <a class="link" href="server-administration.html#option_mysqld_skip-show-database"><code class="option">--skip-show-database</code></a> option, you
        cannot use this statement at all unless you have the
        <a class="link" href="security.html#priv_show-databases"><code class="literal">SHOW DATABASES</code></a> privilege.
      </p><p>
        MySQL implements databases as directories in the data directory,
        so this statement simply lists directories in that location.
        However, the output may include names of directories that do not
        correspond to actual databases.
      </p><p>
        Database information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#schemata-table" title="25.24 The INFORMATION_SCHEMA SCHEMATA Table"><code class="literal">SCHEMATA</code></a> table. See
        <a class="xref" href="information-schema.html#schemata-table" title="25.24 The INFORMATION_SCHEMA SCHEMATA Table">Section 25.24, “The INFORMATION_SCHEMA SCHEMATA Table”</a>.
</p>
<div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Caution
</div>
<p>
          Because any static global privilege is considered a privilege
          for all databases, any static global privilege enables a user
          to see all database names with <a class="link" href="sql-syntax.html#show-databases" title="13.7.6.14 SHOW DATABASES Syntax"><code class="literal">SHOW
          DATABASES</code></a> or by examining the
          <a class="link" href="information-schema.html#schemata-table" title="25.24 The INFORMATION_SCHEMA SCHEMATA Table"><code class="literal">SCHEMATA</code></a> table of
          <code class="literal">INFORMATION_SCHEMA</code>, except databases that
          have been restricted at the database level by partial revokes.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-engine"></a>13.7.6.15 SHOW ENGINE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656197440"></a><a class="indexterm" name="idm140091656196368"></a><pre data-lang="sql" class="programlisting">
SHOW ENGINE <em class="replaceable"><code>engine_name</code></em> {STATUS | MUTEX}
</pre><p>
        <a class="link" href="sql-syntax.html#show-engine" title="13.7.6.15 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE</code></a> displays operational
        information about a storage engine. It requires the
        <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a> privilege. The statement
        has these variants:
      </p><pre data-lang="sql" class="programlisting">
SHOW ENGINE INNODB STATUS
SHOW ENGINE INNODB MUTEX
SHOW ENGINE PERFORMANCE_SCHEMA STATUS
</pre><p>
        <a class="link" href="sql-syntax.html#show-engine" title="13.7.6.15 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE INNODB
        STATUS</code></a> displays extensive information from the
        standard <code class="literal">InnoDB</code> Monitor about the state of
        the <code class="literal">InnoDB</code> storage engine. For information
        about the standard monitor and other <code class="literal">InnoDB</code>
        Monitors that provide information about
        <code class="literal">InnoDB</code> processing, see
        <a class="xref" href="innodb-storage-engine.html#innodb-monitors" title="15.16 InnoDB Monitors">Section 15.16, “InnoDB Monitors”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-engine" title="13.7.6.15 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE INNODB
        MUTEX</code></a> displays <code class="literal">InnoDB</code>
        <a class="link" href="glossary.html#glos_mutex" title="mutex">mutex</a> and
        <a class="link" href="glossary.html#glos_rw_lock" title="rw-lock">rw-lock</a> statistics.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          <code class="literal">InnoDB</code> mutexes and rwlocks can also be
          monitored using <a class="link" href="performance-schema.html" title="Chapter 26 MySQL Performance Schema">Performance
          Schema</a> tables. See
          <a class="xref" href="innodb-storage-engine.html#monitor-innodb-mutex-waits-performance-schema" title="15.15.2 Monitoring InnoDB Mutex Waits Using Performance Schema">Section 15.15.2, “Monitoring InnoDB Mutex Waits Using Performance Schema”</a>.
</p>
</div>
<p>
        Mutex statistics collection is configured dynamically using the
        following options:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            To enable the collection of mutex statistics, run:
          </p><pre data-lang="sql" class="programlisting">SET GLOBAL innodb_monitor_enable='latch';</pre></li><li class="listitem"><p>
            To reset mutex statistics, run:
          </p><pre data-lang="sql" class="programlisting">SET GLOBAL innodb_monitor_reset='latch';</pre></li><li class="listitem"><p>
            To disable the collection of mutex statistics, run:
</p><pre data-lang="sql" class="programlisting">SET GLOBAL innodb_monitor_disable='latch';</pre></li></ul>
</div>
<p>
        Collection of mutex statistics for
        <a class="link" href="sql-syntax.html#show-engine" title="13.7.6.15 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE INNODB
        MUTEX</code></a> can also be enabled by setting
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_monitor_enable"><code class="literal">innodb_monitor_enable='all'</code></a>, or
        disabled by setting
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_monitor_disable"><code class="literal">innodb_monitor_disable='all'</code></a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-engine" title="13.7.6.15 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE INNODB
        MUTEX</code></a> output has these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Type</code>
          </p><p>
            Always <code class="literal">InnoDB</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Name</code>
          </p><p>
            For mutexes, the <code class="literal">Name</code> field reports only
            the mutex name. For rwlocks, the <code class="literal">Name</code>
            field reports the source file where the rwlock is
            implemented, and the line number in the file where the
            rwlock is created. The line number is specific to your
            version of MySQL.
          </p></li><li class="listitem"><p>
            <code class="literal">Status</code>
          </p><p>
            The mutex status. This field reports the number of spins,
            waits, and calls. Statistics for low-level operating system
            mutexes, which are implemented outside of
            <code class="literal">InnoDB</code>, are not reported.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">spins</code> indicates the number of spins.
              </p></li><li class="listitem"><p>
                <code class="literal">waits</code> indicates the number of mutex
                waits.
              </p></li><li class="listitem"><p>
                <code class="literal">calls</code> indicates how many times the
                mutex was requested.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
        <code class="literal">SHOW ENGINE INNODB MUTEX</code> skips the
        <a class="link" href="glossary.html#glos_mutex" title="mutex">mutexes</a> and
        <a class="link" href="glossary.html#glos_rw_lock" title="rw-lock">rw-locks</a> of
        <a class="link" href="glossary.html#glos_buffer_pool" title="buffer pool">buffer pool</a> blocks, as
        the amount of output can be overwhelming on systems with a large
        buffer pool. (There is one mutex and one rw-lock in each 16K
        buffer pool block, and there are 65,536 blocks per gigabyte.)
        <code class="literal">SHOW ENGINE INNODB MUTEX</code> also does not list
        any mutexes or rw-locks that have never been waited on
        (<code class="literal">os_waits=0</code>). Thus, <code class="literal">SHOW ENGINE
        INNODB MUTEX</code> only displays information about mutexes
        and rw-locks outside of the buffer pool that have caused at
        least one OS-level <a class="link" href="glossary.html#glos_wait" title="wait">wait</a>.
      </p><p>
        Use <a class="link" href="sql-syntax.html#show-engine" title="13.7.6.15 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE
        PERFORMANCE_SCHEMA STATUS</code></a> to inspect the internal
        operation of the Performance Schema code:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW ENGINE PERFORMANCE_SCHEMA STATUS\G</code></strong>
...
*************************** 3. row ***************************
  Type: performance_schema
  Name: events_waits_history.size
Status: 76
*************************** 4. row ***************************
  Type: performance_schema
  Name: events_waits_history.count
Status: 10000
*************************** 5. row ***************************
  Type: performance_schema
  Name: events_waits_history.memory
Status: 760000
...
*************************** 57. row ***************************
  Type: performance_schema
  Name: performance_schema.memory
Status: 26459600
...
</pre><p>
        This statement is intended to help the DBA understand the
        effects that different Performance Schema options have on memory
        requirements.
      </p><p>
        <code class="literal">Name</code> values consist of two parts, which name
        an internal buffer and a buffer attribute, respectively.
        Interpret buffer names as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            An internal buffer that is not exposed as a table is named
            within parentheses. Examples:
            <code class="literal">(pfs_cond_class).size</code>,
            <code class="literal">(pfs_mutex_class).memory</code>.
          </p></li><li class="listitem"><p>
            An internal buffer that is exposed as a table in the
            <code class="literal">performance_schema</code> database is named
            after the table, without parentheses. Examples:
            <code class="literal">events_waits_history.size</code>,
            <code class="literal">mutex_instances.count</code>.
          </p></li><li class="listitem"><p>
            A value that applies to the Performance Schema as a whole
            begins with <code class="literal">performance_schema</code>. Example:
            <code class="literal">performance_schema.memory</code>.
</p></li></ul>
</div>
<p>
        Buffer attributes have these meanings:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">size</code> is the size of the internal record
            used by the implementation, such as the size of a row in a
            table. <code class="literal">size</code> values cannot be changed.
          </p></li><li class="listitem"><p>
            <code class="literal">count</code> is the number of internal records,
            such as the number of rows in a table.
            <code class="literal">count</code> values can be changed using
            Performance Schema configuration options.
          </p></li><li class="listitem"><p>
            For a table,
            <code class="literal"><em class="replaceable"><code>tbl_name</code></em>.memory</code>
            is the product of <code class="literal">size</code> and
            <code class="literal">count</code>. For the Performance Schema as a
            whole, <code class="literal">performance_schema.memory</code> is the
            sum of all the memory used (the sum of all other
            <code class="literal">memory</code> values).
</p></li></ul>
</div>
<p>
        In some cases, there is a direct relationship between a
        Performance Schema configuration parameter and a <code class="literal">SHOW
        ENGINE</code> value. For example,
        <code class="literal">events_waits_history_long.count</code> corresponds
        to
        <a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size"><code class="literal">performance_schema_events_waits_history_long_size</code></a>.
        In other cases, the relationship is more complex. For example,
        <code class="literal">events_waits_history.count</code> corresponds to
        <a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size"><code class="literal">performance_schema_events_waits_history_size</code></a>
        (the number of rows per thread) multiplied by
        <a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances"><code class="literal">performance_schema_max_thread_instances</code></a>
        ( the number of threads).
      </p><p><a name="show-engine-ndb-status"></a><b>SHOW ENGINE NDB STATUS. </b>
          If the server has the <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> storage
          engine enabled, <code class="literal">SHOW ENGINE NDB STATUS</code>
          displays cluster status information such as the number of
          connected data nodes, the cluster connectstring, and cluster
          binary log epochs, as well as counts of various Cluster API
          objects created by the MySQL Server when connected to the
          cluster. Sample output from this statement is shown here:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW ENGINE NDB STATUS;</code></strong>
+------------+-----------------------+--------------------------------------------------+
| Type       | Name                  | Status                                           |
+------------+-----------------------+--------------------------------------------------+
| ndbcluster | connection            | cluster_node_id=7,
  connected_host=198.51.100.103, connected_port=1186, number_of_data_nodes=4,
  number_of_ready_data_nodes=3, connect_count=0                                         |
| ndbcluster | NdbTransaction        | created=6, free=0, sizeof=212                    |
| ndbcluster | NdbOperation          | created=8, free=8, sizeof=660                    |
| ndbcluster | NdbIndexScanOperation | created=1, free=1, sizeof=744                    |
| ndbcluster | NdbIndexOperation     | created=0, free=0, sizeof=664                    |
| ndbcluster | NdbRecAttr            | created=1285, free=1285, sizeof=60               |
| ndbcluster | NdbApiSignal          | created=16, free=16, sizeof=136                  |
| ndbcluster | NdbLabel              | created=0, free=0, sizeof=196                    |
| ndbcluster | NdbBranch             | created=0, free=0, sizeof=24                     |
| ndbcluster | NdbSubroutine         | created=0, free=0, sizeof=68                     |
| ndbcluster | NdbCall               | created=0, free=0, sizeof=16                     |
| ndbcluster | NdbBlob               | created=1, free=1, sizeof=264                    |
| ndbcluster | NdbReceiver           | created=4, free=0, sizeof=68                     |
| ndbcluster | binlog                | latest_epoch=155467, latest_trans_epoch=148126,
  latest_received_binlog_epoch=0, latest_handled_binlog_epoch=0,
  latest_applied_binlog_epoch=0                                                         |
+------------+-----------------------+--------------------------------------------------+
</pre><p>
        The <code class="literal">Status</code> column in each of these rows
        provides information about the MySQL server's connection to
        the cluster and about the cluster binary log's status,
        respectively. The <code class="literal">Status</code> information is in
        the form of comma-delimited set of name/value pairs.
      </p><p>
        The <code class="literal">connection</code> row's
        <code class="literal">Status</code> column contains the name/value pairs
        described in the following table.
</p>
<div class="informaltable">
<table summary="Name and value pairs found in the connection row Status column in the output of the SHOW ENGINE NDB STATUS statement."><col width="40%"><col width="60%"><thead><tr>
            <th scope="col">Name</th>
            <th scope="col">Value</th>
          </tr></thead><tbody><tr>
            <td scope="row"><code class="literal">cluster_node_id</code></td>
            <td>The node ID of the MySQL server in the cluster</td>
          </tr><tr>
            <td scope="row"><code class="literal">connected_host</code></td>
            <td>The host name or IP address of the cluster management server to which
              the MySQL server is connected</td>
          </tr><tr>
            <td scope="row"><code class="literal">connected_port</code></td>
            <td>The port used by the MySQL server to connect to the management server
              (<code class="literal">connected_host</code>)</td>
          </tr><tr>
            <td scope="row"><code class="literal">number_of_data_nodes</code></td>
            <td>The number of data nodes configured for the cluster (that is, the number
              of <code class="literal">[ndbd]</code> sections in the cluster
              <code class="filename">config.ini</code> file)</td>
          </tr><tr>
            <td scope="row"><code class="literal">number_of_ready_data_nodes</code></td>
            <td>The number of data nodes in the cluster that are actually running</td>
          </tr><tr>
            <td scope="row"><code class="literal">connect_count</code></td>
            <td>The number of times this <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> has connected or
              reconnected to cluster data nodes</td>
</tr></tbody></table>
</div>
<p>
        The <code class="literal">binlog</code> row's
        <code class="literal">Status</code> column contains information relating
        to NDB Cluster Replication. The name/value pairs it contains are
        described in the following table.
</p>
<div class="informaltable">
<table summary="Name and value pairs found in the binlog row Status column in the output of the SHOW ENGINE NDB STATUS statement."><col width="40%"><col width="60%"><thead><tr>
            <th scope="col">Name</th>
            <th scope="col">Value</th>
          </tr></thead><tbody><tr>
            <td scope="row"><code class="literal">latest_epoch</code></td>
            <td>The most recent epoch most recently run on this MySQL server (that is,
              the sequence number of the most recent transaction run on
              the server)</td>
          </tr><tr>
            <td scope="row"><code class="literal">latest_trans_epoch</code></td>
            <td>The most recent epoch processed by the cluster's data nodes</td>
          </tr><tr>
            <td scope="row"><code class="literal">latest_received_binlog_epoch</code></td>
            <td>The most recent epoch received by the binary log thread</td>
          </tr><tr>
            <td scope="row"><code class="literal">latest_handled_binlog_epoch</code></td>
            <td>The most recent epoch processed by the binary log thread (for writing to
              the binary log)</td>
          </tr><tr>
            <td scope="row"><code class="literal">latest_applied_binlog_epoch</code></td>
            <td>The most recent epoch actually written to the binary log</td>
</tr></tbody></table>
</div>
<p>
        See <a class="xref" href="mysql-cluster.html#mysql-cluster-replication" title="22.6 NDB Cluster Replication">Section 22.6, “NDB Cluster Replication”</a>, for more
        information.
      </p><p>
        The remaining rows from the output of <code class="literal">SHOW ENGINE NDB
        STATUS</code> which are most likely to prove useful in
        monitoring the cluster are listed here by
        <code class="literal">Name</code>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">NdbTransaction</code>: The number and size of
            <code class="literal">NdbTransaction</code> objects that have been
            created. An <code class="literal">NdbTransaction</code> is created
            each time a table schema operation (such as
            <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> or
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>) is performed on
            an <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> table.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbOperation</code>: The number and size of
            <code class="literal">NdbOperation</code> objects that have been
            created.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbIndexScanOperation</code>: The number and
            size of <code class="literal">NdbIndexScanOperation</code> objects
            that have been created.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbIndexOperation</code>: The number and size of
            <code class="literal">NdbIndexOperation</code> objects that have been
            created.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbRecAttr</code>: The number and size of
            <code class="literal">NdbRecAttr</code> objects that have been
            created. In general, one of these is created each time a
            data manipulation statement is performed by an SQL node.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbBlob</code>: The number and size of
            <code class="literal">NdbBlob</code> objects that have been created.
            An <code class="literal">NdbBlob</code> is created for each new
            operation involving a <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>
            column in an <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> table.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbReceiver</code>: The number and size of any
            <code class="literal">NdbReceiver</code> object that have been
            created. The number in the <code class="literal">created</code> column
            is the same as the number of data nodes in the cluster to
            which the MySQL server has connected.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          <code class="literal">SHOW ENGINE NDB STATUS</code> returns an empty
          result if no operations involving
          <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables have been performed
          during the current session by the MySQL client accessing the
          SQL node on which this statement is run.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-engines"></a>13.7.6.16 SHOW ENGINES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091656016480"></a><a class="indexterm" name="idm140091656015408"></a><pre data-lang="sql" class="programlisting">
SHOW [STORAGE] ENGINES
</pre><p>
        <a class="link" href="sql-syntax.html#show-engines" title="13.7.6.16 SHOW ENGINES Syntax"><code class="literal">SHOW ENGINES</code></a> displays status
        information about the server's storage engines. This is
        particularly useful for checking whether a storage engine is
        supported, or to see what the default engine is.
      </p><p>
        For information about MySQL storage engines, see
        <a class="xref" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine">Chapter 15, <i>The InnoDB Storage Engine</i></a>, and
        <a class="xref" href="storage-engines.html" title="Chapter 16 Alternative Storage Engines">Chapter 16, <i>Alternative Storage Engines</i></a>.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW ENGINES\G</code></strong>
*************************** 1. row ***************************
      Engine: ARCHIVE
     Support: YES
     Comment: Archive storage engine
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 2. row ***************************
      Engine: BLACKHOLE
     Support: YES
     Comment: /dev/null storage engine (anything you write to it disappears)
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 3. row ***************************
      Engine: MRG_MYISAM
     Support: YES
     Comment: Collection of identical MyISAM tables
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 4. row ***************************
      Engine: FEDERATED
     Support: NO
     Comment: Federated MySQL storage engine
Transactions: NULL
          XA: NULL
  Savepoints: NULL
*************************** 5. row ***************************
      Engine: MyISAM
     Support: YES
     Comment: MyISAM storage engine
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 6. row ***************************
      Engine: PERFORMANCE_SCHEMA
     Support: YES
     Comment: Performance Schema
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 7. row ***************************
      Engine: InnoDB
     Support: DEFAULT
     Comment: Supports transactions, row-level locking, and foreign keys
Transactions: YES
          XA: YES
  Savepoints: YES
*************************** 8. row ***************************
      Engine: MEMORY
     Support: YES
     Comment: Hash based, stored in memory, useful for temporary tables
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 9. row ***************************
      Engine: CSV
     Support: YES
     Comment: CSV storage engine
Transactions: NO
          XA: NO
  Savepoints: NO
</pre><p>
        The output from <a class="link" href="sql-syntax.html#show-engines" title="13.7.6.16 SHOW ENGINES Syntax"><code class="literal">SHOW ENGINES</code></a> may
        vary according to the MySQL version used and other factors.
      </p><p>
        <a class="link" href="sql-syntax.html#show-engines" title="13.7.6.16 SHOW ENGINES Syntax"><code class="literal">SHOW ENGINES</code></a> output has these
        columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Engine</code>
          </p><p>
            The name of the storage engine.
          </p></li><li class="listitem"><p>
            <code class="literal">Support</code>
          </p><p>
            The server's level of support for the storage engine, as
            shown in the following table.
</p>
<div class="informaltable">
<table summary="Values for the Support column in the output of the SHOW ENGINES statement."><col width="15%"><col width="85%"><thead><tr>
                <th scope="col">Value</th>
                <th scope="col">Meaning</th>
              </tr></thead><tbody><tr>
                <td scope="row"><code class="literal">YES</code></td>
                <td>The engine is supported and is active</td>
              </tr><tr>
                <td scope="row"><code class="literal">DEFAULT</code></td>
                <td>Like <code class="literal">YES</code>, plus this is the default engine</td>
              </tr><tr>
                <td scope="row"><code class="literal">NO</code></td>
                <td>The engine is not supported</td>
              </tr><tr>
                <td scope="row"><code class="literal">DISABLED</code></td>
                <td>The engine is supported but has been disabled</td>
</tr></tbody></table>
</div>
<p>
            A value of <code class="literal">NO</code> means that the server was
            compiled without support for the engine, so it cannot be
            enabled at runtime.
          </p><p>
            A value of <code class="literal">DISABLED</code> occurs either because
            the server was started with an option that disables the
            engine, or because not all options required to enable it
            were given. In the latter case, the error log should contain
            a reason indicating why the option is disabled. See
            <a class="xref" href="server-administration.html#error-log" title="5.4.2 The Error Log">Section 5.4.2, “The Error Log”</a>.
          </p><p>
            You might also see <code class="literal">DISABLED</code> for a storage
            engine if the server was compiled to support it, but was
            started with a
            <code class="option">--skip-<em class="replaceable"><code>engine_name</code></em></code>
            option. For the <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> storage
            engine, <code class="literal">DISABLED</code> means the server was
            compiled with support for NDB Cluster, but was not started
            with the <a class="link" href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> option.
          </p><p>
            All MySQL servers support <code class="literal">MyISAM</code> tables.
            It is not possible to disable <code class="literal">MyISAM</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Comment</code>
          </p><p>
            A brief description of the storage engine.
          </p></li><li class="listitem"><p>
            <code class="literal">Transactions</code>
          </p><p>
            Whether the storage engine supports transactions.
          </p></li><li class="listitem"><p>
            <code class="literal">XA</code>
          </p><p>
            Whether the storage engine supports XA transactions.
          </p></li><li class="listitem"><p>
            <code class="literal">Savepoints</code>
          </p><p>
            Whether the storage engine supports savepoints.
</p></li></ul>
</div>
<p>
        Storage engine information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#engines-table" title="25.9 The INFORMATION_SCHEMA ENGINES Table"><code class="literal">ENGINES</code></a> table. See
        <a class="xref" href="information-schema.html#engines-table" title="25.9 The INFORMATION_SCHEMA ENGINES Table">Section 25.9, “The INFORMATION_SCHEMA ENGINES Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-errors"></a>13.7.6.17 SHOW ERRORS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655953392"></a><a class="indexterm" name="idm140091655952320"></a><pre data-lang="sql" class="programlisting">
SHOW ERRORS [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
SHOW COUNT(*) ERRORS
</pre><p>
        <a class="link" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a> is a diagnostic
        statement that is similar to <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW
        WARNINGS</code></a>, except that it displays information only for
        errors, rather than for errors, warnings, and notes.
      </p><p>
        The <code class="literal">LIMIT</code> clause has the same syntax as for
        the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement. See
        <a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax">Section 13.2.10, “SELECT Syntax”</a>.
      </p><p>
        The <a class="link" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax"><code class="literal">SHOW COUNT(*)
        ERRORS</code></a> statement displays the number of errors. You
        can also retrieve this number from the
        <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> variable:
      </p><pre data-lang="sql" class="programlisting">
SHOW COUNT(*) ERRORS;
SELECT @@error_count;
</pre><p>
        <a class="link" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a> and
        <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> apply only to
        errors, not warnings or notes. In other respects, they are
        similar to <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> and
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a>. In particular,
        <a class="link" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a> cannot display
        information for more than
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> messages, and
        <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> can exceed the
        value of <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> if the
        number of errors exceeds
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>.
      </p><p>
        For more information, see <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax">Section 13.7.6.40, “SHOW WARNINGS Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-events"></a>13.7.6.18 SHOW EVENTS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655922432"></a><pre data-lang="sql" class="programlisting">
SHOW EVENTS
    [{FROM | IN} <em class="replaceable"><code>schema_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        This statement displays information about Event Manager events,
        which are discussed in <a class="xref" href="stored-objects.html#event-scheduler" title="24.4 Using the Event Scheduler">Section 24.4, “Using the Event Scheduler”</a>. It
        requires the <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a> privilege for
        the database from which the events are to be shown.
      </p><p>
        In its simplest form, <a class="link" href="sql-syntax.html#show-events" title="13.7.6.18 SHOW EVENTS Syntax"><code class="literal">SHOW EVENTS</code></a>
        lists all of the events in the current schema:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CURRENT_USER(), SCHEMA();</code></strong>
+----------------+----------+
| CURRENT_USER() | SCHEMA() |
+----------------+----------+
| jon@ghidora    | myschema |
+----------------+----------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW EVENTS\G</code></strong>
*************************** 1. row ***************************
                  Db: myschema
                Name: e_daily
             Definer: jon@ghidora
           Time zone: SYSTEM
                Type: RECURRING
          Execute at: NULL
      Interval value: 1
      Interval field: DAY
              Starts: 2018-08-08 11:06:34
                Ends: NULL
              Status: ENABLED
          Originator: 1
character_set_client: utf8mb4
collation_connection: utf8mb4_0900_ai_ci
  Database Collation: utf8mb4_0900_ai_ci
</pre><p>
        To see events for a specific schema, use the
        <code class="literal">FROM</code> clause. For example, to see events for
        the <code class="literal">test</code> schema, use the following statement:
      </p><pre data-lang="sql" class="programlisting">
SHOW EVENTS FROM test;
</pre><p>
        The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present,
        indicates which event names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-events" title="13.7.6.18 SHOW EVENTS Syntax"><code class="literal">SHOW EVENTS</code></a> output has these
        columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Db</code>
          </p><p>
            The name of the schema (database) to which the event
            belongs.
          </p></li><li class="listitem"><p>
            <code class="literal">Name</code>
          </p><p>
            The name of the event.
          </p></li><li class="listitem"><p>
            <code class="literal">Definer</code>
          </p><p>
            The account of the user who created the event, in
            <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>
            format.
          </p></li><li class="listitem"><p>
            <code class="literal">Time zone</code>
          </p><p>
            The event time zone, which is the time zone used for
            scheduling the event and that is in effect within the event
            as it executes. The default value is
            <code class="literal">SYSTEM</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Type</code>
          </p><p>
            The event repetition type, either <code class="literal">ONE
            TIME</code> (transient) or <code class="literal">RECURRING</code>
            (repeating).
          </p></li><li class="listitem"><p>
            <code class="literal">Execute At</code>
          </p><p>
            For a one-time event, this is the
            <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> value specified in
            the <code class="literal">AT</code> clause of the
            <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> statement used
            to create the event, or of the last
            <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement that
            modified the event. The value shown in this column reflects
            the addition or subtraction of any
            <code class="literal">INTERVAL</code> value included in the event's
            <code class="literal">AT</code> clause. For example, if an event is
            created using <code class="literal">ON SCHEDULE AT CURRENT_TIMESTAMP +
            '1:6' DAY_HOUR</code>, and the event was created at
            2018-02-09 14:05:30, the value shown in this column would be
            <code class="literal">'2018-02-10 20:05:30'</code>. If the event's
            timing is determined by an <code class="literal">EVERY</code> clause
            instead of an <code class="literal">AT</code> clause (that is, if the
            event is recurring), the value of this column is
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Interval Value</code>
          </p><p>
            For a recurring event, the number of intervals to wait
            between event executions. For a transient event, the value
            of this column is always <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Interval Field</code>
          </p><p>
            The time units used for the interval which a recurring event
            waits before repeating. For a transient event, the value of
            this column is always <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Starts</code>
          </p><p>
            The start date and time for a recurring event. This is
            displayed as a <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a>
            value, and is <code class="literal">NULL</code> if no start date and
            time are defined for the event. For a transient event, this
            column is always <code class="literal">NULL</code>. For a recurring
            event whose definition includes a <code class="literal">STARTS</code>
            clause, this column contains the corresponding
            <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> value. As with the
            <code class="literal">Execute At</code> column, this value resolves
            any expressions used. If there is no
            <code class="literal">STARTS</code> clause affecting the timing of the
            event, this column is <code class="literal">NULL</code>
          </p></li><li class="listitem"><p>
            <code class="literal">Ends</code>
          </p><p>
            For a recurring event whose definition includes a
            <code class="literal">ENDS</code> clause, this column contains the
            corresponding <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> value.
            As with the <code class="literal">Execute At</code> column, this value
            resolves any expressions used. If there is no
            <code class="literal">ENDS</code> clause affecting the timing of the
            event, this column is <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Status</code>
          </p><p>
            The event status. One of <code class="literal">ENABLED</code>,
            <code class="literal">DISABLED</code>, or
            <code class="literal">SLAVESIDE_DISABLED</code>.
            <code class="literal">SLAVESIDE_DISABLED</code> indicates that the
            creation of the event occurred on another MySQL server
            acting as a replication master and replicated to the current
            MySQL server which is acting as a slave, but the event is
            not presently being executed on the slave. For more
            information, see
            <a class="xref" href="replication.html#replication-features-invoked" title="17.4.1.16 Replication of Invoked Features">Section 17.4.1.16, “Replication of Invoked Features”</a>. information.
          </p></li><li class="listitem"><p>
            <code class="literal">Originator</code>
          </p><p>
            The server ID of the MySQL server on which the event was
            created; used in replication. This value may be updated by
            <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> to the server ID
            of the server on which that statement occurs, if executed on
            a master server. The default value is 0.
          </p></li><li class="listitem"><p>
            <code class="literal">character_set_client</code>
          </p><p>
            The session value of the
            <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
            variable when the event was created.
          </p></li><li class="listitem"><p>
            <code class="literal">collation_connection</code>
          </p><p>
            The session value of the
            <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
            variable when the event was created.
          </p></li><li class="listitem"><p>
            <code class="literal">Database Collation</code>
          </p><p>
            The collation of the database with which the event is
            associated.
</p></li></ul>
</div>
<p>
        For more information about <code class="literal">SLAVESIDE_DISABLED</code>
        and the <code class="literal">Originator</code> column, see
        <a class="xref" href="replication.html#replication-features-invoked" title="17.4.1.16 Replication of Invoked Features">Section 17.4.1.16, “Replication of Invoked Features”</a>.
      </p><p>
        Times displayed by <a class="link" href="sql-syntax.html#show-events" title="13.7.6.18 SHOW EVENTS Syntax"><code class="literal">SHOW EVENTS</code></a>
        are given in the event time zone, as discussed in
        <a class="xref" href="stored-objects.html#events-metadata" title="24.4.4 Event Metadata">Section 24.4.4, “Event Metadata”</a>.
      </p><p>
        Event information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#events-table" title="25.10 The INFORMATION_SCHEMA EVENTS Table"><code class="literal">EVENTS</code></a> table. See
        <a class="xref" href="information-schema.html#events-table" title="25.10 The INFORMATION_SCHEMA EVENTS Table">Section 25.10, “The INFORMATION_SCHEMA EVENTS Table”</a>.
      </p><p>
        The event action statement is not shown in the output of
        <a class="link" href="sql-syntax.html#show-events" title="13.7.6.18 SHOW EVENTS Syntax"><code class="literal">SHOW EVENTS</code></a>. Use
        <a class="link" href="sql-syntax.html#show-create-event" title="13.7.6.7 SHOW CREATE EVENT Syntax"><code class="literal">SHOW CREATE EVENT</code></a> or the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#events-table" title="25.10 The INFORMATION_SCHEMA EVENTS Table"><code class="literal">EVENTS</code></a> table.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-function-code"></a>13.7.6.19 SHOW FUNCTION CODE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655822384"></a><pre data-lang="sql" class="programlisting">
SHOW FUNCTION CODE <em class="replaceable"><code>func_name</code></em>
</pre><p>
        This statement is similar to <a class="link" href="sql-syntax.html#show-procedure-code" title="13.7.6.27 SHOW PROCEDURE CODE Syntax"><code class="literal">SHOW PROCEDURE
        CODE</code></a> but for stored functions. See
        <a class="xref" href="sql-syntax.html#show-procedure-code" title="13.7.6.27 SHOW PROCEDURE CODE Syntax">Section 13.7.6.27, “SHOW PROCEDURE CODE Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-function-status"></a>13.7.6.20 SHOW FUNCTION STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655813024"></a><pre data-lang="sql" class="programlisting">
SHOW FUNCTION STATUS
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        This statement is similar to <a class="link" href="sql-syntax.html#show-procedure-status" title="13.7.6.28 SHOW PROCEDURE STATUS Syntax"><code class="literal">SHOW PROCEDURE
        STATUS</code></a> but for stored functions. See
        <a class="xref" href="sql-syntax.html#show-procedure-status" title="13.7.6.28 SHOW PROCEDURE STATUS Syntax">Section 13.7.6.28, “SHOW PROCEDURE STATUS Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-grants"></a>13.7.6.21 SHOW GRANTS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655803344"></a><a class="indexterm" name="idm140091655801856"></a><a class="indexterm" name="idm140091655800368"></a><pre data-lang="sql" class="programlisting">
SHOW GRANTS
    [FOR <em class="replaceable"><code>user_or_role</code></em>
        [USING <em class="replaceable"><code>role</code></em> [, <em class="replaceable"><code>role</code></em>] ...]]

<em class="replaceable"><code>user_or_role</code></em>: {
    <em class="replaceable"><code>user</code></em>
  | <em class="replaceable"><code>role</code></em>
}
</pre><p>
        This statement displays the privileges and roles that are
        assigned to a MySQL user account or role, in the form of
        <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statements that must be
        executed to duplicate the privilege and role assignments.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          To display nonprivilege information for MySQL accounts, use
          the <a class="link" href="sql-syntax.html#show-create-user" title="13.7.6.12 SHOW CREATE USER Syntax"><code class="literal">SHOW CREATE USER</code></a> statement.
          See <a class="xref" href="sql-syntax.html#show-create-user" title="13.7.6.12 SHOW CREATE USER Syntax">Section 13.7.6.12, “SHOW CREATE USER Syntax”</a>.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> requires the
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the
        <code class="literal">mysql</code> system database, except to display
        privileges and roles for the current user.
      </p><p>
        To name the account or role for <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW
        GRANTS</code></a>, use the same format as for the
        <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a> statement (for example,
        <code class="literal">'jeffrey'@'localhost'</code>):
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR 'jeffrey'@'localhost';</code></strong>
+------------------------------------------------------------------+
| Grants for jeffrey@localhost                                     |
+------------------------------------------------------------------+
| GRANT USAGE ON *.* TO `jeffrey`@`localhost`                      |
| GRANT SELECT, INSERT, UPDATE ON `db1`.* TO `jeffrey`@`localhost` |
+------------------------------------------------------------------+
</pre><p>
        The host part, if omitted, defaults to <code class="literal">'%'</code>.
        For additional information about specifying account and role
        names, see <a class="xref" href="security.html#account-names" title="6.2.4 Specifying Account Names">Section 6.2.4, “Specifying Account Names”</a>, and
        <a class="xref" href="security.html#role-names" title="6.2.5 Specifying Role Names">Section 6.2.5, “Specifying Role Names”</a>.
      </p><p>
        To display the privileges granted to the current user (the
        account you are using to connect to the server), you can use any
        of the following statements:
      </p><pre data-lang="sql" class="programlisting">
SHOW GRANTS;
SHOW GRANTS FOR CURRENT_USER;
SHOW GRANTS FOR CURRENT_USER();
</pre><a class="indexterm" name="idm140091655774960"></a><a class="indexterm" name="idm140091655773472"></a><a class="indexterm" name="idm140091655772400"></a><a class="indexterm" name="idm140091655770912"></a><p>
        If <code class="literal">SHOW GRANTS FOR CURRENT_USER</code> (or any of
        the equivalent syntaxes) is used in definer context, such as
        within a stored procedure that executes with definer rather than
        invoker privileges, the grants displayed are those of the
        definer and not the invoker.
      </p><p>
        In MySQL 8.0 compared to previous series,
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> no longer displays
        <a class="link" href="security.html#priv_all"><code class="literal">ALL PRIVILEGES</code></a> in
        its global-privileges output because the meaning of
        <a class="link" href="security.html#priv_all"><code class="literal">ALL PRIVILEGES</code></a> at
        the global level varies depending on which dynamic privileges
        are defined. Instead, <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a>
        explictly lists each granted global privilege:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR 'root'@'localhost';</code></strong>
+---------------------------------------------------------------------+
| Grants for root@localhost                                           |
+---------------------------------------------------------------------+
| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD,         |
| SHUTDOWN, PROCESS, FILE, REFERENCES, INDEX, ALTER, SHOW DATABASES,  |
| SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION   |
| SLAVE, REPLICATION CLIENT, CREATE VIEW, SHOW VIEW, CREATE ROUTINE,  |
| ALTER ROUTINE, CREATE USER, EVENT, TRIGGER, CREATE TABLESPACE,      |
| CREATE ROLE, DROP ROLE ON *.* TO `root`@`localhost` WITH GRANT      |
| OPTION                                                              |
| GRANT PROXY ON ''@'' TO 'root'@'localhost' WITH GRANT OPTION        |
+---------------------------------------------------------------------+
</pre><p>
        Applications that process <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW
        GRANTS</code></a> output should be adjusted accordingly.
      </p><p>
        At the global level, <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>
        applies to all granted static global privileges if granted for
        any of them, but applies individually to granted dynamic
        privileges. <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> displays
        global privileges this way:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            One line listing all granted static privileges, if there are
            any, including <code class="literal">WITH GRANT OPTION</code> if
            appropriate.
          </p></li><li class="listitem"><p>
            One line listing all granted dynamic privileges for which
            <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> is granted, if
            there are any, including <code class="literal">WITH GRANT
            OPTION</code>.
          </p></li><li class="listitem"><p>
            One line listing all granted dynamic privileges for which
            <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> is not granted,
            if there are any, without <code class="literal">WITH GRANT
            OPTION</code>.
</p></li></ul>
</div>
<p>
        With the optional <code class="literal">USING</code> clause,
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> enables you to
        examine the privileges associated with roles for the user. Each
        role named in the <code class="literal">USING</code> clause must be
        granted to the user.
      </p><p>
        Suppose that user <code class="literal">u1</code> is assigned roles
        <code class="literal">r1</code> and <code class="literal">r2</code>, as follows:
      </p><pre data-lang="sql" class="programlisting">
CREATE ROLE 'r1', 'r2';
GRANT SELECT ON db1.* TO 'r1';
GRANT INSERT, UPDATE, DELETE ON db1.* TO 'r2';
CREATE USER 'u1'@'localhost' IDENTIFIED BY 'u1pass';
GRANT 'r1', 'r2' TO 'u1'@'localhost';
</pre><p>
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> without
        <code class="literal">USING</code> shows the granted roles:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR 'u1'@'localhost';</code></strong>
+---------------------------------------------+
| Grants for u1@localhost                     |
+---------------------------------------------+
| GRANT USAGE ON *.* TO `u1`@`localhost`      |
| GRANT `r1`@`%`,`r2`@`%` TO `u1`@`localhost` |
+---------------------------------------------+
</pre><p>
        Adding a <code class="literal">USING</code> clause causes the statement to
        also display the privileges associated with each role named in
        the clause:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR 'u1'@'localhost' USING 'r1';</code></strong>
+---------------------------------------------+
| Grants for u1@localhost                     |
+---------------------------------------------+
| GRANT USAGE ON *.* TO `u1`@`localhost`      |
| GRANT SELECT ON `db1`.* TO `u1`@`localhost` |
| GRANT `r1`@`%`,`r2`@`%` TO `u1`@`localhost` |
+---------------------------------------------+
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR 'u1'@'localhost' USING 'r2';</code></strong>
+-------------------------------------------------------------+
| Grants for u1@localhost                                     |
+-------------------------------------------------------------+
| GRANT USAGE ON *.* TO `u1`@`localhost`                      |
| GRANT INSERT, UPDATE, DELETE ON `db1`.* TO `u1`@`localhost` |
| GRANT `r1`@`%`,`r2`@`%` TO `u1`@`localhost`                 |
+-------------------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR 'u1'@'localhost' USING 'r1', 'r2';</code></strong>
+---------------------------------------------------------------------+
| Grants for u1@localhost                                             |
+---------------------------------------------------------------------+
| GRANT USAGE ON *.* TO `u1`@`localhost`                              |
| GRANT SELECT, INSERT, UPDATE, DELETE ON `db1`.* TO `u1`@`localhost` |
| GRANT `r1`@`%`,`r2`@`%` TO `u1`@`localhost`                         |
+---------------------------------------------------------------------+
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          A privilege granted to an account is always in effect, but a
          role is not. The active roles for an account can differ across
          and within sessions, depending on the value of the
          <a class="link" href="server-administration.html#sysvar_activate_all_roles_on_login"><code class="literal">activate_all_roles_on_login</code></a>
          system variable, the account default roles, and whether
          <a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE Syntax"><code class="literal">SET ROLE</code></a> has been executed
          within a session.
</p>
</div>
<p>
        MySQL 8.0.16 and higher supports partial revokes of global
        privileges, such that a global privilege can be restricted from
        applying to particular schemas (see
        <a class="xref" href="security.html#partial-revokes" title="6.2.12 Privilege Restriction Using Partial Revokes">Section 6.2.12, “Privilege Restriction Using Partial Revokes”</a>). To indicate which global
        schema privileges have been revoked for particular schemas,
        <code class="literal">SHOW GRANTS</code> output includes
        <code class="literal">REVOKE</code> statements:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET PERSIST partial_revokes = ON;</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE USER u1;</code></strong>
mysql&gt; <strong class="userinput"><code>GRANT SELECT, INSERT, DELETE ON *.* TO u1;</code></strong>
mysql&gt; <strong class="userinput"><code>REVOKE SELECT, INSERT ON mysql.* FROM u1;</code></strong>
mysql&gt; <strong class="userinput"><code>REVOKE DELETE ON world.* FROM u1;</code></strong>
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR u1;</code></strong>
+--------------------------------------------------+
| Grants for u1@%                                  |
+--------------------------------------------------+
| GRANT SELECT, INSERT, DELETE ON *.* TO `u1`@`%`  |
| REVOKE SELECT, INSERT ON `mysql`.* FROM `u1`@`%` |
| REVOKE DELETE ON `world`.* FROM `u1`@`%`         |
+--------------------------------------------------+
</pre><p>
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> does not display
        privileges that are available to the named account but are
        granted to a different account. For example, if an anonymous
        account exists, the named account might be able to use its
        privileges, but <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> does
        not display them.
      </p><p>
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> displays mandatory
        roles named in the
        <a class="link" href="server-administration.html#sysvar_mandatory_roles"><code class="literal">mandatory_roles</code></a> system variable
        value as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> without a
            <code class="literal">FOR</code> clause displays privileges for the
            current user, and includes mandatory roles.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS FOR
            <em class="replaceable"><code>user</code></em></code></a> displays
            privileges for the named user, and does not include
            mandatory roles.
</p></li></ul>
</div>
<p>
        This behavior is for the benefit of applications that use the
        output of <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW
        GRANTS FOR <em class="replaceable"><code>user</code></em></code></a> to
        determine which privileges are granted explicitly to the named
        user. Were that output to include mandatory roles, it would be
        difficult to distinguish roles granted explicitly to the user
        from mandatory roles.
      </p><p>
        For the current user, applications can determine privileges with
        or without mandatory roles by using <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW
        GRANTS</code></a> or
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS FOR
        CURRENT_USER</code></a>, respectively.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-index"></a>13.7.6.22 SHOW INDEX Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655699488"></a><a class="indexterm" name="idm140091655697584"></a><a class="indexterm" name="idm140091655696512"></a><pre data-lang="sql" class="programlisting">
SHOW [EXTENDED] {INDEX | INDEXES | KEYS}
    {FROM | IN} <em class="replaceable"><code>tbl_name</code></em>
    [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-index" title="13.7.6.22 SHOW INDEX Syntax"><code class="literal">SHOW INDEX</code></a> returns table index
        information. The format resembles that of the
        <code class="literal">SQLStatistics</code> call in ODBC. This statement
        requires some privilege for any column in the table.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW INDEX FROM City\G</code></strong>
*************************** 1. row ***************************
        Table: city
   Non_unique: 0
     Key_name: PRIMARY
 Seq_in_index: 1
  Column_name: ID
    Collation: A
  Cardinality: 4188
     Sub_part: NULL
       Packed: NULL
         Null:
   Index_type: BTREE
      Comment:
Index_comment:
      Visible: YES
   Expression: NULL
*************************** 2. row ***************************
        Table: city
   Non_unique: 1
     Key_name: CountryCode
 Seq_in_index: 1
  Column_name: CountryCode
    Collation: A
  Cardinality: 232
     Sub_part: NULL
       Packed: NULL
         Null:
   Index_type: BTREE
      Comment:
Index_comment:
      Visible: YES
   Expression: NULL
</pre><p>
        An alternative to <code class="literal"><em class="replaceable"><code>tbl_name</code></em>
        FROM <em class="replaceable"><code>db_name</code></em></code> syntax is
        <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em>.
        These two statements are equivalent:
      </p><pre data-lang="sql" class="programlisting">
SHOW INDEX FROM mytable FROM mydb;
SHOW INDEX FROM mydb.mytable;
</pre><p>
        The optional <code class="literal">EXTENDED</code> keyword causes the
        output to include information about hidden indexes that MySQL
        uses internally and are not accessible by users.
      </p><p>
        The <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-index" title="13.7.6.22 SHOW INDEX Syntax"><code class="literal">SHOW INDEX</code></a> returns the following
        fields:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Table</code>
          </p><p>
            The name of the table.
          </p></li><li class="listitem"><p>
            <code class="literal">Non_unique</code>
          </p><p>
            0 if the index cannot contain duplicates, 1 if it can.
          </p></li><li class="listitem"><p>
            <code class="literal">Key_name</code>
          </p><p>
            The name of the index. If the index is the primary key, the
            name is always <code class="literal">PRIMARY</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Seq_in_index</code>
          </p><p>
            The column sequence number in the index, starting with 1.
          </p></li><li class="listitem"><p>
            <code class="literal">Column_name</code>
          </p><p>
            The column name. See also the description for the
            <code class="literal">Expression</code> column.
          </p></li><li class="listitem"><p>
            <code class="literal">Collation</code>
          </p><a class="indexterm" name="idm140091655664672"></a><p>
            How the column is sorted in the index. This can have values
            <code class="literal">A</code> (ascending), <code class="literal">D</code>
            (descending), or <code class="literal">NULL</code> (not sorted).
          </p></li><li class="listitem"><p>
            <code class="literal">Cardinality</code>
          </p><a class="indexterm" name="idm140091655658704"></a><a class="indexterm" name="idm140091655656800"></a><p>
            An estimate of the number of unique values in the index. To
            update this number, run <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
            TABLE</code></a> or (for <code class="literal">MyISAM</code> tables)
            <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk -a</strong></span></a>.
          </p><p>
            <code class="literal">Cardinality</code> is counted based on
            statistics stored as integers, so the value is not
            necessarily exact even for small tables. The higher the
            cardinality, the greater the chance that MySQL uses the
            index when doing joins.
          </p></li><li class="listitem"><p>
            <code class="literal">Sub_part</code>
          </p><p>
            The index prefix. That is, the number of indexed characters
            if the column is only partly indexed,
            <code class="literal">NULL</code> if the entire column is indexed.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Prefix <span class="emphasis"><em>limits</em></span> are measured in bytes.
              However, prefix <span class="emphasis"><em>lengths</em></span> for index
              specifications in <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
              TABLE</code></a>, <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
              TABLE</code></a>, and <a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax"><code class="literal">CREATE
              INDEX</code></a> statements are interpreted as number of
              characters for nonbinary string types
              (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
              <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>) and number of bytes
              for binary string types
              (<a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
              <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>,
              <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>). Take this into
              account when specifying a prefix length for a nonbinary
              string column that uses a multibyte character set.
</p>
</div>
<p>
            For additional information about index prefixes, see
            <a class="xref" href="optimization.html#column-indexes" title="8.3.5 Column Indexes">Section 8.3.5, “Column Indexes”</a>, and
            <a class="xref" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX Syntax">Section 13.1.15, “CREATE INDEX Syntax”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Packed</code>
          </p><p>
            Indicates how the key is packed. <code class="literal">NULL</code> if
            it is not.
          </p></li><li class="listitem"><p>
            <code class="literal">Null</code>
          </p><p>
            Contains <code class="literal">YES</code> if the column may contain
            <code class="literal">NULL</code> values and <code class="literal">''</code> if
            not.
          </p></li><li class="listitem"><p>
            <code class="literal">Index_type</code>
          </p><p>
            The index method used (<code class="literal">BTREE</code>,
            <code class="literal">FULLTEXT</code>, <code class="literal">HASH</code>,
            <code class="literal">RTREE</code>).
          </p></li><li class="listitem"><p>
            <code class="literal">Comment</code>
          </p><p>
            Information about the index not described in its own column,
            such as <code class="literal">disabled</code> if the index is
            disabled.
          </p></li><li class="listitem"><p>
            <code class="literal">Index_comment</code>
          </p><p>
            Any comment provided for the index with a
            <code class="literal">COMMENT</code> attribute when the index was
            created.
          </p></li><li class="listitem"><p>
            <code class="literal">Visible</code>
          </p><p>
            Whether the index is visible to the optimizer. See
            <a class="xref" href="optimization.html#invisible-indexes" title="8.3.12 Invisible Indexes">Section 8.3.12, “Invisible Indexes”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Expression</code>
          </p><p>
            MySQL 8.0.13 and higher supports functional key parts (see
            <a class="xref" href="sql-syntax.html#create-index-functional-key-parts" title="Functional Key Parts">Functional Key Parts</a>), which
            affects both the <code class="literal">Column_name</code> and
            <code class="literal">Expression</code> columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                For a nonfunctional key part,
                <code class="literal">Column_name</code> indicates the column
                indexed by the key part and
                <code class="literal">Expression</code> is
                <code class="literal">NULL</code>.
              </p></li><li class="listitem"><p>
                For a functional key part,
                <code class="literal">Column_name</code> column is
                <code class="literal">NULL</code> and
                <code class="literal">Expression</code> indicates the expression
                for the key part.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
        Information about table indexes is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#statistics-table" title="25.26 The INFORMATION_SCHEMA STATISTICS Table"><code class="literal">STATISTICS</code></a> table. See
        <a class="xref" href="information-schema.html#statistics-table" title="25.26 The INFORMATION_SCHEMA STATISTICS Table">Section 25.26, “The INFORMATION_SCHEMA STATISTICS Table”</a>. The extended information
        about hidden indexes is available only using <code class="literal">SHOW
        EXTENDED INDEX</code>; it cannot be obtained from the
        <a class="link" href="information-schema.html#statistics-table" title="25.26 The INFORMATION_SCHEMA STATISTICS Table"><code class="literal">STATISTICS</code></a> table.
      </p><p>
        You can list a table's indexes with the <a class="link" href="programs.html#mysqlshow" title="4.5.7 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow -k
        <em class="replaceable"><code>db_name</code></em>
        <em class="replaceable"><code>tbl_name</code></em></strong></span></a> command.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-master-status"></a>13.7.6.23 SHOW MASTER STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655592912"></a><pre data-lang="sql" class="programlisting">
SHOW MASTER STATUS
</pre><p>
        This statement provides status information about the binary log
        files of the master. It requires either the
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> or
        <a class="link" href="security.html#priv_replication-client"><code class="literal">REPLICATION CLIENT</code></a> privilege.
      </p><p>
        Example:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW MASTER STATUS\G</code></strong>
*************************** 1. row ***************************
             File: master-bin.000002
         Position: 1307
     Binlog_Do_DB: test
 Binlog_Ignore_DB: manual, mysql
Executed_Gtid_Set: 3E11FA47-71CA-11E1-9E33-C80AA9429562:1-5
1 row in set (0.00 sec)
</pre><p>
        When global transaction IDs are in use,
        <code class="literal">Executed_Gtid_Set</code> shows the set of GTIDs for
        transactions that have been executed on the master. This is the
        same as the value for the
        <a class="link" href="replication.html#sysvar_gtid_executed"><code class="literal">gtid_executed</code></a> system variable
        on this server, as well as the value for
        <code class="literal">Executed_Gtid_Set</code> in the output of
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> on this server.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-open-tables"></a>13.7.6.24 SHOW OPEN TABLES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655576656"></a><a class="indexterm" name="idm140091655574752"></a><pre data-lang="sql" class="programlisting">
SHOW OPEN TABLES
    [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-open-tables" title="13.7.6.24 SHOW OPEN TABLES Syntax"><code class="literal">SHOW OPEN TABLES</code></a> lists the
        non-<code class="literal">TEMPORARY</code> tables that are currently open
        in the table cache. See <a class="xref" href="optimization.html#table-cache" title="8.4.3.1 How MySQL Opens and Closes Tables">Section 8.4.3.1, “How MySQL Opens and Closes Tables”</a>. The
        <code class="literal">FROM</code> clause, if present, restricts the tables
        shown to those present in the <em class="replaceable"><code>db_name</code></em>
        database. The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if
        present, indicates which table names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-open-tables" title="13.7.6.24 SHOW OPEN TABLES Syntax"><code class="literal">SHOW OPEN TABLES</code></a> output has these
        columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Database</code>
          </p><p>
            The database containing the table.
          </p></li><li class="listitem"><p>
            <code class="literal">Table</code>
          </p><p>
            The table name.
          </p></li><li class="listitem"><p>
            <code class="literal">In_use</code>
          </p><p>
            The number of table locks or lock requests there are for the
            table. For example, if one client acquires a lock for a
            table using <code class="literal">LOCK TABLE t1 WRITE</code>,
            <code class="literal">In_use</code> will be 1. If another client
            issues <code class="literal">LOCK TABLE t1 WRITE</code> while the
            table remains locked, the client will block waiting for the
            lock, but the lock request causes <code class="literal">In_use</code>
            to be 2. If the count is zero, the table is open but not
            currently being used. <code class="literal">In_use</code> is also
            increased by the
            <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER Syntax"><code class="literal">HANDLER ...
            OPEN</code></a> statement and decreased by
            <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER Syntax"><code class="literal">HANDLER ...
            CLOSE</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Name_locked</code>
          </p><p>
            Whether the table name is locked. Name locking is used for
            operations such as dropping or renaming tables.
</p></li></ul>
</div>
<p>
        If you have no privileges for a table, it does not show up in
        the output from <a class="link" href="sql-syntax.html#show-open-tables" title="13.7.6.24 SHOW OPEN TABLES Syntax"><code class="literal">SHOW OPEN TABLES</code></a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-plugins"></a>13.7.6.25 SHOW PLUGINS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655541920"></a><pre data-lang="sql" class="programlisting">
SHOW PLUGINS
</pre><p>
        <a class="link" href="sql-syntax.html#show-plugins" title="13.7.6.25 SHOW PLUGINS Syntax"><code class="literal">SHOW PLUGINS</code></a> displays information
        about server plugins.
      </p><p>
        Example of <a class="link" href="sql-syntax.html#show-plugins" title="13.7.6.25 SHOW PLUGINS Syntax"><code class="literal">SHOW PLUGINS</code></a> output:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW PLUGINS\G</code></strong>
*************************** 1. row ***************************
   Name: binlog
 Status: ACTIVE
   Type: STORAGE ENGINE
Library: NULL
License: GPL
*************************** 2. row ***************************
   Name: CSV
 Status: ACTIVE
   Type: STORAGE ENGINE
Library: NULL
License: GPL
*************************** 3. row ***************************
   Name: MEMORY
 Status: ACTIVE
   Type: STORAGE ENGINE
Library: NULL
License: GPL
*************************** 4. row ***************************
   Name: MyISAM
 Status: ACTIVE
   Type: STORAGE ENGINE
Library: NULL
License: GPL
...
</pre><p>
        <a class="link" href="sql-syntax.html#show-plugins" title="13.7.6.25 SHOW PLUGINS Syntax"><code class="literal">SHOW PLUGINS</code></a> output has these
        columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Name</code>
          </p><p>
            The name used to refer to the plugin in statements such as
            <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> and
            <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Status</code>
          </p><p>
            The plugin status, one of <code class="literal">ACTIVE</code>,
            <code class="literal">INACTIVE</code>, <code class="literal">DISABLED</code>,
            <code class="literal">DELETING</code>, or <code class="literal">DELETED</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Type</code>
          </p><p>
            The type of plugin, such as <code class="literal">STORAGE
            ENGINE</code>, <code class="literal">INFORMATION_SCHEMA</code>, or
            <code class="literal">AUTHENTICATION</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Library</code>
          </p><p>
            The name of the plugin shared library file. This is the name
            used to refer to the plugin file in statements such as
            <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> and
            <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a>. This file
            is located in the directory named by the
            <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> system variable.
            If the library name is <code class="literal">NULL</code>, the plugin
            is compiled in and cannot be uninstalled with
            <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">License</code>
          </p><p>
            How the plugin is licensed (for example,
            <code class="literal">GPL</code>).
</p></li></ul>
</div>
<p>
        For plugins installed with <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL
        PLUGIN</code></a>, the <code class="literal">Name</code> and
        <code class="literal">Library</code> values are also registered in the
        <code class="literal">mysql.plugin</code> system table.
      </p><p>
        For information about plugin data structures that form the basis
        of the information displayed by <a class="link" href="sql-syntax.html#show-plugins" title="13.7.6.25 SHOW PLUGINS Syntax"><code class="literal">SHOW
        PLUGINS</code></a>, see <a class="xref" href="extending-mysql.html#plugin-api" title="29.2 The MySQL Plugin API">Section 29.2, “The MySQL Plugin API”</a>.
      </p><p>
        Plugin information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <code class="literal">.PLUGINS</code> table. See
        <a class="xref" href="information-schema.html#plugins-table" title="25.18 The INFORMATION_SCHEMA PLUGINS Table">Section 25.18, “The INFORMATION_SCHEMA PLUGINS Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-privileges"></a>13.7.6.26 SHOW PRIVILEGES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655494832"></a><pre data-lang="sql" class="programlisting">
SHOW PRIVILEGES
</pre><p>
        <a class="link" href="sql-syntax.html#show-privileges" title="13.7.6.26 SHOW PRIVILEGES Syntax"><code class="literal">SHOW PRIVILEGES</code></a> shows the list of
        system privileges that the MySQL server supports. The privileges
        displayed include all static privileges, and all currently
        registered dynamic privileges.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW PRIVILEGES\G</code></strong>
*************************** 1. row ***************************
Privilege: Alter
  Context: Tables
  Comment: To alter the table
*************************** 2. row ***************************
Privilege: Alter routine
  Context: Functions,Procedures
  Comment: To alter or drop stored functions/procedures
*************************** 3. row ***************************
Privilege: Create
  Context: Databases,Tables,Indexes
  Comment: To create new databases and tables
*************************** 4. row ***************************
Privilege: Create routine
  Context: Databases
  Comment: To use CREATE FUNCTION/PROCEDURE
*************************** 5. row ***************************
Privilege: Create temporary tables
  Context: Databases
  Comment: To use CREATE TEMPORARY TABLE
...
</pre><p>
        Privileges belonging to a specific user are displayed by the
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> statement. See
        <a class="xref" href="sql-syntax.html#show-grants" title="13.7.6.21 SHOW GRANTS Syntax">Section 13.7.6.21, “SHOW GRANTS Syntax”</a>, for more information.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-procedure-code"></a>13.7.6.27 SHOW PROCEDURE CODE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655481216"></a><pre data-lang="sql" class="programlisting">
SHOW PROCEDURE CODE <em class="replaceable"><code>proc_name</code></em>
</pre><p>
        This statement is a MySQL extension that is available only for
        servers that have been built with debugging support. It displays
        a representation of the internal implementation of the named
        stored procedure. A similar statement, <a class="link" href="sql-syntax.html#show-function-code" title="13.7.6.19 SHOW FUNCTION CODE Syntax"><code class="literal">SHOW
        FUNCTION CODE</code></a>, displays information about stored
        functions (see <a class="xref" href="sql-syntax.html#show-function-code" title="13.7.6.19 SHOW FUNCTION CODE Syntax">Section 13.7.6.19, “SHOW FUNCTION CODE Syntax”</a>).
      </p><p>
        To use either statement, you must have the global
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> privilege.
      </p><p>
        If the named routine is available, each statement produces a
        result set. Each row in the result set corresponds to one
        <span class="quote">“<span class="quote">instruction</span>”</span> in the routine. The first column is
        <code class="literal">Pos</code>, which is an ordinal number beginning
        with 0. The second column is <code class="literal">Instruction</code>,
        which contains an SQL statement (usually changed from the
        original source), or a directive which has meaning only to the
        stored-routine handler.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>DELIMITER //</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE p1 ()</code></strong>
    -&gt; <strong class="userinput"><code>BEGIN</code></strong>
    -&gt;   <strong class="userinput"><code>DECLARE fanta INT DEFAULT 55;</code></strong>
    -&gt;   <strong class="userinput"><code>DROP TABLE t2;</code></strong>
    -&gt;   <strong class="userinput"><code>LOOP</code></strong>
    -&gt;     <strong class="userinput"><code>INSERT INTO t3 VALUES (fanta);</code></strong>
    -&gt;     <strong class="userinput"><code>END LOOP;</code></strong>
    -&gt;   <strong class="userinput"><code>END//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW PROCEDURE CODE p1//</code></strong>
+-----+----------------------------------------+
| Pos | Instruction                            |
+-----+----------------------------------------+
|   0 | set fanta@0 55                         |
|   1 | stmt 9 "DROP TABLE t2"                 |
|   2 | stmt 5 "INSERT INTO t3 VALUES (fanta)" |
|   3 | jump 2                                 |
+-----+----------------------------------------+
4 rows in set (0.00 sec)
</pre><p>
        In this example, the nonexecutable <code class="literal">BEGIN</code> and
        <code class="literal">END</code> statements have disappeared, and for the
        <code class="literal">DECLARE
        <em class="replaceable"><code>variable_name</code></em></code> statement,
        only the executable part appears (the part where the default is
        assigned). For each statement that is taken from source, there
        is a code word <code class="literal">stmt</code> followed by a type (9
        means <code class="literal">DROP</code>, 5 means
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>, and so on). The final row
        contains an instruction <code class="literal">jump 2</code>, meaning
        <code class="literal">GOTO instruction #2</code>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-procedure-status"></a>13.7.6.28 SHOW PROCEDURE STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655450928"></a><pre data-lang="sql" class="programlisting">
SHOW PROCEDURE STATUS
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        This statement is a MySQL extension. It returns characteristics
        of a stored procedure, such as the database, name, type,
        creator, creation and modification dates, and character set
        information. A similar statement, <a class="link" href="sql-syntax.html#show-function-status" title="13.7.6.20 SHOW FUNCTION STATUS Syntax"><code class="literal">SHOW
        FUNCTION STATUS</code></a>, displays information about stored
        functions (see <a class="xref" href="sql-syntax.html#show-function-status" title="13.7.6.20 SHOW FUNCTION STATUS Syntax">Section 13.7.6.20, “SHOW FUNCTION STATUS Syntax”</a>).
      </p><p>
        The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present,
        indicates which procedure or function names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW PROCEDURE STATUS LIKE 'sp1'\G</code></strong>
*************************** 1. row ***************************
                  Db: test
                Name: sp1
                Type: PROCEDURE
             Definer: testuser@localhost
            Modified: 2018-08-08 13:54:11
             Created: 2018-08-08 13:54:11
       Security_type: DEFINER
             Comment:
character_set_client: utf8mb4
collation_connection: utf8mb4_0900_ai_ci
  Database Collation: utf8mb4_0900_ai_ci
</pre><p>
        <code class="literal">character_set_client</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
        variable when the routine was created.
        <code class="literal">collation_connection</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
        variable when the routine was created. <code class="literal">Database
        Collation</code> is the collation of the database with which
        the routine is associated.
      </p><p>
        Stored routine information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#parameters-table" title="25.16 The INFORMATION_SCHEMA PARAMETERS Table"><code class="literal">PARAMETERS</code></a> and
        <a class="link" href="information-schema.html#routines-table" title="25.23 The INFORMATION_SCHEMA ROUTINES Table"><code class="literal">ROUTINES</code></a> tables. See
        <a class="xref" href="information-schema.html#parameters-table" title="25.16 The INFORMATION_SCHEMA PARAMETERS Table">Section 25.16, “The INFORMATION_SCHEMA PARAMETERS Table”</a>, and
        <a class="xref" href="information-schema.html#routines-table" title="25.23 The INFORMATION_SCHEMA ROUTINES Table">Section 25.23, “The INFORMATION_SCHEMA ROUTINES Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-processlist"></a>13.7.6.29 SHOW PROCESSLIST Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655424224"></a><a class="indexterm" name="idm140091655423152"></a><a class="indexterm" name="idm140091655422080"></a><a class="indexterm" name="idm140091655420992"></a><a class="indexterm" name="idm140091655419504"></a><a class="indexterm" name="idm140091655418016"></a><pre data-lang="sql" class="programlisting">
SHOW [FULL] PROCESSLIST
</pre><p>
        <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> shows which
        threads are running. If you have the
        <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a> privilege, you can see
        all threads. Otherwise, you can see only your own threads (that
        is, threads associated with the MySQL account that you are
        using). If you do not use the <code class="literal">FULL</code> keyword,
        only the first 100 characters of each statement are shown in the
        <code class="literal">Info</code> field.
      </p><p>
        The <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> statement is
        very useful if you get the <span class="quote">“<span class="quote">too many connections</span>”</span>
        error message and want to find out what is going on. MySQL
        reserves one extra connection to be used by accounts that have
        the <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, to ensure that
        administrators should always be able to connect and check the
        system (assuming that you are not giving this privilege to all
        your users).
      </p><p>
        Threads can be killed with the
        <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL</code></a> statement. See
        <a class="xref" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax">Section 13.7.7.4, “KILL Syntax”</a>.
      </p><p>
        Example of <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>
        output:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; SHOW FULL PROCESSLIST\G
*************************** 1. row ***************************
Id: 1
User: system user
Host:
db: NULL
Command: Connect
Time: 1030455
State: Waiting for master to send event
Info: NULL
*************************** 2. row ***************************
Id: 2
User: system user
Host:
db: NULL
Command: Connect
Time: 1004
State: Has read all relay log; waiting for the slave
       I/O thread to update it
Info: NULL
*************************** 3. row ***************************
Id: 3112
User: replikator
Host: artemis:2204
db: NULL
Command: Binlog Dump
Time: 2144
State: Has sent all binlog to slave; waiting for binlog to be updated
Info: NULL
*************************** 4. row ***************************
Id: 3113
User: replikator
Host: iconnect2:45781
db: NULL
Command: Binlog Dump
Time: 2086
State: Has sent all binlog to slave; waiting for binlog to be updated
Info: NULL
*************************** 5. row ***************************
Id: 3123
User: stefan
Host: localhost
db: apollon
Command: Query
Time: 0
State: NULL
Info: SHOW FULL PROCESSLIST
5 rows in set (0.00 sec)
</pre><p>
        <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> output has these
        columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="processlist_id"></a>
            <code class="literal">Id</code>
          </p><p>
            The connection identifier. This is the same type of value
            displayed in the <code class="literal">ID</code> column of the
            <code class="literal">INFORMATION_SCHEMA</code>
            <a class="link" href="information-schema.html#processlist-table" title="25.19 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">PROCESSLIST</code></a> table, the
            <code class="literal">PROCESSLIST_ID</code> column of the Performance
            Schema <a class="link" href="performance-schema.html#threads-table" title="26.12.17.5 The threads Table"><code class="literal">threads</code></a> table, and
            returned by the
            <a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a> function.
          </p></li><li class="listitem"><p><a name="processlist_user"></a>
            <code class="literal">User</code>
          </p><p>
            The MySQL user who issued the statement. A value of
            <code class="literal">system user</code> refers to a nonclient thread
            spawned by the server to handle tasks internally. This could
            be the I/O or SQL thread used on replication slaves or a
            delayed-row handler. For <code class="literal">system user</code>,
            there is no host specified in the <code class="literal">Host</code>
            column. <code class="literal">unauthenticated user</code> refers to a
            thread that has become associated with a client connection
            but for which authentication of the client user has not yet
            been done. <code class="literal">event_scheduler</code> refers to the
            thread that monitors scheduled events (see
            <a class="xref" href="stored-objects.html#event-scheduler" title="24.4 Using the Event Scheduler">Section 24.4, “Using the Event Scheduler”</a>).
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              A <code class="literal">User</code> value of <code class="literal">system
              user</code> is distinct from the
              <a class="link" href="security.html#priv_system-user"><code class="literal">SYSTEM_USER</code></a> privilege. The
              former designates internal threads. The latter
              distinguishes the system user and regular user account
              categories (see <a class="xref" href="security.html#account-categories" title="6.2.11 Account Categories">Section 6.2.11, “Account Categories”</a>).
</p>
</div>
</li><li class="listitem"><p><a name="processlist_host"></a>
            <code class="literal">Host</code>
          </p><p>
            The host name of the client issuing the statement (except
            for <code class="literal">system user</code>, for which there is no
            host). The host name for TCP/IP connections is reported in
            <code class="literal"><em class="replaceable"><code>host_name</code></em>:<em class="replaceable"><code>client_port</code></em></code>
            format to make it easier to determine which client is doing
            what.
          </p></li><li class="listitem"><p><a name="processlist_db"></a>
            <code class="literal">db</code>
          </p><p>
            The default database, if one is selected; otherwise
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p><a name="processlist_command"></a>
            <code class="literal">Command</code>
          </p><p>
            The type of command the thread is executing. For
            descriptions for thread commands, see
            <a class="xref" href="optimization.html#thread-information" title="8.14 Examining Thread Information">Section 8.14, “Examining Thread Information”</a>. The value of this
            column corresponds to the
            <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code>
            commands of the client/server protocol and
            <code class="literal">Com_<em class="replaceable"><code>xxx</code></em></code> status
            variables. See <a class="xref" href="server-administration.html#server-status-variables" title="5.1.10 Server Status Variables">Section 5.1.10, “Server Status Variables”</a>.
          </p></li><li class="listitem"><p><a name="processlist_time"></a>
            <code class="literal">Time</code>
          </p><p>
            The time in seconds that the thread has been in its current
            state. For a slave SQL thread, the value is the number of
            seconds between the timestamp of the last replicated event
            and the real time of the slave machine. See
            <a class="xref" href="replication.html#replication-implementation-details" title="17.2.2 Replication Implementation Details">Section 17.2.2, “Replication Implementation Details”</a>.
          </p></li><li class="listitem"><p><a name="processlist_state"></a>
            <code class="literal">State</code>
          </p><p>
            An action, event, or state that indicates what the thread is
            doing. Descriptions for <code class="literal">State</code> values can
            be found at <a class="xref" href="optimization.html#thread-information" title="8.14 Examining Thread Information">Section 8.14, “Examining Thread Information”</a>.
          </p><p>
            Most states correspond to very quick operations. If a thread
            stays in a given state for many seconds, there might be a
            problem that needs to be investigated.
          </p><p>
            For the <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>
            statement, the value of <code class="literal">State</code> is
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p><a name="processlist_info"></a>
            <code class="literal">Info</code>
          </p><p>
            The statement the thread is executing, or
            <code class="literal">NULL</code> if it is not executing any
            statement. The statement might be the one sent to the
            server, or an innermost statement if the statement executes
            other statements. For example, if a <code class="literal">CALL</code>
            statement executes a stored procedure that is executing a
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement, the
            <code class="literal">Info</code> value shows the
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
</p></li></ul>
</div>
<p>
        Process information is also available from the
        <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin processlist</strong></span></a> command, the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#processlist-table" title="25.19 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">PROCESSLIST</code></a> table, and the
        Performance Schema <a class="link" href="performance-schema.html#threads-table" title="26.12.17.5 The threads Table"><code class="literal">threads</code></a> table
        (see <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>,
        <a class="xref" href="information-schema.html#processlist-table" title="25.19 The INFORMATION_SCHEMA PROCESSLIST Table">Section 25.19, “The INFORMATION_SCHEMA PROCESSLIST Table”</a>, and
        <a class="xref" href="performance-schema.html#threads-table" title="26.12.17.5 The threads Table">Section 26.12.17.5, “The threads Table”</a>). In contrast to the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#processlist-table" title="25.19 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">PROCESSLIST</code></a> table and
        <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> statement, which
        have negative performance consequences because they require a
        mutex, access to <a class="link" href="performance-schema.html#threads-table" title="26.12.17.5 The threads Table"><code class="literal">threads</code></a> does not
        require a mutex and has minimal impact on server performance.
        The <a class="link" href="performance-schema.html#threads-table" title="26.12.17.5 The threads Table"><code class="literal">threads</code></a> table also shows
        information about background threads, which the
        <a class="link" href="information-schema.html#processlist-table" title="25.19 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">PROCESSLIST</code></a> table and
        <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> do not. This
        means that <a class="link" href="performance-schema.html#threads-table" title="26.12.17.5 The threads Table"><code class="literal">threads</code></a> can be used to
        monitor activity the other thread information sources cannot.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-profile"></a>13.7.6.30 SHOW PROFILE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655324368"></a><a class="indexterm" name="idm140091655323296"></a><pre data-lang="sql" class="programlisting">
SHOW PROFILE [<em class="replaceable"><code>type</code></em> [, <em class="replaceable"><code>type</code></em>] ... ]
    [FOR QUERY <em class="replaceable"><code>n</code></em>]
    [LIMIT <em class="replaceable"><code>row_count</code></em> [OFFSET <em class="replaceable"><code>offset</code></em>]]

<em class="replaceable"><code>type</code></em>: {
    ALL
  | BLOCK IO
  | CONTEXT SWITCHES
  | CPU
  | IPC
  | MEMORY
  | PAGE FAULTS
  | SOURCE
  | SWAPS
}
</pre><p>
        The <a class="link" href="sql-syntax.html#show-profile" title="13.7.6.30 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> and
        <a class="link" href="sql-syntax.html#show-profiles" title="13.7.6.31 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a> statements display
        profiling information that indicates resource usage for
        statements executed during the course of the current session.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          The <a class="link" href="sql-syntax.html#show-profile" title="13.7.6.30 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> and
          <a class="link" href="sql-syntax.html#show-profiles" title="13.7.6.31 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a> statements are
          deprecated and will be removed in a future MySQL release. Use
          the <a class="link" href="performance-schema.html" title="Chapter 26 MySQL Performance Schema">Performance
          Schema</a> instead; see
          <a class="xref" href="performance-schema.html#performance-schema-query-profiling" title="26.19.1 Query Profiling Using Performance Schema">Section 26.19.1, “Query Profiling Using Performance Schema”</a>.
</p>
</div>
<p>
        To control profiling, use the
        <a class="link" href="server-administration.html#sysvar_profiling"><code class="literal">profiling</code></a> session variable,
        which has a default value of 0 (<code class="literal">OFF</code>). Enable
        profiling by setting <a class="link" href="server-administration.html#sysvar_profiling"><code class="literal">profiling</code></a>
        to 1 or <code class="literal">ON</code>:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET profiling = 1;</code></strong>
</pre><p>
        <a class="link" href="sql-syntax.html#show-profiles" title="13.7.6.31 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a> displays a list of
        the most recent statements sent to the server. The size of the
        list is controlled by the
        <a class="link" href="server-administration.html#sysvar_profiling_history_size"><code class="literal">profiling_history_size</code></a> session
        variable, which has a default value of 15. The maximum value is
        100. Setting the value to 0 has the practical effect of
        disabling profiling.
      </p><p>
        All statements are profiled except <a class="link" href="sql-syntax.html#show-profile" title="13.7.6.30 SHOW PROFILE Syntax"><code class="literal">SHOW
        PROFILE</code></a> and <a class="link" href="sql-syntax.html#show-profiles" title="13.7.6.31 SHOW PROFILES Syntax"><code class="literal">SHOW
        PROFILES</code></a>, so you will find neither of those statements
        in the profile list. Malformed statements are profiled. For
        example, <code class="literal">SHOW PROFILING</code> is an illegal
        statement, and a syntax error occurs if you try to execute it,
        but it will show up in the profiling list.
      </p><p>
        <a class="link" href="sql-syntax.html#show-profile" title="13.7.6.30 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> displays detailed
        information about a single statement. Without the <code class="literal">FOR
        QUERY <em class="replaceable"><code>n</code></em></code> clause, the output
        pertains to the most recently executed statement. If
        <code class="literal">FOR QUERY <em class="replaceable"><code>n</code></em></code> is
        included, <a class="link" href="sql-syntax.html#show-profile" title="13.7.6.30 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> displays
        information for statement <em class="replaceable"><code>n</code></em>. The
        values of <em class="replaceable"><code>n</code></em> correspond to the
        <code class="literal">Query_ID</code> values displayed by
        <a class="link" href="sql-syntax.html#show-profiles" title="13.7.6.31 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a>.
      </p><p>
        The <code class="literal">LIMIT
        <em class="replaceable"><code>row_count</code></em></code> clause may be
        given to limit the output to
        <em class="replaceable"><code>row_count</code></em> rows. If
        <code class="literal">LIMIT</code> is given, <code class="literal">OFFSET
        <em class="replaceable"><code>offset</code></em></code> may be added to
        begin the output <em class="replaceable"><code>offset</code></em> rows into the
        full set of rows.
      </p><p>
        By default, <a class="link" href="sql-syntax.html#show-profile" title="13.7.6.30 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> displays
        <code class="literal">Status</code> and <code class="literal">Duration</code>
        columns. The <code class="literal">Status</code> values are like the
        <code class="literal">State</code> values displayed by
        <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>, although there
        might be some minor differences in interpretion for the two
        statements for some status values (see
        <a class="xref" href="optimization.html#thread-information" title="8.14 Examining Thread Information">Section 8.14, “Examining Thread Information”</a>).
      </p><p>
        Optional <em class="replaceable"><code>type</code></em> values may be specified
        to display specific additional types of information:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">ALL</code> displays all information
          </p></li><li class="listitem"><p>
            <code class="literal">BLOCK IO</code> displays counts for block input
            and output operations
          </p></li><li class="listitem"><p>
            <code class="literal">CONTEXT SWITCHES</code> displays counts for
            voluntary and involuntary context switches
          </p></li><li class="listitem"><p>
            <code class="literal">CPU</code> displays user and system CPU usage
            times
          </p></li><li class="listitem"><p>
            <code class="literal">IPC</code> displays counts for messages sent and
            received
          </p></li><li class="listitem"><p>
            <code class="literal">MEMORY</code> is not currently implemented
          </p></li><li class="listitem"><p>
            <code class="literal">PAGE FAULTS</code> displays counts for major and
            minor page faults
          </p></li><li class="listitem"><p>
            <code class="literal">SOURCE</code> displays the names of functions
            from the source code, together with the name and line number
            of the file in which the function occurs
          </p></li><li class="listitem"><p>
            <code class="literal">SWAPS</code> displays swap counts
</p></li></ul>
</div>
<p>
        Profiling is enabled per session. When a session ends, its
        profiling information is lost.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT @@profiling;</code></strong>
+-------------+
| @@profiling |
+-------------+
|           0 |
+-------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET profiling = 1;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS t1;</code></strong>
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE T1 (id INT);</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SHOW PROFILES;</code></strong>
+----------+----------+--------------------------+
| Query_ID | Duration | Query                    |
+----------+----------+--------------------------+
|        0 | 0.000088 | SET PROFILING = 1        |
|        1 | 0.000136 | DROP TABLE IF EXISTS t1  |
|        2 | 0.011947 | CREATE TABLE t1 (id INT) |
+----------+----------+--------------------------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW PROFILE;</code></strong>
+----------------------+----------+
| Status               | Duration |
+----------------------+----------+
| checking permissions | 0.000040 |
| creating table       | 0.000056 |
| After create         | 0.011363 |
| query end            | 0.000375 |
| freeing items        | 0.000089 |
| logging slow query   | 0.000019 |
| cleaning up          | 0.000005 |
+----------------------+----------+
7 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW PROFILE FOR QUERY 1;</code></strong>
+--------------------+----------+
| Status             | Duration |
+--------------------+----------+
| query end          | 0.000107 |
| freeing items      | 0.000008 |
| logging slow query | 0.000015 |
| cleaning up        | 0.000006 |
+--------------------+----------+
4 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW PROFILE CPU FOR QUERY 2;</code></strong>
+----------------------+----------+----------+------------+
| Status               | Duration | CPU_user | CPU_system |
+----------------------+----------+----------+------------+
| checking permissions | 0.000040 | 0.000038 |   0.000002 |
| creating table       | 0.000056 | 0.000028 |   0.000028 |
| After create         | 0.011363 | 0.000217 |   0.001571 |
| query end            | 0.000375 | 0.000013 |   0.000028 |
| freeing items        | 0.000089 | 0.000010 |   0.000014 |
| logging slow query   | 0.000019 | 0.000009 |   0.000010 |
| cleaning up          | 0.000005 | 0.000003 |   0.000002 |
+----------------------+----------+----------+------------+
7 rows in set (0.00 sec)
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Profiling is only partially functional on some architectures.
          For values that depend on the <code class="literal">getrusage()</code>
          system call, <code class="literal">NULL</code> is returned on systems
          such as Windows that do not support the call. In addition,
          profiling is per process and not per thread. This means that
          activity on threads within the server other than your own may
          affect the timing information that you see.
</p>
</div>
<p>
        Profiling information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#profiling-table" title="25.20 The INFORMATION_SCHEMA PROFILING Table"><code class="literal">PROFILING</code></a> table. See
        <a class="xref" href="information-schema.html#profiling-table" title="25.20 The INFORMATION_SCHEMA PROFILING Table">Section 25.20, “The INFORMATION_SCHEMA PROFILING Table”</a>. For example, the following
        queries are equivalent:
      </p><pre data-lang="sql" class="programlisting">
SHOW PROFILE FOR QUERY 2;

SELECT STATE, FORMAT(DURATION, 6) AS DURATION
FROM INFORMATION_SCHEMA.PROFILING
WHERE QUERY_ID = 2 ORDER BY SEQ;
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-profiles"></a>13.7.6.31 SHOW PROFILES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655240576"></a><pre data-lang="sql" class="programlisting">
SHOW PROFILES
</pre><p>
        The <a class="link" href="sql-syntax.html#show-profiles" title="13.7.6.31 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a> statement,
        together with <a class="link" href="sql-syntax.html#show-profile" title="13.7.6.30 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a>,
        displays profiling information that indicates resource usage for
        statements executed during the course of the current session.
        For more information, see <a class="xref" href="sql-syntax.html#show-profile" title="13.7.6.30 SHOW PROFILE Syntax">Section 13.7.6.30, “SHOW PROFILE Syntax”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          The <a class="link" href="sql-syntax.html#show-profile" title="13.7.6.30 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> and
          <a class="link" href="sql-syntax.html#show-profiles" title="13.7.6.31 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a> statements are
          deprecated and will be removed in a future MySQL release. Use
          the <a class="link" href="performance-schema.html" title="Chapter 26 MySQL Performance Schema">Performance
          Schema</a> instead; see
          <a class="xref" href="performance-schema.html#performance-schema-query-profiling" title="26.19.1 Query Profiling Using Performance Schema">Section 26.19.1, “Query Profiling Using Performance Schema”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-relaylog-events"></a>13.7.6.32 SHOW RELAYLOG EVENTS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655225568"></a><pre data-lang="sql" class="programlisting">
SHOW RELAYLOG EVENTS
    [IN '<em class="replaceable"><code>log_name</code></em>']
    [FROM <em class="replaceable"><code>pos</code></em>]
    [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
    [<em class="replaceable"><code>channel_option</code></em>]

<em class="replaceable"><code>channel_option</code></em>:
    FOR CHANNEL <em class="replaceable"><code>channel</code></em>
</pre><p>
        Shows the events in the relay log of a replication slave. If you
        do not specify
        <code class="literal">'<em class="replaceable"><code>log_name</code></em>'</code>, the
        first relay log is displayed. This statement has no effect on
        the master. <code class="literal">SHOW RELAYLOG EVENTS</code> requires the
        <a class="link" href="security.html#priv_replication-slave"><code class="literal">REPLICATION SLAVE</code></a> privilege.
      </p><p>
        The <code class="literal">LIMIT</code> clause has the same syntax as for
        the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement. See
        <a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax">Section 13.2.10, “SELECT Syntax”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Issuing a <a class="link" href="sql-syntax.html#show-relaylog-events" title="13.7.6.32 SHOW RELAYLOG EVENTS Syntax"><code class="literal">SHOW RELAYLOG EVENTS</code></a>
          with no <code class="literal">LIMIT</code> clause could start a very
          time- and resource-consuming process because the server
          returns to the client the complete contents of the relay log
          (including all statements modifying data that have been
          received by the slave).
</p>
</div>
<p>
        The optional <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause enables you
        to name which replication channel the statement applies to.
        Providing a <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause applies the
        statement to a specific replication channel. If no channel is
        named and no extra channels exist, the statement applies to the
        default channel.
      </p><p>
        When using multiple replication channels, if a
        <a class="link" href="sql-syntax.html#show-relaylog-events" title="13.7.6.32 SHOW RELAYLOG EVENTS Syntax"><code class="literal">SHOW RELAYLOG EVENTS</code></a> statement
        does not have a channel defined using a <code class="literal">FOR CHANNEL
        <em class="replaceable"><code>channel</code></em></code> clause an error is
        generated. See <a class="xref" href="replication.html#replication-channels" title="17.2.3 Replication Channels">Section 17.2.3, “Replication Channels”</a> for more
        information.
      </p><p>
        <a class="link" href="sql-syntax.html#show-relaylog-events" title="13.7.6.32 SHOW RELAYLOG EVENTS Syntax"><code class="literal">SHOW RELAYLOG EVENTS</code></a> displays the
        following fields for each event in the relay log:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Log_name</code>
          </p><p>
            The name of the file that is being listed.
          </p></li><li class="listitem"><p>
            <code class="literal">Pos</code>
          </p><p>
            The position at which the event occurs.
          </p></li><li class="listitem"><p>
            <code class="literal">Event_type</code>
          </p><p>
            An identifier that describes the event type.
          </p></li><li class="listitem"><p>
            <code class="literal">Server_id</code>
          </p><p>
            The server ID of the server on which the event originated.
          </p></li><li class="listitem"><p>
            <code class="literal">End_log_pos</code>
          </p><p>
            The value of <code class="literal">End_log_pos</code> for this event
            in the master's binary log.
          </p></li><li class="listitem"><p>
            <code class="literal">Info</code>
          </p><p>
            More detailed information about the event type. The format
            of this information depends on the event type.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          Some events relating to the setting of user and system
          variables are not included in the output from
          <a class="link" href="sql-syntax.html#show-relaylog-events" title="13.7.6.32 SHOW RELAYLOG EVENTS Syntax"><code class="literal">SHOW RELAYLOG EVENTS</code></a>. To get
          complete coverage of events within a relay log, use
          <a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files"><span class="command"><strong>mysqlbinlog</strong></span></a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-slave-hosts"></a>13.7.6.33 SHOW SLAVE HOSTS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655182464"></a><pre data-lang="sql" class="programlisting">
SHOW SLAVE HOSTS
</pre><p>
        Displays a list of replication slaves currently registered with
        the master. <code class="literal">SHOW SLAVE HOSTS</code> requires the
        <a class="link" href="security.html#priv_replication-slave"><code class="literal">REPLICATION SLAVE</code></a> privilege.
      </p><p>
        <code class="literal">SHOW SLAVE HOSTS</code> should be executed on a
        server that acts as a replication master. The statement displays
        information about servers that are or have been connected as
        replication slaves, with each row of the result corresponding to
        one slave server, as shown here:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW SLAVE HOSTS</code></strong>;
+------------+-----------+------+-----------+--------------------------------------+
| Server_id  | Host      | Port | Master_id | Slave_UUID                           |
+------------+-----------+------+-----------+--------------------------------------+
|  192168010 | iconnect2 | 3306 | 192168011 | 14cb6624-7f93-11e0-b2c0-c80aa9429562 |
| 1921680101 | athena    | 3306 | 192168011 | 07af4990-f41f-11df-a566-7ac56fdaf645 |
+------------+-----------+------+-----------+--------------------------------------+
</pre>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Server_id</code>: The unique server ID of the
            slave server, as configured in the slave server's
            option file, or on the command line with
            <a class="link" href="replication.html#option_mysqld_server-id"><code class="option">--server-id=<em class="replaceable"><code>value</code></em></code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Host</code>: The host name of the slave server
            as specified on the slave with the
            <a class="link" href="replication.html#option_mysqld_report-host"><code class="option">--report-host</code></a> option. This
            can differ from the machine name as configured in the
            operating system.
          </p></li><li class="listitem"><p>
            <code class="literal">User</code>: The slave server user name as,
            specified on the slave with the
            <a class="link" href="replication.html#option_mysqld_report-user"><code class="option">--report-user</code></a> option.
            Statement output includes this column only if the master
            server is started with the
            <a class="link" href="replication.html#option_mysqld_show-slave-auth-info"><code class="option">--show-slave-auth-info</code></a>
            option.
          </p></li><li class="listitem"><p>
            <code class="literal">Password</code>: The slave server password as,
            specified on the slave with the
            <a class="link" href="replication.html#option_mysqld_report-password"><code class="option">--report-password</code></a> option.
            Statement output includes this column only if the master
            server is started with the
            <a class="link" href="replication.html#option_mysqld_show-slave-auth-info"><code class="option">--show-slave-auth-info</code></a>
            option.
          </p></li><li class="listitem"><p>
            <code class="literal">Port</code>: The port on the master to which the
            slave server is listening, as specified on the slave with
            the <a class="link" href="replication.html#option_mysqld_report-port"><code class="option">--report-port</code></a> option.
          </p><p>
            A zero in this column means that the slave port
            (<a class="link" href="replication.html#option_mysqld_report-port"><code class="option">--report-port</code></a>) was not set.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_id</code>: The unique server ID of the
            master server that the slave server is replicating from.
            This is the server ID of the server on which <code class="literal">SHOW
            SLAVE HOSTS</code> is executed, so this same value is
            listed for each row in the result.
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm140091655151712"></a>

            <code class="literal">Slave_UUID</code>: The globally unique ID of
            this slave, as generated on the slave and found in the
            slave's <code class="filename">auto.cnf</code> file.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-slave-status"></a>13.7.6.34 SHOW SLAVE STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091655146480"></a><pre data-lang="sql" class="programlisting">
SHOW SLAVE STATUS [FOR CHANNEL <em class="replaceable"><code>channel</code></em>]
</pre><p>
        This statement provides status information on essential
        parameters of the slave threads. It requires either the
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> or
        <a class="link" href="security.html#priv_replication-client"><code class="literal">REPLICATION CLIENT</code></a> privilege.
      </p><p>
        <code class="literal">SHOW SLAVE STATUS</code> is nonblocking. When run
        concurrently with <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.7 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a>,
        <code class="literal">SHOW SLAVE STATUS</code> returns without waiting for
        <code class="literal">STOP SLAVE</code> to finish shutting down the slave
        SQL thread or slave I/O thread (or both). This permits use in
        monitoring and other applications where getting an immediate
        response from <code class="literal">SHOW SLAVE STATUS</code> more
        important than ensuring that it returned the latest data.
      </p><p>
        If you issue this statement using the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a>
        client, you can use a <code class="literal">\G</code> statement terminator
        rather than a semicolon to obtain a more readable vertical
        layout:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW SLAVE STATUS\G</code></strong>
*************************** 1. row ***************************
               Slave_IO_State: Waiting for master to send event
                  Master_Host: localhost
                  Master_User: repl
                  Master_Port: 13000
                Connect_Retry: 60
              Master_Log_File: master-bin.000002
          Read_Master_Log_Pos: 1307
               Relay_Log_File: slave-relay-bin.000003
                Relay_Log_Pos: 1508
        Relay_Master_Log_File: master-bin.000002
             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB:
          Replicate_Ignore_DB:
           Replicate_Do_Table:
       Replicate_Ignore_Table:
      Replicate_Wild_Do_Table:
  Replicate_Wild_Ignore_Table:
                   Last_Errno: 0
                   Last_Error:
                 Skip_Counter: 0
          Exec_Master_Log_Pos: 1307
              Relay_Log_Space: 1858
              Until_Condition: None
               Until_Log_File:
                Until_Log_Pos: 0
           Master_SSL_Allowed: No
           Master_SSL_CA_File:
           Master_SSL_CA_Path:
              Master_SSL_Cert:
            Master_SSL_Cipher:
               Master_SSL_Key:
        Seconds_Behind_Master: 0
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: 0
                Last_IO_Error:
               Last_SQL_Errno: 0
               Last_SQL_Error:
  Replicate_Ignore_Server_Ids:
             Master_Server_Id: 1
                  Master_UUID: 3e11fa47-71ca-11e1-9e33-c80aa9429562
             Master_Info_File: /var/mysqld.2/data/master.info
                    SQL_Delay: 0
          SQL_Remaining_Delay: NULL
      Slave_SQL_Running_State: Reading event from the relay log
           Master_Retry_Count: 10
                  Master_Bind:
      Last_IO_Error_Timestamp:
     Last_SQL_Error_Timestamp:
               Master_SSL_Crl:
           Master_SSL_Crlpath:
           Retrieved_Gtid_Set: 3e11fa47-71ca-11e1-9e33-c80aa9429562:1-5
            Executed_Gtid_Set: 3e11fa47-71ca-11e1-9e33-c80aa9429562:1-5
                Auto_Position: 1
         Replicate_Rewrite_DB:
                 Channel_name:
           Master_TLS_Version: TLSv1.2
       Master_public_key_path: public_key.pem
        Get_master_public_key: 0
</pre><p>
        The Performance Schema provides tables that expose replication
        information. This is similar to the information available from
        the <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> statement,
        but represented in table form. For details, see
        <a class="xref" href="performance-schema.html#performance-schema-replication-tables" title="26.12.11 Performance Schema Replication Tables">Section 26.12.11, “Performance Schema Replication Tables”</a>.
      </p><p>
        The following list describes the fields returned by
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>. For additional
        information about interpreting their meanings, see
        <a class="xref" href="replication.html#replication-administration-status" title="17.1.7.1 Checking Replication Status">Section 17.1.7.1, “Checking Replication Status”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Slave_IO_State</code>
          </p><p>
            A copy of the <code class="literal">State</code> field of the
            <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> output for
            the slave I/O thread. This tells you what the thread is
            doing: trying to connect to the master, waiting for events
            from the master, reconnecting to the master, and so on. For
            a listing of possible states, see
            <a class="xref" href="optimization.html#slave-io-thread-states" title="8.14.4 Replication Slave I/O Thread States">Section 8.14.4, “Replication Slave I/O Thread States”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Host</code>
          </p><p>
            The master host that the slave is connected to.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_User</code>
          </p><p>
            The user name of the account used to connect to the master.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Port</code>
          </p><p>
            The port used to connect to the master.
          </p></li><li class="listitem"><p>
            <code class="literal">Connect_Retry</code>
          </p><p>
            The number of seconds between connect retries (default 60).
            This can be set with the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
            TO</code></a> statement.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Log_File</code>
          </p><p>
            The name of the master binary log file from which the I/O
            thread is currently reading.
          </p></li><li class="listitem"><p>
            <code class="literal">Read_Master_Log_Pos</code>
          </p><p>
            The position in the current master binary log file up to
            which the I/O thread has read.
          </p></li><li class="listitem"><p>
            <code class="literal">Relay_Log_File</code>
          </p><p>
            The name of the relay log file from which the SQL thread is
            currently reading and executing.
          </p></li><li class="listitem"><p>
            <code class="literal">Relay_Log_Pos</code>
          </p><p>
            The position in the current relay log file up to which the
            SQL thread has read and executed.
          </p></li><li class="listitem"><p>
            <code class="literal">Relay_Master_Log_File</code>
          </p><p>
            The name of the master binary log file containing the most
            recent event executed by the SQL thread.
          </p></li><li class="listitem"><p>
            <code class="literal">Slave_IO_Running</code>
          </p><p>
            Whether the I/O thread is started and has connected
            successfully to the master. Internally, the state of this
            thread is represented by one of the following three values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><b>MYSQL_SLAVE_NOT_RUN. </b>
                  The slave I/O thread is not running. For this state,
                  <code class="literal">Slave_IO_Running</code> is
                  <code class="literal">No</code>.
                </p></li><li class="listitem"><p><b>MYSQL_SLAVE_RUN_NOT_CONNECT. </b>
                  The slave I/O thread is running, but is not connected
                  to a replication master. For this state,
                  <code class="literal">Slave_IO_Running</code> is
                  <code class="literal">Connecting</code>.
                </p></li><li class="listitem"><p><b>MYSQL_SLAVE_RUN_CONNECT. </b>
                  The slave I/O thread is running, and is connected to a
                  replication master. For this state,
                  <code class="literal">Slave_IO_Running</code> is
                  <code class="literal">Yes</code>.
</p></li></ul>
</div>
<p>
            The value of the
            <a class="link" href="server-administration.html#statvar_Slave_running"><code class="literal">Slave_running</code></a> system
            status variable corresponds with this value.
          </p></li><li class="listitem"><p>
            <code class="literal">Slave_SQL_Running</code>
          </p><p>
            Whether the SQL thread is started.
          </p></li><li class="listitem"><p>
            <code class="literal">Replicate_Do_DB</code>,
            <code class="literal">Replicate_Ignore_DB</code>
          </p><p>
            The names of any databases that were specified with the
            <a class="link" href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> and
            <a class="link" href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a>
            options, or the <a class="link" href="sql-syntax.html#change-replication-filter" title="13.4.2.2 CHANGE REPLICATION FILTER Syntax"><code class="literal">CHANGE REPLICATION
            FILTER</code></a> statement. If the <code class="literal">FOR
            CHANNEL</code> clause was used, the channel specific
            replication filters are shown. Otherwise, the replication
            filters for every replication channel are shown.
          </p></li><li class="listitem"><p>
            <code class="literal">Replicate_Do_Table</code>,
            <code class="literal">Replicate_Ignore_Table</code>,
            <code class="literal">Replicate_Wild_Do_Table</code>,
            <code class="literal">Replicate_Wild_Ignore_Table</code>
          </p><p>
            The names of any tables that were specified with the
            <a class="link" href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table</code></a>,
            <a class="link" href="replication.html#option_mysqld_replicate-ignore-table"><code class="option">--replicate-ignore-table</code></a>,
            <a class="link" href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table</code></a>,
            and
            <a class="link" href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table</code></a>
            options, or the <a class="link" href="sql-syntax.html#change-replication-filter" title="13.4.2.2 CHANGE REPLICATION FILTER Syntax"><code class="literal">CHANGE REPLICATION
            FILTER</code></a> statement. If the <code class="literal">FOR
            CHANNEL</code> clause was used, the channel specific
            replication filters are shown. Otherwise, the replication
            filters for every replication channel are shown.
          </p></li><li class="listitem"><p>
            <code class="literal">Last_Errno</code>, <code class="literal">Last_Error</code>
          </p><p>
            These columns are aliases for
            <code class="literal">Last_SQL_Errno</code> and
            <code class="literal">Last_SQL_Error</code>.
          </p><p>
            Issuing <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> or
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> resets the values
            shown in these columns.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              When the slave SQL thread receives an error, it reports
              the error first, then stops the SQL thread. This means
              that there is a small window of time during which
              <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> shows a
              nonzero value for <code class="literal">Last_SQL_Errno</code> even
              though <code class="literal">Slave_SQL_Running</code> still displays
              <code class="literal">Yes</code>.
</p>
</div>
</li><li class="listitem"><p>
            <code class="literal">Skip_Counter</code>
          </p><p>
            The current value of the
            <a class="link" href="replication.html#sysvar_sql_slave_skip_counter"><code class="literal">sql_slave_skip_counter</code></a>
            system variable. See
            <a class="xref" href="sql-syntax.html#set-global-sql-slave-skip-counter" title="13.4.2.5 SET GLOBAL sql_slave_skip_counter Syntax">Section 13.4.2.5, “SET GLOBAL sql_slave_skip_counter Syntax”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Exec_Master_Log_Pos</code>
          </p><p>
            The position in the current master binary log file to which
            the SQL thread has read and executed, marking the start of
            the next transaction or event to be processed. You can use
            this value with the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
            TO</code></a> statement's
            <code class="literal">MASTER_LOG_POS</code> option when starting a new
            slave from an existing slave, so that the new slave reads
            from this point. The coordinates given by
            (<code class="literal">Relay_Master_Log_File</code>,
            <code class="literal">Exec_Master_Log_Pos</code>) in the master's
            binary log correspond to the coordinates given by
            (<code class="literal">Relay_Log_File</code>,
            <code class="literal">Relay_Log_Pos</code>) in the relay log.
          </p><p>
            Inconsistencies in the sequence of transactions from the
            relay log which have been executed can cause this value to
            be a <span class="quote">“<span class="quote">low-water mark</span>”</span>. In other words,
            transactions appearing before the position are guaranteed to
            have committed, but transactions after the position may have
            committed or not. If these gaps need to be corrected, use
            <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE
            UNTIL SQL_AFTER_MTS_GAPS</code></a>. See
            <a class="xref" href="replication.html#replication-features-transaction-inconsistencies" title="17.4.1.33 Replication and Transaction Inconsistencies">Section 17.4.1.33, “Replication and Transaction Inconsistencies”</a>
            for more information.
          </p></li><li class="listitem"><p>
            <code class="literal">Relay_Log_Space</code>
          </p><p>
            The total combined size of all existing relay log files.
          </p></li><li class="listitem"><p>
            <code class="literal">Until_Condition</code>,
            <code class="literal">Until_Log_File</code>,
            <code class="literal">Until_Log_Pos</code>
          </p><p>
            The values specified in the <code class="literal">UNTIL</code> clause
            of the <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statement.
          </p><p>
            <code class="literal">Until_Condition</code> has these values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">None</code> if no <code class="literal">UNTIL</code>
                clause was specified
              </p></li><li class="listitem"><p>
                <code class="literal">Master</code> if the slave is reading until
                a given position in the master's binary log
              </p></li><li class="listitem"><p>
                <code class="literal">Relay</code> if the slave is reading until a
                given position in its relay log
              </p></li><li class="listitem"><p>
                <code class="literal">SQL_BEFORE_GTIDS</code> if the slave SQL
                thread is processing transactions until it has reached
                the first transaction whose GTID is listed in the
                <code class="literal">gtid_set</code>.
              </p></li><li class="listitem"><p>
                <code class="literal">SQL_AFTER_GTIDS</code> if the slave threads
                are processing all transactions until the last
                transaction in the <code class="literal">gtid_set</code> has been
                processed by both threads.
              </p></li><li class="listitem"><p>
                <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax"><code class="literal">SQL_AFTER_MTS_GAPS</code></a>
                if a multithreaded slave's SQL threads are running until
                no more gaps are found in the relay log.
</p></li></ul>
</div>
<p>
            <code class="literal">Until_Log_File</code> and
            <code class="literal">Until_Log_Pos</code> indicate the log file name
            and position that define the coordinates at which the SQL
            thread stops executing.
          </p><p>
            For more information on <code class="literal">UNTIL</code> clauses,
            see <a class="xref" href="sql-syntax.html#start-slave" title="13.4.2.6 START SLAVE Syntax">Section 13.4.2.6, “START SLAVE Syntax”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_SSL_Allowed</code>,
            <code class="literal">Master_SSL_CA_File</code>,
            <code class="literal">Master_SSL_CA_Path</code>,
            <code class="literal">Master_SSL_Cert</code>,
            <code class="literal">Master_SSL_Cipher</code>,
            <code class="literal">Master_SSL_CRL_File</code>,
            <code class="literal">Master_SSL_CRL_Path</code>,
            <code class="literal">Master_SSL_Key</code>,
            <code class="literal">Master_SSL_Verify_Server_Cert</code>
          </p><p>
            These fields show the SSL parameters used by the slave to
            connect to the master, if any.
          </p><p>
            <code class="literal">Master_SSL_Allowed</code> has these values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">Yes</code> if an SSL connection to the
                master is permitted
              </p></li><li class="listitem"><p>
                <code class="literal">No</code> if an SSL connection to the master
                is not permitted
              </p></li><li class="listitem"><p>
                <code class="literal">Ignored</code> if an SSL connection is
                permitted but the slave server does not have SSL support
                enabled
</p></li></ul>
</div>
<p>
            The values of the other SSL-related fields correspond to the
            values of the <code class="literal">MASTER_SSL_CA</code>,
            <code class="literal">MASTER_SSL_CAPATH</code>,
            <code class="literal">MASTER_SSL_CERT</code>,
            <code class="literal">MASTER_SSL_CIPHER</code>,
            <code class="literal">MASTER_SSL_CRL</code>,
            <code class="literal">MASTER_SSL_CRLPATH</code>,
            <code class="literal">MASTER_SSL_KEY</code>, and
            <code class="literal">MASTER_SSL_VERIFY_SERVER_CERT</code> options to
            the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
            statement. See <a class="xref" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax">Section 13.4.2.1, “CHANGE MASTER TO Syntax”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Seconds_Behind_Master</code>
          </p><p>
            This field is an indication of how <span class="quote">“<span class="quote">late</span>”</span> the
            slave is:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                When the slave is actively processing updates, this
                field shows the difference between the current timestamp
                on the slave and the original timestamp logged on the
                master for the event currently being processed on the
                slave.
              </p></li><li class="listitem"><p>
                When no event is currently being processed on the slave,
                this value is 0.
</p></li></ul>
</div>
<p>
            In essence, this field measures the time difference in
            seconds between the slave SQL thread and the slave I/O
            thread. If the network connection between master and slave
            is fast, the slave I/O thread is very close to the master,
            so this field is a good approximation of how late the slave
            SQL thread is compared to the master. If the network is
            slow, this is <span class="emphasis"><em>not</em></span> a good approximation;
            the slave SQL thread may quite often be caught up with the
            slow-reading slave I/O thread, so
            <code class="literal">Seconds_Behind_Master</code> often shows a value
            of 0, even if the I/O thread is late compared to the master.
            In other words, <span class="emphasis"><em>this column is useful only for
            fast networks</em></span>.
          </p><p>
            This time difference computation works even if the master
            and slave do not have identical clock times, provided that
            the difference, computed when the slave I/O thread starts,
            remains constant from then on. Any changes—including
            NTP updates—can lead to clock skews that can make
            calculation of <code class="literal">Seconds_Behind_Master</code> less
            reliable.
          </p><p>
            In MySQL 8.0, this field is
            <code class="literal">NULL</code> (undefined or unknown) if the slave
            SQL thread is not running, or if the SQL thread has consumed
            all of the relay log and the slave I/O thread is not
            running. (In older versions of MySQL, this field was
            <code class="literal">NULL</code> if the slave SQL thread or the slave
            I/O thread was not running or was not connected to the
            master.) If the I/O thread is running but the relay log is
            exhausted, <code class="literal">Seconds_Behind_Master</code> is set
            to 0.
          </p><p>
            The value of <code class="literal">Seconds_Behind_Master</code> is
            based on the timestamps stored in events, which are
            preserved through replication. This means that if a master
            M1 is itself a slave of M0, any event from M1's binary log
            that originates from M0's binary log has M0's timestamp for
            that event. This enables MySQL to replicate
            <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> successfully.
            However, the problem for
            <code class="literal">Seconds_Behind_Master</code> is that if M1 also
            receives direct updates from clients, the
            <code class="literal">Seconds_Behind_Master</code> value randomly
            fluctuates because sometimes the last event from M1
            originates from M0 and sometimes is the result of a direct
            update on M1.
          </p><p>
            When using a multithreaded slave, you should keep in mind
            that this value is based on
            <code class="literal">Exec_Master_Log_Pos</code>, and so may not
            reflect the position of the most recently committed
            transaction.
          </p></li><li class="listitem"><p>
            <code class="literal">Last_IO_Errno</code>,
            <code class="literal">Last_IO_Error</code>
          </p><p>
            The error number and error message of the most recent error
            that caused the I/O thread to stop. An error number of 0 and
            message of the empty string mean <span class="quote">“<span class="quote">no error.</span>”</span> If
            the <code class="literal">Last_IO_Error</code> value is not empty, the
            error values also appear in the slave's error log.
          </p><p>
            I/O error information includes a timestamp showing when the
            most recent I/O thread error occurred. This timestamp uses
            the format <em class="replaceable"><code>YYMMDD hh:mm:ss</code></em>, and
            appears in the <code class="literal">Last_IO_Error_Timestamp</code>
            column.
          </p><p>
            Issuing <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> or
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> resets the values
            shown in these columns.
          </p></li><li class="listitem"><p>
            <code class="literal">Last_SQL_Errno</code>,
            <code class="literal">Last_SQL_Error</code>
          </p><p>
            The error number and error message of the most recent error
            that caused the SQL thread to stop. An error number of 0 and
            message of the empty string mean <span class="quote">“<span class="quote">no error.</span>”</span> If
            the <code class="literal">Last_SQL_Error</code> value is not empty,
            the error values also appear in the slave's error log.
          </p><p>
            If the slave is multithreaded, the SQL thread is the
            coordinator for worker threads. In this case, the
            <code class="literal">Last_SQL_Error</code> field shows exactly what
            the <code class="literal">Last_Error_Message</code> column in the
            Performance Schema
            <a class="link" href="performance-schema.html#replication-applier-status-by-coordinator-table" title="26.12.11.5 The replication_applier_status_by_coordinator Table"><code class="literal">replication_applier_status_by_coordinator</code></a>
            table shows. The field value is modified to suggest that
            there may be more failures in the other worker threads which
            can be seen in the
            <a class="link" href="performance-schema.html#replication-applier-status-by-worker-table" title="26.12.11.6 The replication_applier_status_by_worker Table"><code class="literal">replication_applier_status_by_worker</code></a>
            table that shows each worker thread's status. If that table
            is not available, the slave error log can be used. The log
            or the
            <a class="link" href="performance-schema.html#replication-applier-status-by-worker-table" title="26.12.11.6 The replication_applier_status_by_worker Table"><code class="literal">replication_applier_status_by_worker</code></a>
            table should also be used to learn more about the failure
            shown by <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> or
            the coordinator table.
          </p><p>
            SQL error information includes a timestamp showing when the
            most recent SQL thread error occurred. This timestamp uses
            the format <em class="replaceable"><code>YYMMDD hh:mm:ss</code></em>, and
            appears in the <code class="literal">Last_SQL_Error_Timestamp</code>
            column.
          </p><p>
            Issuing <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> or
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> resets the values
            shown in these columns.
          </p><p>
            In MySQL 8.0, all error codes and messages
            displayed in the <code class="literal">Last_SQL_Errno</code> and
            <code class="literal">Last_SQL_Error</code> columns correspond to
            error values listed in
            <a class="xref" href="error-handling.html#server-error-reference" title="B.3.1 Server Error Message Reference">Section B.3.1, “Server Error Message Reference”</a>. This was not
            always true in previous versions. (Bug #11760365, Bug
            #52768)
          </p></li><li class="listitem"><p>
            <code class="literal">Replicate_Ignore_Server_Ids</code>
          </p><p>
            Any server IDs that have been specified using the
            <code class="literal">IGNORE_SERVER_IDS</code> option of the
            <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement,
            so that the slave ignores events from these servers. This
            option is used in a circular or other multi-master
            replication setup when one of the servers is removed. If any
            server IDs have been set in this way, a comma-delimited list
            of one or more numbers is shown. If no server IDs have been
            set, the field is blank.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              The <code class="literal">Ignored_server_ids</code> value in the
              <code class="literal">slave_master_info</code> table also shows the
              server IDs to be ignored, but as a space-delimited list,
              preceded by the total number of server IDs to be ignored.
              For example, if a <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
              TO</code></a> statement containing the
              <code class="literal">IGNORE_SERVER_IDS = (2,6,9)</code> option has
              been issued to tell a slave to ignore masters having the
              server ID 2, 6, or 9, that information appears as shown
              here:
            </p><pre data-lang="none" class="programlisting">
	Replicate_Ignore_Server_Ids: 2, 6, 9
</pre><pre data-lang="none" class="programlisting">
	Ignored_server_ids: 3, 2, 6, 9
</pre>
</div>
<p>
            <code class="literal">Replicate_Ignore_Server_Ids</code> filtering is
            performed by the I/O thread, rather than by the SQL thread,
            which means that events which are filtered out are not
            written to the relay log. This differs from the filtering
            actions taken by server options such
            <a class="link" href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table</code></a>, which
            apply to the SQL thread.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              From MySQL 8.0.3, a deprecation warning is issued if
              <code class="literal">SET GTID_MODE=ON</code> is issued when any
              channel has existing server IDs set with
              <code class="literal">IGNORE_SERVER_IDS</code>. Before starting
              GTID-based replication, use
              <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.6.34 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW_SLAVE_STATUS</code></a> to check
              for and clear all ignored server ID lists on the servers
              involved. You can clear a list by issuing a
              <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement
              containing the <code class="literal">IGNORE_SERVER_IDS</code> option
              with an empty list.
</p>
</div>
</li><li class="listitem"><p>
            <code class="literal">Master_Server_Id</code>
          </p><p>
            The <a class="link" href="server-administration.html#sysvar_server_id"><code class="literal">server_id</code></a> value from
            the master.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_UUID</code>
          </p><p>
            The <a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a> value from
            the master.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Info_File</code>
          </p><p>
            The location of the <code class="filename">master.info</code> file,
            if a file rather than a table is used for the slave's master
            info repository.
          </p></li><li class="listitem"><p>
            <code class="literal">SQL_Delay</code>
          </p><p>
            The number of seconds that the slave must lag the master.
          </p></li><li class="listitem"><p>
            <code class="literal">SQL_Remaining_Delay</code>
          </p><p>
            When <code class="literal">Slave_SQL_Running_State</code> is
            <code class="literal">Waiting until MASTER_DELAY seconds after master
            executed event</code>, this field contains the number of
            delay seconds remaining. At other times, this field is
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Slave_SQL_Running_State</code>
          </p><p>
            The state of the SQL thread (analogous to
            <code class="literal">Slave_IO_State</code>). The value is identical
            to the <code class="literal">State</code> value of the SQL thread as
            displayed by <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
            PROCESSLIST</code></a>.
            <a class="xref" href="optimization.html#slave-sql-thread-states" title="8.14.5 Replication Slave SQL Thread States">Section 8.14.5, “Replication Slave SQL Thread States”</a>, provides a
            listing of possible states
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Retry_Count</code>
          </p><p>
            The number of times the slave can attempt to reconnect to
            the master in the event of a lost connection. This value can
            be set using the <code class="literal">MASTER_RETRY_COUNT</code>
            option of the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
            TO</code></a> statement (preferred) or the older
            <a class="link" href="replication.html#option_mysqld_master-retry-count"><code class="option">--master-retry-count</code></a> server
            option (still supported for backward compatibility).
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Bind</code>
          </p><p>
            The network interface that the slave is bound to, if any.
            This is set using the <code class="literal">MASTER_BIND</code> option
            for the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
            statement.
          </p></li><li class="listitem"><p>
            <code class="literal">Last_IO_Error_Timestamp</code>
          </p><p>
            A timestamp in <em class="replaceable"><code>YYMMDD hh:mm:ss</code></em>
            format that shows when the most recent I/O error took place.
          </p></li><li class="listitem"><p>
            <code class="literal">Last_SQL_Error_Timestamp</code>
          </p><p>
            A timestamp in <em class="replaceable"><code>YYMMDD hh:mm:ss</code></em>
            format that shows when the most recent SQL error occurred.
          </p></li><li class="listitem"><p>
            <code class="literal">Retrieved_Gtid_Set</code>
          </p><p>
            The set of global transaction IDs corresponding to all
            transactions received by this slave. Empty if GTIDs are not
            in use. See
            <a class="xref" href="replication.html#replication-gtids-concepts-gtid-sets" title="GTID Sets">GTID Sets</a> for
            more information.
          </p><p>
            This is the set of all GTIDs that exist or have existed in
            the relay logs. Each GTID is added as soon as the
            <code class="literal">Gtid_log_event</code> is received. This can
            cause partially transmitted transactions to have their GTIDs
            included in the set.
          </p><p>
            When all relay logs are lost due to executing
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> or
            <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>, or due to
            the effects of the
            <a class="link" href="replication.html#option_mysqld_relay-log-recovery"><code class="option">--relay-log-recovery</code></a> option,
            the set is cleared. When
            <a class="link" href="replication.html#sysvar_relay_log_purge"><code class="literal">relay_log_purge = 1</code></a>, the
            newest relay log is always kept, and the set is not cleared.
          </p></li><li class="listitem"><p>
            <code class="literal">Executed_Gtid_Set</code>
          </p><p>
            The set of global transaction IDs written in the binary log.
            This is the same as the value for the global
            <a class="link" href="replication.html#sysvar_gtid_executed"><code class="literal">gtid_executed</code></a> system
            variable on this server, as well as the value for
            <code class="literal">Executed_Gtid_Set</code> in the output of
            <a class="link" href="sql-syntax.html#show-master-status" title="13.7.6.23 SHOW MASTER STATUS Syntax"><code class="literal">SHOW MASTER STATUS</code></a> on this
            server. Empty if GTIDs are not in use. See
            <a class="xref" href="replication.html#replication-gtids-concepts-gtid-sets" title="GTID Sets">GTID Sets</a> for
            more information.
          </p></li><li class="listitem"><p>
            <code class="literal">Auto_Position</code>
          </p><p>
            1 if autopositioning is in use; otherwise 0.
          </p></li><li class="listitem"><p>
            <code class="literal">Replicate_Rewrite_DB</code>
          </p><p>
            The <code class="literal">Replicate_Rewrite_DB</code> value displays
            any replication filtering rules that were specified. For
            example, if the following replication filter rule was set:
          </p><pre data-lang="sql" class="programlisting">CHANGE REPLICATION FILTER REPLICATE_REWRITE_DB=((db1,db2), (db3,db4));</pre><p>
            the <code class="literal">Replicate_Rewrite_DB</code> value displays:
          </p><pre data-lang="none" class="programlisting">Replicate_Rewrite_DB: (db1,db2),(db3,db4)</pre><p>
            For more information, see
            <a class="xref" href="sql-syntax.html#change-replication-filter" title="13.4.2.2 CHANGE REPLICATION FILTER Syntax">Section 13.4.2.2, “CHANGE REPLICATION FILTER Syntax”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Channel_name</code>
          </p><p>
            The replication channel which is being displayed. There is
            always a default replication channel, and more replication
            channels can be added. See
            <a class="xref" href="replication.html#replication-channels" title="17.2.3 Replication Channels">Section 17.2.3, “Replication Channels”</a> for more information.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_TLS_Version</code>
          </p><p>
            The TLS version used on the master. For TLS version
            information, see
            <a class="xref" href="security.html#encrypted-connection-protocols-ciphers" title="6.3.6 Encrypted Connection Protocols and Ciphers">Section 6.3.6, “Encrypted Connection Protocols and Ciphers”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_public_key_path</code>
          </p><p>
            The path name to a file containing a slave-side copy of the
            public key required by the master for RSA key pair-based
            password exchange. The file must be in PEM format. This
            column applies to slaves that authenticate with the
            <code class="literal">sha256_password</code> or
            <code class="literal">caching_sha2_password</code> authentication
            plugin.
          </p><p>
            If <code class="literal">Master_public_key_path</code> is given and
            specifies a valid public key file, it takes precedence over
            <code class="literal">Get_master_public_key</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Get_master_public_key</code>
          </p><p>
            Whether to request from the master the public key required
            for RSA key pair-based password exchange. This column
            applies to slaves that authenticate with the
            <code class="literal">caching_sha2_password</code> authentication
            plugin. For that plugin, the master does not send the public
            key unless requested.
          </p><p>
            If <code class="literal">Master_public_key_path</code> is given and
            specifies a valid public key file, it takes precedence over
            <code class="literal">Get_master_public_key</code>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-status"></a>13.7.6.35 SHOW STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091654848160"></a><a class="indexterm" name="idm140091654847088"></a><a class="indexterm" name="idm140091654846016"></a><pre data-lang="sql" class="programlisting">
SHOW [GLOBAL | SESSION] STATUS
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><a class="indexterm" name="idm140091654840656"></a><p>
        <a class="link" href="sql-syntax.html#show-status" title="13.7.6.35 SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a> provides server
        status information (see
        <a class="xref" href="server-administration.html#server-status-variables" title="5.1.10 Server Status Variables">Section 5.1.10, “Server Status Variables”</a>). This statement does
        not require any privilege. It requires only the ability to
        connect to the server.
      </p><p>
        Status variable information is also available from these
        sources:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Performance Schema tables. See
            <a class="xref" href="performance-schema.html#performance-schema-status-variable-tables" title="26.12.14 Performance Schema Status Variable Tables">Section 26.12.14, “Performance Schema Status Variable Tables”</a>.
          </p></li><li class="listitem"><p>
            The <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin extended-status</strong></span></a> command.
            See <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>.
</p></li></ul>
</div>
<p>
        For <a class="link" href="sql-syntax.html#show-status" title="13.7.6.35 SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a>, a
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which variable names to match. A <code class="literal">WHERE</code> clause
        can be given to select rows using more general conditions, as
        discussed in <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-status" title="13.7.6.35 SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a> accepts an optional
        <code class="literal">GLOBAL</code> or <code class="literal">SESSION</code> variable
        scope modifier:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            With a <code class="literal">GLOBAL</code> modifier, the statement
            displays the global status values. A global status variable
            may represent status for some aspect of the server itself
            (for example, <code class="literal">Aborted_connects</code>), or the
            aggregated status over all connections to MySQL (for
            example, <code class="literal">Bytes_received</code> and
            <code class="literal">Bytes_sent</code>). If a variable has no global
            value, the session value is displayed.
          </p></li><li class="listitem"><p>
            With a <code class="literal">SESSION</code> modifier, the statement
            displays the status variable values for the current
            connection. If a variable has no session value, the global
            value is displayed. <code class="literal">LOCAL</code> is a synonym
            for <code class="literal">SESSION</code>.
          </p></li><li class="listitem"><p>
            If no modifier is present, the default is
            <code class="literal">SESSION</code>.
</p></li></ul>
</div>
<p>
        The scope for each status variable is listed at
        <a class="xref" href="server-administration.html#server-status-variables" title="5.1.10 Server Status Variables">Section 5.1.10, “Server Status Variables”</a>.
      </p><p>
        Each invocation of the <a class="link" href="sql-syntax.html#show-status" title="13.7.6.35 SHOW STATUS Syntax"><code class="literal">SHOW
        STATUS</code></a> statement uses an internal temporary table and
        increments the global
        <a class="link" href="server-administration.html#statvar_Created_tmp_tables"><code class="literal">Created_tmp_tables</code></a> value.
      </p><p>
        Partial output is shown here. The list of names and values may
        differ for your server. The meaning of each variable is given in
        <a class="xref" href="server-administration.html#server-status-variables" title="5.1.10 Server Status Variables">Section 5.1.10, “Server Status Variables”</a>.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW STATUS;</code></strong>
+--------------------------+------------+
| Variable_name            | Value      |
+--------------------------+------------+
| Aborted_clients          | 0          |
| Aborted_connects         | 0          |
| Bytes_received           | 155372598  |
| Bytes_sent               | 1176560426 |
| Connections              | 30023      |
| Created_tmp_disk_tables  | 0          |
| Created_tmp_tables       | 8340       |
| Created_tmp_files        | 60         |
...
| Open_tables              | 1          |
| Open_files               | 2          |
| Open_streams             | 0          |
| Opened_tables            | 44600      |
| Questions                | 2026873    |
...
| Table_locks_immediate    | 1920382    |
| Table_locks_waited       | 0          |
| Threads_cached           | 0          |
| Threads_created          | 30022      |
| Threads_connected        | 1          |
| Threads_running          | 1          |
| Uptime                   | 80380      |
+--------------------------+------------+
</pre><p>
        With a <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, the statement
        displays only rows for those variables with names that match the
        pattern:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'Key%';</code></strong>
+--------------------+----------+
| Variable_name      | Value    |
+--------------------+----------+
| Key_blocks_used    | 14955    |
| Key_read_requests  | 96854827 |
| Key_reads          | 162040   |
| Key_write_requests | 7589728  |
| Key_writes         | 3813196  |
+--------------------+----------+
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-table-status"></a>13.7.6.36 SHOW TABLE STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091654800192"></a><a class="indexterm" name="idm140091654799136"></a><a class="indexterm" name="idm140091654797648"></a><a class="indexterm" name="idm140091654796160"></a><pre data-lang="sql" class="programlisting">
SHOW TABLE STATUS
    [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-table-status" title="13.7.6.36 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a> works likes
        <a class="link" href="sql-syntax.html#show-tables" title="13.7.6.37 SHOW TABLES Syntax"><code class="literal">SHOW TABLES</code></a>, but provides a lot
        of information about each non-<code class="literal">TEMPORARY</code>
        table. You can also get this list using the <a class="link" href="programs.html#mysqlshow" title="4.5.7 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow
        --status <em class="replaceable"><code>db_name</code></em></strong></span></a> command.
        The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present,
        indicates which table names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><p>
        This statement also displays information about views.
      </p><p>
        <a class="link" href="sql-syntax.html#show-table-status" title="13.7.6.36 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a> output has
        these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Name</code>
          </p><p>
            The name of the table.
          </p></li><li class="listitem"><p>
            <code class="literal">Engine</code>
          </p><p>
            The storage engine for the table. See
            <a class="xref" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine">Chapter 15, <i>The InnoDB Storage Engine</i></a>, and
            <a class="xref" href="storage-engines.html" title="Chapter 16 Alternative Storage Engines">Chapter 16, <i>Alternative Storage Engines</i></a>.
          </p><p>
            For partitioned tables, <code class="literal">Engine</code> shows the
            name of the storage engine used by all partitions.
          </p></li><li class="listitem"><p>
            <code class="literal">Version</code>
          </p><p>
            This column is unused. With the removal of
            <code class="filename">.frm</code> files in MySQL 8.0, this column
            now reports a hardcoded value of <code class="literal">10</code>,
            which is the last <code class="filename">.frm</code> file version
            used in MySQL 5.7.
          </p></li><li class="listitem"><p>
            <code class="literal">Row_format</code>
          </p><p>
            The row-storage format (<code class="literal">Fixed</code>,
            <code class="literal">Dynamic</code>, <code class="literal">Compressed</code>,
            <code class="literal">Redundant</code>, <code class="literal">Compact</code>).
            For <code class="literal">MyISAM</code> tables,
            <code class="literal">Dynamic</code> corresponds to what
            <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk -dvv</strong></span></a> reports as
            <code class="literal">Packed</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Rows</code>
          </p><p>
            The number of rows. Some storage engines, such as
            <code class="literal">MyISAM</code>, store the exact count. For other
            storage engines, such as <code class="literal">InnoDB</code>, this
            value is an approximation, and may vary from the actual
            value by as much as 40% to 50%. In such cases, use
            <code class="literal">SELECT COUNT(*)</code> to obtain an accurate
            count.
          </p><p>
            The <code class="literal">Rows</code> value is <code class="literal">NULL</code>
            for <code class="literal">INFORMATION_SCHEMA</code> tables.
          </p><p>
            For <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables, the row
            count is only a rough estimate used in SQL optimization.
            (This is also true if the
            <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> table is partitioned.)
          </p></li><li class="listitem"><p>
            <code class="literal">Avg_row_length</code>
          </p><p>
            The average row length.
          </p></li><li class="listitem"><p>
            <code class="literal">Data_length</code>
          </p><p>
            For <code class="literal">MyISAM</code>,
            <code class="literal">Data_length</code> is the length of the data
            file, in bytes.
          </p><p>
            For <code class="literal">InnoDB</code>,
            <code class="literal">Data_length</code> is the approximate amount of
            memory allocated for the clustered index, in bytes.
            Specifically, it is the clustered index size, in pages,
            multiplied by the <code class="literal">InnoDB</code> page size.
          </p><p>
            Refer to the notes at the end of this section for
            information regarding other storage engines.
          </p></li><li class="listitem"><p>
            <code class="literal">Max_data_length</code>
          </p><p>
            For <code class="literal">MyISAM</code>,
            <code class="literal">Max_data_length</code> is maximum length of the
            data file. This is the total number of bytes of data that
            can be stored in the table, given the data pointer size
            used.
          </p><p>
            Unused for <code class="literal">InnoDB</code>.
          </p><p>
            Refer to the notes at the end of this section for
            information regarding other storage engines.
          </p></li><li class="listitem"><p>
            <code class="literal">Index_length</code>
          </p><p>
            For <code class="literal">MyISAM</code>,
            <code class="literal">Index_length</code> is the length of the index
            file, in bytes.
          </p><p>
            For <code class="literal">InnoDB</code>,
            <code class="literal">Index_length</code> is the approximate amount of
            memory allocated for non-clustered indexes, in bytes.
            Specifically, it is the sum of non-clustered index sizes, in
            pages, multiplied by the <code class="literal">InnoDB</code> page
            size.
          </p><p>
            Refer to the notes at the end of this section for
            information regarding other storage engines.
          </p></li><li class="listitem"><p>
            <code class="literal">Data_free</code>
          </p><p>
            The number of allocated but unused bytes.
          </p><p>
            <code class="literal">InnoDB</code> tables report the free space of
            the tablespace to which the table belongs. For a table
            located in the shared tablespace, this is the free space of
            the shared tablespace. If you are using multiple tablespaces
            and the table has its own tablespace, the free space is for
            only that table. Free space means the number of bytes in
            completely free extents minus a safety margin. Even if free
            space displays as 0, it may be possible to insert rows as
            long as new extents need not be allocated.
          </p><p>
            For NDB Cluster, <code class="literal">Data_free</code> shows the
            space allocated on disk for, but not used by, a Disk Data
            table or fragment on disk. (In-memory data resource usage is
            reported by the <code class="literal">Data_length</code> column.)
          </p><p>
            For partitioned tables, this value is only an estimate and
            may not be absolutely correct. A more accurate method of
            obtaining this information in such cases is to query the
            <code class="literal">INFORMATION_SCHEMA</code>
            <a class="link" href="information-schema.html#partitions-table" title="25.17 The INFORMATION_SCHEMA PARTITIONS Table"><code class="literal">PARTITIONS</code></a> table, as shown in
            this example:
          </p><pre data-lang="sql" class="programlisting">
SELECT SUM(DATA_FREE)
    FROM  INFORMATION_SCHEMA.PARTITIONS
    WHERE TABLE_SCHEMA = 'mydb'
    AND   TABLE_NAME   = 'mytable';
</pre><p>
            For more information, see
            <a class="xref" href="information-schema.html#partitions-table" title="25.17 The INFORMATION_SCHEMA PARTITIONS Table">Section 25.17, “The INFORMATION_SCHEMA PARTITIONS Table”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Auto_increment</code>
          </p><p>
            The next <code class="literal">AUTO_INCREMENT</code> value.
          </p></li><li class="listitem"><p>
            <code class="literal">Create_time</code>
          </p><p>
            When the table was created.
          </p></li><li class="listitem"><p>
            <code class="literal">Update_time</code>
          </p><p>
            When the data file was last updated. For some storage
            engines, this value is <code class="literal">NULL</code>. For example,
            <code class="literal">InnoDB</code> stores multiple tables in its
            <a class="link" href="glossary.html#glos_system_tablespace" title="system tablespace">system
            tablespace</a> and the data file timestamp does not
            apply. Even with
            <a class="link" href="glossary.html#glos_file_per_table" title="file-per-table">file-per-table</a>
            mode with each <code class="literal">InnoDB</code> table in a separate
            <code class="literal">.ibd</code> file,
            <a class="link" href="glossary.html#glos_change_buffering" title="change buffering">change
            buffering</a> can delay the write to the data file, so
            the file modification time is different from the time of the
            last insert, update, or delete. For
            <code class="literal">MyISAM</code>, the data file timestamp is used;
            however, on Windows the timestamp is not updated by updates,
            so the value is inaccurate.
          </p><p>
            <code class="literal">Update_time</code> displays a timestamp value
            for the last <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>,
            <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>, or
            <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> performed on
            <code class="literal">InnoDB</code> tables that are not partitioned.
            For MVCC, the timestamp value reflects the
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a> time, which is
            considered the last update time. Timestamps are not
            persisted when the server is restarted or when the table is
            evicted from the <code class="literal">InnoDB</code> data dictionary
            cache.
          </p></li><li class="listitem"><p>
            <code class="literal">Check_time</code>
          </p><p>
            When the table was last checked. Not all storage engines
            update this time, in which case, the value is always
            <code class="literal">NULL</code>.
          </p><p>
            For partitioned <a class="link" href="innodb-storage-engine.html" title="Chapter 15 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables,
            <code class="literal">Check_time</code> is always
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Collation</code>
          </p><p>
            The table default collation. The output does not explicitly
            list the table default character set, but the collation name
            begins with the character set name.
          </p></li><li class="listitem"><p>
            <code class="literal">Checksum</code>
          </p><p>
            The live checksum value, if any.
          </p></li><li class="listitem"><p>
            <code class="literal">Create_options</code>
          </p><p>
            Extra options used with <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE
            TABLE</code></a>. The original options from when
            <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> was executed are
            retained and the options reported here may differ from the
            active table settings and options.
          </p><p>
            For <code class="literal">InnoDB</code> tables, the actual
            <code class="literal">ROW_FORMAT</code> and
            <code class="literal">KEY_BLOCK_SIZE</code> options are reported.
            Prior to MySQL 8.0, <code class="literal">Create_options</code>
            reports the originally supplied
            <code class="literal">ROW_FORMAT</code> and
            <code class="literal">KEY_BLOCK_SIZE</code>. For more information, see
            <a class="xref" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax">Section 13.1.20, “CREATE TABLE Syntax”</a>.
          </p><p>
            <code class="literal">Create_options</code> shows
            <code class="literal">partitioned</code> if the table is partitioned.
            It also shows the <code class="literal">ENCRYPTION</code> option
            specified when creating or altering a file-per-table
            tablespace. This column does not show the encryption option
            specified when creating or altering a general tablespace.
            The <code class="literal">ENCRYPTION</code> column of the
            <a class="link" href="information-schema.html#innodb-tablespaces-table" title="25.39.25 The INFORMATION_SCHEMA INNODB_TABLESPACES Table"><code class="literal">INNODB_TABLESPACES</code></a> table is
            applicable to both file-per-table and general tablespaces.
          </p></li><li class="listitem"><p>
            <code class="literal">Comment</code>
          </p><p>
            The comment used when creating the table (or information as
            to why MySQL could not access the table information).
</p></li></ul>
</div>
<h5><a name="idm140091654669280"></a>Notes</h5>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables, the output of
            this statement shows appropriate values for the
            <code class="literal">Avg_row_length</code> and
            <code class="literal">Data_length</code> columns, with the exception
            that <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> columns are not
            taken into account.
          </p></li><li class="listitem"><p>
            For <a class="link" href="mysql-cluster.html" title="Chapter 22 MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> tables,
            <code class="literal">Data_length</code> includes data stored in main
            memory only; the <code class="literal">Max_data_length</code> and
            <code class="literal">Data_free</code> columns apply to Disk Data.
          </p></li><li class="listitem"><p>
            For NDB Cluster Disk Data tables,
            <code class="literal">Max_data_length</code> shows the space allocated
            for the disk part of a Disk Data table or fragment.
            (In-memory data resource usage is reported by the
            <code class="literal">Data_length</code> column.)
          </p></li><li class="listitem"><p>
            For <code class="literal">MEMORY</code> tables, the
            <code class="literal">Data_length</code>,
            <code class="literal">Max_data_length</code>, and
            <code class="literal">Index_length</code> values approximate the
            actual amount of allocated memory. The allocation algorithm
            reserves memory in large amounts to reduce the number of
            allocation operations.
          </p></li><li class="listitem"><p>
            For views, most columns displayed by
            <a class="link" href="sql-syntax.html#show-table-status" title="13.7.6.36 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a> are 0 or
            <code class="literal">NULL</code> except that <code class="literal">Name</code>
            indicates the view name, <code class="literal">Create_time</code>
            indicates the creation time, and <code class="literal">Comment</code>
            says <code class="literal">VIEW</code>.
</p></li></ul>
</div>
<p>
        Table information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#tables-table" title="25.30 The INFORMATION_SCHEMA TABLES Table"><code class="literal">TABLES</code></a> table. See
        <a class="xref" href="information-schema.html#tables-table" title="25.30 The INFORMATION_SCHEMA TABLES Table">Section 25.30, “The INFORMATION_SCHEMA TABLES Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-tables"></a>13.7.6.37 SHOW TABLES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091654642928"></a><a class="indexterm" name="idm140091654640112"></a><pre data-lang="sql" class="programlisting">
SHOW [EXTENDED] [FULL] TABLES
    [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-tables" title="13.7.6.37 SHOW TABLES Syntax"><code class="literal">SHOW TABLES</code></a> lists the
        non-<code class="literal">TEMPORARY</code> tables in a given database. You
        can also get this list using the <a class="link" href="programs.html#mysqlshow" title="4.5.7 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow
        <em class="replaceable"><code>db_name</code></em></strong></span></a> command. The
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which table names to match. The <code class="literal">WHERE</code> clause
        can be given to select rows using more general conditions, as
        discussed in <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><p>
        Matching performed by the <code class="literal">LIKE</code> clause is
        dependent on the setting of the
        <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> system
        variable.
      </p><p>
        The optional <code class="literal">EXTENDED</code> modifier causes
        <a class="link" href="sql-syntax.html#show-tables" title="13.7.6.37 SHOW TABLES Syntax"><code class="literal">SHOW TABLES</code></a> to list hidden tables
        created by failed <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
        statements. These temporary tables have names beginning with
        <code class="literal">#sql</code> and can be dropped using
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>.
      </p><p>
        This statement also lists any views in the database. The
        optional <code class="literal">FULL</code> modifier causes
        <a class="link" href="sql-syntax.html#show-tables" title="13.7.6.37 SHOW TABLES Syntax"><code class="literal">SHOW TABLES</code></a> to display a second
        output column with values of <code class="literal">BASE TABLE</code> for a
        table, <code class="literal">VIEW</code> for a view, or <code class="literal">SYSTEM
        VIEW</code> for an <code class="literal">INFORMATION_SCHEMA</code>
        table.
      </p><p>
        If you have no privileges for a base table or view, it does not
        show up in the output from <a class="link" href="sql-syntax.html#show-tables" title="13.7.6.37 SHOW TABLES Syntax"><code class="literal">SHOW
        TABLES</code></a> or <a class="link" href="programs.html#mysqlshow" title="4.5.7 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow db_name</strong></span></a>.
      </p><p>
        Table information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#tables-table" title="25.30 The INFORMATION_SCHEMA TABLES Table"><code class="literal">TABLES</code></a> table. See
        <a class="xref" href="information-schema.html#tables-table" title="25.30 The INFORMATION_SCHEMA TABLES Table">Section 25.30, “The INFORMATION_SCHEMA TABLES Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-triggers"></a>13.7.6.38 SHOW TRIGGERS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091654606192"></a><a class="indexterm" name="idm140091654605120"></a><a class="indexterm" name="idm140091654604048"></a><pre data-lang="sql" class="programlisting">
SHOW TRIGGERS
    [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-triggers" title="13.7.6.38 SHOW TRIGGERS Syntax"><code class="literal">SHOW TRIGGERS</code></a> lists the triggers
        currently defined for tables in a database (the default database
        unless a <code class="literal">FROM</code> clause is given). This
        statement returns results only for databases and tables for
        which you have the <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a>
        privilege. The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if
        present, indicates which table names (not trigger names) to
        match and causes the statement to display triggers for those
        tables. The <code class="literal">WHERE</code> clause can be given to
        select rows using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><p>
        For the <code class="literal">ins_sum</code> trigger defined in
        <a class="xref" href="stored-objects.html#triggers" title="24.3 Using Triggers">Section 24.3, “Using Triggers”</a>, the output of
        <a class="link" href="sql-syntax.html#show-triggers" title="13.7.6.38 SHOW TRIGGERS Syntax"><code class="literal">SHOW TRIGGERS</code></a> is as shown here:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW TRIGGERS LIKE 'acc%'\G</code></strong>
*************************** 1. row ***************************
             Trigger: ins_sum
               Event: INSERT
               Table: account
           Statement: SET @sum = @sum + NEW.amount
              Timing: BEFORE
             Created: 2018-08-08 10:10:12.61
            sql_mode: ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,
                      NO_ZERO_IN_DATE,NO_ZERO_DATE,
                      ERROR_FOR_DIVISION_BY_ZERO,
                      NO_ENGINE_SUBSTITUTION
             Definer: me@localhost
character_set_client: utf8mb4
collation_connection: utf8mb4_0900_ai_ci
  Database Collation: utf8mb4_0900_ai_ci
</pre><p>
        <a class="link" href="sql-syntax.html#show-triggers" title="13.7.6.38 SHOW TRIGGERS Syntax"><code class="literal">SHOW TRIGGERS</code></a> output has these
        columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Trigger</code>
          </p><p>
            The name of the trigger.
          </p></li><li class="listitem"><p>
            <code class="literal">Event</code>
          </p><p>
            The trigger event. This is the type of operation on the
            associated table for which the trigger activates. The value
            is <code class="literal">INSERT</code> (a row was inserted),
            <code class="literal">DELETE</code> (a row was deleted), or
            <code class="literal">UPDATE</code> (a row was modified).
          </p></li><li class="listitem"><p>
            <code class="literal">Table</code>
          </p><p>
            The table for which the trigger is defined.
          </p></li><li class="listitem"><p>
            <code class="literal">Statement</code>
          </p><p>
            The trigger body; that is, the statement executed when the
            trigger activates.
          </p></li><li class="listitem"><p>
            <code class="literal">Timing</code>
          </p><p>
            Whether the trigger activates before or after the triggering
            event. The value is <code class="literal">BEFORE</code> or
            <code class="literal">AFTER</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Created</code>
          </p><p>
            The date and time when the trigger was created. This is a
            <code class="literal">TIMESTAMP(2)</code> value (with a fractional
            part in hundredths of seconds) for triggers.
          </p></li><li class="listitem"><p>
            <code class="literal">sql_mode</code>
          </p><p>
            The SQL mode in effect when the trigger was created, and
            under which the trigger executes. For the permitted values,
            see <a class="xref" href="server-administration.html#sql-mode" title="5.1.11 Server SQL Modes">Section 5.1.11, “Server SQL Modes”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Definer</code>
          </p><p>
            The account of the user who created the trigger, in
            <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>
            format.
          </p></li><li class="listitem"><p>
            <code class="literal">character_set_client</code>
          </p><p>
            The session value of the
            <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
            variable when the trigger was created.
          </p></li><li class="listitem"><p>
            <code class="literal">collation_connection</code>
          </p><p>
            The session value of the
            <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
            variable when the trigger was created.
          </p></li><li class="listitem"><p>
            <code class="literal">Database Collation</code>
          </p><p>
            The collation of the database with which the trigger is
            associated.
</p></li></ul>
</div>
<p>
        Trigger information is also available from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#triggers-table" title="25.34 The INFORMATION_SCHEMA TRIGGERS Table"><code class="literal">TRIGGERS</code></a> table. See
        <a class="xref" href="information-schema.html#triggers-table" title="25.34 The INFORMATION_SCHEMA TRIGGERS Table">Section 25.34, “The INFORMATION_SCHEMA TRIGGERS Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-variables"></a>13.7.6.39 SHOW VARIABLES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091654548416"></a><a class="indexterm" name="idm140091654547328"></a><a class="indexterm" name="idm140091654546256"></a><a class="indexterm" name="idm140091654545184"></a><a class="indexterm" name="idm140091654543696"></a><pre data-lang="sql" class="programlisting">
SHOW [GLOBAL | SESSION] VARIABLES
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><a class="indexterm" name="idm140091654538336"></a><p>
        <a class="link" href="sql-syntax.html#show-variables" title="13.7.6.39 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a> shows the values
        of MySQL system variables (see
        <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>). This statement does
        not require any privilege. It requires only the ability to
        connect to the server.
      </p><p>
        System variable information is also available from these
        sources:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Performance Schema tables. See
            <a class="xref" href="performance-schema.html#performance-schema-system-variable-tables" title="26.12.13 Performance Schema System Variable Tables">Section 26.12.13, “Performance Schema System Variable Tables”</a>.
          </p></li><li class="listitem"><p>
            The <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin variables</strong></span></a> command. See
            <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>.
</p></li></ul>
</div>
<p>
        For <a class="link" href="sql-syntax.html#show-variables" title="13.7.6.39 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a>, a
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which variable names to match. A <code class="literal">WHERE</code> clause
        can be given to select rows using more general conditions, as
        discussed in <a class="xref" href="information-schema.html#extended-show" title="25.42 Extensions to SHOW Statements">Section 25.42, “Extensions to SHOW Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-variables" title="13.7.6.39 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a> accepts an
        optional <code class="literal">GLOBAL</code> or <code class="literal">SESSION</code>
        variable scope modifier:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            With a <code class="literal">GLOBAL</code> modifier, the statement
            displays global system variable values. These are the values
            used to initialize the corresponding session variables for
            new connections to MySQL. If a variable has no global value,
            no value is displayed.
          </p></li><li class="listitem"><p>
            With a <code class="literal">SESSION</code> modifier, the statement
            displays the system variable values that are in effect for
            the current connection. If a variable has no session value,
            the global value is displayed. <code class="literal">LOCAL</code> is a
            synonym for <code class="literal">SESSION</code>.
          </p></li><li class="listitem"><p>
            If no modifier is present, the default is
            <code class="literal">SESSION</code>.
</p></li></ul>
</div>
<p>
        The scope for each system variable is listed at
        <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-variables" title="13.7.6.39 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a> is subject to a
        version-dependent display-width limit. For variables with very
        long values that are not completely displayed, use
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> as a workaround. For
        example:
      </p><pre data-lang="sql" class="programlisting">
SELECT @@GLOBAL.innodb_data_file_path;
</pre><p>
        Most system variables can be set at server startup (read-only
        variables such as
        <a class="link" href="server-administration.html#sysvar_version_comment"><code class="literal">version_comment</code></a> are
        exceptions). Many can be changed at runtime with the
        <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET</code></a>
        statement. See <a class="xref" href="server-administration.html#using-system-variables" title="5.1.9 Using System Variables">Section 5.1.9, “Using System Variables”</a>, and
        <a class="xref" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment">Section 13.7.5.1, “SET Syntax for Variable Assignment”</a>.
      </p><p>
        Partial output is shown here. The list of names and values may
        differ for your server.
        <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8 Server System Variables">Section 5.1.8, “Server System Variables”</a>, describes the meaning
        of each variable, and <a class="xref" href="server-administration.html#server-configuration" title="5.1.1 Configuring the Server">Section 5.1.1, “Configuring the Server”</a>,
        provides information about tuning them.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW VARIABLES;</code></strong>
+--------------------------------------------+------------------------------+
| Variable_name                              | Value                        |
+--------------------------------------------+------------------------------+
| activate_all_roles_on_login                | OFF                          |
| auto_generate_certs                        | ON                           |
| auto_increment_increment                   | 1                            |
| auto_increment_offset                      | 1                            |
| autocommit                                 | ON                           |
| automatic_sp_privileges                    | ON                           |
| avoid_temporal_upgrade                     | OFF                          |
| back_log                                   | 151                          |
| basedir                                    | /usr/                        |
| big_tables                                 | OFF                          |
| bind_address                               | *                            |
| binlog_cache_size                          | 32768                        |
| binlog_checksum                            | CRC32                        |
| binlog_direct_non_transactional_updates    | OFF                          |
| binlog_error_action                        | ABORT_SERVER                 |
| binlog_expire_logs_seconds                 | 2592000                      |
| binlog_format                              | ROW                          |
| binlog_group_commit_sync_delay             | 0                            |
| binlog_group_commit_sync_no_delay_count    | 0                            |
| binlog_gtid_simple_recovery                | ON                           |
| binlog_max_flush_queue_time                | 0                            |
| binlog_order_commits                       | ON                           |
| binlog_row_image                           | FULL                         |
| binlog_row_metadata                        | MINIMAL                      |
| binlog_row_value_options                   |                              |
| binlog_rows_query_log_events               | OFF                          |
| binlog_stmt_cache_size                     | 32768                        |
| binlog_transaction_dependency_history_size | 25000                        |
| binlog_transaction_dependency_tracking     | COMMIT_ORDER                 |
| block_encryption_mode                      | aes-128-ecb                  |
| bulk_insert_buffer_size                    | 8388608                      |

...

| max_allowed_packet                         | 67108864                     |
| max_binlog_cache_size                      | 18446744073709547520         |
| max_binlog_size                            | 1073741824                   |
| max_binlog_stmt_cache_size                 | 18446744073709547520         |
| max_connect_errors                         | 100                          |
| max_connections                            | 151                          |
| max_delayed_threads                        | 20                           |
| max_digest_length                          | 1024                         |
| max_error_count                            | 1024                         |
| max_execution_time                         | 0                            |
| max_heap_table_size                        | 16777216                     |
| max_insert_delayed_threads                 | 20                           |
| max_join_size                              | 18446744073709551615         |

...

| thread_handling                            | one-thread-per-connection    |
| thread_stack                               | 286720                       |
| time_zone                                  | SYSTEM                       |
| timestamp                                  | 1530906638.765316            |
| tls_version                                | TLSv1,TLSv1.1,TLSv1.2        |
| tmp_table_size                             | 16777216                     |
| tmpdir                                     | /tmp                         |
| transaction_alloc_block_size               | 8192                         |
| transaction_allow_batching                 | OFF                          |
| transaction_isolation                      | REPEATABLE-READ              |
| transaction_prealloc_size                  | 4096                         |
| transaction_read_only                      | OFF                          |
| transaction_write_set_extraction           | XXHASH64                     |
| unique_checks                              | ON                           |
| updatable_views_with_limit                 | YES                          |
| version                                    | 8.0.12                       |
| version_comment                            | MySQL Community Server - GPL |
| version_compile_machine                    | x86_64                       |
| version_compile_os                         | Linux                        |
| version_compile_zlib                       | 1.2.11                       |
| wait_timeout                               | 28800                        |
| warning_count                              | 0                            |
| windowing_use_high_precision               | ON                           |
+--------------------------------------------+------------------------------+
</pre><p>
        With a <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, the statement
        displays only rows for those variables with names that match the
        pattern. To obtain the row for a specific variable, use a
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause as shown:
      </p><pre data-lang="sql" class="programlisting">
SHOW VARIABLES LIKE 'max_join_size';
SHOW SESSION VARIABLES LIKE 'max_join_size';
</pre><p>
        To get a list of variables whose name match a pattern, use the
        <code class="literal">%</code> wildcard character in a
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause:
      </p><pre data-lang="sql" class="programlisting">
SHOW VARIABLES LIKE '%size%';
SHOW GLOBAL VARIABLES LIKE '%size%';
</pre><p>
        Wildcard characters can be used in any position within the
        pattern to be matched. Strictly speaking, because
        <code class="literal">_</code> is a wildcard that matches any single
        character, you should escape it as <code class="literal">\_</code> to
        match it literally. In practice, this is rarely necessary.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-warnings"></a>13.7.6.40 SHOW WARNINGS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091654476960"></a><a class="indexterm" name="idm140091654475888"></a><pre data-lang="sql" class="programlisting">
SHOW WARNINGS [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
SHOW COUNT(*) WARNINGS
</pre><p>
        <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> is a diagnostic
        statement that displays information about the conditions
        (errors, warnings, and notes) resulting from executing a
        statement in the current session. Warnings are generated for DML
        statements such as <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>,
        <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a>, and
        <a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a> as well as DDL
        statements such as <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
        and <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>.
      </p><p>
        The <code class="literal">LIMIT</code> clause has the same syntax as for
        the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement. See
        <a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax">Section 13.2.10, “SELECT Syntax”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> is also used
        following <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>, to display the
        extended information generated by
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>. See
        <a class="xref" href="optimization.html#explain-extended" title="8.8.3 Extended EXPLAIN Output Format">Section 8.8.3, “Extended EXPLAIN Output Format”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> displays
        information about the conditions resulting from execution of the
        most recent nondiagnostic statement in the current session. If
        the most recent statement resulted in an error during parsing,
        <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> shows the resulting
        conditions, regardless of statement type (diagnostic or
        nondiagnostic).
      </p><p>
        The <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW COUNT(*)
        WARNINGS</code></a> diagnostic statement displays the total
        number of errors, warnings, and notes. You can also retrieve
        this number from the
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> system variable:
      </p><pre data-lang="sql" class="programlisting">
SHOW COUNT(*) WARNINGS;
SELECT @@warning_count;
</pre><p>
        A difference in these statements is that the first is a
        diagnostic statement that does not clear the message list. The
        second, because it is a <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>
        statement is considered nondiagnostic and does clear the message
        list.
      </p><p>
        A related diagnostic statement, <a class="link" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax"><code class="literal">SHOW
        ERRORS</code></a>, shows only error conditions (it excludes
        warnings and notes), and
        <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW COUNT(*)
        ERRORS</code></a> statement displays the total number of errors.
        See <a class="xref" href="sql-syntax.html#show-errors" title="13.7.6.17 SHOW ERRORS Syntax">Section 13.7.6.17, “SHOW ERRORS Syntax”</a>. <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a> can be used to examine information for
        individual conditions. See <a class="xref" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax">Section 13.6.7.3, “GET DIAGNOSTICS Syntax”</a>.
      </p><p>
        Here is a simple example that shows data-conversion warnings for
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>. The example assumes that
        strict SQL mode is disabled. With strict mode enabled, the
        warnings would become errors and terminate the
        <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>.
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (a TINYINT NOT NULL, b CHAR(4));</code></strong>
Query OK, 0 rows affected (0.05 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t1 VALUES(10,'mysql'), (NULL,'test'), (300,'xyz');</code></strong>
Query OK, 3 rows affected, 3 warnings (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 3

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Warning
   Code: 1265
Message: Data truncated for column 'b' at row 1
*************************** 2. row ***************************
  Level: Warning
   Code: 1048
Message: Column 'a' cannot be null
*************************** 3. row ***************************
  Level: Warning
   Code: 1264
Message: Out of range value for column 'a' at row 3
3 rows in set (0.00 sec)
</pre><p>
        The <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> system
        variable controls the maximum number of error, warning, and note
        messages for which the server stores information, and thus the
        number of messages that <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW
        WARNINGS</code></a> displays. To change the number of messages
        the server can store, change the value of
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>.
      </p><p>
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> controls only
        how many messages are stored, not how many are counted. The
        value of <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> is not
        limited by <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>,
        even if the number of messages generated exceeds
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>. The following
        example demonstrates this. The <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a> statement produces three warning messages
        (strict SQL mode is disabled for the example to prevent an error
        from occuring after a single conversion issue). Only one message
        is stored and displayed because
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> has been set to
        1, but all three are counted (as shown by the value of
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a>):
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'max_error_count';</code></strong>
+-----------------+-------+
| Variable_name   | Value |
+-----------------+-------+
| max_error_count | 1024  |
+-----------------+-------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET max_error_count=1, sql_mode = '';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>ALTER TABLE t1 MODIFY b CHAR;</code></strong>
Query OK, 3 rows affected, 3 warnings (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 3

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+----------------------------------------+
| Level   | Code | Message                                |
+---------+------+----------------------------------------+
| Warning | 1263 | Data truncated for column 'b' at row 1 |
+---------+------+----------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @@warning_count;</code></strong>
+-----------------+
| @@warning_count |
+-----------------+
|               3 |
+-----------------+
1 row in set (0.01 sec)
</pre><p>
        To disable message storage, set
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> to 0. In this
        case, <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> still
        indicates how many warnings occurred, but messages are not
        stored and cannot be displayed.
      </p><p>
        The <a class="link" href="server-administration.html#sysvar_sql_notes"><code class="literal">sql_notes</code></a> system variable
        controls whether note messages increment
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> and whether the
        server stores them. By default,
        <a class="link" href="server-administration.html#sysvar_sql_notes"><code class="literal">sql_notes</code></a> is 1, but if set to
        0, notes do not increment
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> and the server
        does not store them:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>SET sql_notes = 1;</code></strong>
mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS test.no_such_table;</code></strong>
Query OK, 0 rows affected, 1 warning (0.00 sec)
mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------------+
| Level | Code | Message                            |
+-------+------+------------------------------------+
| Note  | 1051 | Unknown table 'test.no_such_table' |
+-------+------+------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET sql_notes = 0;</code></strong>
mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS test.no_such_table;</code></strong>
Query OK, 0 rows affected (0.00 sec)
mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
Empty set (0.00 sec)
</pre><p>
        The MySQL server sends to each client a count indicating the
        total number of errors, warnings, and notes resulting from the
        most recent statement executed by that client. From the C API,
        this value can be obtained by calling
        <a class="link" href="connectors-apis.html#mysql-warning-count" title="28.7.7.82 mysql_warning_count()"><code class="literal">mysql_warning_count()</code></a>. See
        <a class="xref" href="connectors-apis.html#mysql-warning-count" title="28.7.7.82 mysql_warning_count()">Section 28.7.7.82, “mysql_warning_count()”</a>.
      </p><p>
        In the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client, you can enable and
        disable automatic warnings display using the
        <code class="literal">warnings</code> and <code class="literal">nowarning</code>
        commands, respectively, or their shortcuts,
        <code class="literal">\W</code> and <code class="literal">\w</code> (see
        <a class="xref" href="programs.html#mysql-commands" title="4.5.1.2 mysql Client Commands">Section 4.5.1.2, “mysql Client Commands”</a>). For example:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>\W</code></strong>
Show warnings enabled.
mysql&gt; <strong class="userinput"><code>SELECT 1/0;</code></strong>
+------+
| 1/0  |
+------+
| NULL |
+------+
1 row in set, 1 warning (0.03 sec)

Warning (Code 1365): Division by 0
mysql&gt; <strong class="userinput"><code>\w</code></strong>
Show warnings disabled.
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="other-administrative-sql"></a>13.7.7 Other Administrative Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#binlog">13.7.7.1 BINLOG Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#cache-index">13.7.7.2 CACHE INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#flush">13.7.7.3 FLUSH Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#kill">13.7.7.4 KILL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#load-index">13.7.7.5 LOAD INDEX INTO CACHE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#reset">13.7.7.6 RESET Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#reset-persist">13.7.7.7 RESET PERSIST Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#restart">13.7.7.8 RESTART Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#shutdown">13.7.7.9 SHUTDOWN Syntax</a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="binlog"></a>13.7.7.1 BINLOG Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091654383200"></a><pre data-lang="sql" class="programlisting">
BINLOG '<em class="replaceable"><code>str</code></em>'
</pre><p>
        <a class="link" href="sql-syntax.html#binlog" title="13.7.7.1 BINLOG Syntax"><code class="literal">BINLOG</code></a> is an internal-use
        statement. It is generated by the <a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files"><span class="command"><strong>mysqlbinlog</strong></span></a>
        program as the printable representation of certain events in
        binary log files. (See <a class="xref" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files">Section 4.6.8, “<span class="command"><strong>mysqlbinlog</strong></span> — Utility for Processing Binary Log Files”</a>.) The
        <code class="literal">'<em class="replaceable"><code>str</code></em>'</code> value is a
        base 64-encoded string the that server decodes to determine the
        data change indicated by the corresponding event. This statement
        requires the <a class="link" href="security.html#priv_binlog-admin"><code class="literal">BINLOG_ADMIN</code></a> or
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        This statement can execute only format description events and
        row events.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="cache-index"></a>13.7.7.2 CACHE INDEX Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091654368736"></a><a class="indexterm" name="idm140091654367664"></a><a class="indexterm" name="idm140091654366176"></a><pre data-lang="sql" class="programlisting">
CACHE INDEX {
      <em class="replaceable"><code>tbl_index_list</code></em> [, <em class="replaceable"><code>tbl_index_list</code></em>] ...
    | <em class="replaceable"><code>tbl_name</code></em> PARTITION (<em class="replaceable"><code>partition_list</code></em>)
  }
  IN <em class="replaceable"><code>key_cache_name</code></em>

<em class="replaceable"><code>tbl_index_list</code></em>:
  <em class="replaceable"><code>tbl_name</code></em> [{INDEX|KEY} (<em class="replaceable"><code>index_name</code></em>[, <em class="replaceable"><code>index_name</code></em>] ...)]

<em class="replaceable"><code>partition_list</code></em>: {
    <em class="replaceable"><code>partition_name</code></em>[, <em class="replaceable"><code>partition_name</code></em>] ...
  | ALL
}
</pre><p>
        The <a class="link" href="sql-syntax.html#cache-index" title="13.7.7.2 CACHE INDEX Syntax"><code class="literal">CACHE INDEX</code></a> statement assigns
        table indexes to a specific key cache. It applies only to
        <code class="literal">MyISAM</code> tables, including partitioned
        <code class="literal">MyISAM</code> tables. After the indexes have been
        assigned, they can be preloaded into the cache if desired with
        <a class="link" href="sql-syntax.html#load-index" title="13.7.7.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD INDEX INTO
        CACHE</code></a>.
      </p><p>
        The following statement assigns indexes from the tables
        <code class="literal">t1</code>, <code class="literal">t2</code>, and
        <code class="literal">t3</code> to the key cache named
        <code class="literal">hot_cache</code>:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CACHE INDEX t1, t2, t3 IN hot_cache;</code></strong>
+---------+--------------------+----------+----------+
| Table   | Op                 | Msg_type | Msg_text |
+---------+--------------------+----------+----------+
| test.t1 | assign_to_keycache | status   | OK       |
| test.t2 | assign_to_keycache | status   | OK       |
| test.t3 | assign_to_keycache | status   | OK       |
+---------+--------------------+----------+----------+
</pre><p>
        The syntax of <a class="link" href="sql-syntax.html#cache-index" title="13.7.7.2 CACHE INDEX Syntax"><code class="literal">CACHE INDEX</code></a> enables
        you to specify that only particular indexes from a table should
        be assigned to the cache. However, the implementation assigns
        all the table's indexes to the cache, so there is no reason to
        specify anything other than the table name.
      </p><p>
        The key cache referred to in a <a class="link" href="sql-syntax.html#cache-index" title="13.7.7.2 CACHE INDEX Syntax"><code class="literal">CACHE
        INDEX</code></a> statement can be created by setting its size
        with a parameter setting statement or in the server parameter
        settings. For example:
      </p><pre data-lang="sql" class="programlisting">
SET GLOBAL keycache1.key_buffer_size=128*1024;
</pre><p>
        Key cache parameters are accessed as members of a structured
        system variable. See
        <a class="xref" href="server-administration.html#structured-system-variables" title="5.1.9.5 Structured System Variables">Section 5.1.9.5, “Structured System Variables”</a>.
      </p><p>
        A key cache must exist before you assign indexes to it, or an
        error occurs:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CACHE INDEX t1 IN non_existent_cache;</code></strong>
ERROR 1284 (HY000): Unknown key cache 'non_existent_cache'
</pre><p>
        By default, table indexes are assigned to the main (default) key
        cache created at the server startup. When a key cache is
        destroyed, all indexes assigned to it are reassigned to the
        default key cache.
      </p><p>
        Index assignment affects the server globally: If one client
        assigns an index to a given cache, this cache is used for all
        queries involving the index, no matter which client issues the
        queries.
      </p><p>
        <a class="link" href="sql-syntax.html#cache-index" title="13.7.7.2 CACHE INDEX Syntax"><code class="literal">CACHE INDEX</code></a> is supported for
        partitioned <code class="literal">MyISAM</code> tables. You can assign one
        or more indexes for one, several, or all partitions to a given
        key cache. For example, you can do the following:
      </p><pre data-lang="sql" class="programlisting">
CREATE TABLE pt (c1 INT, c2 VARCHAR(50), INDEX i(c1))
    ENGINE=MyISAM
    PARTITION BY HASH(c1)
    PARTITIONS 4;

SET GLOBAL kc_fast.key_buffer_size = 128 * 1024;
SET GLOBAL kc_slow.key_buffer_size = 128 * 1024;

CACHE INDEX pt PARTITION (p0) IN kc_fast;
CACHE INDEX pt PARTITION (p1, p3) IN kc_slow;
</pre><p>
        The previous set of statements performs the following actions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Creates a partitioned table with 4 partitions; these
            partitions are automatically named <code class="literal">p0</code>,
            ..., <code class="literal">p3</code>; this table has an index named
            <code class="literal">i</code> on column <code class="literal">c1</code>.
          </p></li><li class="listitem"><p>
            Creates 2 key caches named <code class="literal">kc_fast</code> and
            <code class="literal">kc_slow</code>
          </p></li><li class="listitem"><p>
            Assigns the index for partition <code class="literal">p0</code> to the
            <code class="literal">kc_fast</code> key cache and the index for
            partitions <code class="literal">p1</code> and <code class="literal">p3</code>
            to the <code class="literal">kc_slow</code> key cache; the index for
            the remaining partition (<code class="literal">p2</code>) uses the
            server's default key cache.
</p></li></ul>
</div>
<p>
        If you wish instead to assign the indexes for all partitions in
        table <code class="literal">pt</code> to a single key cache named
        <code class="literal">kc_all</code>, you can use either of the following
        two statements:
      </p><pre data-lang="sql" class="programlisting">
CACHE INDEX pt PARTITION (ALL) IN kc_all;

CACHE INDEX pt IN kc_all;
</pre><p>
        The two statements just shown are equivalent, and issuing either
        one has exactly the same effect. In other words, if you wish to
        assign indexes for all partitions of a partitioned table to the
        same key cache, the <code class="literal">PARTITION (ALL)</code> clause is
        optional.
      </p><p>
        When assigning indexes for multiple partitions to a key cache,
        the partitions need not be contiguous, and you need not list
        their names in any particular order. Indexes for any partitions
        not explicitly assigned to a key cache automatically use the
        server default key cache.
      </p><p>
        Index preloading is also supported for partitioned
        <code class="literal">MyISAM</code> tables. For more information, see
        <a class="xref" href="sql-syntax.html#load-index" title="13.7.7.5 LOAD INDEX INTO CACHE Syntax">Section 13.7.7.5, “LOAD INDEX INTO CACHE Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="flush"></a>13.7.7.3 FLUSH Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091654312368"></a><a class="indexterm" name="idm140091654311296"></a><a class="indexterm" name="idm140091654310224"></a><a class="indexterm" name="idm140091654308736"></a><pre data-lang="sql" class="programlisting">
FLUSH [NO_WRITE_TO_BINLOG | LOCAL] {
    <em class="replaceable"><code>flush_option</code></em> [, <em class="replaceable"><code>flush_option</code></em>] ...
  | <em class="replaceable"><code>tables_option</code></em>
}

<em class="replaceable"><code>flush_option</code></em>: {
    BINARY LOGS
  | ENGINE LOGS
  | ERROR LOGS
  | GENERAL LOGS
  | HOSTS
  | LOGS
  | PRIVILEGES
  | OPTIMIZER_COSTS
  | RELAY LOGS [FOR CHANNEL <em class="replaceable"><code>channel</code></em>]
  | SLOW LOGS
  | STATUS
  | USER_RESOURCES
}

<em class="replaceable"><code>tables_option</code></em>: {
    TABLES
  | TABLES <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ...
  | TABLES WITH READ LOCK
  | TABLES <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ... WITH READ LOCK
  | TABLES <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ... FOR EXPORT
}
</pre><p>
        The <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement has several
        variant forms that clear or reload various internal caches,
        flush tables, or acquire locks. To execute
        <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a>, you must have the
        <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege. Specific flush
        options might require additional privileges, as described later.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          It is not possible to issue
          <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statements within stored
          functions or triggers. However, you may use
          <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> in stored procedures, so
          long as these are not called from stored functions or
          triggers. See <a class="xref" href="restrictions.html#stored-program-restrictions" title="C.1 Restrictions on Stored Programs">Section C.1, “Restrictions on Stored Programs”</a>.
</p>
</div>
<p>
        By default, the server writes
        <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statements to the binary
        log so that they replicate to replication slaves. To suppress
        logging, specify the optional
        <code class="literal">NO_WRITE_TO_BINLOG</code> keyword or its alias
        <code class="literal">LOCAL</code>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          <a class="link" href="sql-syntax.html#flush-logs"><code class="literal">FLUSH LOGS</code></a>,
          <a class="link" href="sql-syntax.html#flush-binary-logs"><code class="literal">FLUSH BINARY LOGS</code></a>,
          <a class="link" href="sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH TABLES WITH READ LOCK</code></a>
          (with or without a table list), and
          <a class="link" href="sql-syntax.html#flush-tables-for-export-with-list"><code class="literal">FLUSH
          TABLES <em class="replaceable"><code>tbl_name</code></em> ... FOR
          EXPORT</code></a> are not written to the binary log in any case
          because they would cause problems if replicated to a slave.
</p>
</div>
<p>
        The <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement causes an
        implicit commit. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        The <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin</strong></span></a> utility provides a
        command-line interface to some flush operations, using commands
        such as <code class="literal">flush-hosts</code>,
        <code class="literal">flush-logs</code>,
        <code class="literal">flush-privileges</code>,
        <code class="literal">flush-status</code>, and
        <code class="literal">flush-tables</code>. See
        <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>.
      </p><p>
        Sending a <code class="literal">SIGHUP</code> signal to the server causes
        several flush operations to occur that are similar to various
        forms of the <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement. See
        <a class="xref" href="server-administration.html#server-signal-response" title="5.1.16 Server Response to Signals">Section 5.1.16, “Server Response to Signals”</a>.
      </p><p>
        The <a class="link" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax"><code class="literal">RESET</code></a> statement is similar to
        <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a>. See
        <a class="xref" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax">Section 13.7.7.6, “RESET Syntax”</a>, for information about using the
        <a class="link" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax"><code class="literal">RESET</code></a> statement with replication.
      </p><p>
        The following list describes the permitted
        <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement
        <em class="replaceable"><code>flush_option</code></em> values. For descriptions
        of <a class="link" href="sql-syntax.html#flush-tables-variants" title="FLUSH TABLES Syntax"><code class="literal">FLUSH
        TABLES</code></a> variants, see
        <a class="xref" href="sql-syntax.html#flush-tables-variants" title="FLUSH TABLES Syntax">FLUSH TABLES Syntax</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="flush-binary-logs"></a>
            <a class="link" href="sql-syntax.html#flush-binary-logs"><code class="literal">FLUSH BINARY LOGS</code></a>
          </p><p>
            Closes and reopens any binary log file to which the server
            is writing. If binary logging is enabled, the sequence
            number of the binary log file is incremented by one relative
            to the previous file.
          </p></li><li class="listitem"><p><a name="flush-engine-logs"></a>
            <a class="link" href="sql-syntax.html#flush-engine-logs"><code class="literal">FLUSH ENGINE LOGS</code></a>
          </p><p>
            Closes and reopens any flushable logs for installed storage
            engines. This causes <code class="literal">InnoDB</code> to flush its
            logs to disk.
          </p></li><li class="listitem"><p><a name="flush-error-logs"></a>
            <a class="link" href="sql-syntax.html#flush-error-logs"><code class="literal">FLUSH ERROR LOGS</code></a>
          </p><p>
            Closes and reopens any error log file to which the server is
            writing.
          </p></li><li class="listitem"><p><a name="flush-general-logs"></a>
            <a class="link" href="sql-syntax.html#flush-general-logs"><code class="literal">FLUSH GENERAL LOGS</code></a>
          </p><p>
            Closes and reopens any general query log file to which the
            server is writing.
          </p></li><li class="listitem"><p><a name="flush-hosts"></a>
            <a class="link" href="sql-syntax.html#flush-hosts"><code class="literal">FLUSH HOSTS</code></a>
          </p><p>
            Empties the host cache and the Performance Schema
            <a class="link" href="performance-schema.html#host-cache-table" title="26.12.17.1 The host_cache Table"><code class="literal">host_cache</code></a> table that exposes
            the cache contents, and unblocks any blocked hosts. See
            <a class="xref" href="optimization.html#host-cache" title="8.12.4.2 DNS Lookup Optimization and the Host Cache">Section 8.12.4.2, “DNS Lookup Optimization and the Host Cache”</a>.
          </p><p>
            Flush the host cache if some of your hosts change IP address
            or if the error message <code class="literal">Host
            '<em class="replaceable"><code>host_name</code></em>' is blocked</code>
            occurs for connections from legitimate hosts. (See
            <a class="xref" href="error-handling.html#blocked-host" title="B.4.2.5 Host 'host_name' is blocked">Section B.4.2.5, “Host 'host_name' is blocked”</a>.) When more than
            <a class="link" href="server-administration.html#sysvar_max_connect_errors"><code class="literal">max_connect_errors</code></a> errors
            occur successively for a given host while connecting to the
            MySQL server, MySQL assumes that something is wrong and
            blocks the host from further connection requests. Flushing
            the host cache enables further connection attempts from the
            host. The default value of
            <a class="link" href="server-administration.html#sysvar_max_connect_errors"><code class="literal">max_connect_errors</code></a> is 100.
            To avoid this error message, start the server with
            <a class="link" href="server-administration.html#sysvar_max_connect_errors"><code class="literal">max_connect_errors</code></a> set to a
            large value.
          </p></li><li class="listitem"><p><a name="flush-logs"></a>
            <a class="link" href="sql-syntax.html#flush-logs"><code class="literal">FLUSH LOGS</code></a>
          </p><p>
            Closes and reopens any log file to which the server is
            writing. If binary logging is enabled, the sequence number
            of the binary log file is incremented by one relative to the
            previous file. If relay logging is enabled, the sequence
            number of the relay log file is incremented by one relative
            to the previous file.
          </p><p>
            <a class="link" href="sql-syntax.html#flush-logs"><code class="literal">FLUSH LOGS</code></a> has no effect on
            tables used for the general query log or for the slow query
            log (see <a class="xref" href="server-administration.html#log-destinations" title="5.4.1 Selecting General Query Log and Slow Query Log Output Destinations">Section 5.4.1, “Selecting General Query Log and Slow Query Log Output Destinations”</a>).
          </p></li><li class="listitem"><p><a name="flush-optimizer-costs"></a>
            <a class="link" href="sql-syntax.html#flush-optimizer-costs"><code class="literal">FLUSH OPTIMIZER_COSTS</code></a>
          </p><p>
            Rereads the cost model tables so that the optimizer starts
            using the current cost estimates stored in them. The server
            writes a warning to the error log for any unrecognized
            entries. (For information about these tables, see
            <a class="xref" href="optimization.html#cost-model" title="8.9.5 The Optimizer Cost Model">Section 8.9.5, “The Optimizer Cost Model”</a>.) This operation affects only
            sessions that begin subsequent to the flush. Existing
            sessions continue to use the cost estimates that were
            current when they began.
          </p></li><li class="listitem"><p><a name="flush-privileges"></a>
            <a class="link" href="sql-syntax.html#flush-privileges"><code class="literal">FLUSH PRIVILEGES</code></a>
          </p><p>
            Reloads the privileges from the grant tables in the
            <code class="literal">mysql</code> system database, and clears the
            in-memory cache used by the
            <code class="literal">caching_sha2_password</code> authentication
            plugin.
          </p><p>
            As part of this operation, the server reads the
            <code class="literal">global_grants</code> table containing dynamic
            privilege assignments and registers any unregistered
            privileges found there.
          </p><p>
            The server caches information in memory as a result of
            <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT Syntax"><code class="literal">GRANT</code></a>,
            <a class="link" href="sql-syntax.html#create-user" title="13.7.1.3 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>,
            <a class="link" href="sql-syntax.html#create-server" title="13.1.18 CREATE SERVER Syntax"><code class="literal">CREATE SERVER</code></a>, and
            <a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> statements.
            This memory is not released by the corresponding
            <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE Syntax"><code class="literal">REVOKE</code></a>,
            <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER Syntax"><code class="literal">DROP USER</code></a>,
            <a class="link" href="sql-syntax.html#drop-server" title="13.1.30 DROP SERVER Syntax"><code class="literal">DROP SERVER</code></a>, and
            <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.4.6 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a> statements,
            so for a server that executes many instances of the
            statements that cause caching, there will be an increase in
            memory use. This cached memory can be freed with
            <a class="link" href="sql-syntax.html#flush-privileges"><code class="literal">FLUSH PRIVILEGES</code></a>.
          </p></li><li class="listitem"><p><a name="flush-relay-logs"></a>
            <a class="link" href="sql-syntax.html#flush-relay-logs"><code class="literal">FLUSH
            RELAY LOGS [FOR CHANNEL
            <em class="replaceable"><code>channel</code></em>]</code></a>
          </p><p>
            Closes and reopens any relay log file to which the server is
            writing. If relay logging is enabled, the sequence number of
            the relay log file is incremented by one relative to the
            previous file.
          </p><p>
            The <code class="literal">FOR CHANNEL
            <em class="replaceable"><code>channel</code></em></code> clause enables
            you to name which replication channel the statement applies
            to. Execute
            <a class="link" href="sql-syntax.html#flush-relay-logs"><code class="literal">FLUSH
            RELAY LOGS FOR CHANNEL
            <em class="replaceable"><code>channel</code></em></code></a> to flush the
            relay log for a specific replication channel. If no channel
            is named and no extra replication channels exist, the
            statement applies to the default channel. If no channel is
            named and multiple replication channels exist, the statement
            applies to all replication channels. For more information,
            see <a class="xref" href="replication.html#replication-channels" title="17.2.3 Replication Channels">Section 17.2.3, “Replication Channels”</a>.
          </p></li><li class="listitem"><p><a name="flush-slow-logs"></a>
            <a class="link" href="sql-syntax.html#flush-slow-logs"><code class="literal">FLUSH SLOW LOGS</code></a>
          </p><p>
            Closes and reopens any slow query log file to which the
            server is writing.
          </p></li><li class="listitem"><p><a name="flush-status"></a>
            <a class="link" href="sql-syntax.html#flush-status"><code class="literal">FLUSH STATUS</code></a>
          </p><p>
            This option adds the session status from all active sessions
            to the global status variables, resets the status of all
            active sessions, and resets account, host, and user status
            values aggregated from disconnected sessions. See
            <a class="xref" href="performance-schema.html#performance-schema-status-variable-tables" title="26.12.14 Performance Schema Status Variable Tables">Section 26.12.14, “Performance Schema Status Variable Tables”</a>.
            This information may be of use when debugging a query. See
            <a class="xref" href="introduction.html#bug-reports" title="1.7 How to Report Bugs or Problems">Section 1.7, “How to Report Bugs or Problems”</a>.
          </p></li><li class="listitem"><p><a name="flush-user-resources"></a>
            <a class="link" href="sql-syntax.html#flush-user-resources"><code class="literal">FLUSH USER_RESOURCES</code></a>
          </p><p>
            Resets all per-hour user resources to zero. This enables
            clients that have reached their hourly connection, query, or
            update limits to resume activity immediately.
            <a class="link" href="sql-syntax.html#flush-user-resources"><code class="literal">FLUSH USER_RESOURCES</code></a> does not
            apply to the limit on maximum simultaneous connections that
            is controlled by the
            <a class="link" href="server-administration.html#sysvar_max_user_connections"><code class="literal">max_user_connections</code></a> system
            variable. See <a class="xref" href="security.html#user-resources" title="6.2.20 Setting Account Resource Limits">Section 6.2.20, “Setting Account Resource Limits”</a>.
</p></li></ul>
</div>
<h5><a name="flush-tables-variants"></a>FLUSH TABLES Syntax</h5>
<p>
        <a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH TABLES</code></a> flushes tables, and,
        depending on the variant used, acquires locks. Any
        <code class="literal">TABLES</code> variant used in a
        <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement must be the only
        option used. <a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH
        TABLE</code></a> is a synonym for <a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH
        TABLES</code></a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          The descriptions here that indicate tables are flushed by
          closing them apply differently for <code class="literal">InnoDB</code>,
          which flushes table contents to disk but leaves them open.
          This still permits table files to be copied while the tables
          are open, as long as other activity does not modify them.
</p>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="flush-tables"></a>
            <a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH TABLES</code></a>
          </p><p>
            Closes all open tables, forces all tables in use to be
            closed, and flushes the prepared statement cache. For
            information about prepared statement caching, see
            <a class="xref" href="optimization.html#statement-caching" title="8.10.3 Caching of Prepared Statements and Stored Programs">Section 8.10.3, “Caching of Prepared Statements and Stored Programs”</a>.
          </p><p>
            <a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH TABLES</code></a> is not permitted
            when there is an active
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES ...
            READ</code></a>. To flush and lock tables, use
            <a class="link" href="sql-syntax.html#flush-tables-with-read-lock-with-list"><code class="literal">FLUSH
            TABLES <em class="replaceable"><code>tbl_name</code></em> ... WITH READ
            LOCK</code></a> instead.
          </p></li><li class="listitem"><p><a name="flush-tables-with-list"></a>
            <a class="link" href="sql-syntax.html#flush-tables-with-list"><code class="literal">FLUSH
            TABLES <em class="replaceable"><code>tbl_name</code></em> [,
            <em class="replaceable"><code>tbl_name</code></em>] ...</code></a>
          </p><p>
            With a list of one or more comma-separated table names, this
            statement is like <a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH
            TABLES</code></a> with no names except that the server
            flushes only the named tables. If a named table does not
            exist, no error occurs.
          </p></li><li class="listitem"><p><a name="flush-tables-with-read-lock"></a>
            <a class="link" href="sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH
            TABLES WITH READ LOCK</code></a>
          </p><p>
            Closes all open tables and locks all tables for all
            databases with a global read lock. This is a very convenient
            way to get backups if you have a file system such as Veritas
            or ZFS that can take snapshots in time. Use
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> to release the lock.
          </p><p>
            <a class="link" href="sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH TABLES WITH READ LOCK</code></a>
            acquires a global read lock rather than table locks, so it
            is not subject to the same behavior as
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> and
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> with respect to table locking and implicit
            commits:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
                TABLES</code></a> implicitly commits any active
                transaction only if any tables currently have been
                locked with <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>.
                The commit does not occur for
                <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
                TABLES</code></a> following <a class="link" href="sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH
                TABLES WITH READ LOCK</code></a> because the latter
                statement does not acquire table locks.
              </p></li><li class="listitem"><p>
                Beginning a transaction causes table locks acquired with
                <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to be
                released, as though you had executed
                <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
                TABLES</code></a>. Beginning a transaction does not
                release a global read lock acquired with
                <a class="link" href="sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH TABLES WITH READ
                LOCK</code></a>.
</p></li></ul>
</div>
<p>
            <a class="link" href="sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH TABLES WITH READ LOCK</code></a>
            does not prevent the server from inserting rows into the log
            tables (see <a class="xref" href="server-administration.html#log-destinations" title="5.4.1 Selecting General Query Log and Slow Query Log Output Destinations">Section 5.4.1, “Selecting General Query Log and Slow Query Log Output Destinations”</a>).
          </p></li><li class="listitem"><p><a name="flush-tables-with-read-lock-with-list"></a>
            <a class="link" href="sql-syntax.html#flush-tables-with-read-lock-with-list"><code class="literal">FLUSH
            TABLES <em class="replaceable"><code>tbl_name</code></em> [,
            <em class="replaceable"><code>tbl_name</code></em>] ... WITH READ
            LOCK</code></a>
          </p><p>
            This statement flushes and acquires read locks for the named
            tables. The statement first acquires exclusive metadata
            locks for the tables, so it waits for transactions that have
            those tables open to complete. Then the statement flushes
            the tables from the table cache, reopens the tables,
            acquires table locks (like
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES ...
            READ</code></a>), and downgrades the metadata locks from
            exclusive to shared. After the statement acquires locks and
            downgrades the metadata locks, other sessions can read but
            not modify the tables.
          </p><p>
            Because this statement acquires table locks, you must have
            the <a class="link" href="security.html#priv_lock-tables"><code class="literal">LOCK TABLES</code></a> privilege for
            each table, in addition to the
            <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege that is
            required to use any <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a>
            statement.
          </p><p>
            This statement applies only to existing base
            (non-<code class="literal">TEMPORARY) </code>tables. If a name refers
            to a base table, that table is used. If it refers to a
            <code class="literal">TEMPORARY</code> table, it is ignored. If a name
            applies to a view, an
            <a class="link" href="error-handling.html#error_er_wrong_object"><code class="literal">ER_WRONG_OBJECT</code></a> error
            occurs. Otherwise, an
            <a class="link" href="error-handling.html#error_er_no_such_table"><code class="literal">ER_NO_SUCH_TABLE</code></a> error
            occurs.
          </p><p>
            Use <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> to release the locks,
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to release the
            locks and acquire other locks, or
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a> to release the locks and begin a new
            transaction.
          </p><p>
            This <a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH TABLES</code></a> variant
            enables tables to be flushed and locked in a single
            operation. It provides a workaround for the restriction that
            <a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH TABLES</code></a> is not permitted
            when there is an active
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES ...
            READ</code></a>.
          </p><p>
            This statement does not perform an implicit
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a>, so an error results if you use the
            statement while there is any active
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> or use it a
            second time without first releasing the locks acquired.
          </p><p>
            If a flushed table was opened with
            <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER Syntax"><code class="literal">HANDLER</code></a>, the handler is
            implicitly flushed and loses its position.
          </p></li><li class="listitem"><p><a name="flush-tables-for-export-with-list"></a>
            <a class="link" href="sql-syntax.html#flush-tables-for-export-with-list"><code class="literal">FLUSH
            TABLES <em class="replaceable"><code>tbl_name</code></em> [,
            <em class="replaceable"><code>tbl_name</code></em>] ... FOR
            EXPORT</code></a>
          </p><p>
            This <a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH TABLES</code></a> variant
            applies to <code class="literal">InnoDB</code> tables. It ensures that
            changes to the named tables have been flushed to disk so
            that binary table copies can be made while the server is
            running.
          </p><p>
            The statement works like this:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
                It acquires shared metadata locks for the named tables.
                The statement blocks as long as other sessions have
                active transactions that have modified those tables or
                hold table locks for them. When the locks have been
                acquired, the statement blocks transactions that attempt
                to update the tables, while permitting read-only
                operations to continue.
              </p></li><li class="listitem"><p>
                It checks whether all storage engines for the tables
                support <code class="literal">FOR EXPORT</code>. If any do not, an
                <a class="link" href="error-handling.html#error_er_illegal_ha"><code class="literal">ER_ILLEGAL_HA</code></a> error
                occurs and the statement fails.
              </p></li><li class="listitem"><p>
                The statement notifies the storage engine for each table
                to make the table ready for export. The storage engine
                must ensure that any pending changes are written to
                disk.
              </p></li><li class="listitem"><p>
                The statement puts the session in lock-tables mode so
                that the metadata locks acquired earlier are not
                released when the <code class="literal">FOR EXPORT</code>
                statement completes.
</p></li></ol>
</div>
<p>
            The
            <a class="link" href="sql-syntax.html#flush-tables-for-export-with-list"><code class="literal">FLUSH
            TABLES ... FOR EXPORT</code></a> statement requires that you
            have the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> privilege for
            each table. Because this statement acquires table locks, you
            must also have the <a class="link" href="security.html#priv_lock-tables"><code class="literal">LOCK
            TABLES</code></a> privilege for each table, in addition to
            the <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege that is
            required to use any <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a>
            statement.
          </p><p>
            This statement applies only to existing base
            (non-<code class="literal">TEMPORARY</code>) tables. If a name refers
            to a base table, that table is used. If it refers to a
            <code class="literal">TEMPORARY</code> table, it is ignored. If a name
            applies to a view, an
            <a class="link" href="error-handling.html#error_er_wrong_object"><code class="literal">ER_WRONG_OBJECT</code></a> error
            occurs. Otherwise, an
            <a class="link" href="error-handling.html#error_er_no_such_table"><code class="literal">ER_NO_SUCH_TABLE</code></a> error
            occurs.
          </p><p>
            <code class="literal">InnoDB</code> supports <code class="literal">FOR
            EXPORT</code> for tables that have their own
            <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file"><code class="filename">.ibd</code>
            file</a> file (that is, tables created with the
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a>
            setting enabled). <code class="literal">InnoDB</code> ensures when
            notified by the <code class="literal">FOR EXPORT</code> statement that
            any changes have been flushed to disk. This permits a binary
            copy of table contents to be made while the <code class="literal">FOR
            EXPORT</code> statement is in effect because the
            <code class="filename">.ibd</code> file is transaction consistent and
            can be copied while the server is running. <code class="literal">FOR
            EXPORT</code> does not apply to <code class="literal">InnoDB</code>
            system tablespace files, or to <code class="literal">InnoDB</code>
            tables that have <code class="literal">FULLTEXT</code> indexes.
          </p><p>
            <a class="link" href="sql-syntax.html#flush-tables-for-export-with-list"><code class="literal">FLUSH
            TABLES ...FOR EXPORT</code></a> is supported for partitioned
            <code class="literal">InnoDB</code> tables.
          </p><p>
            When notified by <code class="literal">FOR EXPORT</code>,
            <code class="literal">InnoDB</code> writes to disk certain kinds of
            data that is normally held in memory or in separate disk
            buffers outside the tablespace files. For each table,
            <code class="literal">InnoDB</code> also produces a file named
            <code class="filename"><em class="replaceable"><code>table_name</code></em>.cfg</code>
            in the same database directory as the table. The
            <code class="filename">.cfg</code> file contains metadata needed to
            reimport the tablespace files later, into the same or
            different server.
          </p><p>
            When the <code class="literal">FOR EXPORT</code> statement completes,
            <code class="literal">InnoDB</code> will have flushed all
            <a class="link" href="glossary.html#glos_dirty_page" title="dirty page">dirty pages</a> to the
            table data files. Any
            <a class="link" href="glossary.html#glos_change_buffer" title="change buffer">change buffer</a>
            entries are merged prior to flushing. At this point, the
            tables are locked and quiescent: The tables are in a
            transactionally consistent state on disk and you can copy
            the <code class="filename">.ibd</code> tablespace files along with
            the corresponding <code class="filename">.cfg</code> files to get a
            consistent snapshot of those tables.
          </p><p>
            For the procedure to reimport the copied table data into a
            MySQL instance, see <a class="xref" href="innodb-storage-engine.html#tablespace-copying" title="15.6.3.7 Copying Tablespaces to Another Instance">Section 15.6.3.7, “Copying Tablespaces to Another Instance”</a>.
          </p><p>
            After you are done with the tables, use
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> to release the locks,
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to release the
            locks and acquire other locks, or
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a> to release the locks and begin a new
            transaction.
          </p><p>
            While any of these statements is in effect within the
            session, attempts to use
            <a class="link" href="sql-syntax.html#flush-tables-for-export-with-list"><code class="literal">FLUSH
            TABLES ... FOR EXPORT</code></a> produce an error:
          </p><pre data-lang="sql" class="programlisting">
FLUSH TABLES ... WITH READ LOCK
FLUSH TABLES ... FOR EXPORT
LOCK TABLES ... READ
LOCK TABLES ... WRITE
</pre><p>
            While
            <a class="link" href="sql-syntax.html#flush-tables-for-export-with-list"><code class="literal">FLUSH
            TABLES ... FOR EXPORT</code></a> is in effect within the
            session, attempts to use any of these statements produce an
            error:
          </p><pre data-lang="sql" class="programlisting">
FLUSH TABLES WITH READ LOCK
FLUSH TABLES ... WITH READ LOCK
FLUSH TABLES ... FOR EXPORT
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="kill"></a>13.7.7.4 KILL Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091654048976"></a><a class="indexterm" name="idm140091654047904"></a><pre data-lang="sql" class="programlisting">
KILL [CONNECTION | QUERY] <em class="replaceable"><code>processlist_id</code></em>
</pre><p>
        Each connection to <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> runs in a separate
        thread. You can kill a thread with the <code class="literal">KILL
        <em class="replaceable"><code>processlist_id</code></em></code> statement.
      </p><p>
        Thread processlist identifiers can be determined from the
        <code class="literal">ID</code> column of the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#processlist-table" title="25.19 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">PROCESSLIST</code></a> table, the
        <code class="literal">Id</code> column of <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
        PROCESSLIST</code></a> output, and the
        <code class="literal">PROCESSLIST_ID</code> column of the Performance
        Schema <a class="link" href="performance-schema.html#threads-table" title="26.12.17.5 The threads Table"><code class="literal">threads</code></a> table. The value for
        the current thread is returned by the
        <a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a> function.
      </p><p>
        <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL</code></a> permits an optional
        <code class="literal">CONNECTION</code> or <code class="literal">QUERY</code>
        modifier:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL
            CONNECTION</code></a> is the same as
            <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL</code></a> with no modifier: It
            terminates the connection associated with the given
            <em class="replaceable"><code>processlist_id</code></em>, after terminating
            any statement the connection is executing.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL QUERY</code></a>
            terminates the statement the connection is currently
            executing, but leaves the connection itself intact.
</p></li></ul>
</div>
<p>
        The ability to see which threads are available to be killed
        depends on the <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a> privilege:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Without <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a>, you can see
            only your own threads.
          </p></li><li class="listitem"><p>
            With <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a>, you can see all
            threads.
</p></li></ul>
</div>
<p>
        The ability to kill threads and statements depends on the
        <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> and
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privileges:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Without <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
            <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>, you can kill only your
            own threads and statements.
          </p></li><li class="listitem"><p>
            With <a class="link" href="security.html#priv_connection-admin"><code class="literal">CONNECTION_ADMIN</code></a> or
            <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>, you can kill all
            threads and statements, except that to affect a thread or
            statement that is executing with the
            <a class="link" href="security.html#priv_system-user"><code class="literal">SYSTEM_USER</code></a> privilege, your
            own session must additionally have the
            <a class="link" href="security.html#priv_system-user"><code class="literal">SYSTEM_USER</code></a> privilege.
</p></li></ul>
</div>
<p>
        You can also use the <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin processlist</strong></span></a>
        and <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin kill</strong></span></a> commands to examine and
        kill threads.
      </p><p>
        When you use <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL</code></a>, a
        thread-specific kill flag is set for the thread. In most cases,
        it might take some time for the thread to die because the kill
        flag is checked only at specific intervals:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            During <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> operations, for
            <code class="literal">ORDER BY</code> and <code class="literal">GROUP BY</code>
            loops, the flag is checked after reading a block of rows. If
            the kill flag is set, the statement is aborted.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operations that
            make a table copy check the kill flag periodically for each
            few copied rows read from the original table. If the kill
            flag was set, the statement is aborted and the temporary
            table is deleted.
          </p><p>
            The <a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL Syntax"><code class="literal">KILL</code></a> statement returns
            without waiting for confirmation, but the kill flag check
            aborts the operation within a reasonably small amount of
            time. Aborting the operation to perform any necessary
            cleanup also takes some time.
          </p></li><li class="listitem"><p>
            During <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> or
            <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> operations, the kill
            flag is checked after each block read and after each updated
            or deleted row. If the kill flag is set, the statement is
            aborted. If you are not using transactions, the changes are
            not rolled back.
          </p></li><li class="listitem"><p>
            <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a> aborts and returns
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            If the thread is in the table lock handler (state:
            <code class="literal">Locked</code>), the table lock is quickly
            aborted.
          </p></li><li class="listitem"><p>
            If the thread is waiting for free disk space in a write
            call, the write is aborted with a <span class="quote">“<span class="quote">disk full</span>”</span>
            error message.
</p></li></ul>
</div>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Warning
</div>
<p>
          Killing a <a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> or
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> operation on a
          <code class="literal">MyISAM</code> table results in a table that is
          corrupted and unusable. Any reads or writes to such a table
          fail until you optimize or repair it again (without
          interruption).
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="load-index"></a>13.7.7.5 LOAD INDEX INTO CACHE Syntax</h4>

</div>

</div>

</div>
<pre data-lang="sql" class="programlisting">
LOAD INDEX INTO CACHE
  <em class="replaceable"><code>tbl_index_list</code></em> [, <em class="replaceable"><code>tbl_index_list</code></em>] ...

<em class="replaceable"><code>tbl_index_list</code></em>:
  <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_list</code></em>)]
    [{INDEX|KEY} (<em class="replaceable"><code>index_name</code></em>[, <em class="replaceable"><code>index_name</code></em>] ...)]
    [IGNORE LEAVES]

<em class="replaceable"><code>partition_list</code></em>: {
    <em class="replaceable"><code>partition_name</code></em>[, <em class="replaceable"><code>partition_name</code></em>] ...
  | ALL
}
</pre><p>
        The <a class="link" href="sql-syntax.html#load-index" title="13.7.7.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD INDEX INTO
        CACHE</code></a> statement preloads a table index into the key
        cache to which it has been assigned by an explicit
        <a class="link" href="sql-syntax.html#cache-index" title="13.7.7.2 CACHE INDEX Syntax"><code class="literal">CACHE INDEX</code></a> statement, or into
        the default key cache otherwise.
      </p><p>
        <a class="link" href="sql-syntax.html#load-index" title="13.7.7.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD INDEX INTO
        CACHE</code></a> applies only to <code class="literal">MyISAM</code>
        tables, including partitioned <code class="literal">MyISAM</code> tables.
        In addition, indexes on partitioned tables can be preloaded for
        one, several, or all partitions.
      </p><p>
        The <code class="literal">IGNORE LEAVES</code> modifier causes only blocks
        for the nonleaf nodes of the index to be preloaded.
      </p><p>
        <code class="literal">IGNORE LEAVES</code> is also supported for
        partitioned <code class="literal">MyISAM</code> tables.
      </p><p>
        The following statement preloads nodes (index blocks) of indexes
        for the tables <code class="literal">t1</code> and <code class="literal">t2</code>:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>LOAD INDEX INTO CACHE t1, t2 IGNORE LEAVES;</code></strong>
+---------+--------------+----------+----------+
| Table   | Op           | Msg_type | Msg_text |
+---------+--------------+----------+----------+
| test.t1 | preload_keys | status   | OK       |
| test.t2 | preload_keys | status   | OK       |
+---------+--------------+----------+----------+
</pre><p>
        This statement preloads all index blocks from
        <code class="literal">t1</code>. It preloads only blocks for the nonleaf
        nodes from <code class="literal">t2</code>.
      </p><p>
        The syntax of <a class="link" href="sql-syntax.html#load-index" title="13.7.7.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD
        INDEX INTO CACHE</code></a> enables you to specify that only
        particular indexes from a table should be preloaded. However,
        the implementation preloads all the table's indexes into the
        cache, so there is no reason to specify anything other than the
        table name.
      </p><p>
        It is possible to preload indexes on specific partitions of
        partitioned <code class="literal">MyISAM</code> tables. For example, of
        the following 2 statements, the first preloads indexes for
        partition <code class="literal">p0</code> of a partitioned table
        <code class="literal">pt</code>, while the second preloads the indexes for
        partitions <code class="literal">p1</code> and <code class="literal">p3</code> of
        the same table:
      </p><pre data-lang="sql" class="programlisting">
LOAD INDEX INTO CACHE pt PARTITION (p0);
LOAD INDEX INTO CACHE pt PARTITION (p1, p3);
</pre><p>
        To preload the indexes for all partitions in table
        <code class="literal">pt</code>, you can use either of the following two
        statements:
      </p><pre data-lang="sql" class="programlisting">
LOAD INDEX INTO CACHE pt PARTITION (ALL);

LOAD INDEX INTO CACHE pt;
</pre><p>
        The two statements just shown are equivalent, and issuing either
        one has exactly the same effect. In other words, if you wish to
        preload indexes for all partitions of a partitioned table, the
        <code class="literal">PARTITION (ALL)</code> clause is optional.
      </p><p>
        When preloading indexes for multiple partitions, the partitions
        need not be contiguous, and you need not list their names in any
        particular order.
      </p><p>
        <a class="link" href="sql-syntax.html#load-index" title="13.7.7.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD INDEX INTO
        CACHE ... IGNORE LEAVES</code></a> fails unless all indexes in a
        table have the same block size. To determine index block sizes
        for a table, use <a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk -dv</strong></span></a> and check the
        <code class="literal">Blocksize</code> column.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="reset"></a>13.7.7.6 RESET Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091653935824"></a><a class="indexterm" name="idm140091653934752"></a><pre data-lang="sql" class="programlisting">
RESET <em class="replaceable"><code>reset_option</code></em> [, <em class="replaceable"><code>reset_option</code></em>] ...

<em class="replaceable"><code>reset_option</code></em>: {
    MASTER
  | SLAVE
}
</pre><p>
        The <a class="link" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax"><code class="literal">RESET</code></a> statement is used to
        clear the state of various server operations. You must have the
        <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege to execute
        <a class="link" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax"><code class="literal">RESET</code></a>.
      </p><p>
        For information about the <a class="link" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax"><code class="literal">RESET
        PERSIST</code></a> statement that removes persisted global system
        variables, see <a class="xref" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax">Section 13.7.7.7, “RESET PERSIST Syntax”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax"><code class="literal">RESET</code></a> acts as a stronger version
        of the <a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement. See
        <a class="xref" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH Syntax">Section 13.7.7.3, “FLUSH Syntax”</a>.
      </p><p>
        The <a class="link" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax"><code class="literal">RESET</code></a> statement causes an
        implicit commit. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        The following list describes the permitted
        <a class="link" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax"><code class="literal">RESET</code></a> statement
        <em class="replaceable"><code>reset_option</code></em> values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">RESET MASTER</code>
          </p><p>
            Deletes all binary logs listed in the index file, resets the
            binary log index file to be empty, and creates a new binary
            log file.
          </p></li><li class="listitem"><p>
            <code class="literal">RESET SLAVE</code>
          </p><p>
            Makes the slave forget its replication position in the
            master binary logs. Also resets the relay log by deleting
            any existing relay log files and beginning a new one.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="reset-persist"></a>13.7.7.7 RESET PERSIST Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091653907936"></a><a class="indexterm" name="idm140091653906864"></a><a class="indexterm" name="idm140091653905776"></a><pre data-lang="sql" class="programlisting">
RESET PERSIST [[IF EXISTS] <em class="replaceable"><code>system_var_name</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax"><code class="literal">RESET PERSIST</code></a> removes persisted
        global system variable settings from the
        <code class="filename">mysqld-auto.cnf</code> option file in the data
        directory. Removing a persisted system variable causes the
        variable no longer to be initialized from
        <code class="filename">mysqld-auto.cnf</code> at server startup. For more
        information about persisting system variables and the
        <code class="filename">mysqld-auto.cnf</code> file, see
        <a class="xref" href="server-administration.html#persisted-system-variables" title="5.1.9.3 Persisted System Variables">Section 5.1.9.3, “Persisted System Variables”</a>.
      </p><p>
        The privileges required for <a class="link" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax"><code class="literal">RESET
        PERSIST</code></a> depend on the type of system variable to be
        removed:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For dynamic system variables, this statement requires the
            <a class="link" href="security.html#priv_system-variables-admin"><code class="literal">SYSTEM_VARIABLES_ADMIN</code></a> or
            <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
          </p></li><li class="listitem"><p>
            For read-only system variables, this statement requires the
            <a class="link" href="security.html#priv_system-variables-admin"><code class="literal">SYSTEM_VARIABLES_ADMIN</code></a> and
            <a class="link" href="security.html#priv_persist-ro-variables-admin"><code class="literal">PERSIST_RO_VARIABLES_ADMIN</code></a>
            privileges.
</p></li></ul>
</div>
<p>
        See <a class="xref" href="server-administration.html#system-variable-privileges" title="5.1.9.1 System Variable Privileges">Section 5.1.9.1, “System Variable Privileges”</a>.
      </p><p>
        Depending on whether the variable name and <code class="literal">IF
        EXISTS</code> clauses are present, the
        <a class="link" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax"><code class="literal">RESET PERSIST</code></a> statement has these
        forms:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            To remove all persisted variables from
            <code class="filename">mysqld-auto.cnf</code>, use
            <a class="link" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax"><code class="literal">RESET PERSIST</code></a> without naming
            any system variable:
          </p><pre data-lang="sql" class="programlisting">
RESET PERSIST;
</pre><p>
            You must have privileges for removing both dynamic and
            read-only system variables if
            <code class="filename">mysqld-auto.cnf</code> contains both kinds of
            variables.
          </p></li><li class="listitem"><p>
            To remove a specific persisted variable from
            <code class="filename">mysqld-auto.cnf</code>, name it in the
            statement:
          </p><pre data-lang="sql" class="programlisting">
RESET PERSIST <em class="replaceable"><code>system_var_name</code></em>;
</pre><p>
            This includes plugin system variables, even if the plugin is
            not currently installed. If the variable is not present in
            the file, an error occurs.
          </p></li><li class="listitem"><p>
            To remove a specific persisted variable from
            <code class="filename">mysqld-auto.cnf</code>, but produce a warning
            rather than an error if the variable is not present in the
            file, add an <code class="literal">IF EXISTS</code> clause to the
            previous syntax:
          </p><pre data-lang="sql" class="programlisting">
RESET PERSIST IF EXISTS <em class="replaceable"><code>system_var_name</code></em>;
</pre></li></ul>
</div>
<p>
        <a class="link" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax"><code class="literal">RESET PERSIST</code></a> is not affected by
        the value of the
        <a class="link" href="server-administration.html#sysvar_persisted_globals_load"><code class="literal">persisted_globals_load</code></a> system
        variable.
      </p><p>
        <a class="link" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax"><code class="literal">RESET PERSIST</code></a> affects the
        contents of the Performance Schema
        <a class="link" href="performance-schema.html#persisted-variables-table" title="26.12.13.1 Performance Schema persisted_variables Table"><code class="literal">persisted_variables</code></a> table because
        the table contents correspond to the contents of the
        <code class="filename">mysqld-auto.cnf</code> file. On the other hand,
        because <a class="link" href="sql-syntax.html#reset-persist" title="13.7.7.7 RESET PERSIST Syntax"><code class="literal">RESET PERSIST</code></a> does not
        change variable values, it has no effect on the contents of the
        Performance Schema <a class="link" href="performance-schema.html#variables-info-table" title="26.12.13.2 Performance Schema variables_info Table"><code class="literal">variables_info</code></a>
        table until the server is restarted.
      </p><p>
        For information about <a class="link" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax"><code class="literal">RESET</code></a>
        statement variants that clear the state of other server
        operations, see <a class="xref" href="sql-syntax.html#reset" title="13.7.7.6 RESET Syntax">Section 13.7.7.6, “RESET Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="restart"></a>13.7.7.8 RESTART Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091653856944"></a><pre data-lang="sql" class="programlisting">
RESTART
</pre><p>
        This statement stops and restarts the MySQL server. It requires
        the <a class="link" href="security.html#priv_shutdown"><code class="literal">SHUTDOWN</code></a> privilege.
      </p><p>
        One use for <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a> is when it is
        not possible or convenient to gain command-line access to the
        MySQL server on the server host to restart it. For example,
        <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1 SET Syntax for Variable Assignment"><code class="literal">SET
        PERSIST_ONLY</code></a> can be used at runtime to make
        configuration changes to system variables that can be set only
        at server startup, but the server must still be restarted for
        those changes to take effect. The
        <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a> statement provides a way
        to do so from within client sessions, without requiring
        command-line access on the server host.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          After executing a <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a>
          statement, the client can expect the current connection to be
          lost. If auto-reconnect is enabled, the connection will be
          reestablished after the server restarts. Otherwise, the
          connection must be reestablished manually.
</p>
</div>
<p>
        A successful <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a> operation
        requires <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> to be running in an
        environment that has a monitoring process available to detect a
        server shutdown performed for restart purposes:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            In the presence of a monitoring process,
            <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a> causes
            <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> to terminate such that the
            monitoring process can determine that it should start a new
            <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> instance.
          </p></li><li class="listitem"><p>
            If no monitoring process is present,
            <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a> fails with an error.
</p></li></ul>
</div>
<p>
        These platforms provide the necessary monitoring support for the
        <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a> statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Windows, when <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> is started as a
            Windows service or standalone. (<a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>
            forks, and one process acts as a monitor to the other, which
            acts as the server.)
          </p></li><li class="listitem"><p>
            Unix and Unix-like systems that use systemd or
            <a class="link" href="programs.html#mysqld-safe" title="4.3.2 mysqld_safe — MySQL Server Startup Script"><span class="command"><strong>mysqld_safe</strong></span></a> to manage
            <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>.
</p></li></ul>
</div>
<p>
        To configure a monitoring environment such that
        <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> enables the
        <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a> statement:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            Set the <code class="literal">MYSQLD_PARENT_PID</code> environment
            variable to the value of the process ID of the process that
            starts <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>, before starting
            <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>.
          </p></li><li class="listitem"><p>
            When <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> performs a shutdown due to
            use of the <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a> statement,
            it returns exit code 16.
          </p></li><li class="listitem"><p>
            When the monitoring process detects an exit code of 16, it
            starts <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> again. Otherwise, it exits.
</p></li></ol>
</div>
<p>
        Here is a minimal example as implemented in the
        <span class="command"><strong>bash</strong></span> shell:
      </p><pre data-lang="terminal" class="programlisting">
#!/bin/bash

export MYSQLD_PARENT_PID=$$

export MYSQLD_RESTART_EXIT=16

while true ; do
  bin/mysqld <em class="replaceable"><code>mysqld options here</code></em>
  if [ $? -ne $MYSQLD_RESTART_EXIT ]; then
    break
  fi
done
</pre><p>
        On Windows, the forking used to implement
        <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a> makes determining the
        server process to attach to for debugging more difficult. To
        alleviate this, starting the server with
        <a class="link" href="server-administration.html#option_mysqld_gdb"><code class="option">--gdb</code></a> suppresses forking, in
        addition to its other actions done to set up a debugging
        environment. In non-debug settings,
        <a class="link" href="server-administration.html#option_mysqld_no-monitor"><code class="option">--no-monitor</code></a> may be used for the
        sole purpose of suppressing forking the monitor process. For a
        server started with either <a class="link" href="server-administration.html#option_mysqld_gdb"><code class="option">--gdb</code></a>
        or <a class="link" href="server-administration.html#option_mysqld_no-monitor"><code class="option">--no-monitor</code></a>, executing
        <a class="link" href="sql-syntax.html#restart" title="13.7.7.8 RESTART Syntax"><code class="literal">RESTART</code></a> causes the server to
        simply exit without restarting.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="shutdown"></a>13.7.7.9 SHUTDOWN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091653799616"></a><pre data-lang="sql" class="programlisting">
SHUTDOWN
</pre><p>
        This statement stops the MySQL server. It requires the
        <a class="link" href="security.html#priv_shutdown"><code class="literal">SHUTDOWN</code></a> privilege.
      </p><p>
        <a class="link" href="sql-syntax.html#shutdown" title="13.7.7.9 SHUTDOWN Syntax"><code class="literal">SHUTDOWN</code></a> provides an SQL-level
        interface to the same functionality available using the
        <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin shutdown</strong></span></a> command.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-utility"></a>13.8 Utility Statements</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#describe">13.8.1 DESCRIBE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#explain">13.8.2 EXPLAIN Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#help">13.8.3 HELP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#use">13.8.4 USE Syntax</a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="describe"></a>13.8.1 DESCRIBE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091653786448"></a><a class="indexterm" name="idm140091653785376"></a><p>
      The <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> and
      <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> statements are synonyms,
      used either to obtain information about table structure or query
      execution plans. For more information, see
      <a class="xref" href="sql-syntax.html#show-columns" title="13.7.6.5 SHOW COLUMNS Syntax">Section 13.7.6.5, “SHOW COLUMNS Syntax”</a>, and <a class="xref" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax">Section 13.8.2, “EXPLAIN Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="explain"></a>13.8.2 EXPLAIN Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091653778704"></a><a class="indexterm" name="idm140091653777632"></a><pre data-lang="sql" class="programlisting">
{EXPLAIN | DESCRIBE | DESC}
    <em class="replaceable"><code>tbl_name</code></em> [<em class="replaceable"><code>col_name</code></em> | <em class="replaceable"><code>wild</code></em>]

{EXPLAIN | DESCRIBE | DESC}
    [<em class="replaceable"><code>explain_type</code></em>]
    {<em class="replaceable"><code>explainable_stmt</code></em> | FOR CONNECTION <em class="replaceable"><code>connection_id</code></em>}

<em class="replaceable"><code>explain_type</code></em>: {
    FORMAT = <em class="replaceable"><code>format_name</code></em>
}

<em class="replaceable"><code>format_name</code></em>: {
    TRADITIONAL
  | JSON
  | TREE
}

<em class="replaceable"><code>explainable_stmt</code></em>: {
    SELECT statement
  | DELETE statement
  | INSERT statement
  | REPLACE statement
  | UPDATE statement
}
</pre><p>
      The <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> and
      <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> statements are synonyms. In
      practice, the <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> keyword is
      more often used to obtain information about table structure,
      whereas <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> is used to obtain a
      query execution plan (that is, an explanation of how MySQL would
      execute a query).
    </p><p>
      The following discussion uses the
      <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> and
      <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> keywords in accordance with
      those uses, but the MySQL parser treats them as completely
      synonymous.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="sql-syntax.html#explain-table-structure" title="Obtaining Table Structure Information">Obtaining Table Structure Information</a></p></li><li class="listitem"><p><a class="xref" href="sql-syntax.html#explain-execution-plan" title="Obtaining Execution Plan Information">Obtaining Execution Plan Information</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="explain-table-structure"></a>Obtaining Table Structure Information</h4>

</div>

</div>

</div>
<p>
        <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> provides information
        about the columns in a table:
      </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>DESCRIBE City;</code></strong>
+------------+----------+------+-----+---------+----------------+
| Field      | Type     | Null | Key | Default | Extra          |
+------------+----------+------+-----+---------+----------------+
| Id         | int(11)  | NO   | PRI | NULL    | auto_increment |
| Name       | char(35) | NO   |     |         |                |
| Country    | char(3)  | NO   | UNI |         |                |
| District   | char(20) | YES  | MUL |         |                |
| Population | int(11)  | NO   |     | 0       |                |
+------------+----------+------+-----+---------+----------------+
</pre><p>
        <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> is a shortcut for
        <a class="link" href="sql-syntax.html#show-columns" title="13.7.6.5 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a>. These statements
        also display information for views. The description for
        <a class="link" href="sql-syntax.html#show-columns" title="13.7.6.5 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a> provides more
        information about the output columns. See
        <a class="xref" href="sql-syntax.html#show-columns" title="13.7.6.5 SHOW COLUMNS Syntax">Section 13.7.6.5, “SHOW COLUMNS Syntax”</a>.
      </p><p>
        By default, <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> displays
        information about all columns in the table.
        <em class="replaceable"><code>col_name</code></em>, if given, is the name of a
        column in the table. In this case, the statement displays
        information only for the named column.
        <em class="replaceable"><code>wild</code></em>, if given, is a pattern string.
        It can contain the SQL <code class="literal">%</code> and
        <code class="literal">_</code> wildcard characters. In this case, the
        statement displays output only for the columns with names
        matching the string. There is no need to enclose the string
        within quotation marks unless it contains spaces or other
        special characters.
      </p><a class="indexterm" name="idm140091653740176"></a><a class="indexterm" name="idm140091653739104"></a><p>
        The <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> statement is
        provided for compatibility with Oracle.
      </p><p>
        The <a class="link" href="sql-syntax.html#show-create-table" title="13.7.6.10 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>,
        <a class="link" href="sql-syntax.html#show-table-status" title="13.7.6.36 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a>, and
        <a class="link" href="sql-syntax.html#show-index" title="13.7.6.22 SHOW INDEX Syntax"><code class="literal">SHOW INDEX</code></a> statements also
        provide information about tables. See <a class="xref" href="sql-syntax.html#show" title="13.7.6 SHOW Syntax">Section 13.7.6, “SHOW Syntax”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="explain-execution-plan"></a>Obtaining Execution Plan Information</h4>

</div>

</div>

</div>
<p>
        The <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> statement provides
        information about how MySQL executes statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> works with
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>,
            <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>,
            <a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT Syntax"><code class="literal">INSERT</code></a>,
            <a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE Syntax"><code class="literal">REPLACE</code></a>, and
            <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements.
          </p></li><li class="listitem"><p>
            When <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> is used with an
            explainable statement, MySQL displays information from the
            optimizer about the statement execution plan. That is, MySQL
            explains how it would process the statement, including
            information about how tables are joined and in which order.
            For information about using
            <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> to obtain execution
            plan information, see <a class="xref" href="optimization.html#explain-output" title="8.8.2 EXPLAIN Output Format">Section 8.8.2, “EXPLAIN Output Format”</a>.
          </p></li><li class="listitem"><p>
            When <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> is used with
            <code class="literal">FOR CONNECTION
            <em class="replaceable"><code>connection_id</code></em></code> rather
            than an explainable statement, it displays the execution
            plan for the statement executing in the named connection.
            See <a class="xref" href="optimization.html#explain-for-connection" title="8.8.4 Obtaining Execution Plan Information for a Named Connection">Section 8.8.4, “Obtaining Execution Plan Information for a Named Connection”</a>.
          </p></li><li class="listitem"><p>
            For explainable statements,
            <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> produces additional
            execution plan information that can be displayed using
            <a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a>. See
            <a class="xref" href="optimization.html#explain-extended" title="8.8.3 Extended EXPLAIN Output Format">Section 8.8.3, “Extended EXPLAIN Output Format”</a>.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> is useful for
            examining queries involving partitioned tables. See
            <a class="xref" href="partitioning.html#partitioning-info" title="23.3.5 Obtaining Information About Partitions">Section 23.3.5, “Obtaining Information About Partitions”</a>.
          </p></li><li class="listitem"><p>
            The <code class="literal">FORMAT</code> option can be used to select
            the output format. <code class="literal">TRADITIONAL</code> presents
            the output in tabular format. This is the default if no
            <code class="literal">FORMAT</code> option is present.
            <code class="literal">JSON</code> format displays the information in
            JSON format. In MySQL 8.0.16 and later,
            <code class="literal">TREE</code> provides tree-like output with more
            precise descriptions of query handling than the
            <code class="literal">TRADITIONAL</code> format; currently, it is
            still under development and considered experimental only.
</p></li></ul>
</div>
<p>
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> requires the
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for any tables
        or views accessed, including any underlying tables of views. For
        views, <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> also requires the
        <a class="link" href="security.html#priv_show-view"><code class="literal">SHOW VIEW</code></a> privilege.
      </p><p>
        <a class="indexterm" name="idm140091653692528"></a>

        With the help of <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>, you can
        see where you should add indexes to tables so that the statement
        executes faster by using indexes to find rows. You can also use
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> to check whether the
        optimizer joins the tables in an optimal order. To give a hint
        to the optimizer to use a join order corresponding to the order
        in which the tables are named in a
        <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a> statement, begin the
        statement with <code class="literal">SELECT STRAIGHT_JOIN</code> rather
        than just <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax"><code class="literal">SELECT</code></a>. (See
        <a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT Syntax">Section 13.2.10, “SELECT Syntax”</a>.)
      </p><p>
        The optimizer trace may sometimes provide information
        complementary to that of <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>.
        However, the optimizer trace format and content are subject to
        change between versions. For details, see
        <a class="ulink" href="https://dev.mysql.com/doc/internals/en/optimizer-tracing.html" target="_top">MySQL
        Internals: Tracing the Optimizer</a>.
      </p><p>
        If you have a problem with indexes not being used when you
        believe that they should be, run <a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
        TABLE</code></a> to update table statistics, such as cardinality
        of keys, that can affect the choices the optimizer makes. See
        <a class="xref" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE Syntax">Section 13.7.3.1, “ANALYZE TABLE Syntax”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          MySQL Workbench has a Visual Explain capability that provides a
          visual representation of
          <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> output. See
          <a class="ulink" href="https://dev.mysql.com/doc/workbench/en/wb-tutorial-visual-explain-dbt3.html" target="_top">Tutorial: Using Explain to Improve Query Performance</a>.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="help"></a>13.8.3 HELP Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091653675072"></a><pre data-lang="sql" class="programlisting">
HELP '<em class="replaceable"><code>search_string</code></em>'
</pre><p>
      The <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a> statement returns online
      information from the MySQL Reference Manual. Its proper operation
      requires that the help tables in the <code class="literal">mysql</code>
      database be initialized with help topic information (see
      <a class="xref" href="server-administration.html#server-side-help-support" title="5.1.14 Server-Side Help Support">Section 5.1.14, “Server-Side Help Support”</a>).
    </p><p>
      The <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a> statement searches the
      help tables for the given search string and displays the result of
      the search. The search string is not case-sensitive.
    </p><p>
      The search string can contain the wildcard characters
      <code class="literal">%</code> and <code class="literal">_</code>. These have the same
      meaning as for pattern-matching operations performed with the
      <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> operator. For example,
      <code class="literal">HELP 'rep%'</code> returns a list of topics that begin
      with <code class="literal">rep</code>.
    </p><p>
      The HELP statement understands several types of search strings:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          At the most general level, use <code class="literal">contents</code> to
          retrieve a list of the top-level help categories:
        </p><pre data-lang="sql" class="programlisting">
HELP 'contents'
</pre></li><li class="listitem"><p>
          For a list of topics in a given help category, such as
          <code class="literal">Data Types</code>, use the category name:
        </p><pre data-lang="sql" class="programlisting">
HELP 'data types'
</pre></li><li class="listitem"><p>
          For help on a specific help topic, such as the
          <a class="link" href="functions.html#function_ascii"><code class="literal">ASCII()</code></a> function or the
          <a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement, use the
          associated keyword or keywords:
        </p><pre data-lang="sql" class="programlisting">
HELP 'ascii'
HELP 'create table'
</pre></li></ul>
</div>
<p>
      In other words, the search string matches a category, many topics,
      or a single topic. You cannot necessarily tell in advance whether
      a given search string will return a list of items or the help
      information for a single help topic. However, you can tell what
      kind of response <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a> returned by
      examining the number of rows and columns in the result set.
    </p><p>
      The following descriptions indicate the forms that the result set
      can take. Output for the example statements is shown using the
      familiar <span class="quote">“<span class="quote">tabular</span>”</span> or <span class="quote">“<span class="quote">vertical</span>”</span> format
      that you see when using the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client, but
      note that <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> itself reformats
      <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a> result sets in a different
      way.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Empty result set
        </p><p>
          No match could be found for the search string.
        </p></li><li class="listitem"><p>
          Result set containing a single row with three columns
        </p><p>
          This means that the search string yielded a hit for the help
          topic. The result has three columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">name</code>: The topic name.
            </p></li><li class="listitem"><p>
              <code class="literal">description</code>: Descriptive help text for
              the topic.
            </p></li><li class="listitem"><p>
              <code class="literal">example</code>: Usage example or examples.
              This column might be blank.
</p></li></ul>
</div>
<p>
          Example: <code class="literal">HELP 'replace'</code>
        </p><p>
          Yields:
        </p><pre data-lang="none" class="programlisting">
name: REPLACE
description: Syntax:
REPLACE(str,from_str,to_str)

Returns the string str with all occurrences of the string from_str
replaced by the string to_str. REPLACE() performs a case-sensitive
match when searching for from_str.
example: mysql&gt; SELECT REPLACE('www.mysql.com', 'w', 'Ww');
        -&gt; 'WwWwWw.mysql.com'
</pre></li><li class="listitem"><p>
          Result set containing multiple rows with two columns
        </p><p>
          This means that the search string matched many help topics.
          The result set indicates the help topic names:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">name</code>: The help topic name.
            </p></li><li class="listitem"><p>
              <code class="literal">is_it_category</code>: <code class="literal">Y</code> if
              the name represents a help category, <code class="literal">N</code>
              if it does not. If it does not, the
              <code class="literal">name</code> value when specified as the
              argument to the <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a>
              statement should yield a single-row result set containing
              a description for the named item.
</p></li></ul>
</div>
<p>
          Example: <code class="literal">HELP 'status'</code>
        </p><p>
          Yields:
        </p><pre data-lang="none" class="programlisting">
+-----------------------+----------------+
| name                  | is_it_category |
+-----------------------+----------------+
| SHOW                  | N              |
| SHOW ENGINE           | N              |
| SHOW MASTER STATUS    | N              |
| SHOW PROCEDURE STATUS | N              |
| SHOW SLAVE STATUS     | N              |
| SHOW STATUS           | N              |
| SHOW TABLE STATUS     | N              |
+-----------------------+----------------+
</pre></li><li class="listitem"><p>
          Result set containing multiple rows with three columns
        </p><p>
          This means the search string matches a category. The result
          set contains category entries:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">source_category_name</code>: The help category
              name.
            </p></li><li class="listitem"><p>
              <code class="literal">name</code>: The category or topic name
            </p></li><li class="listitem"><p>
              <code class="literal">is_it_category</code>: <code class="literal">Y</code> if
              the name represents a help category, <code class="literal">N</code>
              if it does not. If it does not, the
              <code class="literal">name</code> value when specified as the
              argument to the <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a>
              statement should yield a single-row result set containing
              a description for the named item.
</p></li></ul>
</div>
<p>
          Example: <code class="literal">HELP 'functions'</code>
        </p><p>
          Yields:
        </p><pre data-lang="none" class="programlisting">
+----------------------+-------------------------+----------------+
| source_category_name | name                    | is_it_category |
+----------------------+-------------------------+----------------+
| Functions            | CREATE FUNCTION         | N              |
| Functions            | DROP FUNCTION           | N              |
| Functions            | Bit Functions           | Y              |
| Functions            | Comparison operators    | Y              |
| Functions            | Control flow functions  | Y              |
| Functions            | Date and Time Functions | Y              |
| Functions            | Encryption Functions    | Y              |
| Functions            | Information Functions   | Y              |
| Functions            | Logical operators       | Y              |
| Functions            | Miscellaneous Functions | Y              |
| Functions            | Numeric Functions       | Y              |
| Functions            | String Functions        | Y              |
+----------------------+-------------------------+----------------+
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="use"></a>13.8.4 USE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091653605536"></a><a class="indexterm" name="idm140091653604496"></a><pre data-lang="sql" class="programlisting">
USE <em class="replaceable"><code>db_name</code></em>
</pre><p>
      The <code class="literal">USE <em class="replaceable"><code>db_name</code></em></code>
      statement tells MySQL to use the
      <em class="replaceable"><code>db_name</code></em> database as the default
      (current) database for subsequent statements. The database remains
      the default until the end of the session or another
      <a class="link" href="sql-syntax.html#use" title="13.8.4 USE Syntax"><code class="literal">USE</code></a> statement is issued:
    </p><pre data-lang="sql" class="programlisting">
USE db1;
SELECT COUNT(*) FROM mytable;   # selects from db1.mytable
USE db2;
SELECT COUNT(*) FROM mytable;   # selects from db2.mytable
</pre><p>
      The database name must be specified on a single line. Newlines in
      database names are not supported.
    </p><p>
      Making a particular database the default by means of the
      <a class="link" href="sql-syntax.html#use" title="13.8.4 USE Syntax"><code class="literal">USE</code></a> statement does not preclude
      accessing tables in other databases. The following example
      accesses the <code class="literal">author</code> table from the
      <code class="literal">db1</code> database and the <code class="literal">editor</code>
      table from the <code class="literal">db2</code> database:
    </p><pre data-lang="sql" class="programlisting">
USE db1;
SELECT author_name,editor_name FROM author,db2.editor
  WHERE author.editor_id = db2.editor.editor_id;
</pre>
</div>

</div>

</div>
<div class="copyright-footer">

</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left"><a accesskey="p" href="functions.html">Prev</a></td>
<td width="20%" align="center"><a accesskey="u" href="">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="data-dictionary.html">Next</a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter 12 Functions and Operators</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top">Chapter 14 MySQL Data Dictionary</td>
</tr>
</table>
</div>
</body>
</html>
