<!DOCTYPE html>
<html lang="zh-cn" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="牧云" />
	
	
	
	<title>Windows/Linux下查看DNS生效解析的nslookup命令详解 ｜ 牧人池塘</title>
	
    
    
    <meta name="description" content="之前查域名生效情况都是直接在web页面上查询各地解析生效情况，实际在windows和linux下都可以直接查询，当然现在在线查询更方便，主要是节点多，国内外一些dns厂商也提供了在线查询的页面，在此不" />
    

    
    
    <meta name="keywords" content="牧人池塘, DBA, 运维, 开发, 独立博客, iops.top" />
    

	
    
    <link rel="shortcut icon" href="/favicon.ico" />

    <link rel="stylesheet" type="text/css" media="screen" href="/css/normalize.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/css/animate.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/css/zozo.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="/css/remixicon.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/css/highlight.css" />

    
    
</head>

<body>
    <div class="main animate__animated animate__fadeInDown">
        <div class="nav_container animated fadeInDown">
    <div class="site_nav" id="site_nav">
        <ul>
            
            <li>
                <a href="/">首页</a>
            </li>
            
            <li>
                <a href="/notes/">技术</a>
            </li>
            
            <li>
                <a href="/life/">生活</a>
            </li>
            
            <li>
                <a href="/tags/">标签</a>
            </li>
            
            <li>
                <a href="/archives/">归档</a>
            </li>
            
            <li>
                <a href="/doc/">文档</a>
            </li>
            
            <li>
                <a href="/firendlink/">友链</a>
            </li>
            
            <li>
                <a href="/about/">关于</a>
            </li>
            
        </ul>
    </div>
    <div class="menu_icon">
        <a id="menu_icon"><i class="ri-menu-line"></i></a>
    </div>
</div>
        <div class="header animated fadeInDown">
    <div class="site_title_container">
        <div class="site_title">
            <h1>
                <a href="/">
                    <span>牧人池塘</span>
                </a>
            </h1>
        </div>
        <div class="description">
            <p class="sub_title">时光匆匆，记录是对思维的沉淀.</p>
            <div class="my_socials">
                
                
                <a href="https://github.com/rootdba" title="github" target="_blank"><i class="ri-github-fill"></i></a>
                
                
                
                <a href="https://twitter.com/imlaoma" title="twitter" target="_blank"><i class="ri-twitter-fill"></i></a>
                
                
                <a href="/index.xml" type="application/rss+xml" title="rss" target="_blank"><i
                        class="ri-rss-fill"></i></a>
            </div>
        </div>
    </div>
</div>
        <div class="content">
            <div class="post_page">
                <div class="post animate__animated animate__fadeInDown">
                    <div class="post_title post_detail_title">
                        <h2><a href='/notes/windows_linux_nslookup/'>Windows/Linux下查看DNS生效解析的nslookup命令详解</a></h2>
                        <span class="date">2015.12.10</span>
                    </div>
                    <div class="post_content markdown"><p>之前查域名生效情况都是直接在web页面上查询各地解析生效情况，实际在windows和linux下都可以直接查询，当然现在在线查询更方便，主要是节点多，国内外一些dns厂商也提供了在线查询的页面，在此不做一一列举，以下是在win和linux下查询的方法，高手可以绕过；</p>
<p>Windows下直接在cmd下运行 nslookup mydomain即可，如下图：
<img src="/upfile/img/3999207181.png" alt=""></p>
<p>一般会直接显示出A记录或者cname记录</p>
<p>查看MX记录生效情况：</p>
<p>nslookup -qt=mx mydomain 如下图</p>
<p><img src="/upfile/img/359441539.png" alt=""></p>
<p>查看NS是那个服务器既使用的那家的DNS</p>
<p>nslookup -qt=ns mydomain 如下图</p>
<p><img src="/upfile/img/1675273663.png" alt=""></p>
<p>查看域名cname别名记录生效情况 如下图</p>
<p><img src="/upfile/img/2248453644.png" alt=""></p>
<p>Linux下需要安装下nslookup命令才能使用，命令参数更多，安装方法如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Ubuntu:
</span></span><span class="line"><span class="cl">sudo apt-get install dnsutils
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Debian:
</span></span><span class="line"><span class="cl">apt-get update
</span></span><span class="line"><span class="cl">apt-get install dnsutils
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Fedora / Centos / RedHat:
</span></span><span class="line"><span class="cl">yum install bind-utils
</span></span></code></pre></div><p>一般使用交互模式:
输入 nslookup 回车，即可进入交互模式，然后输入域名，即可查询域名的解析情况，如下图：</p>
<p><img src="/upfile/img/2026025175.png" alt=""></p>
<p><img src="/upfile/img/97009822.png" alt=""></p>
<p>说明如下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ nslookup
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">www.baidu.com
</span></span><span class="line"><span class="cl">Server: 61.139.2.69 //上连的DNS服务器
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Address: 61.139.2.69#53 //上连的DNS服务器的IP地址与端口号
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Non-authoritative answer: //非权威答案，即从上连DNS服务器的本地缓存中读取出的值，而非实际去查询到的值
</span></span><span class="line"><span class="cl">www.baidu.com canonical <span class="nv">name</span> <span class="o">=</span> www.a.shifen.com. //说明www.baidu.com有个别名叫www.a.shifen.com
</span></span><span class="line"><span class="cl">Name: www.a.shifen.com //域名www.a.shifen.com
</span></span><span class="line"><span class="cl">Address: 115.239.210.27 //对应的IP地址之一
</span></span><span class="line"><span class="cl">Name: www.a.shifen.com
</span></span><span class="line"><span class="cl">Address: 115.239.211.112//对应的IP地址之二
</span></span></code></pre></div><p>首先nslookup会连接到当前的默认上连DNS服务器去查询domain的IP地址，并将之作为当前默认上连DNS服务器。
另外，还有一个命令叫做lserver [domain]，它与server的区别在于，它是取本地的第一台DNS服务器来查询domain的IP地址，并将之作为当前默认上连DNS服务器。（lserver中的首字母l就是local的意思）</p>
<p>以上是使用默认的dns服务器查询，可以用server设置要查询的dns服务器如下图：</p>
<p><img src="/upfile/img/3864936082.png" alt=""></p>
<p>上面是使用google的dns服务器8.8.8.8来查询baidu域名的解析情况；</p>
<p>其他常用参数：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">exit</span>
</span></span><span class="line"><span class="cl">退出nslookup的交互模式。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">set</span> all
</span></span><span class="line"><span class="cl">列出nslookup工具的常用选项的当前设置值。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">set</span> all
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Default server: 8.8.8.8 //当前的上连DNS服务器
</span></span><span class="line"><span class="cl">Address: 8.8.8.8#53 //当前的上连DNS服务器的IP地址和端口
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Set options:
</span></span><span class="line"><span class="cl">novc nodebug nod2
</span></span><span class="line"><span class="cl">search recurse
</span></span><span class="line"><span class="cl"><span class="nv">timeout</span> <span class="o">=</span> <span class="m">0</span> <span class="nv">retry</span> <span class="o">=</span> <span class="m">3</span> <span class="nv">port</span> <span class="o">=</span> <span class="m">53</span>
</span></span><span class="line"><span class="cl"><span class="nv">querytype</span> <span class="o">=</span> A <span class="nv">class</span> <span class="o">=</span> IN
</span></span><span class="line"><span class="cl"><span class="nv">srchlist</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">set</span> <span class="nv">type</span><span class="o">=[</span>value<span class="o">]</span>
</span></span><span class="line"><span class="cl">也可以写成set <span class="nv">querytype</span><span class="o">=[</span>value<span class="o">]</span>，用于更改信息查询类型。
</span></span></code></pre></div><p>默认情况下，nslookup是查询域名所对应的A记录，而如果你想查询其对应的MX记录等信息时，就需要专门设置type值了。
目前常用的type值如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">A：查看主机的IPv4地址
</span></span><span class="line"><span class="cl">AAAA：查看主机的IPv6地址
</span></span><span class="line"><span class="cl">ANY：查看关于主机域的所有信息
</span></span><span class="line"><span class="cl">CNAME：查找与别名对应的正式名字
</span></span><span class="line"><span class="cl">HINFO：查找主机的CPU与操作系统类型
</span></span><span class="line"><span class="cl">MINFO：查找邮箱信息
</span></span><span class="line"><span class="cl">MX：查找邮件交换信息
</span></span><span class="line"><span class="cl">NS：查找主机域的域名服务器
</span></span><span class="line"><span class="cl">PTR：查找与给定IP地址匹配的主机名
</span></span><span class="line"><span class="cl">RP：查找域负责人记录
</span></span><span class="line"><span class="cl">SOA：查找域内的SOA地址
</span></span><span class="line"><span class="cl">UINFO：查找用户信息
</span></span><span class="line"><span class="cl">例如，针对MX类型的查询结果如下：
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">set</span> <span class="nv">type</span><span class="o">=</span>MX
</span></span><span class="line"><span class="cl">baidu.com //查询MX信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Server: 61.139.2.69
</span></span><span class="line"><span class="cl">Address: 61.139.2.69#53
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Non-authoritative answer:
</span></span><span class="line"><span class="cl">baidu.com mail <span class="nv">exchanger</span> <span class="o">=</span> <span class="m">20</span> jpmx.baidu.com.
</span></span><span class="line"><span class="cl">baidu.com mail <span class="nv">exchanger</span> <span class="o">=</span> <span class="m">20</span> mx50.baidu.com.
</span></span><span class="line"><span class="cl">baidu.com mail <span class="nv">exchanger</span> <span class="o">=</span> <span class="m">10</span> mx.mailcdn.baidu.com.
</span></span><span class="line"><span class="cl">baidu.com mail <span class="nv">exchanger</span> <span class="o">=</span> <span class="m">20</span> mx1.baidu.com.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Authoritative answers can be found from:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">set</span> <span class="nv">type</span><span class="o">=</span>A
</span></span><span class="line"><span class="cl">baidu.com //查询A记录
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Server: 61.139.2.69
</span></span><span class="line"><span class="cl">Address: 61.139.2.69#53
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Non-authoritative answer:
</span></span><span class="line"><span class="cl">Name: baidu.com
</span></span><span class="line"><span class="cl">Address: 123.125.114.144
</span></span><span class="line"><span class="cl">Name: baidu.com
</span></span><span class="line"><span class="cl">Address: 220.181.111.85
</span></span><span class="line"><span class="cl">Name: baidu.com
</span></span><span class="line"><span class="cl">Address: 220.181.111.86
</span></span></code></pre></div><p><img src="/upfile/img/3714611251.png" alt=""></p>
<p><img src="/upfile/img/19385084.png" alt=""></p>
</div>
                    <div class="post_footer">
                        
                        <div class="meta">
                            <div class="info">
                                <span class="field tags">
                                    <i class="ri-stack-line"></i>
                                    
                                    <a href="/tags/dns/">DNS</a>
                                    
                                    <a href="/tags/nslookup/">nslookup</a>
                                    
                                    <a href="/tags/%E8%A7%A3%E6%9E%90/">解析</a>
                                    
                                    <a href="/tags/%E7%94%9F%E6%95%88/">生效</a>
                                    
                                </span>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                
                
<div>    
    <div class="pagination__title">
        <span class="pagination__title-h" style="font-size: 16px;">发表评论</span>
        <br/>
    </div>
    <div id="tcomment"></div>
    <script src="https://utteranc.es/client.js"
            repo="rootdba/rootdba.github.io" 
            issue-term="url"
            theme="preferred-color-scheme"
            crossorigin="anonymous"
            async>
    </script>
</div>




                
            </div>
        </div>
    </div>
    <a id="back_to_top" href="#" class="back_to_top"><i class="ri-arrow-up-s-line"></i></a>
    <footer class="footer">
    <div class="powered_by">

        
        <a href="/">&copy; 2015-2023 牧人池塘</a> <a href="https://gohugo.io/" target="_blank">Hugo驱动</a> <a href="https://github.com/varkai/hugo-theme-zozo" target="_blank">Theme: Zozo</a> <a href='/index.xml' target="_blank" title='Rss订阅'>Rss订阅</a> 

    </div>

    <div class="footer_slogan">
        <span>勿在浮沙筑高台，不为繁华易匠心.</span><br>
    </div>
</footer>
    <script src="/js/jquery-3.5.1.min.js"></script>
<link href="/css/fancybox.min.css" rel="stylesheet">
<script src="/js/fancybox.min.js"></script>
<script src="/js/zozo.js"></script>


<script type="text/javascript" async
    src="/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
                processEscapes: true,
                processEnvironments: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                TeX: {
                    equationNumbers: { autoNumber: "AMS" },
                    extensions: ["AMSmath.js", "AMSsymbols.js"]
                }
            }
        });

        MathJax.Hub.Queue(function () {
            
            
            
            var all = MathJax.Hub.getAllJax(), i;
            for (i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

<style>
    code.has-jax {
        font: inherit;
        font-size: 100%;
        background: inherit;
        border: inherit;
        color: #515151;
    }
</style>



</body>

</html>